function N1(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function Yl(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const Je={},_i=[],Hr=()=>{},a0=()=>!1,ao=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Jl=e=>e.startsWith("onUpdate:"),Wt=Object.assign,Ql=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},D1=Object.prototype.hasOwnProperty,Ve=(e,t)=>D1.call(e,t),Re=Array.isArray,xi=e=>Ls(e)==="[object Map]",oo=e=>Ls(e)==="[object Set]",Xc=e=>Ls(e)==="[object Date]",Fe=e=>typeof e=="function",vt=e=>typeof e=="string",Wr=e=>typeof e=="symbol",Qe=e=>e!==null&&typeof e=="object",o0=e=>(Qe(e)||Fe(e))&&Fe(e.then)&&Fe(e.catch),l0=Object.prototype.toString,Ls=e=>l0.call(e),L1=e=>Ls(e).slice(8,-1),c0=e=>Ls(e)==="[object Object]",Zl=e=>vt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,os=Yl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),lo=e=>{const t=Object.create(null);return(r=>t[r]||(t[r]=e(r)))},M1=/-\w/g,wr=lo(e=>e.replace(M1,t=>t.slice(1).toUpperCase())),B1=/\B([A-Z])/g,Rn=lo(e=>e.replace(B1,"-$1").toLowerCase()),co=lo(e=>e.charAt(0).toUpperCase()+e.slice(1)),Lo=lo(e=>e?`on${co(e)}`:""),bn=(e,t)=>!Object.is(e,t),va=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},u0=(e,t,r,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:r})},uo=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Yc;const fo=()=>Yc||(Yc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ec(e){if(Re(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=vt(n)?H1(n):ec(n);if(i)for(const s in i)t[s]=i[s]}return t}else if(vt(e)||Qe(e))return e}const U1=/;(?![^(]*\))/g,j1=/:([^]+)/,$1=/\/\*[^]*?\*\//g;function H1(e){const t={};return e.replace($1,"").split(U1).forEach(r=>{if(r){const n=r.split(j1);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Ir(e){let t="";if(vt(e))t=e;else if(Re(e))for(let r=0;r<e.length;r++){const n=Ir(e[r]);n&&(t+=n+" ")}else if(Qe(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const W1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",V1=Yl(W1);function f0(e){return!!e||e===""}function K1(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=ho(e[n],t[n]);return r}function ho(e,t){if(e===t)return!0;let r=Xc(e),n=Xc(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=Wr(e),n=Wr(t),r||n)return e===t;if(r=Re(e),n=Re(t),r||n)return r&&n?K1(e,t):!1;if(r=Qe(e),n=Qe(t),r||n){if(!r||!n)return!1;const i=Object.keys(e).length,s=Object.keys(t).length;if(i!==s)return!1;for(const a in e){const o=e.hasOwnProperty(a),l=t.hasOwnProperty(a);if(o&&!l||!o&&l||!ho(e[a],t[a]))return!1}}return String(e)===String(t)}function z1(e,t){return e.findIndex(r=>ho(r,t))}const h0=e=>!!(e&&e.__v_isRef===!0),Ce=e=>vt(e)?e:e==null?"":Re(e)||Qe(e)&&(e.toString===l0||!Fe(e.toString))?h0(e)?Ce(e.value):JSON.stringify(e,d0,2):String(e),d0=(e,t)=>h0(t)?d0(e,t.value):xi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,i],s)=>(r[Mo(n,s)+" =>"]=i,r),{})}:oo(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>Mo(r))}:Wr(t)?Mo(t):Qe(t)&&!Re(t)&&!c0(t)?String(t):t,Mo=(e,t="")=>{var r;return Wr(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};let Jt;class G1{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Jt,!t&&Jt&&(this.index=(Jt.scopes||(Jt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].pause();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].resume();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].resume()}}run(t){if(this._active){const r=Jt;try{return Jt=this,t()}finally{Jt=r}}}on(){++this._on===1&&(this.prevScope=Jt,Jt=this)}off(){this._on>0&&--this._on===0&&(Jt=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function q1(){return Jt}let et;const Bo=new WeakSet;class p0{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Jt&&Jt.active&&Jt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Bo.has(this)&&(Bo.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||m0(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Jc(this),v0(this);const t=et,r=Fr;et=this,Fr=!0;try{return this.fn()}finally{_0(this),et=t,Fr=r,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)nc(t);this.deps=this.depsTail=void 0,Jc(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Bo.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){dl(this)&&this.run()}get dirty(){return dl(this)}}let g0=0,ls,cs;function m0(e,t=!1){if(e.flags|=8,t){e.next=cs,cs=e;return}e.next=ls,ls=e}function tc(){g0++}function rc(){if(--g0>0)return;if(cs){let t=cs;for(cs=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let e;for(;ls;){let t=ls;for(ls=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function v0(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function _0(e){let t,r=e.depsTail,n=r;for(;n;){const i=n.prevDep;n.version===-1?(n===r&&(r=i),nc(n),X1(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}e.deps=t,e.depsTail=r}function dl(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(x0(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function x0(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ys)||(e.globalVersion=ys,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!dl(e))))return;e.flags|=2;const t=e.dep,r=et,n=Fr;et=e,Fr=!0;try{v0(e);const i=e.fn(e._value);(t.version===0||bn(i,e._value))&&(e.flags|=128,e._value=i,t.version++)}catch(i){throw t.version++,i}finally{et=r,Fr=n,_0(e),e.flags&=-3}}function nc(e,t=!1){const{dep:r,prevSub:n,nextSub:i}=e;if(n&&(n.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let s=r.computed.deps;s;s=s.nextDep)nc(s,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function X1(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let Fr=!0;const w0=[];function an(){w0.push(Fr),Fr=!1}function on(){const e=w0.pop();Fr=e===void 0?!0:e}function Jc(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const r=et;et=void 0;try{t()}finally{et=r}}}let ys=0;class Y1{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ic{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!et||!Fr||et===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==et)r=this.activeLink=new Y1(et,this),et.deps?(r.prevDep=et.depsTail,et.depsTail.nextDep=r,et.depsTail=r):et.deps=et.depsTail=r,y0(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=et.depsTail,r.nextDep=void 0,et.depsTail.nextDep=r,et.depsTail=r,et.deps===r&&(et.deps=n)}return r}trigger(t){this.version++,ys++,this.notify(t)}notify(t){tc();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{rc()}}}function y0(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)y0(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}}const pl=new WeakMap,Gn=Symbol(""),gl=Symbol(""),Es=Symbol("");function Bt(e,t,r){if(Fr&&et){let n=pl.get(e);n||pl.set(e,n=new Map);let i=n.get(r);i||(n.set(r,i=new ic),i.map=n,i.key=r),i.track()}}function Zr(e,t,r,n,i,s){const a=pl.get(e);if(!a){ys++;return}const o=l=>{l&&l.trigger()};if(tc(),t==="clear")a.forEach(o);else{const l=Re(e),c=l&&Zl(r);if(l&&r==="length"){const u=Number(n);a.forEach((f,h)=>{(h==="length"||h===Es||!Wr(h)&&h>=u)&&o(f)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),c&&o(a.get(Es)),t){case"add":l?c&&o(a.get("length")):(o(a.get(Gn)),xi(e)&&o(a.get(gl)));break;case"delete":l||(o(a.get(Gn)),xi(e)&&o(a.get(gl)));break;case"set":xi(e)&&o(a.get(Gn));break}}rc()}function ii(e){const t=We(e);return t===e?t:(Bt(t,"iterate",Es),xr(e)?t:t.map(Nr))}function po(e){return Bt(e=We(e),"iterate",Es),e}function vn(e,t){return ln(e)?qn(e)?Ri(Nr(t)):Ri(t):Nr(t)}const J1={__proto__:null,[Symbol.iterator](){return Uo(this,Symbol.iterator,e=>vn(this,e))},concat(...e){return ii(this).concat(...e.map(t=>Re(t)?ii(t):t))},entries(){return Uo(this,"entries",e=>(e[1]=vn(this,e[1]),e))},every(e,t){return Gr(this,"every",e,t,void 0,arguments)},filter(e,t){return Gr(this,"filter",e,t,r=>r.map(n=>vn(this,n)),arguments)},find(e,t){return Gr(this,"find",e,t,r=>vn(this,r),arguments)},findIndex(e,t){return Gr(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Gr(this,"findLast",e,t,r=>vn(this,r),arguments)},findLastIndex(e,t){return Gr(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Gr(this,"forEach",e,t,void 0,arguments)},includes(...e){return jo(this,"includes",e)},indexOf(...e){return jo(this,"indexOf",e)},join(e){return ii(this).join(e)},lastIndexOf(...e){return jo(this,"lastIndexOf",e)},map(e,t){return Gr(this,"map",e,t,void 0,arguments)},pop(){return Xi(this,"pop")},push(...e){return Xi(this,"push",e)},reduce(e,...t){return Qc(this,"reduce",e,t)},reduceRight(e,...t){return Qc(this,"reduceRight",e,t)},shift(){return Xi(this,"shift")},some(e,t){return Gr(this,"some",e,t,void 0,arguments)},splice(...e){return Xi(this,"splice",e)},toReversed(){return ii(this).toReversed()},toSorted(e){return ii(this).toSorted(e)},toSpliced(...e){return ii(this).toSpliced(...e)},unshift(...e){return Xi(this,"unshift",e)},values(){return Uo(this,"values",e=>vn(this,e))}};function Uo(e,t,r){const n=po(e),i=n[t]();return n!==e&&!xr(e)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.done||(s.value=r(s.value)),s}),i}const Q1=Array.prototype;function Gr(e,t,r,n,i,s){const a=po(e),o=a!==e&&!xr(e),l=a[t];if(l!==Q1[t]){const f=l.apply(e,s);return o?Nr(f):f}let c=r;a!==e&&(o?c=function(f,h){return r.call(this,vn(e,f),h,e)}:r.length>2&&(c=function(f,h){return r.call(this,f,h,e)}));const u=l.call(a,c,n);return o&&i?i(u):u}function Qc(e,t,r,n){const i=po(e);let s=r;return i!==e&&(xr(e)?r.length>3&&(s=function(a,o,l){return r.call(this,a,o,l,e)}):s=function(a,o,l){return r.call(this,a,vn(e,o),l,e)}),i[t](s,...n)}function jo(e,t,r){const n=We(e);Bt(n,"iterate",Es);const i=n[t](...r);return(i===-1||i===!1)&&oc(r[0])?(r[0]=We(r[0]),n[t](...r)):i}function Xi(e,t,r=[]){an(),tc();const n=We(e)[t].apply(e,r);return rc(),on(),n}const Z1=Yl("__proto__,__v_isRef,__isVue"),E0=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Wr));function eg(e){Wr(e)||(e=String(e));const t=We(this);return Bt(t,"has",e),t.hasOwnProperty(e)}class T0{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){if(r==="__v_skip")return t.__v_skip;const i=this._isReadonly,s=this._isShallow;if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return s;if(r==="__v_raw")return n===(i?s?ug:k0:s?A0:b0).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const a=Re(t);if(!i){let l;if(a&&(l=J1[r]))return l;if(r==="hasOwnProperty")return eg}const o=Reflect.get(t,r,jt(t)?t:n);if((Wr(r)?E0.has(r):Z1(r))||(i||Bt(t,"get",r),s))return o;if(jt(o)){const l=a&&Zl(r)?o:o.value;return i&&Qe(l)?vl(l):l}return Qe(o)?i?vl(o):go(o):o}}class S0 extends T0{constructor(t=!1){super(!1,t)}set(t,r,n,i){let s=t[r];const a=Re(t)&&Zl(r);if(!this._isShallow){const c=ln(s);if(!xr(n)&&!ln(n)&&(s=We(s),n=We(n)),!a&&jt(s)&&!jt(n))return c||(s.value=n),!0}const o=a?Number(r)<t.length:Ve(t,r),l=Reflect.set(t,r,n,jt(t)?t:i);return t===We(i)&&(o?bn(n,s)&&Zr(t,"set",r,n):Zr(t,"add",r,n)),l}deleteProperty(t,r){const n=Ve(t,r);t[r];const i=Reflect.deleteProperty(t,r);return i&&n&&Zr(t,"delete",r,void 0),i}has(t,r){const n=Reflect.has(t,r);return(!Wr(r)||!E0.has(r))&&Bt(t,"has",r),n}ownKeys(t){return Bt(t,"iterate",Re(t)?"length":Gn),Reflect.ownKeys(t)}}class tg extends T0{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const rg=new S0,ng=new tg,ig=new S0(!0);const ml=e=>e,Js=e=>Reflect.getPrototypeOf(e);function sg(e,t,r){return function(...n){const i=this.__v_raw,s=We(i),a=xi(s),o=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,c=i[e](...n),u=r?ml:t?Ri:Nr;return!t&&Bt(s,"iterate",l?gl:Gn),{next(){const{value:f,done:h}=c.next();return h?{value:f,done:h}:{value:o?[u(f[0]),u(f[1])]:u(f),done:h}},[Symbol.iterator](){return this}}}}function Qs(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function ag(e,t){const r={get(i){const s=this.__v_raw,a=We(s),o=We(i);e||(bn(i,o)&&Bt(a,"get",i),Bt(a,"get",o));const{has:l}=Js(a),c=t?ml:e?Ri:Nr;if(l.call(a,i))return c(s.get(i));if(l.call(a,o))return c(s.get(o));s!==a&&s.get(i)},get size(){const i=this.__v_raw;return!e&&Bt(We(i),"iterate",Gn),i.size},has(i){const s=this.__v_raw,a=We(s),o=We(i);return e||(bn(i,o)&&Bt(a,"has",i),Bt(a,"has",o)),i===o?s.has(i):s.has(i)||s.has(o)},forEach(i,s){const a=this,o=a.__v_raw,l=We(o),c=t?ml:e?Ri:Nr;return!e&&Bt(l,"iterate",Gn),o.forEach((u,f)=>i.call(s,c(u),c(f),a))}};return Wt(r,e?{add:Qs("add"),set:Qs("set"),delete:Qs("delete"),clear:Qs("clear")}:{add(i){!t&&!xr(i)&&!ln(i)&&(i=We(i));const s=We(this);return Js(s).has.call(s,i)||(s.add(i),Zr(s,"add",i,i)),this},set(i,s){!t&&!xr(s)&&!ln(s)&&(s=We(s));const a=We(this),{has:o,get:l}=Js(a);let c=o.call(a,i);c||(i=We(i),c=o.call(a,i));const u=l.call(a,i);return a.set(i,s),c?bn(s,u)&&Zr(a,"set",i,s):Zr(a,"add",i,s),this},delete(i){const s=We(this),{has:a,get:o}=Js(s);let l=a.call(s,i);l||(i=We(i),l=a.call(s,i)),o&&o.call(s,i);const c=s.delete(i);return l&&Zr(s,"delete",i,void 0),c},clear(){const i=We(this),s=i.size!==0,a=i.clear();return s&&Zr(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{r[i]=sg(i,e,t)}),r}function sc(e,t){const r=ag(e,t);return(n,i,s)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(Ve(r,i)&&i in n?r:n,i,s)}const og={get:sc(!1,!1)},lg={get:sc(!1,!0)},cg={get:sc(!0,!1)};const b0=new WeakMap,A0=new WeakMap,k0=new WeakMap,ug=new WeakMap;function fg(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function hg(e){return e.__v_skip||!Object.isExtensible(e)?0:fg(L1(e))}function go(e){return ln(e)?e:ac(e,!1,rg,og,b0)}function O0(e){return ac(e,!1,ig,lg,A0)}function vl(e){return ac(e,!0,ng,cg,k0)}function ac(e,t,r,n,i){if(!Qe(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=hg(e);if(s===0)return e;const a=i.get(e);if(a)return a;const o=new Proxy(e,s===2?n:r);return i.set(e,o),o}function qn(e){return ln(e)?qn(e.__v_raw):!!(e&&e.__v_isReactive)}function ln(e){return!!(e&&e.__v_isReadonly)}function xr(e){return!!(e&&e.__v_isShallow)}function oc(e){return e?!!e.__v_raw:!1}function We(e){const t=e&&e.__v_raw;return t?We(t):e}function dg(e){return!Ve(e,"__v_skip")&&Object.isExtensible(e)&&u0(e,"__v_skip",!0),e}const Nr=e=>Qe(e)?go(e):e,Ri=e=>Qe(e)?vl(e):e;function jt(e){return e?e.__v_isRef===!0:!1}function pg(e){return C0(e,!1)}function gg(e){return C0(e,!0)}function C0(e,t){return jt(e)?e:new mg(e,t)}class mg{constructor(t,r){this.dep=new ic,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:We(t),this._value=r?t:Nr(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||xr(t)||ln(t);t=n?t:We(t),bn(t,r)&&(this._rawValue=t,this._value=n?t:Nr(t),this.dep.trigger())}}function wi(e){return jt(e)?e.value:e}const vg={get:(e,t,r)=>t==="__v_raw"?e:wi(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return jt(i)&&!jt(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function R0(e){return qn(e)?e:new Proxy(e,vg)}class _g{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new ic(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ys-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&et!==this)return m0(this,!0),!0}get value(){const t=this.dep.track();return x0(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function xg(e,t,r=!1){let n,i;return Fe(e)?n=e:(n=e.get,i=e.set),new _g(n,i,r)}const Zs={},Aa=new WeakMap;let Mn;function wg(e,t=!1,r=Mn){if(r){let n=Aa.get(r);n||Aa.set(r,n=[]),n.push(e)}}function yg(e,t,r=Je){const{immediate:n,deep:i,once:s,scheduler:a,augmentJob:o,call:l}=r,c=O=>i?O:xr(O)||i===!1||i===0?en(O,1):en(O);let u,f,h,d,g=!1,p=!1;if(jt(e)?(f=()=>e.value,g=xr(e)):qn(e)?(f=()=>c(e),g=!0):Re(e)?(p=!0,g=e.some(O=>qn(O)||xr(O)),f=()=>e.map(O=>{if(jt(O))return O.value;if(qn(O))return c(O);if(Fe(O))return l?l(O,2):O()})):Fe(e)?t?f=l?()=>l(e,2):e:f=()=>{if(h){an();try{h()}finally{on()}}const O=Mn;Mn=u;try{return l?l(e,3,[d]):e(d)}finally{Mn=O}}:f=Hr,t&&i){const O=f,V=i===!0?1/0:i;f=()=>en(O(),V)}const m=q1(),w=()=>{u.stop(),m&&m.active&&Ql(m.effects,u)};if(s&&t){const O=t;t=(...V)=>{O(...V),w()}}let T=p?new Array(e.length).fill(Zs):Zs;const _=O=>{if(!(!(u.flags&1)||!u.dirty&&!O))if(t){const V=u.run();if(i||g||(p?V.some((ee,I)=>bn(ee,T[I])):bn(V,T))){h&&h();const ee=Mn;Mn=u;try{const I=[V,T===Zs?void 0:p&&T[0]===Zs?[]:T,d];T=V,l?l(t,3,I):t(...I)}finally{Mn=ee}}}else u.run()};return o&&o(_),u=new p0(f),u.scheduler=a?()=>a(_,!1):_,d=O=>wg(O,!1,u),h=u.onStop=()=>{const O=Aa.get(u);if(O){if(l)l(O,4);else for(const V of O)V();Aa.delete(u)}},t?n?_(!0):T=u.run():a?a(_.bind(null,!0),!0):u.run(),w.pause=u.pause.bind(u),w.resume=u.resume.bind(u),w.stop=w,w}function en(e,t=1/0,r){if(t<=0||!Qe(e)||e.__v_skip||(r=r||new Map,(r.get(e)||0)>=t))return e;if(r.set(e,t),t--,jt(e))en(e.value,t,r);else if(Re(e))for(let n=0;n<e.length;n++)en(e[n],t,r);else if(oo(e)||xi(e))e.forEach(n=>{en(n,t,r)});else if(c0(e)){for(const n in e)en(e[n],t,r);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&en(e[n],t,r)}return e}function Ms(e,t,r,n){try{return n?e(...n):e()}catch(i){mo(i,t,r)}}function Vr(e,t,r,n){if(Fe(e)){const i=Ms(e,t,r,n);return i&&o0(i)&&i.catch(s=>{mo(s,t,r)}),i}if(Re(e)){const i=[];for(let s=0;s<e.length;s++)i.push(Vr(e[s],t,r,n));return i}}function mo(e,t,r,n=!0){const i=t?t.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||Je;if(t){let o=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const u=o.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](e,l,c)===!1)return}o=o.parent}if(s){an(),Ms(s,null,10,[e,l,c]),on();return}}Eg(e,r,i,n,a)}function Eg(e,t,r,n=!0,i=!1){if(i)throw e;console.error(e)}const qt=[];let Ur=-1;const yi=[];let _n=null,hi=0;const I0=Promise.resolve();let ka=null;function lc(e){const t=ka||I0;return e?t.then(this?e.bind(this):e):t}function Tg(e){let t=Ur+1,r=qt.length;for(;t<r;){const n=t+r>>>1,i=qt[n],s=Ts(i);s<e||s===e&&i.flags&2?t=n+1:r=n}return t}function cc(e){if(!(e.flags&1)){const t=Ts(e),r=qt[qt.length-1];!r||!(e.flags&2)&&t>=Ts(r)?qt.push(e):qt.splice(Tg(t),0,e),e.flags|=1,F0()}}function F0(){ka||(ka=I0.then(N0))}function Sg(e){Re(e)?yi.push(...e):_n&&e.id===-1?_n.splice(hi+1,0,e):e.flags&1||(yi.push(e),e.flags|=1),F0()}function Zc(e,t,r=Ur+1){for(;r<qt.length;r++){const n=qt[r];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;qt.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function P0(e){if(yi.length){const t=[...new Set(yi)].sort((r,n)=>Ts(r)-Ts(n));if(yi.length=0,_n){_n.push(...t);return}for(_n=t,hi=0;hi<_n.length;hi++){const r=_n[hi];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}_n=null,hi=0}}const Ts=e=>e.id==null?e.flags&2?-1:1/0:e.id;function N0(e){try{for(Ur=0;Ur<qt.length;Ur++){const t=qt[Ur];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ms(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ur<qt.length;Ur++){const t=qt[Ur];t&&(t.flags&=-2)}Ur=-1,qt.length=0,P0(),ka=null,(qt.length||yi.length)&&N0()}}let hr=null,D0=null;function Oa(e){const t=hr;return hr=e,D0=e&&e.type.__scopeId||null,t}function uc(e,t=hr,r){if(!t||e._n)return e;const n=(...i)=>{n._d&&Ia(-1);const s=Oa(t);let a;try{a=e(...i)}finally{Oa(s),n._d&&Ia(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Qt(e,t){if(hr===null)return e;const r=wo(hr),n=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,a,o,l=Je]=t[i];s&&(Fe(s)&&(s={mounted:s,updated:s}),s.deep&&en(a),n.push({dir:s,instance:r,value:a,oldValue:void 0,arg:o,modifiers:l}))}return e}function Pn(e,t,r,n){const i=e.dirs,s=t&&t.dirs;for(let a=0;a<i.length;a++){const o=i[a];s&&(o.oldValue=s[a].value);let l=o.dir[n];l&&(an(),Vr(l,r,8,[e.el,o,e,t]),on())}}const bg=Symbol("_vte"),Ag=e=>e.__isTeleport,kg=Symbol("_leaveCb");function fc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,fc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function L0(e,t){return Fe(e)?Wt({name:e.name},t,{setup:e}):e}function M0(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Ca=new WeakMap;function us(e,t,r,n,i=!1){if(Re(e)){e.forEach((g,p)=>us(g,t&&(Re(t)?t[p]:t),r,n,i));return}if(fs(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&us(e,t,r,n.component.subTree);return}const s=n.shapeFlag&4?wo(n.component):n.el,a=i?null:s,{i:o,r:l}=e,c=t&&t.r,u=o.refs===Je?o.refs={}:o.refs,f=o.setupState,h=We(f),d=f===Je?a0:g=>Ve(h,g);if(c!=null&&c!==l){if(eu(t),vt(c))u[c]=null,d(c)&&(f[c]=null);else if(jt(c)){c.value=null;const g=t;g.k&&(u[g.k]=null)}}if(Fe(l))Ms(l,o,12,[a,u]);else{const g=vt(l),p=jt(l);if(g||p){const m=()=>{if(e.f){const w=g?d(l)?f[l]:u[l]:l.value;if(i)Re(w)&&Ql(w,s);else if(Re(w))w.includes(s)||w.push(s);else if(g)u[l]=[s],d(l)&&(f[l]=u[l]);else{const T=[s];l.value=T,e.k&&(u[e.k]=T)}}else g?(u[l]=a,d(l)&&(f[l]=a)):p&&(l.value=a,e.k&&(u[e.k]=a))};if(a){const w=()=>{m(),Ca.delete(e)};w.id=-1,Ca.set(e,w),sr(w,r)}else eu(e),m()}}}function eu(e){const t=Ca.get(e);t&&(t.flags|=8,Ca.delete(e))}fo().requestIdleCallback;fo().cancelIdleCallback;const fs=e=>!!e.type.__asyncLoader,B0=e=>e.type.__isKeepAlive;function Og(e,t){U0(e,"a",t)}function Cg(e,t){U0(e,"da",t)}function U0(e,t,r=Ut){const n=e.__wdc||(e.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(vo(t,n,r),r){let i=r.parent;for(;i&&i.parent;)B0(i.parent.vnode)&&Rg(n,t,r,i),i=i.parent}}function Rg(e,t,r,n){const i=vo(t,e,n,!0);j0(()=>{Ql(n[t],i)},r)}function vo(e,t,r=Ut,n=!1){if(r){const i=r[e]||(r[e]=[]),s=t.__weh||(t.__weh=(...a)=>{an();const o=Us(r),l=Vr(t,r,e,a);return o(),on(),l});return n?i.unshift(s):i.push(s),s}}const fn=e=>(t,r=Ut)=>{(!bs||e==="sp")&&vo(e,(...n)=>t(...n),r)},Ig=fn("bm"),Fg=fn("m"),Pg=fn("bu"),Ng=fn("u"),Dg=fn("bum"),j0=fn("um"),Lg=fn("sp"),Mg=fn("rtg"),Bg=fn("rtc");function Ug(e,t=Ut){vo("ec",e,t)}const jg="components";function Bs(e,t){return Hg(jg,e,!0,t)||e}const $g=Symbol.for("v-ndc");function Hg(e,t,r=!0,n=!1){const i=hr||Ut;if(i){const s=i.type;{const o=Rm(s,!1);if(o&&(o===t||o===wr(t)||o===co(wr(t))))return s}const a=tu(i[e]||s[e],t)||tu(i.appContext[e],t);return!a&&n?s:a}}function tu(e,t){return e&&(e[t]||e[wr(t)]||e[co(wr(t))])}function lr(e,t,r,n){let i;const s=r,a=Re(e);if(a||vt(e)){const o=a&&qn(e);let l=!1,c=!1;o&&(l=!xr(e),c=ln(e),e=po(e)),i=new Array(e.length);for(let u=0,f=e.length;u<f;u++)i[u]=t(l?c?Ri(Nr(e[u])):Nr(e[u]):e[u],u,void 0,s)}else if(typeof e=="number"){i=new Array(e);for(let o=0;o<e;o++)i[o]=t(o+1,o,void 0,s)}else if(Qe(e))if(e[Symbol.iterator])i=Array.from(e,(o,l)=>t(o,l,void 0,s));else{const o=Object.keys(e);i=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const u=o[l];i[l]=t(e[u],u,l,s)}}else i=[];return i}const _l=e=>e?oh(e)?wo(e):_l(e.parent):null,hs=Wt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>_l(e.parent),$root:e=>_l(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>H0(e),$forceUpdate:e=>e.f||(e.f=()=>{cc(e.update)}),$nextTick:e=>e.n||(e.n=lc.bind(e.proxy)),$watch:e=>Zg.bind(e)}),$o=(e,t)=>e!==Je&&!e.__isScriptSetup&&Ve(e,t),Wg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:n,data:i,props:s,accessCache:a,type:o,appContext:l}=e;if(t[0]!=="$"){const h=a[t];if(h!==void 0)switch(h){case 1:return n[t];case 2:return i[t];case 4:return r[t];case 3:return s[t]}else{if($o(n,t))return a[t]=1,n[t];if(i!==Je&&Ve(i,t))return a[t]=2,i[t];if(Ve(s,t))return a[t]=3,s[t];if(r!==Je&&Ve(r,t))return a[t]=4,r[t];xl&&(a[t]=0)}}const c=hs[t];let u,f;if(c)return t==="$attrs"&&Bt(e.attrs,"get",""),c(e);if((u=o.__cssModules)&&(u=u[t]))return u;if(r!==Je&&Ve(r,t))return a[t]=4,r[t];if(f=l.config.globalProperties,Ve(f,t))return f[t]},set({_:e},t,r){const{data:n,setupState:i,ctx:s}=e;return $o(i,t)?(i[t]=r,!0):n!==Je&&Ve(n,t)?(n[t]=r,!0):Ve(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:i,props:s,type:a}},o){let l;return!!(r[o]||e!==Je&&o[0]!=="$"&&Ve(e,o)||$o(t,o)||Ve(s,o)||Ve(n,o)||Ve(hs,o)||Ve(i.config.globalProperties,o)||(l=a.__cssModules)&&l[o])},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Ve(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function ru(e){return Re(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let xl=!0;function Vg(e){const t=H0(e),r=e.proxy,n=e.ctx;xl=!1,t.beforeCreate&&nu(t.beforeCreate,e,"bc");const{data:i,computed:s,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:f,mounted:h,beforeUpdate:d,updated:g,activated:p,deactivated:m,beforeDestroy:w,beforeUnmount:T,destroyed:_,unmounted:O,render:V,renderTracked:ee,renderTriggered:I,errorCaptured:q,serverPrefetch:M,expose:te,inheritAttrs:ne,components:se,directives:de,filters:Be}=t;if(c&&Kg(c,n,null),a)for(const be in a){const Pe=a[be];Fe(Pe)&&(n[be]=Pe.bind(r))}if(i){const be=i.call(r,r);Qe(be)&&(e.data=go(be))}if(xl=!0,s)for(const be in s){const Pe=s[be],Xe=Fe(Pe)?Pe.bind(r,r):Fe(Pe.get)?Pe.get.bind(r,r):Hr,ht=!Fe(Pe)&&Fe(Pe.set)?Pe.set.bind(r):Hr,it=Or({get:Xe,set:ht});Object.defineProperty(n,be,{enumerable:!0,configurable:!0,get:()=>it.value,set:R=>it.value=R})}if(o)for(const be in o)$0(o[be],n,r,be);if(l){const be=Fe(l)?l.call(r):l;Reflect.ownKeys(be).forEach(Pe=>{_a(Pe,be[Pe])})}u&&nu(u,e,"c");function Me(be,Pe){Re(Pe)?Pe.forEach(Xe=>be(Xe.bind(r))):Pe&&be(Pe.bind(r))}if(Me(Ig,f),Me(Fg,h),Me(Pg,d),Me(Ng,g),Me(Og,p),Me(Cg,m),Me(Ug,q),Me(Bg,ee),Me(Mg,I),Me(Dg,T),Me(j0,O),Me(Lg,M),Re(te))if(te.length){const be=e.exposed||(e.exposed={});te.forEach(Pe=>{Object.defineProperty(be,Pe,{get:()=>r[Pe],set:Xe=>r[Pe]=Xe,enumerable:!0})})}else e.exposed||(e.exposed={});V&&e.render===Hr&&(e.render=V),ne!=null&&(e.inheritAttrs=ne),se&&(e.components=se),de&&(e.directives=de),M&&M0(e)}function Kg(e,t,r=Hr){Re(e)&&(e=wl(e));for(const n in e){const i=e[n];let s;Qe(i)?"default"in i?s=tn(i.from||n,i.default,!0):s=tn(i.from||n):s=tn(i),jt(s)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):t[n]=s}}function nu(e,t,r){Vr(Re(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function $0(e,t,r,n){let i=n.includes(".")?K0(r,n):()=>r[n];if(vt(e)){const s=t[e];Fe(s)&&xa(i,s)}else if(Fe(e))xa(i,e.bind(r));else if(Qe(e))if(Re(e))e.forEach(s=>$0(s,t,r,n));else{const s=Fe(e.handler)?e.handler.bind(r):t[e.handler];Fe(s)&&xa(i,s,e)}}function H0(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:i,optionsCache:s,config:{optionMergeStrategies:a}}=e.appContext,o=s.get(t);let l;return o?l=o:!i.length&&!r&&!n?l=t:(l={},i.length&&i.forEach(c=>Ra(l,c,a,!0)),Ra(l,t,a)),Qe(t)&&s.set(t,l),l}function Ra(e,t,r,n=!1){const{mixins:i,extends:s}=t;s&&Ra(e,s,r,!0),i&&i.forEach(a=>Ra(e,a,r,!0));for(const a in t)if(!(n&&a==="expose")){const o=zg[a]||r&&r[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const zg={data:iu,props:su,emits:su,methods:rs,computed:rs,beforeCreate:Vt,created:Vt,beforeMount:Vt,mounted:Vt,beforeUpdate:Vt,updated:Vt,beforeDestroy:Vt,beforeUnmount:Vt,destroyed:Vt,unmounted:Vt,activated:Vt,deactivated:Vt,errorCaptured:Vt,serverPrefetch:Vt,components:rs,directives:rs,watch:qg,provide:iu,inject:Gg};function iu(e,t){return t?e?function(){return Wt(Fe(e)?e.call(this,this):e,Fe(t)?t.call(this,this):t)}:t:e}function Gg(e,t){return rs(wl(e),wl(t))}function wl(e){if(Re(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Vt(e,t){return e?[...new Set([].concat(e,t))]:t}function rs(e,t){return e?Wt(Object.create(null),e,t):t}function su(e,t){return e?Re(e)&&Re(t)?[...new Set([...e,...t])]:Wt(Object.create(null),ru(e),ru(t??{})):t}function qg(e,t){if(!e)return t;if(!t)return e;const r=Wt(Object.create(null),e);for(const n in t)r[n]=Vt(e[n],t[n]);return r}function W0(){return{app:null,config:{isNativeTag:a0,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Xg=0;function Yg(e,t){return function(n,i=null){Fe(n)||(n=Wt({},n)),i!=null&&!Qe(i)&&(i=null);const s=W0(),a=new WeakSet,o=[];let l=!1;const c=s.app={_uid:Xg++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:Fm,get config(){return s.config},set config(u){},use(u,...f){return a.has(u)||(u&&Fe(u.install)?(a.add(u),u.install(c,...f)):Fe(u)&&(a.add(u),u(c,...f))),c},mixin(u){return s.mixins.includes(u)||s.mixins.push(u),c},component(u,f){return f?(s.components[u]=f,c):s.components[u]},directive(u,f){return f?(s.directives[u]=f,c):s.directives[u]},mount(u,f,h){if(!l){const d=c._ceVNode||Et(n,i);return d.appContext=s,h===!0?h="svg":h===!1&&(h=void 0),e(d,u,h),l=!0,c._container=u,u.__vue_app__=c,wo(d.component)}},onUnmount(u){o.push(u)},unmount(){l&&(Vr(o,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(u,f){return s.provides[u]=f,c},runWithContext(u){const f=Ei;Ei=c;try{return u()}finally{Ei=f}}};return c}}let Ei=null;function _a(e,t){if(Ut){let r=Ut.provides;const n=Ut.parent&&Ut.parent.provides;n===r&&(r=Ut.provides=Object.create(n)),r[e]=t}}function tn(e,t,r=!1){const n=bm();if(n||Ei){let i=Ei?Ei._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return r&&Fe(t)?t.call(n&&n.proxy):t}}const Jg=Symbol.for("v-scx"),Qg=()=>tn(Jg);function xa(e,t,r){return V0(e,t,r)}function V0(e,t,r=Je){const{immediate:n,deep:i,flush:s,once:a}=r,o=Wt({},r),l=t&&n||!t&&s!=="post";let c;if(bs){if(s==="sync"){const d=Qg();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=Hr,d.resume=Hr,d.pause=Hr,d}}const u=Ut;o.call=(d,g,p)=>Vr(d,u,g,p);let f=!1;s==="post"?o.scheduler=d=>{sr(d,u&&u.suspense)}:s!=="sync"&&(f=!0,o.scheduler=(d,g)=>{g?d():cc(d)}),o.augmentJob=d=>{t&&(d.flags|=4),f&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const h=yg(e,t,o);return bs&&(c?c.push(h):l&&h()),h}function Zg(e,t,r){const n=this.proxy,i=vt(e)?e.includes(".")?K0(n,e):()=>n[e]:e.bind(n,n);let s;Fe(t)?s=t:(s=t.handler,r=t);const a=Us(this),o=V0(i,s.bind(n),r);return a(),o}function K0(e,t){const r=t.split(".");return()=>{let n=e;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}const em=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${wr(t)}Modifiers`]||e[`${Rn(t)}Modifiers`];function tm(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Je;let i=r;const s=t.startsWith("update:"),a=s&&em(n,t.slice(7));a&&(a.trim&&(i=r.map(u=>vt(u)?u.trim():u)),a.number&&(i=r.map(uo)));let o,l=n[o=Lo(t)]||n[o=Lo(wr(t))];!l&&s&&(l=n[o=Lo(Rn(t))]),l&&Vr(l,e,6,i);const c=n[o+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,Vr(c,e,6,i)}}const rm=new WeakMap;function z0(e,t,r=!1){const n=r?rm:t.emitsCache,i=n.get(e);if(i!==void 0)return i;const s=e.emits;let a={},o=!1;if(!Fe(e)){const l=c=>{const u=z0(c,t,!0);u&&(o=!0,Wt(a,u))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!s&&!o?(Qe(e)&&n.set(e,null),null):(Re(s)?s.forEach(l=>a[l]=null):Wt(a,s),Qe(e)&&n.set(e,a),a)}function _o(e,t){return!e||!ao(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ve(e,t[0].toLowerCase()+t.slice(1))||Ve(e,Rn(t))||Ve(e,t))}function au(e){const{type:t,vnode:r,proxy:n,withProxy:i,propsOptions:[s],slots:a,attrs:o,emit:l,render:c,renderCache:u,props:f,data:h,setupState:d,ctx:g,inheritAttrs:p}=e,m=Oa(e);let w,T;try{if(r.shapeFlag&4){const O=i||n,V=O;w=$r(c.call(V,O,u,f,d,h,g)),T=o}else{const O=t;w=$r(O.length>1?O(f,{attrs:o,slots:a,emit:l}):O(f,null)),T=t.props?o:nm(o)}}catch(O){ds.length=0,mo(O,e,1),w=Et(An)}let _=w;if(T&&p!==!1){const O=Object.keys(T),{shapeFlag:V}=_;O.length&&V&7&&(s&&O.some(Jl)&&(T=im(T,s)),_=Ii(_,T,!1,!0))}return r.dirs&&(_=Ii(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(r.dirs):r.dirs),r.transition&&fc(_,r.transition),w=_,Oa(m),w}const nm=e=>{let t;for(const r in e)(r==="class"||r==="style"||ao(r))&&((t||(t={}))[r]=e[r]);return t},im=(e,t)=>{const r={};for(const n in e)(!Jl(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function sm(e,t,r){const{props:n,children:i,component:s}=e,{props:a,children:o,patchFlag:l}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?ou(n,a,c):!!a;if(l&8){const u=t.dynamicProps;for(let f=0;f<u.length;f++){const h=u[f];if(a[h]!==n[h]&&!_o(c,h))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?ou(n,a,c):!0:!!a;return!1}function ou(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(t[s]!==e[s]&&!_o(r,s))return!0}return!1}function am({vnode:e,parent:t},r){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=r,t=t.parent;else break}}const G0={},q0=()=>Object.create(G0),X0=e=>Object.getPrototypeOf(e)===G0;function om(e,t,r,n=!1){const i={},s=q0();e.propsDefaults=Object.create(null),Y0(e,t,i,s);for(const a in e.propsOptions[0])a in i||(i[a]=void 0);r?e.props=n?i:O0(i):e.type.props?e.props=i:e.props=s,e.attrs=s}function lm(e,t,r,n){const{props:i,attrs:s,vnode:{patchFlag:a}}=e,o=We(i),[l]=e.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=e.vnode.dynamicProps;for(let f=0;f<u.length;f++){let h=u[f];if(_o(e.emitsOptions,h))continue;const d=t[h];if(l)if(Ve(s,h))d!==s[h]&&(s[h]=d,c=!0);else{const g=wr(h);i[g]=yl(l,o,g,d,e,!1)}else d!==s[h]&&(s[h]=d,c=!0)}}}else{Y0(e,t,i,s)&&(c=!0);let u;for(const f in o)(!t||!Ve(t,f)&&((u=Rn(f))===f||!Ve(t,u)))&&(l?r&&(r[f]!==void 0||r[u]!==void 0)&&(i[f]=yl(l,o,f,void 0,e,!0)):delete i[f]);if(s!==o)for(const f in s)(!t||!Ve(t,f))&&(delete s[f],c=!0)}c&&Zr(e.attrs,"set","")}function Y0(e,t,r,n){const[i,s]=e.propsOptions;let a=!1,o;if(t)for(let l in t){if(os(l))continue;const c=t[l];let u;i&&Ve(i,u=wr(l))?!s||!s.includes(u)?r[u]=c:(o||(o={}))[u]=c:_o(e.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(s){const l=We(r),c=o||Je;for(let u=0;u<s.length;u++){const f=s[u];r[f]=yl(i,l,f,c[f],e,!Ve(c,f))}}return a}function yl(e,t,r,n,i,s){const a=e[r];if(a!=null){const o=Ve(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&Fe(l)){const{propsDefaults:c}=i;if(r in c)n=c[r];else{const u=Us(i);n=c[r]=l.call(null,t),u()}}else n=l;i.ce&&i.ce._setProp(r,n)}a[0]&&(s&&!o?n=!1:a[1]&&(n===""||n===Rn(r))&&(n=!0))}return n}const cm=new WeakMap;function J0(e,t,r=!1){const n=r?cm:t.propsCache,i=n.get(e);if(i)return i;const s=e.props,a={},o=[];let l=!1;if(!Fe(e)){const u=f=>{l=!0;const[h,d]=J0(f,t,!0);Wt(a,h),d&&o.push(...d)};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!s&&!l)return Qe(e)&&n.set(e,_i),_i;if(Re(s))for(let u=0;u<s.length;u++){const f=wr(s[u]);lu(f)&&(a[f]=Je)}else if(s)for(const u in s){const f=wr(u);if(lu(f)){const h=s[u],d=a[f]=Re(h)||Fe(h)?{type:h}:Wt({},h),g=d.type;let p=!1,m=!0;if(Re(g))for(let w=0;w<g.length;++w){const T=g[w],_=Fe(T)&&T.name;if(_==="Boolean"){p=!0;break}else _==="String"&&(m=!1)}else p=Fe(g)&&g.name==="Boolean";d[0]=p,d[1]=m,(p||Ve(d,"default"))&&o.push(f)}}const c=[a,o];return Qe(e)&&n.set(e,c),c}function lu(e){return e[0]!=="$"&&!os(e)}const hc=e=>e==="_"||e==="_ctx"||e==="$stable",dc=e=>Re(e)?e.map($r):[$r(e)],um=(e,t,r)=>{if(t._n)return t;const n=uc((...i)=>dc(t(...i)),r);return n._c=!1,n},Q0=(e,t,r)=>{const n=e._ctx;for(const i in e){if(hc(i))continue;const s=e[i];if(Fe(s))t[i]=um(i,s,n);else if(s!=null){const a=dc(s);t[i]=()=>a}}},Z0=(e,t)=>{const r=dc(t);e.slots.default=()=>r},eh=(e,t,r)=>{for(const n in t)(r||!hc(n))&&(e[n]=t[n])},fm=(e,t,r)=>{const n=e.slots=q0();if(e.vnode.shapeFlag&32){const i=t._;i?(eh(n,t,r),r&&u0(n,"_",i,!0)):Q0(t,n)}else t&&Z0(e,t)},hm=(e,t,r)=>{const{vnode:n,slots:i}=e;let s=!0,a=Je;if(n.shapeFlag&32){const o=t._;o?r&&o===1?s=!1:eh(i,t,r):(s=!t.$stable,Q0(t,i)),a=t}else t&&(Z0(e,t),a={default:1});if(s)for(const o in i)!hc(o)&&a[o]==null&&delete i[o]},sr=vm;function dm(e){return pm(e)}function pm(e,t){const r=fo();r.__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:h,setScopeId:d=Hr,insertStaticContent:g}=e,p=(E,C,F,Y=null,z=null,D=null,ue=void 0,le=null,oe=!!C.dynamicChildren)=>{if(E===C)return;E&&!Yi(E,C)&&(Y=L(E),R(E,z,D,!0),E=null),C.patchFlag===-2&&(oe=!1,C.dynamicChildren=null);const{type:ie,ref:Se,shapeFlag:ge}=C;switch(ie){case xo:m(E,C,F,Y);break;case An:w(E,C,F,Y);break;case Wo:E==null&&T(C,F,Y,ue);break;case rt:se(E,C,F,Y,z,D,ue,le,oe);break;default:ge&1?V(E,C,F,Y,z,D,ue,le,oe):ge&6?de(E,C,F,Y,z,D,ue,le,oe):(ge&64||ge&128)&&ie.process(E,C,F,Y,z,D,ue,le,oe,X)}Se!=null&&z?us(Se,E&&E.ref,D,C||E,!C):Se==null&&E&&E.ref!=null&&us(E.ref,null,D,E,!0)},m=(E,C,F,Y)=>{if(E==null)n(C.el=o(C.children),F,Y);else{const z=C.el=E.el;C.children!==E.children&&c(z,C.children)}},w=(E,C,F,Y)=>{E==null?n(C.el=l(C.children||""),F,Y):C.el=E.el},T=(E,C,F,Y)=>{[E.el,E.anchor]=g(E.children,C,F,Y,E.el,E.anchor)},_=({el:E,anchor:C},F,Y)=>{let z;for(;E&&E!==C;)z=h(E),n(E,F,Y),E=z;n(C,F,Y)},O=({el:E,anchor:C})=>{let F;for(;E&&E!==C;)F=h(E),i(E),E=F;i(C)},V=(E,C,F,Y,z,D,ue,le,oe)=>{if(C.type==="svg"?ue="svg":C.type==="math"&&(ue="mathml"),E==null)ee(C,F,Y,z,D,ue,le,oe);else{const ie=E.el&&E.el._isVueCE?E.el:null;try{ie&&ie._beginPatch(),M(E,C,z,D,ue,le,oe)}finally{ie&&ie._endPatch()}}},ee=(E,C,F,Y,z,D,ue,le)=>{let oe,ie;const{props:Se,shapeFlag:ge,transition:ye,dirs:Ae}=E;if(oe=E.el=a(E.type,D,Se&&Se.is,Se),ge&8?u(oe,E.children):ge&16&&q(E.children,oe,null,Y,z,Ho(E,D),ue,le),Ae&&Pn(E,null,Y,"created"),I(oe,E,E.scopeId,ue,Y),Se){for(const $e in Se)$e!=="value"&&!os($e)&&s(oe,$e,null,Se[$e],D,Y);"value"in Se&&s(oe,"value",null,Se.value,D),(ie=Se.onVnodeBeforeMount)&&Lr(ie,Y,E)}Ae&&Pn(E,null,Y,"beforeMount");const De=gm(z,ye);De&&ye.beforeEnter(oe),n(oe,C,F),((ie=Se&&Se.onVnodeMounted)||De||Ae)&&sr(()=>{ie&&Lr(ie,Y,E),De&&ye.enter(oe),Ae&&Pn(E,null,Y,"mounted")},z)},I=(E,C,F,Y,z)=>{if(F&&d(E,F),Y)for(let D=0;D<Y.length;D++)d(E,Y[D]);if(z){let D=z.subTree;if(C===D||nh(D.type)&&(D.ssContent===C||D.ssFallback===C)){const ue=z.vnode;I(E,ue,ue.scopeId,ue.slotScopeIds,z.parent)}}},q=(E,C,F,Y,z,D,ue,le,oe=0)=>{for(let ie=oe;ie<E.length;ie++){const Se=E[ie]=le?xn(E[ie]):$r(E[ie]);p(null,Se,C,F,Y,z,D,ue,le)}},M=(E,C,F,Y,z,D,ue)=>{const le=C.el=E.el;let{patchFlag:oe,dynamicChildren:ie,dirs:Se}=C;oe|=E.patchFlag&16;const ge=E.props||Je,ye=C.props||Je;let Ae;if(F&&Nn(F,!1),(Ae=ye.onVnodeBeforeUpdate)&&Lr(Ae,F,C,E),Se&&Pn(C,E,F,"beforeUpdate"),F&&Nn(F,!0),(ge.innerHTML&&ye.innerHTML==null||ge.textContent&&ye.textContent==null)&&u(le,""),ie?te(E.dynamicChildren,ie,le,F,Y,Ho(C,z),D):ue||Pe(E,C,le,null,F,Y,Ho(C,z),D,!1),oe>0){if(oe&16)ne(le,ge,ye,F,z);else if(oe&2&&ge.class!==ye.class&&s(le,"class",null,ye.class,z),oe&4&&s(le,"style",ge.style,ye.style,z),oe&8){const De=C.dynamicProps;for(let $e=0;$e<De.length;$e++){const Le=De[$e],Nt=ge[Le],bt=ye[Le];(bt!==Nt||Le==="value")&&s(le,Le,Nt,bt,z,F)}}oe&1&&E.children!==C.children&&u(le,C.children)}else!ue&&ie==null&&ne(le,ge,ye,F,z);((Ae=ye.onVnodeUpdated)||Se)&&sr(()=>{Ae&&Lr(Ae,F,C,E),Se&&Pn(C,E,F,"updated")},Y)},te=(E,C,F,Y,z,D,ue)=>{for(let le=0;le<C.length;le++){const oe=E[le],ie=C[le],Se=oe.el&&(oe.type===rt||!Yi(oe,ie)||oe.shapeFlag&198)?f(oe.el):F;p(oe,ie,Se,null,Y,z,D,ue,!0)}},ne=(E,C,F,Y,z)=>{if(C!==F){if(C!==Je)for(const D in C)!os(D)&&!(D in F)&&s(E,D,C[D],null,z,Y);for(const D in F){if(os(D))continue;const ue=F[D],le=C[D];ue!==le&&D!=="value"&&s(E,D,le,ue,z,Y)}"value"in F&&s(E,"value",C.value,F.value,z)}},se=(E,C,F,Y,z,D,ue,le,oe)=>{const ie=C.el=E?E.el:o(""),Se=C.anchor=E?E.anchor:o("");let{patchFlag:ge,dynamicChildren:ye,slotScopeIds:Ae}=C;Ae&&(le=le?le.concat(Ae):Ae),E==null?(n(ie,F,Y),n(Se,F,Y),q(C.children||[],F,Se,z,D,ue,le,oe)):ge>0&&ge&64&&ye&&E.dynamicChildren?(te(E.dynamicChildren,ye,F,z,D,ue,le),(C.key!=null||z&&C===z.subTree)&&th(E,C,!0)):Pe(E,C,F,Se,z,D,ue,le,oe)},de=(E,C,F,Y,z,D,ue,le,oe)=>{C.slotScopeIds=le,E==null?C.shapeFlag&512?z.ctx.activate(C,F,Y,ue,oe):Be(C,F,Y,z,D,ue,oe):Oe(E,C,oe)},Be=(E,C,F,Y,z,D,ue)=>{const le=E.component=Sm(E,Y,z);if(B0(E)&&(le.ctx.renderer=X),Am(le,!1,ue),le.asyncDep){if(z&&z.registerDep(le,Me,ue),!E.el){const oe=le.subTree=Et(An);w(null,oe,C,F),E.placeholder=oe.el}}else Me(le,E,C,F,z,D,ue)},Oe=(E,C,F)=>{const Y=C.component=E.component;if(sm(E,C,F))if(Y.asyncDep&&!Y.asyncResolved){be(Y,C,F);return}else Y.next=C,Y.update();else C.el=E.el,Y.vnode=C},Me=(E,C,F,Y,z,D,ue)=>{const le=()=>{if(E.isMounted){let{next:ge,bu:ye,u:Ae,parent:De,vnode:$e}=E;{const ir=rh(E);if(ir){ge&&(ge.el=$e.el,be(E,ge,ue)),ir.asyncDep.then(()=>{E.isUnmounted||le()});return}}let Le=ge,Nt;Nn(E,!1),ge?(ge.el=$e.el,be(E,ge,ue)):ge=$e,ye&&va(ye),(Nt=ge.props&&ge.props.onVnodeBeforeUpdate)&&Lr(Nt,De,ge,$e),Nn(E,!0);const bt=au(E),nr=E.subTree;E.subTree=bt,p(nr,bt,f(nr.el),L(nr),E,z,D),ge.el=bt.el,Le===null&&am(E,bt.el),Ae&&sr(Ae,z),(Nt=ge.props&&ge.props.onVnodeUpdated)&&sr(()=>Lr(Nt,De,ge,$e),z)}else{let ge;const{el:ye,props:Ae}=C,{bm:De,m:$e,parent:Le,root:Nt,type:bt}=E,nr=fs(C);Nn(E,!1),De&&va(De),!nr&&(ge=Ae&&Ae.onVnodeBeforeMount)&&Lr(ge,Le,C),Nn(E,!0);{Nt.ce&&Nt.ce._def.shadowRoot!==!1&&Nt.ce._injectChildStyle(bt);const ir=E.subTree=au(E);p(null,ir,F,Y,E,z,D),C.el=ir.el}if($e&&sr($e,z),!nr&&(ge=Ae&&Ae.onVnodeMounted)){const ir=C;sr(()=>Lr(ge,Le,ir),z)}(C.shapeFlag&256||Le&&fs(Le.vnode)&&Le.vnode.shapeFlag&256)&&E.a&&sr(E.a,z),E.isMounted=!0,C=F=Y=null}};E.scope.on();const oe=E.effect=new p0(le);E.scope.off();const ie=E.update=oe.run.bind(oe),Se=E.job=oe.runIfDirty.bind(oe);Se.i=E,Se.id=E.uid,oe.scheduler=()=>cc(Se),Nn(E,!0),ie()},be=(E,C,F)=>{C.component=E;const Y=E.vnode.props;E.vnode=C,E.next=null,lm(E,C.props,Y,F),hm(E,C.children,F),an(),Zc(E),on()},Pe=(E,C,F,Y,z,D,ue,le,oe=!1)=>{const ie=E&&E.children,Se=E?E.shapeFlag:0,ge=C.children,{patchFlag:ye,shapeFlag:Ae}=C;if(ye>0){if(ye&128){ht(ie,ge,F,Y,z,D,ue,le,oe);return}else if(ye&256){Xe(ie,ge,F,Y,z,D,ue,le,oe);return}}Ae&8?(Se&16&&Z(ie,z,D),ge!==ie&&u(F,ge)):Se&16?Ae&16?ht(ie,ge,F,Y,z,D,ue,le,oe):Z(ie,z,D,!0):(Se&8&&u(F,""),Ae&16&&q(ge,F,Y,z,D,ue,le,oe))},Xe=(E,C,F,Y,z,D,ue,le,oe)=>{E=E||_i,C=C||_i;const ie=E.length,Se=C.length,ge=Math.min(ie,Se);let ye;for(ye=0;ye<ge;ye++){const Ae=C[ye]=oe?xn(C[ye]):$r(C[ye]);p(E[ye],Ae,F,null,z,D,ue,le,oe)}ie>Se?Z(E,z,D,!0,!1,ge):q(C,F,Y,z,D,ue,le,oe,ge)},ht=(E,C,F,Y,z,D,ue,le,oe)=>{let ie=0;const Se=C.length;let ge=E.length-1,ye=Se-1;for(;ie<=ge&&ie<=ye;){const Ae=E[ie],De=C[ie]=oe?xn(C[ie]):$r(C[ie]);if(Yi(Ae,De))p(Ae,De,F,null,z,D,ue,le,oe);else break;ie++}for(;ie<=ge&&ie<=ye;){const Ae=E[ge],De=C[ye]=oe?xn(C[ye]):$r(C[ye]);if(Yi(Ae,De))p(Ae,De,F,null,z,D,ue,le,oe);else break;ge--,ye--}if(ie>ge){if(ie<=ye){const Ae=ye+1,De=Ae<Se?C[Ae].el:Y;for(;ie<=ye;)p(null,C[ie]=oe?xn(C[ie]):$r(C[ie]),F,De,z,D,ue,le,oe),ie++}}else if(ie>ye)for(;ie<=ge;)R(E[ie],z,D,!0),ie++;else{const Ae=ie,De=ie,$e=new Map;for(ie=De;ie<=ye;ie++){const Dt=C[ie]=oe?xn(C[ie]):$r(C[ie]);Dt.key!=null&&$e.set(Dt.key,ie)}let Le,Nt=0;const bt=ye-De+1;let nr=!1,ir=0;const pn=new Array(bt);for(ie=0;ie<bt;ie++)pn[ie]=0;for(ie=Ae;ie<=ge;ie++){const Dt=E[ie];if(Nt>=bt){R(Dt,z,D,!0);continue}let gr;if(Dt.key!=null)gr=$e.get(Dt.key);else for(Le=De;Le<=ye;Le++)if(pn[Le-De]===0&&Yi(Dt,C[Le])){gr=Le;break}gr===void 0?R(Dt,z,D,!0):(pn[gr-De]=ie+1,gr>=ir?ir=gr:nr=!0,p(Dt,C[gr],F,null,z,D,ue,le,oe),Nt++)}const Vi=nr?mm(pn):_i;for(Le=Vi.length-1,ie=bt-1;ie>=0;ie--){const Dt=De+ie,gr=C[Dt],Xs=C[Dt+1],Ki=Dt+1<Se?Xs.el||Xs.placeholder:Y;pn[ie]===0?p(null,gr,F,Ki,z,D,ue,le,oe):nr&&(Le<0||ie!==Vi[Le]?it(gr,F,Ki,2):Le--)}}},it=(E,C,F,Y,z=null)=>{const{el:D,type:ue,transition:le,children:oe,shapeFlag:ie}=E;if(ie&6){it(E.component.subTree,C,F,Y);return}if(ie&128){E.suspense.move(C,F,Y);return}if(ie&64){ue.move(E,C,F,X);return}if(ue===rt){n(D,C,F);for(let ge=0;ge<oe.length;ge++)it(oe[ge],C,F,Y);n(E.anchor,C,F);return}if(ue===Wo){_(E,C,F);return}if(Y!==2&&ie&1&&le)if(Y===0)le.beforeEnter(D),n(D,C,F),sr(()=>le.enter(D),z);else{const{leave:ge,delayLeave:ye,afterLeave:Ae}=le,De=()=>{E.ctx.isUnmounted?i(D):n(D,C,F)},$e=()=>{D._isLeaving&&D[kg](!0),ge(D,()=>{De(),Ae&&Ae()})};ye?ye(D,De,$e):$e()}else n(D,C,F)},R=(E,C,F,Y=!1,z=!1)=>{const{type:D,props:ue,ref:le,children:oe,dynamicChildren:ie,shapeFlag:Se,patchFlag:ge,dirs:ye,cacheIndex:Ae}=E;if(ge===-2&&(z=!1),le!=null&&(an(),us(le,null,F,E,!0),on()),Ae!=null&&(C.renderCache[Ae]=void 0),Se&256){C.ctx.deactivate(E);return}const De=Se&1&&ye,$e=!fs(E);let Le;if($e&&(Le=ue&&ue.onVnodeBeforeUnmount)&&Lr(Le,C,E),Se&6)P(E.component,F,Y);else{if(Se&128){E.suspense.unmount(F,Y);return}De&&Pn(E,null,C,"beforeUnmount"),Se&64?E.type.remove(E,C,F,X,Y):ie&&!ie.hasOnce&&(D!==rt||ge>0&&ge&64)?Z(ie,C,F,!1,!0):(D===rt&&ge&384||!z&&Se&16)&&Z(oe,C,F),Y&&H(E)}($e&&(Le=ue&&ue.onVnodeUnmounted)||De)&&sr(()=>{Le&&Lr(Le,C,E),De&&Pn(E,null,C,"unmounted")},F)},H=E=>{const{type:C,el:F,anchor:Y,transition:z}=E;if(C===rt){N(F,Y);return}if(C===Wo){O(E);return}const D=()=>{i(F),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(E.shapeFlag&1&&z&&!z.persisted){const{leave:ue,delayLeave:le}=z,oe=()=>ue(F,D);le?le(E.el,D,oe):oe()}else D()},N=(E,C)=>{let F;for(;E!==C;)F=h(E),i(E),E=F;i(C)},P=(E,C,F)=>{const{bum:Y,scope:z,job:D,subTree:ue,um:le,m:oe,a:ie}=E;cu(oe),cu(ie),Y&&va(Y),z.stop(),D&&(D.flags|=8,R(ue,E,C,F)),le&&sr(le,C),sr(()=>{E.isUnmounted=!0},C)},Z=(E,C,F,Y=!1,z=!1,D=0)=>{for(let ue=D;ue<E.length;ue++)R(E[ue],C,F,Y,z)},L=E=>{if(E.shapeFlag&6)return L(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const C=h(E.anchor||E.el),F=C&&C[bg];return F?h(F):C};let Q=!1;const K=(E,C,F)=>{E==null?C._vnode&&R(C._vnode,null,null,!0):p(C._vnode||null,E,C,null,null,null,F),C._vnode=E,Q||(Q=!0,Zc(),P0(),Q=!1)},X={p,um:R,m:it,r:H,mt:Be,mc:q,pc:Pe,pbc:te,n:L,o:e};return{render:K,hydrate:void 0,createApp:Yg(K)}}function Ho({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function Nn({effect:e,job:t},r){r?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function gm(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function th(e,t,r=!1){const n=e.children,i=t.children;if(Re(n)&&Re(i))for(let s=0;s<n.length;s++){const a=n[s];let o=i[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[s]=xn(i[s]),o.el=a.el),!r&&o.patchFlag!==-2&&th(a,o)),o.type===xo&&o.patchFlag!==-1&&(o.el=a.el),o.type===An&&!o.el&&(o.el=a.el)}}function mm(e){const t=e.slice(),r=[0];let n,i,s,a,o;const l=e.length;for(n=0;n<l;n++){const c=e[n];if(c!==0){if(i=r[r.length-1],e[i]<c){t[n]=i,r.push(n);continue}for(s=0,a=r.length-1;s<a;)o=s+a>>1,e[r[o]]<c?s=o+1:a=o;c<e[r[s]]&&(s>0&&(t[n]=r[s-1]),r[s]=n)}}for(s=r.length,a=r[s-1];s-- >0;)r[s]=a,a=t[a];return r}function rh(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:rh(t)}function cu(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const nh=e=>e.__isSuspense;function vm(e,t){t&&t.pendingBranch?Re(e)?t.effects.push(...e):t.effects.push(e):Sg(e)}const rt=Symbol.for("v-fgt"),xo=Symbol.for("v-txt"),An=Symbol.for("v-cmt"),Wo=Symbol.for("v-stc"),ds=[];let dr=null;function me(e=!1){ds.push(dr=e?null:[])}function _m(){ds.pop(),dr=ds[ds.length-1]||null}let Ss=1;function Ia(e,t=!1){Ss+=e,e<0&&dr&&t&&(dr.hasOnce=!0)}function ih(e){return e.dynamicChildren=Ss>0?dr||_i:null,_m(),Ss>0&&dr&&dr.push(e),e}function _e(e,t,r,n,i,s){return ih(k(e,t,r,n,i,s,!0))}function sh(e,t,r,n,i){return ih(Et(e,t,r,n,i,!0))}function Fa(e){return e?e.__v_isVNode===!0:!1}function Yi(e,t){return e.type===t.type&&e.key===t.key}const ah=({key:e})=>e??null,wa=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?vt(e)||jt(e)||Fe(e)?{i:hr,r:e,k:t,f:!!r}:e:null);function k(e,t=null,r=null,n=0,i=null,s=e===rt?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ah(t),ref:t&&wa(t),scopeId:D0,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:hr};return o?(pc(l,r),s&128&&e.normalize(l)):r&&(l.shapeFlag|=vt(r)?8:16),Ss>0&&!a&&dr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&dr.push(l),l}const Et=xm;function xm(e,t=null,r=null,n=0,i=null,s=!1){if((!e||e===$g)&&(e=An),Fa(e)){const o=Ii(e,t,!0);return r&&pc(o,r),Ss>0&&!s&&dr&&(o.shapeFlag&6?dr[dr.indexOf(e)]=o:dr.push(o)),o.patchFlag=-2,o}if(Im(e)&&(e=e.__vccOpts),t){t=wm(t);let{class:o,style:l}=t;o&&!vt(o)&&(t.class=Ir(o)),Qe(l)&&(oc(l)&&!Re(l)&&(l=Wt({},l)),t.style=ec(l))}const a=vt(e)?1:nh(e)?128:Ag(e)?64:Qe(e)?4:Fe(e)?2:0;return k(e,t,r,n,i,a,s,!0)}function wm(e){return e?oc(e)||X0(e)?Wt({},e):e:null}function Ii(e,t,r=!1,n=!1){const{props:i,ref:s,patchFlag:a,children:o,transition:l}=e,c=t?ym(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&ah(c),ref:t&&t.ref?r&&s?Re(s)?s.concat(wa(t)):[s,wa(t)]:wa(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==rt?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ii(e.ssContent),ssFallback:e.ssFallback&&Ii(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&n&&fc(u,l.clone(u)),u}function _r(e=" ",t=0){return Et(xo,null,e,t)}function tt(e="",t=!1){return t?(me(),sh(An,null,e)):Et(An,null,e)}function $r(e){return e==null||typeof e=="boolean"?Et(An):Re(e)?Et(rt,null,e.slice()):Fa(e)?xn(e):Et(xo,null,String(e))}function xn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ii(e)}function pc(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Re(t))r=16;else if(typeof t=="object")if(n&65){const i=t.default;i&&(i._c&&(i._d=!1),pc(e,i()),i._c&&(i._d=!0));return}else{r=32;const i=t._;!i&&!X0(t)?t._ctx=hr:i===3&&hr&&(hr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Fe(t)?(t={default:t,_ctx:hr},r=32):(t=String(t),n&64?(r=16,t=[_r(t)]):r=8);e.children=t,e.shapeFlag|=r}function ym(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=Ir([t.class,n.class]));else if(i==="style")t.style=ec([t.style,n.style]);else if(ao(i)){const s=t[i],a=n[i];a&&s!==a&&!(Re(s)&&s.includes(a))&&(t[i]=s?[].concat(s,a):a)}else i!==""&&(t[i]=n[i])}return t}function Lr(e,t,r,n=null){Vr(e,t,7,[r,n])}const Em=W0();let Tm=0;function Sm(e,t,r){const n=e.type,i=(t?t.appContext:e.appContext)||Em,s={uid:Tm++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new G1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:J0(n,i),emitsOptions:z0(n,i),emit:null,emitted:null,propsDefaults:Je,inheritAttrs:n.inheritAttrs,ctx:Je,data:Je,props:Je,attrs:Je,slots:Je,refs:Je,setupState:Je,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=tm.bind(null,s),e.ce&&e.ce(s),s}let Ut=null;const bm=()=>Ut||hr;let Pa,El;{const e=fo(),t=(r,n)=>{let i;return(i=e[r])||(i=e[r]=[]),i.push(n),s=>{i.length>1?i.forEach(a=>a(s)):i[0](s)}};Pa=t("__VUE_INSTANCE_SETTERS__",r=>Ut=r),El=t("__VUE_SSR_SETTERS__",r=>bs=r)}const Us=e=>{const t=Ut;return Pa(e),e.scope.on(),()=>{e.scope.off(),Pa(t)}},uu=()=>{Ut&&Ut.scope.off(),Pa(null)};function oh(e){return e.vnode.shapeFlag&4}let bs=!1;function Am(e,t=!1,r=!1){t&&El(t);const{props:n,children:i}=e.vnode,s=oh(e);om(e,n,s,t),fm(e,i,r||t);const a=s?km(e,t):void 0;return t&&El(!1),a}function km(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Wg);const{setup:n}=r;if(n){an();const i=e.setupContext=n.length>1?Cm(e):null,s=Us(e),a=Ms(n,e,0,[e.props,i]),o=o0(a);if(on(),s(),(o||e.sp)&&!fs(e)&&M0(e),o){if(a.then(uu,uu),t)return a.then(l=>{fu(e,l)}).catch(l=>{mo(l,e,0)});e.asyncDep=a}else fu(e,a)}else lh(e)}function fu(e,t,r){Fe(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Qe(t)&&(e.setupState=R0(t)),lh(e)}function lh(e,t,r){const n=e.type;e.render||(e.render=n.render||Hr);{const i=Us(e);an();try{Vg(e)}finally{on(),i()}}}const Om={get(e,t){return Bt(e,"get",""),e[t]}};function Cm(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,Om),slots:e.slots,emit:e.emit,expose:t}}function wo(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(R0(dg(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in hs)return hs[r](e)},has(t,r){return r in t||r in hs}})):e.proxy}function Rm(e,t=!0){return Fe(e)?e.displayName||e.name:e.name||t&&e.__name}function Im(e){return Fe(e)&&"__vccOpts"in e}const Or=(e,t)=>xg(e,t,bs);function ch(e,t,r){try{Ia(-1);const n=arguments.length;return n===2?Qe(t)&&!Re(t)?Fa(t)?Et(e,null,[t]):Et(e,t):Et(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Fa(r)&&(r=[r]),Et(e,t,r))}finally{Ia(1)}}const Fm="3.5.25";let Tl;const hu=typeof window<"u"&&window.trustedTypes;if(hu)try{Tl=hu.createPolicy("vue",{createHTML:e=>e})}catch{}const uh=Tl?e=>Tl.createHTML(e):e=>e,Pm="http://www.w3.org/2000/svg",Nm="http://www.w3.org/1998/Math/MathML",Qr=typeof document<"u"?document:null,du=Qr&&Qr.createElement("template"),Dm={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t==="svg"?Qr.createElementNS(Pm,e):t==="mathml"?Qr.createElementNS(Nm,e):r?Qr.createElement(e,{is:r}):Qr.createElement(e);return e==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:e=>Qr.createTextNode(e),createComment:e=>Qr.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Qr.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,i,s){const a=r?r.previousSibling:t.lastChild;if(i&&(i===s||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),r),!(i===s||!(i=i.nextSibling)););else{du.innerHTML=uh(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const o=du.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},Lm=Symbol("_vtc");function Mm(e,t,r){const n=e[Lm];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const pu=Symbol("_vod"),Bm=Symbol("_vsh"),Um=Symbol(""),jm=/(?:^|;)\s*display\s*:/;function $m(e,t,r){const n=e.style,i=vt(r);let s=!1;if(r&&!i){if(t)if(vt(t))for(const a of t.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&ya(n,o,"")}else for(const a in t)r[a]==null&&ya(n,a,"");for(const a in r)a==="display"&&(s=!0),ya(n,a,r[a])}else if(i){if(t!==r){const a=n[Um];a&&(r+=";"+a),n.cssText=r,s=jm.test(r)}}else t&&e.removeAttribute("style");pu in e&&(e[pu]=s?n.display:"",e[Bm]&&(n.display="none"))}const gu=/\s*!important$/;function ya(e,t,r){if(Re(r))r.forEach(n=>ya(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=Hm(e,t);gu.test(r)?e.setProperty(Rn(n),r.replace(gu,""),"important"):e[n]=r}}const mu=["Webkit","Moz","ms"],Vo={};function Hm(e,t){const r=Vo[t];if(r)return r;let n=wr(t);if(n!=="filter"&&n in e)return Vo[t]=n;n=co(n);for(let i=0;i<mu.length;i++){const s=mu[i]+n;if(s in e)return Vo[t]=s}return t}const vu="http://www.w3.org/1999/xlink";function _u(e,t,r,n,i,s=V1(t)){n&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(vu,t.slice(6,t.length)):e.setAttributeNS(vu,t,r):r==null||s&&!f0(r)?e.removeAttribute(t):e.setAttribute(t,s?"":Wr(r)?String(r):r)}function xu(e,t,r,n,i){if(t==="innerHTML"||t==="textContent"){r!=null&&(e[t]=t==="innerHTML"?uh(r):r);return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?e.getAttribute("value")||"":e.value,l=r==null?e.type==="checkbox"?"on":"":String(r);(o!==l||!("_value"in e))&&(e.value=l),r==null&&e.removeAttribute(t),e._value=r;return}let a=!1;if(r===""||r==null){const o=typeof e[t];o==="boolean"?r=f0(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{e[t]=r}catch{}a&&e.removeAttribute(i||t)}function $n(e,t,r,n){e.addEventListener(t,r,n)}function Wm(e,t,r,n){e.removeEventListener(t,r,n)}const wu=Symbol("_vei");function Vm(e,t,r,n,i=null){const s=e[wu]||(e[wu]={}),a=s[t];if(n&&a)a.value=n;else{const[o,l]=Km(t);if(n){const c=s[t]=qm(n,i);$n(e,o,c,l)}else a&&(Wm(e,o,a,l),s[t]=void 0)}}const yu=/(?:Once|Passive|Capture)$/;function Km(e){let t;if(yu.test(e)){t={};let n;for(;n=e.match(yu);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Rn(e.slice(2)),t]}let Ko=0;const zm=Promise.resolve(),Gm=()=>Ko||(zm.then(()=>Ko=0),Ko=Date.now());function qm(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Vr(Xm(n,r.value),t,5,[n])};return r.value=e,r.attached=Gm(),r}function Xm(e,t){if(Re(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>i=>!i._stopped&&n&&n(i))}else return t}const Eu=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ym=(e,t,r,n,i,s)=>{const a=i==="svg";t==="class"?Mm(e,n,a):t==="style"?$m(e,r,n):ao(t)?Jl(t)||Vm(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Jm(e,t,n,a))?(xu(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&_u(e,t,n,a,s,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!vt(n))?xu(e,wr(t),n,s,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),_u(e,t,n,a))};function Jm(e,t,r,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&Eu(t)&&Fe(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Eu(t)&&vt(r)?!1:t in e}const Na=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Re(t)?r=>va(t,r):t};function Qm(e){e.target.composing=!0}function Tu(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ti=Symbol("_assign");function Su(e,t,r){return t&&(e=e.trim()),r&&(e=uo(e)),e}const kr={created(e,{modifiers:{lazy:t,trim:r,number:n}},i){e[Ti]=Na(i);const s=n||i.props&&i.props.type==="number";$n(e,t?"change":"input",a=>{a.target.composing||e[Ti](Su(e.value,r,s))}),(r||s)&&$n(e,"change",()=>{e.value=Su(e.value,r,s)}),t||($n(e,"compositionstart",Qm),$n(e,"compositionend",Tu),$n(e,"change",Tu))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:r,modifiers:{lazy:n,trim:i,number:s}},a){if(e[Ti]=Na(a),e.composing)return;const o=(s||e.type==="number")&&!/^0\d/.test(e.value)?uo(e.value):e.value,l=t??"";o!==l&&(document.activeElement===e&&e.type!=="range"&&(n&&t===r||i&&e.value.trim()===l)||(e.value=l))}},Sl={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const i=oo(t);$n(e,"change",()=>{const s=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>r?uo(Da(a)):Da(a));e[Ti](e.multiple?i?new Set(s):s:s[0]),e._assigning=!0,lc(()=>{e._assigning=!1})}),e[Ti]=Na(n)},mounted(e,{value:t}){bu(e,t)},beforeUpdate(e,t,r){e[Ti]=Na(r)},updated(e,{value:t}){e._assigning||bu(e,t)}};function bu(e,t){const r=e.multiple,n=Re(t);if(!(r&&!n&&!oo(t))){for(let i=0,s=e.options.length;i<s;i++){const a=e.options[i],o=Da(a);if(r)if(n){const l=typeof o;l==="string"||l==="number"?a.selected=t.some(c=>String(c)===String(o)):a.selected=z1(t,o)>-1}else a.selected=t.has(o);else if(ho(Da(a),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Da(e){return"_value"in e?e._value:e.value}const Zm=["ctrl","shift","alt","meta"],ev={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Zm.some(r=>e[`${r}Key`]&&!t.includes(r))},Ji=(e,t)=>{const r=e._withMods||(e._withMods={}),n=t.join(".");return r[n]||(r[n]=((i,...s)=>{for(let a=0;a<t.length;a++){const o=ev[t[a]];if(o&&o(i,t))return}return e(i,...s)}))},tv={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},qr=(e,t)=>{const r=e._withKeys||(e._withKeys={}),n=t.join(".");return r[n]||(r[n]=(i=>{if(!("key"in i))return;const s=Rn(i.key);if(t.some(a=>a===s||tv[a]===s))return e(i)}))},rv=Wt({patchProp:Ym},Dm);let Au;function nv(){return Au||(Au=dm(rv))}const iv=((...e)=>{const t=nv().createApp(...e),{mount:r}=t;return t.mount=n=>{const i=av(n);if(!i)return;const s=t._component;!Fe(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=r(i,!1,sv(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},t});function sv(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function av(e){return vt(e)?document.querySelector(e):e}const Mi=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r},ov={name:"App"};function lv(e,t,r,n,i,s){const a=Bs("RouterView");return me(),sh(a)}const cv=Mi(ov,[["render",lv]]);const di=typeof document<"u";function fh(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function uv(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&fh(e.default)}const He=Object.assign;function zo(e,t){const r={};for(const n in t){const i=t[n];r[n]=Dr(i)?i.map(e):e(i)}return r}const ps=()=>{},Dr=Array.isArray;function ku(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}const hh=/#/g,fv=/&/g,hv=/\//g,dv=/=/g,pv=/\?/g,dh=/\+/g,gv=/%5B/g,mv=/%5D/g,ph=/%5E/g,vv=/%60/g,gh=/%7B/g,_v=/%7C/g,mh=/%7D/g,xv=/%20/g;function gc(e){return e==null?"":encodeURI(""+e).replace(_v,"|").replace(gv,"[").replace(mv,"]")}function wv(e){return gc(e).replace(gh,"{").replace(mh,"}").replace(ph,"^")}function bl(e){return gc(e).replace(dh,"%2B").replace(xv,"+").replace(hh,"%23").replace(fv,"%26").replace(vv,"`").replace(gh,"{").replace(mh,"}").replace(ph,"^")}function yv(e){return bl(e).replace(dv,"%3D")}function Ev(e){return gc(e).replace(hh,"%23").replace(pv,"%3F")}function Tv(e){return Ev(e).replace(hv,"%2F")}function As(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Sv=/\/$/,bv=e=>e.replace(Sv,"");function Go(e,t,r="/"){let n,i={},s="",a="";const o=t.indexOf("#");let l=t.indexOf("?");return l=o>=0&&l>o?-1:l,l>=0&&(n=t.slice(0,l),s=t.slice(l,o>0?o:t.length),i=e(s.slice(1))),o>=0&&(n=n||t.slice(0,o),a=t.slice(o,t.length)),n=Cv(n??t,r),{fullPath:n+s+a,path:n,query:i,hash:As(a)}}function Av(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function Ou(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function kv(e,t,r){const n=t.matched.length-1,i=r.matched.length-1;return n>-1&&n===i&&Fi(t.matched[n],r.matched[i])&&vh(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Fi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function vh(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!Ov(e[r],t[r]))return!1;return!0}function Ov(e,t){return Dr(e)?Cu(e,t):Dr(t)?Cu(t,e):e===t}function Cu(e,t){return Dr(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function Cv(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/"),i=n[n.length-1];(i===".."||i===".")&&n.push("");let s=r.length-1,a,o;for(a=0;a<n.length;a++)if(o=n[a],o!==".")if(o==="..")s>1&&s--;else break;return r.slice(0,s).join("/")+"/"+n.slice(a).join("/")}const gn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Al=(function(e){return e.pop="pop",e.push="push",e})({}),qo=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Rv(e){if(!e)if(di){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),bv(e)}const Iv=/^[^#]+#/;function Fv(e,t){return e.replace(Iv,"#")+t}function Pv(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const yo=()=>({left:window.scrollX,top:window.scrollY});function Nv(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),i=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!i)return;t=Pv(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Ru(e,t){return(history.state?history.state.position-t:-1)+e}const kl=new Map;function Dv(e,t){kl.set(e,t)}function Lv(e){const t=kl.get(e);return kl.delete(e),t}function Mv(e){return typeof e=="string"||e&&typeof e=="object"}function _h(e){return typeof e=="string"||typeof e=="symbol"}let ct=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const xh=Symbol("");ct.MATCHER_NOT_FOUND+"",ct.NAVIGATION_GUARD_REDIRECT+"",ct.NAVIGATION_ABORTED+"",ct.NAVIGATION_CANCELLED+"",ct.NAVIGATION_DUPLICATED+"";function Pi(e,t){return He(new Error,{type:e,[xh]:!0},t)}function Xr(e,t){return e instanceof Error&&xh in e&&(t==null||!!(e.type&t))}const Bv=["params","query","hash"];function Uv(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const r of Bv)r in e&&(t[r]=e[r]);return JSON.stringify(t,null,2)}function jv(e){const t={};if(e===""||e==="?")return t;const r=(e[0]==="?"?e.slice(1):e).split("&");for(let n=0;n<r.length;++n){const i=r[n].replace(dh," "),s=i.indexOf("="),a=As(s<0?i:i.slice(0,s)),o=s<0?null:As(i.slice(s+1));if(a in t){let l=t[a];Dr(l)||(l=t[a]=[l]),l.push(o)}else t[a]=o}return t}function Iu(e){let t="";for(let r in e){const n=e[r];if(r=yv(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Dr(n)?n.map(i=>i&&bl(i)):[n&&bl(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function $v(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Dr(n)?n.map(i=>i==null?null:""+i):n==null?n:""+n)}return t}const Hv=Symbol(""),Fu=Symbol(""),mc=Symbol(""),wh=Symbol(""),Ol=Symbol("");function Qi(){let e=[];function t(n){return e.push(n),()=>{const i=e.indexOf(n);i>-1&&e.splice(i,1)}}function r(){e=[]}return{add:t,list:()=>e.slice(),reset:r}}function wn(e,t,r,n,i,s=a=>a()){const a=n&&(n.enterCallbacks[i]=n.enterCallbacks[i]||[]);return()=>new Promise((o,l)=>{const c=h=>{h===!1?l(Pi(ct.NAVIGATION_ABORTED,{from:r,to:t})):h instanceof Error?l(h):Mv(h)?l(Pi(ct.NAVIGATION_GUARD_REDIRECT,{from:t,to:h})):(a&&n.enterCallbacks[i]===a&&typeof h=="function"&&a.push(h),o())},u=s(()=>e.call(n&&n.instances[i],t,r,c));let f=Promise.resolve(u);e.length<3&&(f=f.then(c)),f.catch(h=>l(h))})}function Xo(e,t,r,n,i=s=>s()){const s=[];for(const a of e)for(const o in a.components){let l=a.components[o];if(!(t!=="beforeRouteEnter"&&!a.instances[o]))if(fh(l)){const c=(l.__vccOpts||l)[t];c&&s.push(wn(c,r,n,a,o,i))}else{let c=l();s.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${o}" at "${a.path}"`);const f=uv(u)?u.default:u;a.mods[o]=u,a.components[o]=f;const h=(f.__vccOpts||f)[t];return h&&wn(h,r,n,a,o,i)()}))}}return s}function Wv(e,t){const r=[],n=[],i=[],s=Math.max(t.matched.length,e.matched.length);for(let a=0;a<s;a++){const o=t.matched[a];o&&(e.matched.find(c=>Fi(c,o))?n.push(o):r.push(o));const l=e.matched[a];l&&(t.matched.find(c=>Fi(c,l))||i.push(l))}return[r,n,i]}let Vv=()=>location.protocol+"//"+location.host;function yh(e,t){const{pathname:r,search:n,hash:i}=t,s=e.indexOf("#");if(s>-1){let a=i.includes(e.slice(s))?e.slice(s).length:1,o=i.slice(a);return o[0]!=="/"&&(o="/"+o),Ou(o,"")}return Ou(r,e)+n+i}function Kv(e,t,r,n){let i=[],s=[],a=null;const o=({state:h})=>{const d=yh(e,location),g=r.value,p=t.value;let m=0;if(h){if(r.value=d,t.value=h,a&&a===g){a=null;return}m=p?h.position-p.position:0}else n(d);i.forEach(w=>{w(r.value,g,{delta:m,type:Al.pop,direction:m?m>0?qo.forward:qo.back:qo.unknown})})};function l(){a=r.value}function c(h){i.push(h);const d=()=>{const g=i.indexOf(h);g>-1&&i.splice(g,1)};return s.push(d),d}function u(){if(document.visibilityState==="hidden"){const{history:h}=window;if(!h.state)return;h.replaceState(He({},h.state,{scroll:yo()}),"")}}function f(){for(const h of s)h();s=[],window.removeEventListener("popstate",o),window.removeEventListener("pagehide",u),document.removeEventListener("visibilitychange",u)}return window.addEventListener("popstate",o),window.addEventListener("pagehide",u),document.addEventListener("visibilitychange",u),{pauseListeners:l,listen:c,destroy:f}}function Pu(e,t,r,n=!1,i=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:i?yo():null}}function zv(e){const{history:t,location:r}=window,n={value:yh(e,r)},i={value:t.state};i.value||s(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const f=e.indexOf("#"),h=f>-1?(r.host&&document.querySelector("base")?e:e.slice(f))+l:Vv()+e+l;try{t[u?"replaceState":"pushState"](c,"",h),i.value=c}catch(d){console.error(d),r[u?"replace":"assign"](h)}}function a(l,c){s(l,He({},t.state,Pu(i.value.back,l,i.value.forward,!0),c,{position:i.value.position}),!0),n.value=l}function o(l,c){const u=He({},i.value,t.state,{forward:l,scroll:yo()});s(u.current,u,!0),s(l,He({},Pu(n.value,l,null),{position:u.position+1},c),!1),n.value=l}return{location:n,state:i,push:o,replace:a}}function Gv(e){e=Rv(e);const t=zv(e),r=Kv(e,t.state,t.location,t.replace);function n(s,a=!0){a||r.pauseListeners(),history.go(s)}const i=He({location:"",base:e,go:n,createHref:Fv.bind(null,e)},t,r);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>t.state.value}),i}function qv(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),Gv(e)}let Kn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var xt=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(xt||{});const Xv={type:Kn.Static,value:""},Yv=/[a-zA-Z0-9_]/;function Jv(e){if(!e)return[[]];if(e==="/")return[[Xv]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(d){throw new Error(`ERR (${r})/"${c}": ${d}`)}let r=xt.Static,n=r;const i=[];let s;function a(){s&&i.push(s),s=[]}let o=0,l,c="",u="";function f(){c&&(r===xt.Static?s.push({type:Kn.Static,value:c}):r===xt.Param||r===xt.ParamRegExp||r===xt.ParamRegExpEnd?(s.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:Kn.Param,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;o<e.length;){if(l=e[o++],l==="\\"&&r!==xt.ParamRegExp){n=r,r=xt.EscapeNext;continue}switch(r){case xt.Static:l==="/"?(c&&f(),a()):l===":"?(f(),r=xt.Param):h();break;case xt.EscapeNext:h(),r=n;break;case xt.Param:l==="("?r=xt.ParamRegExp:Yv.test(l)?h():(f(),r=xt.Static,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case xt.ParamRegExp:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:r=xt.ParamRegExpEnd:u+=l;break;case xt.ParamRegExpEnd:f(),r=xt.Static,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:t("Unknown state");break}}return r===xt.ParamRegExp&&t(`Unfinished custom RegExp for param "${c}"`),f(),a(),i}const Nu="[^/]+?",Qv={sensitive:!1,strict:!1,start:!0,end:!0};var Kt=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Kt||{});const Zv=/[.+*?^${}()[\]/\\]/g;function e_(e,t){const r=He({},Qv,t),n=[];let i=r.start?"^":"";const s=[];for(const c of e){const u=c.length?[]:[Kt.Root];r.strict&&!c.length&&(i+="/");for(let f=0;f<c.length;f++){const h=c[f];let d=Kt.Segment+(r.sensitive?Kt.BonusCaseSensitive:0);if(h.type===Kn.Static)f||(i+="/"),i+=h.value.replace(Zv,"\\$&"),d+=Kt.Static;else if(h.type===Kn.Param){const{value:g,repeatable:p,optional:m,regexp:w}=h;s.push({name:g,repeatable:p,optional:m});const T=w||Nu;if(T!==Nu){d+=Kt.BonusCustomRegExp;try{`${T}`}catch(O){throw new Error(`Invalid custom RegExp for param "${g}" (${T}): `+O.message)}}let _=p?`((?:${T})(?:/(?:${T}))*)`:`(${T})`;f||(_=m&&c.length<2?`(?:/${_})`:"/"+_),m&&(_+="?"),i+=_,d+=Kt.Dynamic,m&&(d+=Kt.BonusOptional),p&&(d+=Kt.BonusRepeatable),T===".*"&&(d+=Kt.BonusWildcard)}u.push(d)}n.push(u)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=Kt.BonusStrict}r.strict||(i+="/?"),r.end?i+="$":r.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const a=new RegExp(i,r.sensitive?"":"i");function o(c){const u=c.match(a),f={};if(!u)return null;for(let h=1;h<u.length;h++){const d=u[h]||"",g=s[h-1];f[g.name]=d&&g.repeatable?d.split("/"):d}return f}function l(c){let u="",f=!1;for(const h of e){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const d of h)if(d.type===Kn.Static)u+=d.value;else if(d.type===Kn.Param){const{value:g,repeatable:p,optional:m}=d,w=g in c?c[g]:"";if(Dr(w)&&!p)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const T=Dr(w)?w.join("/"):w;if(!T)if(m)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);u+=T}}return u||"/"}return{re:a,score:n,keys:s,parse:o,stringify:l}}function t_(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===Kt.Static+Kt.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Kt.Static+Kt.Segment?1:-1:0}function Eh(e,t){let r=0;const n=e.score,i=t.score;for(;r<n.length&&r<i.length;){const s=t_(n[r],i[r]);if(s)return s;r++}if(Math.abs(i.length-n.length)===1){if(Du(n))return 1;if(Du(i))return-1}return i.length-n.length}function Du(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const r_={strict:!1,end:!0,sensitive:!1};function n_(e,t,r){const n=e_(Jv(e.path),r),i=He(n,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf==!t.record.aliasOf&&t.children.push(i),i}function i_(e,t){const r=[],n=new Map;t=ku(r_,t);function i(f){return n.get(f)}function s(f,h,d){const g=!d,p=Mu(f);p.aliasOf=d&&d.record;const m=ku(t,f),w=[p];if("alias"in f){const O=typeof f.alias=="string"?[f.alias]:f.alias;for(const V of O)w.push(Mu(He({},p,{components:d?d.record.components:p.components,path:V,aliasOf:d?d.record:p})))}let T,_;for(const O of w){const{path:V}=O;if(h&&V[0]!=="/"){const ee=h.record.path,I=ee[ee.length-1]==="/"?"":"/";O.path=h.record.path+(V&&I+V)}if(T=n_(O,h,m),d?d.alias.push(T):(_=_||T,_!==T&&_.alias.push(T),g&&f.name&&!Bu(T)&&a(f.name)),Th(T)&&l(T),p.children){const ee=p.children;for(let I=0;I<ee.length;I++)s(ee[I],T,d&&d.children[I])}d=d||T}return _?()=>{a(_)}:ps}function a(f){if(_h(f)){const h=n.get(f);h&&(n.delete(f),r.splice(r.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=r.indexOf(f);h>-1&&(r.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function o(){return r}function l(f){const h=o_(f,r);r.splice(h,0,f),f.record.name&&!Bu(f)&&n.set(f.record.name,f)}function c(f,h){let d,g={},p,m;if("name"in f&&f.name){if(d=n.get(f.name),!d)throw Pi(ct.MATCHER_NOT_FOUND,{location:f});m=d.record.name,g=He(Lu(h.params,d.keys.filter(_=>!_.optional).concat(d.parent?d.parent.keys.filter(_=>_.optional):[]).map(_=>_.name)),f.params&&Lu(f.params,d.keys.map(_=>_.name))),p=d.stringify(g)}else if(f.path!=null)p=f.path,d=r.find(_=>_.re.test(p)),d&&(g=d.parse(p),m=d.record.name);else{if(d=h.name?n.get(h.name):r.find(_=>_.re.test(h.path)),!d)throw Pi(ct.MATCHER_NOT_FOUND,{location:f,currentLocation:h});m=d.record.name,g=He({},h.params,f.params),p=d.stringify(g)}const w=[];let T=d;for(;T;)w.unshift(T.record),T=T.parent;return{name:m,path:p,params:g,matched:w,meta:a_(w)}}e.forEach(f=>s(f));function u(){r.length=0,n.clear()}return{addRoute:s,resolve:c,removeRoute:a,clearRoutes:u,getRoutes:o,getRecordMatcher:i}}function Lu(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function Mu(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:s_(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function s_(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="object"?r[n]:r;return t}function Bu(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function a_(e){return e.reduce((t,r)=>He(t,r.meta),{})}function o_(e,t){let r=0,n=t.length;for(;r!==n;){const s=r+n>>1;Eh(e,t[s])<0?n=s:r=s+1}const i=l_(e);return i&&(n=t.lastIndexOf(i,n-1)),n}function l_(e){let t=e;for(;t=t.parent;)if(Th(t)&&Eh(e,t)===0)return t}function Th({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Uu(e){const t=tn(mc),r=tn(wh),n=Or(()=>{const l=wi(e.to);return t.resolve(l)}),i=Or(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],f=r.matched;if(!u||!f.length)return-1;const h=f.findIndex(Fi.bind(null,u));if(h>-1)return h;const d=ju(l[c-2]);return c>1&&ju(u)===d&&f[f.length-1].path!==d?f.findIndex(Fi.bind(null,l[c-2])):h}),s=Or(()=>i.value>-1&&d_(r.params,n.value.params)),a=Or(()=>i.value>-1&&i.value===r.matched.length-1&&vh(r.params,n.value.params));function o(l={}){if(h_(l)){const c=t[wi(e.replace)?"replace":"push"](wi(e.to)).catch(ps);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:Or(()=>n.value.href),isActive:s,isExactActive:a,navigate:o}}function c_(e){return e.length===1?e[0]:e}const u_=L0({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Uu,setup(e,{slots:t}){const r=go(Uu(e)),{options:n}=tn(mc),i=Or(()=>({[$u(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[$u(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const s=t.default&&c_(t.default(r));return e.custom?s:ch("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:i.value},s)}}}),f_=u_;function h_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function d_(e,t){for(const r in t){const n=t[r],i=e[r];if(typeof n=="string"){if(n!==i)return!1}else if(!Dr(i)||i.length!==n.length||n.some((s,a)=>s!==i[a]))return!1}return!0}function ju(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const $u=(e,t,r)=>e??t??r,p_=L0({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=tn(Ol),i=Or(()=>e.route||n.value),s=tn(Fu,0),a=Or(()=>{let c=wi(s);const{matched:u}=i.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),o=Or(()=>i.value.matched[a.value]);_a(Fu,Or(()=>a.value+1)),_a(Hv,o),_a(Ol,i);const l=pg();return xa(()=>[l.value,o.value,e.name],([c,u,f],[h,d,g])=>{u&&(u.instances[f]=c,d&&d!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=d.leaveGuards),u.updateGuards.size||(u.updateGuards=d.updateGuards))),c&&u&&(!d||!Fi(u,d)||!h)&&(u.enterCallbacks[f]||[]).forEach(p=>p(c))},{flush:"post"}),()=>{const c=i.value,u=e.name,f=o.value,h=f&&f.components[u];if(!h)return Hu(r.default,{Component:h,route:c});const d=f.props[u],g=d?d===!0?c.params:typeof d=="function"?d(c):d:null,m=ch(h,He({},g,t,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return Hu(r.default,{Component:m,route:c})||m}}});function Hu(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const g_=p_;function m_(e){const t=i_(e.routes,e),r=e.parseQuery||jv,n=e.stringifyQuery||Iu,i=e.history,s=Qi(),a=Qi(),o=Qi(),l=gg(gn);let c=gn;di&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=zo.bind(null,L=>""+L),f=zo.bind(null,Tv),h=zo.bind(null,As);function d(L,Q){let K,X;return _h(L)?(K=t.getRecordMatcher(L),X=Q):X=L,t.addRoute(X,K)}function g(L){const Q=t.getRecordMatcher(L);Q&&t.removeRoute(Q)}function p(){return t.getRoutes().map(L=>L.record)}function m(L){return!!t.getRecordMatcher(L)}function w(L,Q){if(Q=He({},Q||l.value),typeof L=="string"){const F=Go(r,L,Q.path),Y=t.resolve({path:F.path},Q),z=i.createHref(F.fullPath);return He(F,Y,{params:h(Y.params),hash:As(F.hash),redirectedFrom:void 0,href:z})}let K;if(L.path!=null)K=He({},L,{path:Go(r,L.path,Q.path).path});else{const F=He({},L.params);for(const Y in F)F[Y]==null&&delete F[Y];K=He({},L,{params:f(F)}),Q.params=f(Q.params)}const X=t.resolve(K,Q),Ee=L.hash||"";X.params=u(h(X.params));const E=Av(n,He({},L,{hash:wv(Ee),path:X.path})),C=i.createHref(E);return He({fullPath:E,hash:Ee,query:n===Iu?$v(L.query):L.query||{}},X,{redirectedFrom:void 0,href:C})}function T(L){return typeof L=="string"?Go(r,L,l.value.path):He({},L)}function _(L,Q){if(c!==L)return Pi(ct.NAVIGATION_CANCELLED,{from:Q,to:L})}function O(L){return I(L)}function V(L){return O(He(T(L),{replace:!0}))}function ee(L,Q){const K=L.matched[L.matched.length-1];if(K&&K.redirect){const{redirect:X}=K;let Ee=typeof X=="function"?X(L,Q):X;return typeof Ee=="string"&&(Ee=Ee.includes("?")||Ee.includes("#")?Ee=T(Ee):{path:Ee},Ee.params={}),He({query:L.query,hash:L.hash,params:Ee.path!=null?{}:L.params},Ee)}}function I(L,Q){const K=c=w(L),X=l.value,Ee=L.state,E=L.force,C=L.replace===!0,F=ee(K,X);if(F)return I(He(T(F),{state:typeof F=="object"?He({},Ee,F.state):Ee,force:E,replace:C}),Q||K);const Y=K;Y.redirectedFrom=Q;let z;return!E&&kv(n,X,K)&&(z=Pi(ct.NAVIGATION_DUPLICATED,{to:Y,from:X}),it(X,X,!0,!1)),(z?Promise.resolve(z):te(Y,X)).catch(D=>Xr(D)?Xr(D,ct.NAVIGATION_GUARD_REDIRECT)?D:ht(D):Pe(D,Y,X)).then(D=>{if(D){if(Xr(D,ct.NAVIGATION_GUARD_REDIRECT))return I(He({replace:C},T(D.to),{state:typeof D.to=="object"?He({},Ee,D.to.state):Ee,force:E}),Q||Y)}else D=se(Y,X,!0,C,Ee);return ne(Y,X,D),D})}function q(L,Q){const K=_(L,Q);return K?Promise.reject(K):Promise.resolve()}function M(L){const Q=N.values().next().value;return Q&&typeof Q.runWithContext=="function"?Q.runWithContext(L):L()}function te(L,Q){let K;const[X,Ee,E]=Wv(L,Q);K=Xo(X.reverse(),"beforeRouteLeave",L,Q);for(const F of X)F.leaveGuards.forEach(Y=>{K.push(wn(Y,L,Q))});const C=q.bind(null,L,Q);return K.push(C),Z(K).then(()=>{K=[];for(const F of s.list())K.push(wn(F,L,Q));return K.push(C),Z(K)}).then(()=>{K=Xo(Ee,"beforeRouteUpdate",L,Q);for(const F of Ee)F.updateGuards.forEach(Y=>{K.push(wn(Y,L,Q))});return K.push(C),Z(K)}).then(()=>{K=[];for(const F of E)if(F.beforeEnter)if(Dr(F.beforeEnter))for(const Y of F.beforeEnter)K.push(wn(Y,L,Q));else K.push(wn(F.beforeEnter,L,Q));return K.push(C),Z(K)}).then(()=>(L.matched.forEach(F=>F.enterCallbacks={}),K=Xo(E,"beforeRouteEnter",L,Q,M),K.push(C),Z(K))).then(()=>{K=[];for(const F of a.list())K.push(wn(F,L,Q));return K.push(C),Z(K)}).catch(F=>Xr(F,ct.NAVIGATION_CANCELLED)?F:Promise.reject(F))}function ne(L,Q,K){o.list().forEach(X=>M(()=>X(L,Q,K)))}function se(L,Q,K,X,Ee){const E=_(L,Q);if(E)return E;const C=Q===gn,F=di?history.state:{};K&&(X||C?i.replace(L.fullPath,He({scroll:C&&F&&F.scroll},Ee)):i.push(L.fullPath,Ee)),l.value=L,it(L,Q,K,C),ht()}let de;function Be(){de||(de=i.listen((L,Q,K)=>{if(!P.listening)return;const X=w(L),Ee=ee(X,P.currentRoute.value);if(Ee){I(He(Ee,{replace:!0,force:!0}),X).catch(ps);return}c=X;const E=l.value;di&&Dv(Ru(E.fullPath,K.delta),yo()),te(X,E).catch(C=>Xr(C,ct.NAVIGATION_ABORTED|ct.NAVIGATION_CANCELLED)?C:Xr(C,ct.NAVIGATION_GUARD_REDIRECT)?(I(He(T(C.to),{force:!0}),X).then(F=>{Xr(F,ct.NAVIGATION_ABORTED|ct.NAVIGATION_DUPLICATED)&&!K.delta&&K.type===Al.pop&&i.go(-1,!1)}).catch(ps),Promise.reject()):(K.delta&&i.go(-K.delta,!1),Pe(C,X,E))).then(C=>{C=C||se(X,E,!1),C&&(K.delta&&!Xr(C,ct.NAVIGATION_CANCELLED)?i.go(-K.delta,!1):K.type===Al.pop&&Xr(C,ct.NAVIGATION_ABORTED|ct.NAVIGATION_DUPLICATED)&&i.go(-1,!1)),ne(X,E,C)}).catch(ps)}))}let Oe=Qi(),Me=Qi(),be;function Pe(L,Q,K){ht(L);const X=Me.list();return X.length?X.forEach(Ee=>Ee(L,Q,K)):console.error(L),Promise.reject(L)}function Xe(){return be&&l.value!==gn?Promise.resolve():new Promise((L,Q)=>{Oe.add([L,Q])})}function ht(L){return be||(be=!L,Be(),Oe.list().forEach(([Q,K])=>L?K(L):Q()),Oe.reset()),L}function it(L,Q,K,X){const{scrollBehavior:Ee}=e;if(!di||!Ee)return Promise.resolve();const E=!K&&Lv(Ru(L.fullPath,0))||(X||!K)&&history.state&&history.state.scroll||null;return lc().then(()=>Ee(L,Q,E)).then(C=>C&&Nv(C)).catch(C=>Pe(C,L,Q))}const R=L=>i.go(L);let H;const N=new Set,P={currentRoute:l,listening:!0,addRoute:d,removeRoute:g,clearRoutes:t.clearRoutes,hasRoute:m,getRoutes:p,resolve:w,options:e,push:O,replace:V,go:R,back:()=>R(-1),forward:()=>R(1),beforeEach:s.add,beforeResolve:a.add,afterEach:o.add,onError:Me.add,isReady:Xe,install(L){L.component("RouterLink",f_),L.component("RouterView",g_),L.config.globalProperties.$router=P,Object.defineProperty(L.config.globalProperties,"$route",{enumerable:!0,get:()=>wi(l)}),di&&!H&&l.value===gn&&(H=!0,O(i.location).catch(X=>{}));const Q={};for(const X in gn)Object.defineProperty(Q,X,{get:()=>l.value[X],enumerable:!0});L.provide(mc,P),L.provide(wh,O0(Q)),L.provide(Ol,l);const K=L.unmount;N.add(L),L.unmount=function(){N.delete(L),N.size<1&&(c=gn,de&&de(),de=null,l.value=gn,H=!1,be=!1),K()}}};function Z(L){return L.reduce((Q,K)=>Q.then(()=>M(K)),Promise.resolve())}return P}function v_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function js(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Yr={},ea={},Cl=function(e,t){return Cl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Cl(e,t)};function Sh(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Cl(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var La=function(){return La=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},La.apply(this,arguments)};function Bi(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function bh(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Ah(e,t){return function(r,n){t(r,n,e)}}function kh(e,t,r,n,i,s){function a(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var o=n.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?n.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),f,h=!1,d=r.length-1;d>=0;d--){var g={};for(var p in n)g[p]=p==="access"?{}:n[p];for(var p in n.access)g.access[p]=n.access[p];g.addInitializer=function(w){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(w||null))};var m=(0,r[d])(o==="accessor"?{get:u.get,set:u.set}:u[l],g);if(o==="accessor"){if(m===void 0)continue;if(m===null||typeof m!="object")throw new TypeError("Object expected");(f=a(m.get))&&(u.get=f),(f=a(m.set))&&(u.set=f),(f=a(m.init))&&i.unshift(f)}else(f=a(m))&&(o==="field"?i.unshift(f):u[l]=f)}c&&Object.defineProperty(c,n.name,u),h=!0}function Oh(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function Ch(e){return typeof e=="symbol"?e:"".concat(e)}function Rh(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function Ih(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function we(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})}function Fh(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){r.label=c[1];break}if(c[0]===6&&r.label<s[1]){r.label=s[1],s=c;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(c);break}s[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var Eo=Object.create?(function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}):(function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]});function Ph(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Eo(t,e,r)}function Ma(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function vc(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Nh(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(vc(arguments[t]));return e}function Dh(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,i++)n[i]=s[a];return n}function Lh(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function Ni(e){return this instanceof Ni?(this.v=e,this):new Ni(e)}function Mh(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(d){return function(g){return Promise.resolve(g).then(d,f)}}function o(d,g){n[d]&&(i[d]=function(p){return new Promise(function(m,w){s.push([d,p,m,w])>1||l(d,p)})},g&&(i[d]=g(i[d])))}function l(d,g){try{c(n[d](g))}catch(p){h(s[0][3],p)}}function c(d){d.value instanceof Ni?Promise.resolve(d.value.v).then(u,f):h(s[0][2],d)}function u(d){l("next",d)}function f(d){l("throw",d)}function h(d,g){d(g),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Bh(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:Ni(e[i](a)),done:!1}:s?s(a):a}:s}}function Uh(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Ma=="function"?Ma(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(o,l){a=e[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(c){s({value:c,done:o})},a)}}function jh(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var __=Object.create?(function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}):function(e,t){e.default=t},Rl=function(e){return Rl=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Rl(e)};function $h(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Rl(e),n=0;n<r.length;n++)r[n]!=="default"&&Eo(t,e,r[n]);return __(t,e),t}function Hh(e){return e&&e.__esModule?e:{default:e}}function Wh(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function Vh(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r}function Kh(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function zh(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var x_=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function Gh(e){function t(s){e.error=e.hasError?new x_(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var r,n=0;function i(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(i,function(a){return t(a),i()})}else n|=1}catch(a){t(a)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function qh(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,s,a){return n?t?".jsx":".js":i&&(!s||!a)?r:i+s+"."+a.toLowerCase()+"js"}):e}const w_={__extends:Sh,__assign:La,__rest:Bi,__decorate:bh,__param:Ah,__esDecorate:kh,__runInitializers:Oh,__propKey:Ch,__setFunctionName:Rh,__metadata:Ih,__awaiter:we,__generator:Fh,__createBinding:Eo,__exportStar:Ph,__values:Ma,__read:vc,__spread:Nh,__spreadArrays:Dh,__spreadArray:Lh,__await:Ni,__asyncGenerator:Mh,__asyncDelegator:Bh,__asyncValues:Uh,__makeTemplateObject:jh,__importStar:$h,__importDefault:Hh,__classPrivateFieldGet:Wh,__classPrivateFieldSet:Vh,__classPrivateFieldIn:Kh,__addDisposableResource:zh,__disposeResources:Gh,__rewriteRelativeImportExtension:qh},y_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:zh,get __assign(){return La},__asyncDelegator:Bh,__asyncGenerator:Mh,__asyncValues:Uh,__await:Ni,__awaiter:we,__classPrivateFieldGet:Wh,__classPrivateFieldIn:Kh,__classPrivateFieldSet:Vh,__createBinding:Eo,__decorate:bh,__disposeResources:Gh,__esDecorate:kh,__exportStar:Ph,__extends:Sh,__generator:Fh,__importDefault:Hh,__importStar:$h,__makeTemplateObject:jh,__metadata:Ih,__param:Ah,__propKey:Ch,__read:vc,__rest:Bi,__rewriteRelativeImportExtension:qh,__runInitializers:Oh,__setFunctionName:Rh,__spread:Nh,__spreadArray:Lh,__spreadArrays:Dh,__values:Ma,default:w_},Symbol.toStringTag,{value:"Module"})),E_=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);let To=class extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}},Xh=class extends To{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},Il=class extends To{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},Fl=class extends To{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}};var Ba;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Ba||(Ba={}));class T_{constructor(t,{headers:r={},customFetch:n,region:i=Ba.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=E_(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return we(this,arguments,void 0,function*(r,n={}){var i;let s,a;try{const{headers:o,method:l,body:c,signal:u,timeout:f}=n;let h={},{region:d}=n;d||(d=this.region);const g=new URL(`${this.url}/${r}`);d&&d!=="any"&&(h["x-region"]=d,g.searchParams.set("forceFunctionRegion",d));let p;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",p=c):typeof c=="string"?(h["Content-Type"]="text/plain",p=c):typeof FormData<"u"&&c instanceof FormData?p=c:(h["Content-Type"]="application/json",p=JSON.stringify(c)):p=c;let m=u;f&&(a=new AbortController,s=setTimeout(()=>a.abort(),f),u?(m=a.signal,u.addEventListener("abort",()=>a.abort())):m=a.signal);const w=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:p,signal:m}).catch(V=>{throw new Xh(V)}),T=w.headers.get("x-relay-error");if(T&&T==="true")throw new Il(w);if(!w.ok)throw new Fl(w);let _=((i=w.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),O;return _==="application/json"?O=yield w.json():_==="application/octet-stream"||_==="application/pdf"?O=yield w.blob():_==="text/event-stream"?O=w:_==="multipart/form-data"?O=yield w.formData():O=yield w.text(),{data:O,error:null,response:w}}catch(o){return{data:null,error:o,response:o instanceof Fl||o instanceof Il?o.context:void 0}}finally{s&&clearTimeout(s)}})}}const S_=Object.freeze(Object.defineProperty({__proto__:null,get FunctionRegion(){return Ba},FunctionsClient:T_,FunctionsError:To,FunctionsFetchError:Xh,FunctionsHttpError:Fl,FunctionsRelayError:Il},Symbol.toStringTag,{value:"Module"})),Yh=js(S_);var Mt={};const Ui=js(y_);var ta={},ra={},na={},ia={},sa={},aa={},Wu;function Jh(){if(Wu)return aa;Wu=1,Object.defineProperty(aa,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return aa.default=e,aa}var Vu;function Qh(){if(Vu)return sa;Vu=1,Object.defineProperty(sa,"__esModule",{value:!0});const t=Ui.__importDefault(Jh());let r=class{constructor(i){var s,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let o=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,u,f,h;let d=null,g=null,p=null,m=l.status,w=l.statusText;if(l.ok){if(this.method!=="HEAD"){const V=await l.text();V===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((c=this.headers.get("Accept"))===null||c===void 0)&&c.includes("application/vnd.pgrst.plan+text"))?g=V:g=JSON.parse(V))}const _=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),O=(f=l.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");_&&O&&O.length>1&&(p=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(d={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,p=null,m=406,w="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const _=await l.text();try{d=JSON.parse(_),Array.isArray(d)&&l.status===404&&(g=[],d=null,m=200,w="OK")}catch{l.status===404&&_===""?(m=204,w="No Content"):d={message:_}}if(d&&this.isMaybeSingle&&(!((h=d?.details)===null||h===void 0)&&h.includes("0 rows"))&&(d=null,m=200,w="OK"),d&&this.shouldThrowOnError)throw new t.default(d)}return{error:d,data:g,count:p,status:m,statusText:w}});return this.shouldThrowOnError||(o=o.catch(l=>{var c,u,f,h,d,g;let p="";const m=l?.cause;if(m){const w=(c=m?.message)!==null&&c!==void 0?c:"",T=(u=m?.code)!==null&&u!==void 0?u:"";p=`${(f=l?.name)!==null&&f!==void 0?f:"FetchError"}: ${l?.message}`,p+=`

Caused by: ${(h=m?.name)!==null&&h!==void 0?h:"Error"}: ${w}`,T&&(p+=` (${T})`),m?.stack&&(p+=`
${m.stack}`)}else p=(d=l?.stack)!==null&&d!==void 0?d:"";return{error:{message:`${(g=l?.name)!==null&&g!==void 0?g:"FetchError"}: ${l?.message}`,details:p,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),o.then(i,s)}returns(){return this}overrideTypes(){return this}};return sa.default=r,sa}var Ku;function Zh(){if(Ku)return ia;Ku=1,Object.defineProperty(ia,"__esModule",{value:!0});const t=Ui.__importDefault(Qh());let r=class extends t.default{select(i){let s=!1;const a=(i??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this.url.searchParams.set(c,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const f=[i?"analyze":null,s?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${h}"; options=${f};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};return ia.default=r,ia}var zu;function _c(){if(zu)return na;zu=1,Object.defineProperty(na,"__esModule",{value:!0});const t=Ui.__importDefault(Zh()),r=new RegExp("[,()]");let n=class extends t.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}regexMatch(s,a){return this.url.searchParams.append(s,`match.${a}`),this}regexIMatch(s,a){return this.url.searchParams.append(s,`imatch.${a}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}isDistinct(s,a){return this.url.searchParams.append(s,`isdistinct.${a}`),this}in(s,a){const o=Array.from(new Set(a)).map(l=>typeof l=="string"&&r.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:o,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const u=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${c}fts${u}.${a}`),this}match(s){return Object.entries(s).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(s,a,o){return this.url.searchParams.append(s,`not.${a}.${o}`),this}or(s,{foreignTable:a,referencedTable:o=a}={}){const l=o?`${o}.or`:"or";return this.url.searchParams.append(l,`(${s})`),this}filter(s,a,o){return this.url.searchParams.append(s,`${a}.${o}`),this}};return na.default=n,na}var Gu;function ed(){if(Gu)return ra;Gu=1,Object.defineProperty(ra,"__esModule",{value:!0});const t=Ui.__importDefault(_c());let r=class{constructor(i,{headers:s={},schema:a,fetch:o}){this.url=i,this.headers=new Headers(s),this.schema=a,this.fetch=o}select(i,s){const{head:a=!1,count:o}=s??{},l=a?"HEAD":"GET";let c=!1;const u=(i??"*").split("").map(f=>/\s/.test(f)&&!c?"":(f==='"'&&(c=!c),f)).join("");return this.url.searchParams.set("select",u),o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:a=!0}={}){var o;const l="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const c=i.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(c.length>0){const u=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){var c;const u="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(f.length>0){const h=[...new Set(f)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(i,{count:s}={}){var a;const o="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:i}={}){var s;const a="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};return ra.default=r,ra}var qu;function b_(){if(qu)return ta;qu=1,Object.defineProperty(ta,"__esModule",{value:!0});const e=Ui,t=e.__importDefault(ed()),r=e.__importDefault(_c());let n=class td{constructor(s,{headers:a={},schema:o,fetch:l}={}){this.url=s,this.headers=new Headers(a),this.schemaName=o,this.fetch=l}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const a=new URL(`${this.url}/${s}`);return new t.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new td(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:o=!1,get:l=!1,count:c}={}){var u;let f;const h=new URL(`${this.url}/rpc/${s}`);let d;o||l?(f=o?"HEAD":"GET",Object.entries(a).filter(([p,m])=>m!==void 0).map(([p,m])=>[p,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([p,m])=>{h.searchParams.append(p,m)})):(f="POST",d=a);const g=new Headers(this.headers);return c&&g.set("Prefer",`count=${c}`),new r.default({method:f,url:h,headers:g,schema:this.schemaName,body:d,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}};return ta.default=n,ta}var Xu;function rd(){if(Xu)return Mt;Xu=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.PostgrestError=Mt.PostgrestBuilder=Mt.PostgrestTransformBuilder=Mt.PostgrestFilterBuilder=Mt.PostgrestQueryBuilder=Mt.PostgrestClient=void 0;const e=Ui,t=e.__importDefault(b_());Mt.PostgrestClient=t.default;const r=e.__importDefault(ed());Mt.PostgrestQueryBuilder=r.default;const n=e.__importDefault(_c());Mt.PostgrestFilterBuilder=n.default;const i=e.__importDefault(Zh());Mt.PostgrestTransformBuilder=i.default;const s=e.__importDefault(Qh());Mt.PostgrestBuilder=s.default;const a=e.__importDefault(Jh());return Mt.PostgrestError=a.default,Mt.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:s.default,PostgrestError:a.default},Mt}class nd{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const A_="2.87.1",k_=`realtime-js/${A_}`,id="1.0.0",O_="2.0.0",Yu=id,Pl=1e4,C_=1e3,R_=100;var Hn;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Hn||(Hn={}));var pt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(pt||(pt={}));var Ar;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ar||(Ar={}));var Nl;(function(e){e.websocket="websocket"})(Nl||(Nl={}));var Wn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Wn||(Wn={}));class I_{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},a=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(t,r,n){var i,s;const a=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",l=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+c.length+f.length,d=new ArrayBuffer(this.HEADER_LENGTH+h);let g=new DataView(d),p=0;g.setUint8(p++,this.KINDS.userBroadcastPush),g.setUint8(p++,l.length),g.setUint8(p++,o.length),g.setUint8(p++,a.length),g.setUint8(p++,c.length),g.setUint8(p++,f.length),g.setUint8(p++,r),Array.from(l,w=>g.setUint8(p++,w.charCodeAt(0))),Array.from(o,w=>g.setUint8(p++,w.charCodeAt(0))),Array.from(a,w=>g.setUint8(p++,w.charCodeAt(0))),Array.from(c,w=>g.setUint8(p++,w.charCodeAt(0))),Array.from(f,w=>g.setUint8(p++,w.charCodeAt(0)));var m=new Uint8Array(d.byteLength+n.byteLength);return m.set(new Uint8Array(d),0),m.set(new Uint8Array(n),d.byteLength),m.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,a,o,l]=n;return r({join_ref:i,ref:s,topic:a,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(t.slice(l,l+i));l=l+i;const u=n.decode(t.slice(l,l+s));l=l+s;const f=n.decode(t.slice(l,l+a));l=l+a;const h=t.slice(l,t.byteLength),d=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,g={type:this.BROADCAST_EVENT,event:u,payload:d};return a>0&&(g.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:g}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class sd{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ze;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ze||(Ze={}));const Ju=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,a)=>(s[a]=F_(a,e,t,i),s),{}):{}},F_=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i?.type,a=r[e];return s&&!n.includes(s)?ad(s,a):Dl(a)},ad=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return L_(t,r)}switch(e){case Ze.bool:return P_(t);case Ze.float4:case Ze.float8:case Ze.int2:case Ze.int4:case Ze.int8:case Ze.numeric:case Ze.oid:return N_(t);case Ze.json:case Ze.jsonb:return D_(t);case Ze.timestamp:return M_(t);case Ze.abstime:case Ze.date:case Ze.daterange:case Ze.int4range:case Ze.int8range:case Ze.money:case Ze.reltime:case Ze.text:case Ze.time:case Ze.timestamptz:case Ze.timetz:case Ze.tsrange:case Ze.tstzrange:return Dl(t);default:return Dl(t)}},Dl=e=>e,P_=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},N_=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},D_=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},L_=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>ad(t,o))}return e},M_=e=>typeof e=="string"?e.replace(" ","T"):e,od=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Yo{constructor(t,r,n={},i=Pl){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ll;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ll||(Ll={}));let ld=class Ea{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ea.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=Ea.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Ea.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const f=s[c];if(f){const h=u.map(m=>m.presence_ref),d=f.map(m=>m.presence_ref),g=u.filter(m=>d.indexOf(m.presence_ref)<0),p=f.filter(m=>h.indexOf(m.presence_ref)<0);g.length>0&&(o[c]=g),p.length>0&&(l[c]=p)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(d=>d.presence_ref),h=u.filter(d=>f.indexOf(d.presence_ref)<0);t[o].unshift(...h)}n(o,u,l)}),this.map(a,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,i(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var Ml;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ml||(Ml={}));var Si;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Si||(Si={}));var jr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(jr||(jr={}));const B_=pt;let cd=class ns{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=pt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Yo(this,Ar.join,this.params,this.timeout),this.rejoinTimer=new sd(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=pt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=pt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=pt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=pt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=pt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ar.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new ld(this),this.broadcastEndpointURL=od(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==pt.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[Si.PRESENCE]&&this.bindings[Si.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(d=>t?.(jr.CHANNEL_ERROR,d)),this._onClose(()=>t?.(jr.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var g;if(this.socket._isManualToken()||this.socket.setAuth(),d===void 0){t?.(jr.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,m=(g=p?.length)!==null&&g!==void 0?g:0,w=[];for(let T=0;T<m;T++){const _=p[T],{filter:{event:O,schema:V,table:ee,filter:I}}=_,q=d&&d[T];if(q&&q.event===O&&ns.isFilterValueEqual(q.schema,V)&&ns.isFilterValueEqual(q.table,ee)&&ns.isFilterValueEqual(q.filter,I))w.push(Object.assign(Object.assign({},_),{id:q.id}));else{this.unsubscribe(),this.state=pt.errored,t?.(jr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(jr.SUBSCRIBED);return}}).receive("error",d=>{this.state=pt.errored,t?.(jr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t?.(jr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===pt.joined&&t===Si.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=pt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ar.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Yo(this,Ar.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=pt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Yo(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>R_){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Ar;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(d=>{var g,p,m;return((g=d.filter)===null||g===void 0?void 0:g.event)==="*"||((m=(p=d.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(d=>d.callback(h,n)):(s=this.bindings[a])===null||s===void 0||s.filter(d=>{var g,p,m,w,T,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in d){const O=d.id,V=(g=d.filter)===null||g===void 0?void 0:g.event;return O&&((p=r.ids)===null||p===void 0?void 0:p.includes(O))&&(V==="*"||V?.toLocaleLowerCase()===((m=r.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const O=(T=(w=d?.filter)===null||w===void 0?void 0:w.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return O==="*"||O===((_=r?.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===a}).map(d=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:p,table:m,commit_timestamp:w,type:T,errors:_}=g;h=Object.assign(Object.assign({},{schema:p,table:m,commit_timestamp:w,eventType:T,new:{},old:{},errors:_}),this._getPayloadRecords(g))}d.callback(h,n)})}_isClosed(){return this.state===pt.closed}_isJoined(){return this.state===pt.joined}_isJoining(){return this.state===pt.joining}_isLeaving(){return this.state===pt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&ns.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ar.close,{},t)}_onError(t){this._on(Ar.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=pt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ju(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ju(t.columns,t.old_record)),r}};const Jo=()=>{},oa={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},U_=[1e3,2e3,5e3,1e4],j_=1e4,$_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;let H_=class{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Pl,this.transport=null,this.heartbeatIntervalMs=oa.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jo,this.ref=0,this.reconnectTimer=null,this.vsn=Yu,this.logger=Jo,this.conn=null,this.sendBuffer=[],this.serializer=new I_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Nl.websocket}`,this.httpEndpoint=od(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=nd.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Hn.connecting:return Wn.Connecting;case Hn.open:return Wn.Open;case Hn.closing:return Wn.Closing;default:return Wn.Closed}}isConnected(){return this.connectionState()===Wn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new cd(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(C_,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},oa.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:a}=r,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Hn.open||this.conn.readyState===Hn.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ar.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([$_],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:k_};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(Ar.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new sd(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},oa.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,a,o,l,c,u,f,h,d;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Pl,this.heartbeatIntervalMs=(i=t?.heartbeatIntervalMs)!==null&&i!==void 0?i:oa.HEARTBEAT_INTERVAL,this.worker=(s=t?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=t?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=t?.heartbeatCallback)!==null&&o!==void 0?o:Jo,this.vsn=(l=t?.vsn)!==null&&l!==void 0?l:Yu,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:(g=>U_[g-1]||j_),this.vsn){case id:this.encode=(u=t?.encode)!==null&&u!==void 0?u:((g,p)=>p(JSON.stringify(g))),this.decode=(f=t?.decode)!==null&&f!==void 0?f:((g,p)=>p(JSON.parse(g)));break;case O_:this.encode=(h=t?.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(d=t?.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}};const W_=Object.freeze(Object.defineProperty({__proto__:null,REALTIME_CHANNEL_STATES:B_,get REALTIME_LISTEN_TYPES(){return Si},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return Ml},get REALTIME_PRESENCE_LISTEN_EVENTS(){return Ll},get REALTIME_SUBSCRIBE_STATES(){return jr},RealtimeChannel:cd,RealtimeClient:H_,RealtimePresence:ld,WebSocketFactory:nd},Symbol.toStringTag,{value:"Module"})),ud=js(W_);class $s extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function st(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class fd extends $s{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ua extends $s{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const xc=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),V_=()=>Response,Bl=e=>{if(Array.isArray(e))return e.map(r=>Bl(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Bl(n)}),t},K_=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},z_=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e),Qo=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},G_=(e,t,r)=>we(void 0,void 0,void 0,function*(){const n=yield V_();e instanceof n&&!r?.noResolveJson?e.json().then(i=>{const s=e.status||500,a=i?.statusCode||s+"";t(new fd(Qo(i),s,a))}).catch(i=>{t(new Ua(Qo(i),i))}):t(new Ua(Qo(e),e))}),q_=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"||!n?i:(K_(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,t?.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r))};function Hs(e,t,r,n,i,s){return we(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,q_(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>G_(l,o,n))})})}function ks(e,t,r,n){return we(this,void 0,void 0,function*(){return Hs(e,"GET",t,r,n)})}function br(e,t,r,n,i){return we(this,void 0,void 0,function*(){return Hs(e,"POST",t,n,i,r)})}function Ul(e,t,r,n,i){return we(this,void 0,void 0,function*(){return Hs(e,"PUT",t,n,i,r)})}function X_(e,t,r,n){return we(this,void 0,void 0,function*(){return Hs(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function wc(e,t,r,n,i){return we(this,void 0,void 0,function*(){return Hs(e,"DELETE",t,n,i,r)})}class Y_{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return we(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(st(t))return{data:null,error:t};throw t}})}}var hd;class J_{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[hd]="BlobDownloadBuilder",this.promise=null}asStream(){return new Y_(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return we(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(st(t))return{data:null,error:t};throw t}})}}hd=Symbol.toStringTag;const Q_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Qu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Z_{constructor(t,r={},n,i){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=xc(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,i){return we(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Qu),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),l&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),i?.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield(t=="PUT"?Ul:br)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},a?.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(st(s))return{data:null,error:s};throw s}})}upload(t,r,n){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return we(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Qu.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield Ul(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(st(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return we(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r?.upsert&&(i["x-upsert"]="true");const s=yield br(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new $s("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(st(n))return{data:null,error:n};throw n}})}update(t,r,n){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return we(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(st(i))return{data:null,error:i};throw i}})}copy(t,r,n){return we(this,void 0,void 0,function*(){try{return{data:{path:(yield br(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(st(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return we(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield br(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(st(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return we(this,void 0,void 0,function*(){try{const i=yield br(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(st(i))return{data:null,error:i};throw i}})}download(t,r){const i=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),a=s?`?${s}`:"",o=this._getFinalPath(t),l=()=>ks(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new J_(l,this.shouldThrowOnError)}info(t){return we(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield ks(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Bl(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(st(n))return{data:null,error:n};throw n}})}exists(t){return we(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield X_(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(st(n)&&n instanceof Ua){const i=n.originalError;if([400,404].includes(i?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return we(this,void 0,void 0,function*(){try{return{data:yield wc(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(st(r))return{data:null,error:r};throw r}})}list(t,r,n){return we(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Q_),r),{prefix:t||""});return{data:yield br(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(st(i))return{data:null,error:i};throw i}})}listV2(t,r){return we(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield br(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(st(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const dd="2.87.1",pd={"X-Client-Info":`storage-js/${dd}`};class ex{constructor(t,r={},n,i){this.shouldThrowOnError=!1;const s=new URL(t);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pd),r),this.fetch=xc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return we(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield ks(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(st(r))return{data:null,error:r};throw r}})}getBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield ks(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(st(r))return{data:null,error:r};throw r}})}createBucket(t){return we(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield br(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(st(i))return{data:null,error:i};throw i}})}updateBucket(t,r){return we(this,void 0,void 0,function*(){try{return{data:yield Ul(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(st(n))return{data:null,error:n};throw n}})}emptyBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(st(r))return{data:null,error:r};throw r}})}deleteBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield wc(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(st(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var Os=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function tx(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function rx(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function nx(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:a}){const o=tx(e.baseUrl,n,i),l=await rx(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...a},body:s?JSON.stringify(s):void 0}),u=await c.text(),f=(c.headers.get("content-type")||"").includes("application/json"),h=f&&u?JSON.parse(u):u;if(!c.ok){const d=f?h:void 0,g=d?.error;throw new Os(g?.message??`Request failed with status ${c.status}`,{status:c.status,icebergType:g?.type,icebergCode:g?.code,details:d})}return{status:c.status,headers:c.headers,data:h}}}}function la(e){return e.join("")}var ix=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:la(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${la(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${la(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${la(e.namespace)}`}),!0}catch(t){if(t instanceof Os&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Os&&r.status===409)return;throw r}}};function si(e){return e.join("")}var sx=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Os&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Os&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},ax=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=nx({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new ix(this.client,t),this.tableOps=new sx(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};class gd{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pd),r),this.fetch=xc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(st(r))return{data:null,error:r};throw r}})}listBuckets(t){return we(this,void 0,void 0,function*(){try{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield ks(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(st(r))return{data:null,error:r};throw r}})}deleteBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield wc(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(st(r))return{data:null,error:r};throw r}})}from(t){if(!z_(t))throw new $s("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new ax({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:()=>we(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(s,a){const o=s[a];return typeof o!="function"?o:(...l)=>we(this,void 0,void 0,function*(){try{return{data:yield o.apply(s,l),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}})}})}}const yc={"X-Client-Info":`storage-js/${dd}`,"Content-Type":"application/json"};class Ec extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Zt(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class Ta extends Ec{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class md extends Ec{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var jl;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(jl||(jl={}));const So=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ox=()=>Response,vd=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},lx=e=>Array.from(new Float32Array(e)),cx=(e,t)=>{if(t!==void 0&&e.float32.length!==t)throw new Error(`Vector dimension mismatch: expected ${t}, got ${e.float32.length}`)},Zu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ux=(e,t,r)=>we(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const i=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const o=a?.statusCode||a?.code||i+"";t(new Ta(Zu(a),i,o))}).catch(()=>{const a=i+"",o=s.statusText||`HTTP ${i} error`;t(new Ta(o,i,a))});else{const a=i+"",o=s.statusText||`HTTP ${i} error`;t(new Ta(o,i,a))}}else t(new md(Zu(e),e))}),fx=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return n?(vd(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function hx(e,t,r,n,i,s){return we(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,fx(t,n,i,s)).then(l=>{if(!l.ok)throw l;if(n?.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>ux(l,o,n))})})}function fr(e,t,r,n,i){return we(this,void 0,void 0,function*(){return hx(e,"POST",t,n,i,r)})}class _d{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},yc),r),this.fetch=So(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return we(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}getIndex(t,r){return we(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zt(n))return{data:null,error:n};throw n}})}listIndexes(t){return we(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return we(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Zt(n))return{data:null,error:n};throw n}})}}class xd{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},yc),r),this.fetch=So(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return we(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield fr(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}getVectors(t){return we(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}listVectors(t){return we(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield fr(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}queryVectors(t){return we(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}deleteVectors(t){return we(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield fr(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}}class wd{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},yc),r),this.fetch=So(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return we(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}getBucket(t){return we(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}listBuckets(){return we(this,arguments,void 0,function*(t={}){try{return{data:yield fr(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return we(this,void 0,void 0,function*(){try{return{data:(yield fr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}})}}class yd extends wd{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new Ed(this.url,this.headers,t,this.fetch)}createBucket(t){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return we(this,void 0,void 0,function*(){return r.createBucket.call(this,t)})}getBucket(t){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return we(this,void 0,void 0,function*(){return r.getBucket.call(this,t)})}listBuckets(){const t=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return we(this,arguments,void 0,function*(r={}){return t.listBuckets.call(this,r)})}deleteBucket(t){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return we(this,void 0,void 0,function*(){return r.deleteBucket.call(this,t)})}}class Ed extends _d{constructor(t,r,n,i){super(t,r,i),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return we(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return we(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return we(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return we(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new Td(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class Td extends xd{constructor(t,r,n,i,s){super(t,r,s),this.vectorBucketName=n,this.indexName=i}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return we(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return we(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return we(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return we(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return we(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class dx extends ex{constructor(t,r={},n,i){super(t,r,n,i)}from(t){return new Z_(this.url,this.headers,t,this.fetch)}get vectors(){return new yd(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new gd(this.url+"/iceberg",this.headers,this.fetch)}}const px=Object.freeze(Object.defineProperty({__proto__:null,StorageAnalyticsClient:gd,StorageApiError:fd,StorageClient:dx,StorageError:$s,StorageUnknownError:Ua,StorageVectorsApiError:Ta,StorageVectorsClient:yd,StorageVectorsError:Ec,get StorageVectorsErrorCode(){return jl},StorageVectorsUnknownError:md,VectorBucketApi:wd,VectorBucketScope:Ed,VectorDataApi:xd,VectorIndexApi:_d,VectorIndexScope:Td,isPlainObject:vd,isStorageError:st,isStorageVectorsError:Zt,normalizeToFloat32:lx,resolveFetch:So,resolveResponse:ox,validateVectorDimension:cx},Symbol.toStringTag,{value:"Module"})),gx=js(px);var Zo={},Zi={},ef;function mx(){return ef||(ef=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.version=void 0,Zi.version="2.87.1"),Zi}var tf;function vx(){return tf||(tf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_REALTIME_OPTIONS=e.DEFAULT_AUTH_OPTIONS=e.DEFAULT_DB_OPTIONS=e.DEFAULT_GLOBAL_OPTIONS=e.DEFAULT_HEADERS=void 0;const t=mx();let r="";typeof Deno<"u"?r="deno":typeof document<"u"?r="web":typeof navigator<"u"&&navigator.product==="ReactNative"?r="react-native":r="node",e.DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${r}/${t.version}`},e.DEFAULT_GLOBAL_OPTIONS={headers:e.DEFAULT_HEADERS},e.DEFAULT_DB_OPTIONS={schema:"public"},e.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},e.DEFAULT_REALTIME_OPTIONS={}})(Zo)),Zo}var el={},rf;function _x(){return rf||(rf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.fetchWithAuth=e.resolveHeadersConstructor=e.resolveFetch=void 0;const t=i=>i?(...s)=>i(...s):(...s)=>fetch(...s);e.resolveFetch=t;const r=()=>Headers;e.resolveHeadersConstructor=r;const n=(i,s,a)=>{const o=(0,e.resolveFetch)(a),l=(0,e.resolveHeadersConstructor)();return async(c,u)=>{var f;const h=(f=await s())!==null&&f!==void 0?f:i;let d=new l(u?.headers);return d.has("apikey")||d.set("apikey",i),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),o(c,Object.assign(Object.assign({},u),{headers:d}))}};e.fetchWithAuth=n})(el)),el}var Jr={},nf;function xx(){if(nf)return Jr;nf=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.isBrowser=void 0,Jr.uuid=e,Jr.ensureTrailingSlash=t,Jr.applySettingDefaults=n,Jr.validateSupabaseUrl=i;function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var a=Math.random()*16|0,o=s=="x"?a:a&3|8;return o.toString(16)})}function t(s){return s.endsWith("/")?s:s+"/"}const r=()=>typeof window<"u";Jr.isBrowser=r;function n(s,a){var o,l;const{db:c,auth:u,realtime:f,global:h}=s,{db:d,auth:g,realtime:p,global:m}=a,w={db:Object.assign(Object.assign({},d),c),auth:Object.assign(Object.assign({},g),u),realtime:Object.assign(Object.assign({},p),f),storage:{},global:Object.assign(Object.assign(Object.assign({},m),h),{headers:Object.assign(Object.assign({},(o=m?.headers)!==null&&o!==void 0?o:{}),(l=h?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return s.accessToken?w.accessToken=s.accessToken:delete w.accessToken,w}function i(s){const a=s?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(t(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}return Jr}var es={};const Sd="2.87.1",pi=30*1e3,$l=3,tl=$l*pi,wx="http://localhost:9999",yx="supabase.auth.token",Ex={"X-Client-Info":`gotrue-js/${Sd}`},Hl="X-Supabase-Api-Version",bd={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Tx=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Sx=600*1e3;let Di=class extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}};function Te(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}let Ad=class extends Di{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}};function kd(e){return Te(e)&&e.name==="AuthApiError"}let yn=class extends Di{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}},hn=class extends Di{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}},Yt=class extends hn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function Od(e){return Te(e)&&e.name==="AuthSessionMissingError"}let Bn=class extends hn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},is=class extends hn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},ss=class extends hn{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function Cd(e){return Te(e)&&e.name==="AuthImplicitGrantRedirectError"}let Wl=class extends hn{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},ja=class extends hn{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}};function Sa(e){return Te(e)&&e.name==="AuthRetryableFetchError"}let Vl=class extends hn{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}};function bx(e){return Te(e)&&e.name==="AuthWeakPasswordError"}let $a=class extends hn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};const Ha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sf=` 	
\r=`.split(""),Ax=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<sf.length;t+=1)e[sf[t].charCodeAt(0)]=-2;for(let t=0;t<Ha.length;t+=1)e[Ha[t].charCodeAt(0)]=t;return e})();function af(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ha[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ha[n]),t.queuedBits-=6}}function Rd(e,t,r){const n=Ax[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function of(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Cx(a,n,r)};for(let a=0;a<e.length;a+=1)Rd(e.charCodeAt(a),i,s);return t.join("")}function kx(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Ox(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}kx(n,t)}}function Cx(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function bi(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Rd(e.charCodeAt(i),r,n);return new Uint8Array(t)}function Rx(e){const t=[];return Ox(e,r=>t.push(r)),new Uint8Array(t)}function zn(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>af(i,r,n)),af(null,r,n),t.join("")}function Ix(e){return Math.round(Date.now()/1e3)+e}function Fx(){return Symbol("auth-callback")}const kt=()=>typeof window<"u"&&typeof document<"u",Dn={tested:!1,writable:!1},Id=()=>{if(!kt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Dn.tested)return Dn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Dn.tested=!0,Dn.writable=!0}catch{Dn.tested=!0,Dn.writable=!1}return Dn.writable};function Px(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Fd=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Nx=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",gi=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ln=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},At=async(e,t)=>{await e.removeItem(t)};class bo{constructor(){this.promise=new bo.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}bo.promiseConstructor=Promise;function rl(e){const t=e.split(".");if(t.length!==3)throw new $a("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Tx.test(t[n]))throw new $a("JWT not in base64url format");return{header:JSON.parse(of(t[0])),payload:JSON.parse(of(t[1])),signature:bi(t[2]),raw:{header:t[0],payload:t[1]}}}async function Dx(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Lx(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function Mx(e){return("0"+e.toString(16)).substr(-2)}function Bx(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Mx).join("")}async function Ux(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function jx(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Ux(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ai(e,t,r=!1){const n=Bx();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await gi(e,`${t}-code-verifier`,i);const s=await jx(n);return[s,n===s?"plain":"s256"]}const $x=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Hx(e){const t=e.headers.get(Hl);if(!t||!t.match($x))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Wx(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Vx(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Kx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function oi(e){if(!Kx.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function nl(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function zx(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function lf(e){return JSON.parse(JSON.stringify(e))}const Un=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Gx=[502,503,504];async function cf(e){var t;if(!Nx(e))throw new ja(Un(e),0);if(Gx.includes(e.status))throw new ja(Un(e),e.status);let r;try{r=await e.json()}catch(s){throw new yn(Un(s),s)}let n;const i=Hx(e);if(i&&i.getTime()>=bd["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Vl(Un(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Yt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Vl(Un(r),e.status,r.weak_password.reasons);throw new Ad(Un(r),e.status||500,n)}const qx=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function ke(e,t,r,n){var i;const s=Object.assign({},n?.headers);s[Hl]||(s[Hl]=bd["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n?.query)!==null&&i!==void 0?i:{};n?.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Xx(e,t,r+o,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function Xx(e,t,r,n,i,s){const a=qx(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new ja(Un(l),0)}if(o.ok||await cf(o),n?.noResolveJson)return o;try{return await o.json()}catch(l){await cf(l)}}function Sr(e){var t;let r=null;Qx(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Ix(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function uf(e){const t=Sr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function En(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Yx(e){return{data:e,error:null}}function Jx(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=Bi(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function ff(e){return e}function Qx(e){return e.access_token&&e.refresh_token&&e.expires_in}const ba=["global","local","others"];let Tc=class{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Fd(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=ba[0]){if(ba.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ba.join(", ")}`);try{return await ke(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Te(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await ke(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:En})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Bi(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n?.newEmail,delete i.newEmail),await ke(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Jx,redirectTo:r?.redirectTo})}catch(r){if(Te(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ke(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:En})}catch(r){if(Te(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ke(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:ff});if(u.error)throw u.error;const f=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);c[`${m}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Te(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){oi(t);try{return await ke(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:En})}catch(r){if(Te(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){oi(t);try{return await ke(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:En})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){oi(t);try{return await ke(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:En})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){oi(t.userId);try{const{data:r,error:n}=await ke(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _deleteFactor(t){oi(t.userId),oi(t.id);try{return{data:await ke(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ke(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:ff});if(u.error)throw u.error;const f=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);c[`${m}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Te(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await ke(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ke(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await ke(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Te(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await ke(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ke(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Te(r))return{data:null,error:r};throw r}}};function hf(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const jn={debug:!!(globalThis&&Id()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Sc extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}let Pd=class extends Sc{};class Zx extends Sc{}async function Nd(e,t,r){jn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),jn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){jn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{jn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw jn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Pd(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(jn.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}const df={};async function ew(e,t,r){var n;const i=(n=df[e])!==null&&n!==void 0?n:Promise.resolve(),s=Promise.race([i.catch(()=>null),t>=0?new Promise((a,o)=>{setTimeout(()=>{o(new Zx(`Acquring process lock with name "${e}" timed out`))},t)}):null].filter(a=>a)).catch(a=>{if(a&&a.isAcquireTimeout)throw a;return null}).then(async()=>await r());return df[e]=s.catch(async a=>{if(a&&a.isAcquireTimeout)return await i,null;throw a}),await s}function tw(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Dd(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function rw(e){return parseInt(e,16)}function nw(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function iw(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const d=Dd(e.address),g=u?`${u}://${n}`:n,p=e.statement?`${e.statement}
`:"",m=`${g} wants you to sign in with your Ethereum account:
${d}

${p}`;let w=`URI: ${f}
Version: ${h}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(w+=`
Expiration Time: ${i.toISOString()}`),o&&(w+=`
Not Before: ${o.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let T=`
Resources:`;for(const _ of c){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);T+=`
- ${_}`}w+=T}return`${m}
${w}`}class gt extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Wa extends gt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function sw({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new gt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new gt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new gt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new gt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new gt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new gt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new gt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new gt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(Ld(a)){if(s.rp.id!==a)return new gt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new gt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new gt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new gt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new gt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function aw({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new gt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new gt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Ld(n)){if(r.rpId!==n)return new gt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new gt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new gt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new gt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class ow{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const lw=new ow;function cw(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Bi(e,["challenge","user","excludeCredentials"]),s=bi(t).buffer,a=Object.assign(Object.assign({},r),{id:bi(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:bi(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function uw(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Bi(e,["challenge","allowCredentials"]),i=bi(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const o=r[a];s.allowCredentials[a]=Object.assign(Object.assign({},o),{id:bi(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function fw(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:zn(new Uint8Array(e.response.attestationObject)),clientDataJSON:zn(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function hw(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:zn(new Uint8Array(i.authenticatorData)),clientDataJSON:zn(new Uint8Array(i.clientDataJSON)),signature:zn(new Uint8Array(i.signature)),userHandle:i.userHandle?zn(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Ld(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function pf(){var e,t;return!!(kt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function dw(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Wa("Browser returned unexpected credential type",t)}:{data:null,error:new Wa("Empty credential response",t)}}catch(t){return{data:null,error:sw({error:t,options:e})}}}async function pw(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Wa("Browser returned unexpected credential type",t)}:{data:null,error:new Wa("Empty credential response",t)}}catch(t){return{data:null,error:aw({error:t,options:e})}}}const gw={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},mw={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Va(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))n[s]=a;else if(r(a))n[s]=a;else if(t(a)){const o=n[s];t(o)?n[s]=Va(o,a):n[s]=Va(a)}else n[s]=a}return n}function vw(e,t){return Va(gw,e,t||{})}function _w(e,t){return Va(mw,e,t||{})}class xw{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!a)return{data:null,error:o};const l=i??lw.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=vw(a.webauthn.credential_options.publicKey,s?.create),{data:u,error:f}=await dw({publicKey:c,signal:l});return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const c=_w(a.webauthn.credential_options.publicKey,s?.request),{data:u,error:f}=await pw(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(a){return Te(a)?{data:null,error:a}:{data:null,error:new yn("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Di("rpId is required for WebAuthn authentication")};try{if(!pf())return{data:null,error:new yn("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return Te(a)?{data:null,error:a}:{data:null,error:new yn("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Di("rpId is required for WebAuthn registration")};try{if(!pf())return{data:null,error:new yn("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return Te(a)?{data:null,error:a}:{data:null,error:new yn("Unexpected error in register",a)}}}}tw();const ww={url:wx,storageKey:yx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ex,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function gf(e,t,r){return await r()}const li={};let bc=class Kl{get jwks(){var t,r;return(r=(t=li[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){li[this.storageKey]=Object.assign(Object.assign({},li[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=li[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){li[this.storageKey]=Object.assign(Object.assign({},li[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},ww),t);if(this.storageKey=s.storageKey,this.instanceID=(r=Kl.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Kl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&kt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Tc({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Fd(s.fetch),this.lock=s.lock||gf,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:this.persistSession&&kt()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=Nd:this.lock=gf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new xw(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Id()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hf(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=hf(this.memoryStorage)),kt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Sd}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(kt()&&(r=Px(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),kt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Cd(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Te(r)?this._returnResult({error:r}):this._returnResult({error:new yn("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t?.options)===null||i===void 0?void 0:i.captchaToken}},xform:Sr}),{data:a,error:o}=s;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(Te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:u,password:f,options:h}=t;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await ai(this.storage,this.storageKey)),s=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:u,password:f,data:(r=h?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:g},xform:Sr})}else if("phone"in t){const{phone:u,password:f,options:h}=t;s=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h?.data)!==null&&n!==void 0?n:{},channel:(i=h?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Sr})}else throw new is("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return await At(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:uf})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:uf})}else throw new is("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Bn;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Te(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,a,o,l,c,u,f,h;let d,g;if("message"in t)d=t.message,g=t.signature;else{const{chain:p,wallet:m,statement:w,options:T}=t;let _;if(kt())if(typeof m=="object")_=m;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")_=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=m}const O=new URL((r=T?.url)!==null&&r!==void 0?r:window.location.href),V=await _.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!V||V.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const ee=Dd(V[0]);let I=(n=T?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!I){const M=await _.request({method:"eth_chainId"});I=rw(M)}const q={domain:O.host,address:ee,statement:w,uri:O.href,version:"1",chainId:I,nonce:(i=T?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=T?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=T?.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=T?.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=T?.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=T?.signInWithEthereum)===null||u===void 0?void 0:u.resources};d=iw(q),g=await _.request({method:"personal_sign",params:[nw(d),ee]})}try{const{data:p,error:m}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:g},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Sr});if(m)throw m;if(!p||!p.session||!p.user){const w=new Bn;return this._returnResult({data:{user:null,session:null},error:w})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:m})}catch(p){if(Te(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(t){var r,n,i,s,a,o,l,c,u,f,h,d;let g,p;if("message"in t)g=t.message,p=t.signature;else{const{chain:m,wallet:w,statement:T,options:_}=t;let O;if(kt())if(typeof w=="object")O=w;else{const ee=window;if("solana"in ee&&typeof ee.solana=="object"&&("signIn"in ee.solana&&typeof ee.solana.signIn=="function"||"signMessage"in ee.solana&&typeof ee.solana.signMessage=="function"))O=ee.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=w}const V=new URL((r=_?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in O&&O.signIn){const ee=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_?.signInWithSolana),{version:"1",domain:V.host,uri:V.href}),T?{statement:T}:null));let I;if(Array.isArray(ee)&&ee[0]&&typeof ee[0]=="object")I=ee[0];else if(ee&&typeof ee=="object"&&"signedMessage"in ee&&"signature"in ee)I=ee;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)g=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),p=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${V.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${V.href}`,`Issued At: ${(i=(n=_?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=_?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_?.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((f=(u=_?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",..._.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const ee=await O.signMessage(new TextEncoder().encode(g),"utf8");if(!ee||!(ee instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=ee}}try{const{data:m,error:w}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:zn(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:Sr});if(w)throw w;if(!m||!m.session||!m.user){const T=new Bn;return this._returnResult({data:{user:null,session:null},error:T})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:w})}catch(m){if(Te(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(t){const r=await Ln(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Sr});if(await At(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const o=new Bn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Sr}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Bn;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(Te(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await ai(this.storage,this.storageKey));const{error:f}=await ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l?.data)!==null&&i!==void 0?i:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new is("You must provide either an email or phone number.")}catch(o){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await ke(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Sr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(Te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await ai(this.storage,this.storageKey));const c=await ke(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:Yx});return!((s=c.data)===null||s===void 0)&&s.url&&kt()&&!(!((a=t.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Yt;const{error:i}=await ke(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Te(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await ke(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await ke(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:o})}throw new is("You must provide either an email or phone number and a type")}catch(r){if(Te(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ln(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<tl:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await Ln(this.userStorage,this.storageKey+"-user");a?.user?t.user=a.user:t.user=nl()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=zx(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:En}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Yt}:await ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:En})})}catch(r){if(Te(r))return Od(r)&&(await this._removeSession(),await At(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Yt;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await ai(this.storage,this.storageKey));const{data:c,error:u}=await ke(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:En});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Yt;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=rl(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Te(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Yt;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Te(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!kt())throw new ss("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ss(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Wl("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ss("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Wl("No code detected.");const{data:T,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!a||!c)throw new ss("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let h=u+f;l&&(h=parseInt(l));const d=h-u;d*1e3<=pi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${f}s`);const g=h-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,u);const{data:p,error:m}=await this._getUser(s);if(m)throw m;const w={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:h,refresh_token:a,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(n){if(Te(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ln(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({error:s});const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(kd(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await At(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Fx(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await ai(this.storage,this.storageKey,!0));try{return await ke(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,u;const{data:f,error:h}=s;if(h)throw h;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ke(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return kt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:t.provider,url:n?.url},error:null})}catch(n){if(Te(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:a,provider:o,token:l,access_token:c,nonce:u}=t,f=await ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Sr}),{data:h,error:d}=f;return d?this._returnResult({data:{user:null,session:null},error:d}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Bn}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:d}))}catch(i){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await ke(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Lx(async i=>(i>0&&await Dx(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await ke(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Sr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Sa(s)&&Date.now()+a-n<pi})}catch(n){if(this._debug(r,"error",n),Te(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),kt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Ln(this.storage,this.storageKey);if(i&&this.userStorage){let a=await Ln(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await gi(this.userStorage,this.storageKey+"-user",a)),i.user=(t=a?.user)!==null&&t!==void 0?t:nl()}else if(i&&!i.user&&!i.user){const a=await Ln(this.storage,this.storageKey+"-user");a&&a?.user?(i.user=a.user,await At(this.storage,this.storageKey+"-user"),await gi(this.storage,this.storageKey,i)):i.user=nl()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<tl;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${tl}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),Sa(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&a?.user?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Yt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new bo;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Yt;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),Te(s)){const a={data:null,error:s};return Sa(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await At(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await gi(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=lf(i);await gi(this.storage,this.storageKey,s)}else{const i=lf(r);await gi(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await At(this.storage,this.storageKey),await At(this.storage,this.storageKey+"-code-verifier"),await At(this.storage,this.storageKey+"-user"),this.userStorage&&await At(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&kt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),pi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/pi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${pi}ms, refresh threshold is ${$l} ticks`),i<=$l&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Sc)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await ai(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n?.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await ke(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await ke(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&l.type==="totp"&&(!((i=l?.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?fw(t.webauthn.credential_response):hw(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await ke(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=await ke(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:cw(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:uw(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r?.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=rl(n.access_token);let a=null;s.aal&&(a=s.aal);let o=a;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const c=s.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await ke(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Yt})})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Yt});const a=await ke(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&kt()&&!r?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Yt});const a=await ke(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&kt()&&!r?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await ke(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Yt})})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await ke(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Yt})})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+Sx>i)return n;const{data:s,error:a}=await ke(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:d,error:g}=await this.getSession();if(g||!d.session)return this._returnResult({data:null,error:g});n=d.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=rl(n);r?.allowExpired||Wx(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:s,header:i,signature:a},error:null}}const u=Vx(i.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,Rx(`${o}.${l}`)))throw new $a("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}};bc.nextInstanceID={};const yw=Tc,Ew=bc,Tw=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:yw,AuthApiError:Ad,AuthClient:Ew,AuthError:Di,AuthImplicitGrantRedirectError:ss,AuthInvalidCredentialsError:is,AuthInvalidJwtError:$a,AuthInvalidTokenResponseError:Bn,AuthPKCEGrantCodeExchangeError:Wl,AuthRetryableFetchError:ja,AuthSessionMissingError:Yt,AuthUnknownError:yn,AuthWeakPasswordError:Vl,CustomAuthError:hn,GoTrueAdminApi:Tc,GoTrueClient:bc,NavigatorLockAcquireTimeoutError:Pd,SIGN_OUT_SCOPES:ba,isAuthApiError:kd,isAuthError:Te,isAuthImplicitGrantRedirectError:Cd,isAuthRetryableFetchError:Sa,isAuthSessionMissingError:Od,isAuthWeakPasswordError:bx,lockInternals:jn,navigatorLock:Nd,processLock:ew},Symbol.toStringTag,{value:"Module"})),Md=js(Tw);var mf;function Sw(){if(mf)return es;mf=1,Object.defineProperty(es,"__esModule",{value:!0}),es.SupabaseAuthClient=void 0;const e=Md;let t=class extends e.AuthClient{constructor(n){super(n)}};return es.SupabaseAuthClient=t,es}var vf;function _f(){if(vf)return ea;vf=1,Object.defineProperty(ea,"__esModule",{value:!0});const e=Yh,t=rd(),r=ud,n=gx,i=vx(),s=_x(),a=xx(),o=Sw();class l{constructor(u,f,h){var d,g,p;this.supabaseUrl=u,this.supabaseKey=f;const m=(0,a.validateSupabaseUrl)(u);if(!f)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const w=`sb-${m.hostname.split(".")[0]}-auth-token`,T={db:i.DEFAULT_DB_OPTIONS,realtime:i.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},i.DEFAULT_AUTH_OPTIONS),{storageKey:w}),global:i.DEFAULT_GLOBAL_OPTIONS},_=(0,a.applySettingDefaults)(h??{},T);this.storageKey=(d=_.auth.storageKey)!==null&&d!==void 0?d:"",this.headers=(g=_.global.headers)!==null&&g!==void 0?g:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(O,V)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(V)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((p=_.auth)!==null&&p!==void 0?p:{},this.headers,_.global.fetch),this.fetch=(0,s.fetchWithAuth)(f,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.accessToken&&this.accessToken().then(O=>this.realtime.setAuth(O)).catch(O=>console.warn("Failed to set initial Realtime auth token:",O)),this.rest=new t.PostgrestClient(new URL("rest/v1",m).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new n.StorageClient(this.storageUrl.href,this.headers,this.fetch,h?.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new e.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(u){return this.rest.from(u)}schema(u){return this.rest.schema(u)}rpc(u,f={},h={head:!1,get:!1,count:void 0}){return this.rest.rpc(u,f,h)}channel(u,f={config:{}}){return this.realtime.channel(u,f)}getChannels(){return this.realtime.getChannels()}removeChannel(u){return this.realtime.removeChannel(u)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var u,f;if(this.accessToken)return await this.accessToken();const{data:h}=await this.auth.getSession();return(f=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:u,persistSession:f,detectSessionInUrl:h,storage:d,userStorage:g,storageKey:p,flowType:m,lock:w,debug:T,throwOnError:_},O,V){const ee={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new o.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},ee),O),storageKey:p,autoRefreshToken:u,persistSession:f,detectSessionInUrl:h,storage:d,userStorage:g,flowType:m,lock:w,debug:T,throwOnError:_,fetch:V,hasCustomAuthorizationHeader:Object.keys(this.headers).some(I=>I.toLowerCase()==="authorization")})}_initRealtimeClient(u){return new r.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},u),{params:Object.assign({apikey:this.supabaseKey},u?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((f,h)=>{this._handleTokenChanged(f,"CLIENT",h?.access_token)})}_handleTokenChanged(u,f,h){(u==="TOKEN_REFRESHED"||u==="SIGNED_IN")&&this.changedAccessToken!==h?(this.changedAccessToken=h,this.realtime.setAuth(h)):u==="SIGNED_OUT"&&(this.realtime.setAuth(),f=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}return ea.default=l,ea}var xf;function bw(){return xf||(xf=1,(function(e){var t=Yr&&Yr.__createBinding||(Object.create?(function(u,f,h,d){d===void 0&&(d=h);var g=Object.getOwnPropertyDescriptor(f,h);(!g||("get"in g?!f.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return f[h]}}),Object.defineProperty(u,d,g)}):(function(u,f,h,d){d===void 0&&(d=h),u[d]=f[h]})),r=Yr&&Yr.__exportStar||function(u,f){for(var h in u)h!=="default"&&!Object.prototype.hasOwnProperty.call(f,h)&&t(f,u,h)},n=Yr&&Yr.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(e,"__esModule",{value:!0}),e.createClient=e.SupabaseClient=e.FunctionRegion=e.FunctionsError=e.FunctionsRelayError=e.FunctionsFetchError=e.FunctionsHttpError=e.PostgrestError=void 0;const i=n(_f());r(Md,e);var s=rd();Object.defineProperty(e,"PostgrestError",{enumerable:!0,get:function(){return s.PostgrestError}});var a=Yh;Object.defineProperty(e,"FunctionsHttpError",{enumerable:!0,get:function(){return a.FunctionsHttpError}}),Object.defineProperty(e,"FunctionsFetchError",{enumerable:!0,get:function(){return a.FunctionsFetchError}}),Object.defineProperty(e,"FunctionsRelayError",{enumerable:!0,get:function(){return a.FunctionsRelayError}}),Object.defineProperty(e,"FunctionsError",{enumerable:!0,get:function(){return a.FunctionsError}}),Object.defineProperty(e,"FunctionRegion",{enumerable:!0,get:function(){return a.FunctionRegion}}),r(ud,e);var o=_f();Object.defineProperty(e,"SupabaseClient",{enumerable:!0,get:function(){return n(o).default}});const l=(u,f,h)=>new i.default(u,f,h);e.createClient=l;function c(){if(typeof window<"u"||typeof process>"u")return!1;const u=process.version;if(u==null)return!1;const f=u.match(/^v(\d+)\./);return f?parseInt(f[1],10)<=18:!1}c()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")})(Yr)),Yr}var Bd=bw();const Ud=v_(Bd),Aw=N1({__proto__:null,default:Ud},[Bd]),{PostgrestError:e3,FunctionsHttpError:t3,FunctionsFetchError:r3,FunctionsRelayError:n3,FunctionsError:i3,FunctionRegion:s3,SupabaseClient:a3,createClient:kw,GoTrueAdminApi:o3,GoTrueClient:l3,AuthAdminApi:c3,AuthClient:u3,navigatorLock:f3,NavigatorLockAcquireTimeoutError:h3,lockInternals:d3,processLock:p3,SIGN_OUT_SCOPES:g3,AuthError:m3,AuthApiError:v3,AuthUnknownError:_3,CustomAuthError:x3,AuthSessionMissingError:w3,AuthInvalidTokenResponseError:y3,AuthInvalidCredentialsError:E3,AuthImplicitGrantRedirectError:T3,AuthPKCEGrantCodeExchangeError:S3,AuthRetryableFetchError:b3,AuthWeakPasswordError:A3,AuthInvalidJwtError:k3,isAuthError:O3,isAuthApiError:C3,isAuthSessionMissingError:R3,isAuthImplicitGrantRedirectError:I3,isAuthRetryableFetchError:F3,isAuthWeakPasswordError:P3,RealtimePresence:N3,RealtimeChannel:D3,RealtimeClient:L3,REALTIME_LISTEN_TYPES:M3,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:B3,REALTIME_PRESENCE_LISTEN_EVENTS:U3,REALTIME_SUBSCRIBE_STATES:j3,REALTIME_CHANNEL_STATES:$3}=Ud||Aw,Ow="https://ykmrystcfwjrrgkglyzr.supabase.co",Cw="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlrbXJ5c3RjZndqcnJna2dseXpyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ5MzQyODIsImV4cCI6MjA4MDUxMDI4Mn0.T4yy_DqaDxilkAW8NMRbYiXiEyQNWknr04TD0sDC_R8",lt=kw(Ow,Cw);var Ka={};Ka.version="0.18.5";var jd=1252,Rw=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$d=function(e){Rw.indexOf(e)!=-1&&(jd=e)};function Iw(){$d(1252)}var Cs=function(e){$d(e)};function Fw(){Cs(1200),Iw()}var ca=function(t){return String.fromCharCode(t)},wf=function(t){return String.fromCharCode(t)},za,Tn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Rs(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Tn.charAt(s)+Tn.charAt(a)+Tn.charAt(o)+Tn.charAt(l);return t}function cn(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Tn.indexOf(e.charAt(c++)),a=Tn.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=Tn.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Tn.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var je=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),dn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Yn(e){return je?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function yf(e){return je?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Cr=function(t){return je?dn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ao(e){if(typeof ArrayBuffer>"u")return Cr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ws(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Pw(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Rt=je?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:dn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Nw(e){for(var t=[],r=0,n=e.length+250,i=Yn(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Yn(65535),n=65530)}return t.push(i.slice(0,r)),Rt(t)}var gs=/\u0000/g,ua=/[\u0001-\u0006]/g;function Ai(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Rr(e,t){var r=""+e;return r.length>=t?r:ut("0",t-r.length)+r}function Ac(e,t){var r=""+e;return r.length>=t?r:ut(" ",t-r.length)+r}function Ga(e,t){var r=""+e;return r.length>=t?r:r+ut(" ",t-r.length)}function Dw(e,t){var r=""+Math.round(e);return r.length>=t?r:ut("0",t-r.length)+r}function Lw(e,t){var r=""+e;return r.length>=t?r:ut("0",t-r.length)+r}var Ef=Math.pow(2,32);function ci(e,t){if(e>Ef||e<-Ef)return Dw(e,t);var r=Math.round(e);return Lw(r,t)}function qa(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Tf=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],il=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Mw(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Sf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Bw={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xa(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*a+s,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function fa(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Kw(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Hd=new Date(1899,11,31,0,0,0),Uw=Hd.getTime(),jw=new Date(1900,2,1,0,0,0);function Wd(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=jw&&(r+=1440*60*1e3),(r-(Uw+(e.getTimezoneOffset()-Hd.getTimezoneOffset())*6e4))/(1440*60*1e3)}function kc(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $w(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Hw(e){var t=e<0?12:11,r=kc(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Ww(e){var t=kc(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Vw(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Hw(e):t===10?r=e.toFixed(10).substr(0,12):r=Ww(e),kc($w(r.toUpperCase()))}function zl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Vw(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return kn(14,Wd(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Kw(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function zw(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return il[r.m-1][1];case 5:return il[r.m-1][0];default:return il[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Tf[r.q][0];default:return Tf[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Rr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Rr(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Rr(l,c):"";return u}function Sn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Vd=/%/g;function Gw(e,t,r){var n=t.replace(Vd,""),i=t.length-n.length;return rn(e,n,r*Math.pow(10,2*i))+ut("%",i)}function qw(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Kd(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Kd(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var zd=/# (\?+)( ?)\/( ?)(\d+)/;function Xw(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?ut(" ",e[1].length+1+e[4].length):Ac(a,e[1].length)+e[2]+"/"+e[3]+Rr(o,e[4].length))}function Yw(e,t,r){return r+(t===0?"":""+t)+ut(" ",e[1].length+2+e[4].length)}var Gd=/^#*0*\.([0#]+)/,qd=/\).*[0#]/,Xd=/\(###\) ###\\?-####/;function zt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function bf(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Af(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Jw(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Qw(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function mr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(qd)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mr("n",n,r):"("+mr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return qw(e,t,r);if(t.indexOf("%")!==-1)return Gw(e,t,r);if(t.indexOf("E")!==-1)return Kd(t,r);if(t.charCodeAt(0)===36)return"$"+mr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ci(l,t.length);if(t.match(/^[#?]+$/))return i=ci(r,0),i==="0"&&(i=""),i.length>t.length?i:zt(t.substr(0,t.length-i.length))+i;if(s=t.match(zd))return Xw(s,l,c);if(t.match(/^#+0+$/))return c+ci(l,t.length-t.indexOf("0"));if(s=t.match(Gd))return i=bf(r,s[1].length).replace(/^([^\.]+)$/,"$1."+zt(s[1])).replace(/\.$/,"."+zt(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+ut("0",zt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+bf(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Sn(ci(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mr(e,t,-r):Sn(""+(Math.floor(r)+Jw(r,s[1].length)))+"."+Rr(Af(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return mr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ai(mr(e,t.replace(/[\\-]/g,""),r)),a=0,Ai(Ai(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(Xd))return i=mr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Xa(l,Math.pow(10,a)-1,!1),i=""+c,u=rn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Ga(o[2],a),u.length<s[4].length&&(u=zt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Xa(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ac(o[1],a)+s[2]+"/"+s[3]+Ga(o[2],a):ut(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=ci(r,0),t.length<=i.length?i:zt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return zt(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=Af(r,s[1].length),r<0?"-"+mr(e,t,-r):Sn(Qw(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Rr(0,3-g.length):"")+g})+"."+Rr(a,s[1].length);switch(t){case"###,##0.00":return mr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Sn(ci(l,0));return d!=="0"?c+d:"";case"###,###.00":return mr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return mr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Zw(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ey(e,t,r){var n=t.replace(Vd,""),i=t.length-n.length;return rn(e,n,r*Math.pow(10,2*i))+ut("%",i)}function Yd(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Yd(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Mr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(qd)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Mr("n",n,r):"("+Mr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Zw(e,t,r);if(t.indexOf("%")!==-1)return ey(e,t,r);if(t.indexOf("E")!==-1)return Yd(t,r);if(t.charCodeAt(0)===36)return"$"+Mr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Rr(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:zt(t.substr(0,t.length-i.length))+i;if(s=t.match(zd))return Yw(s,l,c);if(t.match(/^#+0+$/))return c+Rr(l,t.length-t.indexOf("0"));if(s=t.match(Gd))return i=(""+r).replace(/^([^\.]+)$/,"$1."+zt(s[1])).replace(/\.$/,"."+zt(s[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+ut("0",zt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Sn(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Mr(e,t,-r):Sn(""+r)+"."+ut("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Mr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ai(Mr(e,t.replace(/[\\-]/g,""),r)),a=0,Ai(Ai(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(Xd))return i=Mr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Xa(l,Math.pow(10,a)-1,!1),i=""+c,u=rn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Ga(o[2],a),u.length<s[4].length&&(u=zt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Xa(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ac(o[1],a)+s[2]+"/"+s[3]+Ga(o[2],a):ut(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:zt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return zt(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Mr(e,t,-r):Sn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Rr(0,3-g.length):"")+g})+"."+Rr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Sn(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return Mr(e,t.slice(0,t.lastIndexOf(".")),r)+zt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rn(e,t,r){return(r|0)===r?Mr(e,t,r):mr(e,t,r)}function ty(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Jd=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qd(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":qa(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Jd))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function ry(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,f,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!qa(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=e.charAt(++a),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=fa(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=fa(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var p={t:o,v:o};if(c==null&&(c=fa(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(p.v=c.H>=12?"":""),p.t="T",a+=5,h="h"):(p.t="t",++a),c==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Jd)){if(c==null&&(c=fa(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qd(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var m=0,w=0,T;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",m<1&&(m=1);break;case"s":(T=i[a].v.match(/\.0+$/))&&(w=Math.max(w,T[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[a].v.match(/[Hh]/)&&(m=1),m<2&&i[a].v.match(/[Mm]/)&&(m=2),m<3&&i[a].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",O;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=zw(i[a].t.charCodeAt(0),i[a].v,c,w),i[a].t="t";break;case"n":case"?":for(O=a+1;i[O]!=null&&((o=i[O].t)==="?"||o==="D"||(o===" "||o==="t")&&i[O+1]!=null&&(i[O+1].t==="?"||i[O+1].t==="t"&&i[O+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[O].v==="/"||i[O].v===" "&&i[O+1]!=null&&i[O+1].t=="?"));)i[a].v+=i[O].v,i[O]={v:"",t:";"},++O;_+=i[a].v,a=O-1;break;case"G":i[a].t="t",i[a].v=zl(t,r);break}var V="",ee,I;if(_.length>0){_.charCodeAt(0)==40?(ee=t<0&&_.charCodeAt(0)===45?-t:t,I=rn("n",_,ee)):(ee=t<0&&n>1?-t:t,I=rn("n",_,ee),ee<0&&i[0]&&i[0].t=="t"&&(I=I.substr(1),i[0].v="-"+i[0].v)),O=I.length-1;var q=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){q=a;break}var M=i.length;if(q===i.length&&I.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(O>=i[a].v.length-1?(O-=i[a].v.length,i[a].v=I.substr(O+1,i[a].v.length)):O<0?i[a].v="":(i[a].v=I.substr(0,O+1),O=-1),i[a].t="t",M=a);O>=0&&M<i.length&&(i[M].v=I.substr(0,O+1)+i[M].v)}else if(q!==i.length&&I.indexOf("E")===-1){for(O=I.indexOf(".")-1,a=q;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===q?i[a].v.indexOf(".")-1:i[a].v.length-1,V=i[a].v.substr(u+1);u>=0;--u)O>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(V=I.charAt(O--)+V);i[a].v=V,i[a].t="t",M=a}for(O>=0&&M<i.length&&(i[M].v=I.substr(0,O+1)+i[M].v),O=I.indexOf(".")+1,a=q;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==q)){for(u=i[a].v.indexOf(".")>-1&&a===q?i[a].v.indexOf(".")+1:0,V=i[a].v.substr(0,u);u<i[a].v.length;++u)O<I.length&&(V+=I.charAt(O++));i[a].v=V,i[a].t="t",M=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(ee=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=rn(i[a].t,i[a].v,ee),i[a].t="t");var te="";for(a=0;a!==i.length;++a)i[a]!=null&&(te+=i[a].v);return te}var kf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Of(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function ny(e,t){var r=ty(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(kf),o=r[1].match(kf);return Of(t,a)?[n,r[0]]:Of(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function kn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ft)[e],n==null&&(n=r.table&&r.table[Sf[e]]||ft[Sf[e]]),n==null&&(n=Bw[e]||"General");break}if(qa(n,0))return zl(t,r);t instanceof Date&&(t=Wd(t,r.date1904));var i=ny(n,t);if(qa(i[1]))return zl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return ry(i[1],t,r,i[0])}function Zd(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ft[r]==null){t<0&&(t=r);continue}if(ft[r]==e){t=r;break}}t<0&&(t=391)}return ft[t]=e,t}function ko(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Zd(e[t],t)}function Oo(){ft=Mw()}var ep=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iy(e){var t=typeof e=="number"?ft[e]:e;return t=t.replace(ep,"(\\d+)"),new RegExp("^"+t+"$")}function sy(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(ep)||[]).forEach(function(f,h){var d=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var ay=(function(){var e={};e.version="1.2.0";function t(){for(var I=0,q=new Array(256),M=0;M!=256;++M)I=M,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,q[M]=I;return typeof Int32Array<"u"?new Int32Array(q):q}var r=t();function n(I){var q=0,M=0,te=0,ne=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)ne[te]=I[te];for(te=0;te!=256;++te)for(M=I[te],q=256+te;q<4096;q+=256)M=ne[q]=M>>>8^I[M&255];var se=[];for(te=1;te!=16;++te)se[te-1]=typeof Int32Array<"u"?ne.subarray(te*256,te*256+256):ne.slice(te*256,te*256+256);return se}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],d=i[8],g=i[9],p=i[10],m=i[11],w=i[12],T=i[13],_=i[14];function O(I,q){for(var M=q^-1,te=0,ne=I.length;te<ne;)M=M>>>8^r[(M^I.charCodeAt(te++))&255];return~M}function V(I,q){for(var M=q^-1,te=I.length-15,ne=0;ne<te;)M=_[I[ne++]^M&255]^T[I[ne++]^M>>8&255]^w[I[ne++]^M>>16&255]^m[I[ne++]^M>>>24]^p[I[ne++]]^g[I[ne++]]^d[I[ne++]]^h[I[ne++]]^f[I[ne++]]^u[I[ne++]]^c[I[ne++]]^l[I[ne++]]^o[I[ne++]]^a[I[ne++]]^s[I[ne++]]^r[I[ne++]];for(te+=15;ne<te;)M=M>>>8^r[(M^I[ne++])&255];return~M}function ee(I,q){for(var M=q^-1,te=0,ne=I.length,se=0,de=0;te<ne;)se=I.charCodeAt(te++),se<128?M=M>>>8^r[(M^se)&255]:se<2048?(M=M>>>8^r[(M^(192|se>>6&31))&255],M=M>>>8^r[(M^(128|se&63))&255]):se>=55296&&se<57344?(se=(se&1023)+64,de=I.charCodeAt(te++)&1023,M=M>>>8^r[(M^(240|se>>8&7))&255],M=M>>>8^r[(M^(128|se>>2&63))&255],M=M>>>8^r[(M^(128|de>>6&15|(se&3)<<4))&255],M=M>>>8^r[(M^(128|de&63))&255]):(M=M>>>8^r[(M^(224|se>>12&15))&255],M=M>>>8^r[(M^(128|se>>6&63))&255],M=M>>>8^r[(M^(128|se&63))&255]);return~M}return e.table=r,e.bstr=O,e.buf=V,e.str=ee,e})(),Ye=(function(){var t={};t.version="1.2.1";function r(v,S){for(var x=v.split("/"),y=S.split("/"),b=0,A=0,U=Math.min(x.length,y.length);b<U;++b){if(A=x[b].length-y[b].length)return A;if(x[b]!=y[b])return x[b]<y[b]?-1:1}return x.length-y.length}function n(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:n(v.slice(0,-1));var S=v.lastIndexOf("/");return S===-1?v:v.slice(0,S+1)}function i(v){if(v.charAt(v.length-1)=="/")return i(v.slice(0,-1));var S=v.lastIndexOf("/");return S===-1?v:v.slice(S+1)}function s(v,S){typeof S=="string"&&(S=new Date(S));var x=S.getHours();x=x<<6|S.getMinutes(),x=x<<5|S.getSeconds()>>>1,v.write_shift(2,x);var y=S.getFullYear()-1980;y=y<<4|S.getMonth()+1,y=y<<5|S.getDate(),v.write_shift(2,y)}function a(v){var S=v.read_shift(2)&65535,x=v.read_shift(2)&65535,y=new Date,b=x&31;x>>>=5;var A=x&15;x>>>=4,y.setMilliseconds(0),y.setFullYear(x+1980),y.setMonth(A-1),y.setDate(b);var U=S&31;S>>>=5;var J=S&63;return S>>>=6,y.setHours(S),y.setMinutes(J),y.setSeconds(U<<1),y}function o(v){or(v,0);for(var S={},x=0;v.l<=v.length-4;){var y=v.read_shift(2),b=v.read_shift(2),A=v.l+b,U={};switch(y){case 21589:x=v.read_shift(1),x&1&&(U.mtime=v.read_shift(4)),b>5&&(x&2&&(U.atime=v.read_shift(4)),x&4&&(U.ctime=v.read_shift(4))),U.mtime&&(U.mt=new Date(U.mtime*1e3));break}v.l=A,S[y]=U}return S}var l;function c(){return l||(l={})}function u(v,S){if(v[0]==80&&v[1]==75)return qc(v,S);if((v[0]|32)==109&&(v[1]|32)==105)return O1(v,S);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var x=3,y=512,b=0,A=0,U=0,J=0,B=0,j=[],W=v.slice(0,512);or(W,0);var ae=f(W);switch(x=ae[0],x){case 3:y=512;break;case 4:y=4096;break;case 0:if(ae[1]==0)return qc(v,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+x)}y!==512&&(W=v.slice(0,y),or(W,28));var pe=v.slice(0,y);h(W,x);var xe=W.read_shift(4,"i");if(x===3&&xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xe);W.l+=4,U=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),J=W.read_shift(4,"i"),b=W.read_shift(4,"i"),B=W.read_shift(4,"i"),A=W.read_shift(4,"i");for(var ce=-1,ve=0;ve<109&&(ce=W.read_shift(4,"i"),!(ce<0));++ve)j[ve]=ce;var Ie=d(v,y);m(B,A,Ie,y,j);var at=T(Ie,U,j,y);at[U].name="!Directory",b>0&&J!==de&&(at[J].name="!MiniFAT"),at[j[0]].name="!FAT",at.fat_addrs=j,at.ssz=y;var ot={},Lt=[],zi=[],Gi=[];_(U,at,Ie,Lt,b,ot,zi,J),g(zi,Gi,Lt),Lt.shift();var qi={FileIndex:zi,FullPaths:Gi};return S&&S.raw&&(qi.raw={header:pe,sectors:Ie}),qi}function f(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(Be,"Header Signature: "),v.l+=16;var S=v.read_shift(2,"u");return[v.read_shift(2,"u"),S]}function h(v,S){var x=9;switch(v.l+=2,x=v.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+x);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+x);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+x)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function d(v,S){for(var x=Math.ceil(v.length/S)-1,y=[],b=1;b<x;++b)y[b-1]=v.slice(b*S,(b+1)*S);return y[x-1]=v.slice(x*S),y}function g(v,S,x){for(var y=0,b=0,A=0,U=0,J=0,B=x.length,j=[],W=[];y<B;++y)j[y]=W[y]=y,S[y]=x[y];for(;J<W.length;++J)y=W[J],b=v[y].L,A=v[y].R,U=v[y].C,j[y]===y&&(b!==-1&&j[b]!==b&&(j[y]=j[b]),A!==-1&&j[A]!==A&&(j[y]=j[A])),U!==-1&&(j[U]=y),b!==-1&&y!=j[y]&&(j[b]=j[y],W.lastIndexOf(b)<J&&W.push(b)),A!==-1&&y!=j[y]&&(j[A]=j[y],W.lastIndexOf(A)<J&&W.push(A));for(y=1;y<B;++y)j[y]===y&&(A!==-1&&j[A]!==A?j[y]=j[A]:b!==-1&&j[b]!==b&&(j[y]=j[b]));for(y=1;y<B;++y)if(v[y].type!==0){if(J=y,J!=j[J])do J=j[J],S[y]=S[J]+"/"+S[y];while(J!==0&&j[J]!==-1&&J!=j[J]);j[y]=-1}for(S[0]+="/",y=1;y<B;++y)v[y].type!==2&&(S[y]+="/")}function p(v,S,x){for(var y=v.start,b=v.size,A=[],U=y;x&&b>0&&U>=0;)A.push(S.slice(U*se,U*se+se)),b-=se,U=Vn(x,U*4);return A.length===0?G(0):Rt(A).slice(0,v.size)}function m(v,S,x,y,b){var A=de;if(v===de){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var U=x[v],J=(y>>>2)-1;if(!U)return;for(var B=0;B<J&&(A=Vn(U,B*4))!==de;++B)b.push(A);m(Vn(U,y-4),S-1,x,y,b)}}function w(v,S,x,y,b){var A=[],U=[];b||(b=[]);var J=y-1,B=0,j=0;for(B=S;B>=0;){b[B]=!0,A[A.length]=B,U.push(v[B]);var W=x[Math.floor(B*4/y)];if(j=B*4&J,y<4+j)throw new Error("FAT boundary crossed: "+B+" 4 "+y);if(!v[W])break;B=Vn(v[W],j)}return{nodes:A,data:Lf([U])}}function T(v,S,x,y){var b=v.length,A=[],U=[],J=[],B=[],j=y-1,W=0,ae=0,pe=0,xe=0;for(W=0;W<b;++W)if(J=[],pe=W+S,pe>=b&&(pe-=b),!U[pe]){B=[];var ce=[];for(ae=pe;ae>=0;){ce[ae]=!0,U[ae]=!0,J[J.length]=ae,B.push(v[ae]);var ve=x[Math.floor(ae*4/y)];if(xe=ae*4&j,y<4+xe)throw new Error("FAT boundary crossed: "+ae+" 4 "+y);if(!v[ve]||(ae=Vn(v[ve],xe),ce[ae]))break}A[pe]={nodes:J,data:Lf([B])}}return A}function _(v,S,x,y,b,A,U,J){for(var B=0,j=y.length?2:0,W=S[v].data,ae=0,pe=0,xe;ae<W.length;ae+=128){var ce=W.slice(ae,ae+128);or(ce,64),pe=ce.read_shift(2),xe=Fc(ce,0,pe-j),y.push(xe);var ve={name:xe,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0},Ie=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);Ie!==0&&(ve.ct=O(ce,ce.l-8));var at=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);at!==0&&(ve.mt=O(ce,ce.l-8)),ve.start=ce.read_shift(4,"i"),ve.size=ce.read_shift(4,"i"),ve.size<0&&ve.start<0&&(ve.size=ve.type=0,ve.start=de,ve.name=""),ve.type===5?(B=ve.start,b>0&&B!==de&&(S[B].name="!StreamData")):ve.size>=4096?(ve.storage="fat",S[ve.start]===void 0&&(S[ve.start]=w(x,ve.start,S.fat_addrs,S.ssz)),S[ve.start].name=ve.name,ve.content=S[ve.start].data.slice(0,ve.size)):(ve.storage="minifat",ve.size<0?ve.size=0:B!==de&&ve.start!==de&&S[B]&&(ve.content=p(ve,S[B].data,(S[J]||{}).data))),ve.content&&or(ve.content,0),A[xe]=ve,U.push(ve)}}function O(v,S){return new Date((ur(v,S+4)/1e7*Math.pow(2,32)+ur(v,S)/1e7-11644473600)*1e3)}function V(v,S){return c(),u(l.readFileSync(v),S)}function ee(v,S){var x=S&&S.type;switch(x||je&&Buffer.isBuffer(v)&&(x="buffer"),x||"base64"){case"file":return V(v,S);case"base64":return u(Cr(cn(v)),S);case"binary":return u(Cr(v),S)}return u(v,S)}function I(v,S){var x=S||{},y=x.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=y+"/",v.FileIndex[0]={name:y,type:5}),x.CLSID&&(v.FileIndex[0].clsid=x.CLSID),q(v)}function q(v){var S="Sh33tJ5";if(!Ye.find(v,"/"+S)){var x=G(4);x[0]=55,x[1]=x[3]=50,x[2]=54,v.FileIndex.push({name:S,type:2,content:x,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+S),M(v)}}function M(v,S){I(v);for(var x=!1,y=!1,b=v.FullPaths.length-1;b>=0;--b){var A=v.FileIndex[b];switch(A.type){case 0:y?x=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:y=!0,isNaN(A.R*A.L*A.C)&&(x=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(x=!0);break;default:x=!0;break}}if(!(!x&&!S)){var U=new Date(1987,1,19),J=0,B=Object.create?Object.create(null):{},j=[];for(b=0;b<v.FullPaths.length;++b)B[v.FullPaths[b]]=!0,v.FileIndex[b].type!==0&&j.push([v.FullPaths[b],v.FileIndex[b]]);for(b=0;b<j.length;++b){var W=n(j[b][0]);y=B[W],y||(j.push([W,{name:i(W).replace("/",""),type:1,clsid:Me,ct:U,mt:U,content:null}]),B[W]=!0)}for(j.sort(function(xe,ce){return r(xe[0],ce[0])}),v.FullPaths=[],v.FileIndex=[],b=0;b<j.length;++b)v.FullPaths[b]=j[b][0],v.FileIndex[b]=j[b][1];for(b=0;b<j.length;++b){var ae=v.FileIndex[b],pe=v.FullPaths[b];if(ae.name=i(pe).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||Me,b===0)ae.C=j.length>1?1:-1,ae.size=0,ae.type=5;else if(pe.slice(-1)=="/"){for(J=b+1;J<j.length&&n(v.FullPaths[J])!=pe;++J);for(ae.C=J>=j.length?-1:J,J=b+1;J<j.length&&n(v.FullPaths[J])!=n(pe);++J);ae.R=J>=j.length?-1:J,ae.type=1}else n(v.FullPaths[b+1]||"")==n(pe)&&(ae.R=b+1),ae.type=2}}}function te(v,S){var x=S||{};if(x.fileType=="mad")return C1(v,x);switch(M(v),x.fileType){case"zip":return E1(v,x)}var y=(function(xe){for(var ce=0,ve=0,Ie=0;Ie<xe.FileIndex.length;++Ie){var at=xe.FileIndex[Ie];if(at.content){var ot=at.content.length;ot>0&&(ot<4096?ce+=ot+63>>6:ve+=ot+511>>9)}}for(var Lt=xe.FullPaths.length+3>>2,zi=ce+7>>3,Gi=ce+127>>7,qi=zi+ve+Lt+Gi,Fn=qi+127>>7,Do=Fn<=109?0:Math.ceil((Fn-109)/127);qi+Fn+Do+127>>7>Fn;)Do=++Fn<=109?0:Math.ceil((Fn-109)/127);var zr=[1,Do,Fn,Gi,Lt,ve,ce,0];return xe.FileIndex[0].size=ce<<6,zr[7]=(xe.FileIndex[0].start=zr[0]+zr[1]+zr[2]+zr[3]+zr[4]+zr[5])+(zr[6]+7>>3),zr})(v),b=G(y[7]<<9),A=0,U=0;{for(A=0;A<8;++A)b.write_shift(1,Oe[A]);for(A=0;A<8;++A)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),A=0;A<3;++A)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,y[2]),b.write_shift(4,y[0]+y[1]+y[2]+y[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,y[3]?y[0]+y[1]+y[2]-1:de),b.write_shift(4,y[3]),b.write_shift(-4,y[1]?y[0]-1:de),b.write_shift(4,y[1]),A=0;A<109;++A)b.write_shift(-4,A<y[2]?y[1]+A:-1)}if(y[1])for(U=0;U<y[1];++U){for(;A<236+U*127;++A)b.write_shift(-4,A<y[2]?y[1]+A:-1);b.write_shift(-4,U===y[1]-1?de:U+1)}var J=function(xe){for(U+=xe;A<U-1;++A)b.write_shift(-4,A+1);xe&&(++A,b.write_shift(-4,de))};for(U=A=0,U+=y[1];A<U;++A)b.write_shift(-4,be.DIFSECT);for(U+=y[2];A<U;++A)b.write_shift(-4,be.FATSECT);J(y[3]),J(y[4]);for(var B=0,j=0,W=v.FileIndex[0];B<v.FileIndex.length;++B)W=v.FileIndex[B],W.content&&(j=W.content.length,!(j<4096)&&(W.start=U,J(j+511>>9)));for(J(y[6]+7>>3);b.l&511;)b.write_shift(-4,be.ENDOFCHAIN);for(U=A=0,B=0;B<v.FileIndex.length;++B)W=v.FileIndex[B],W.content&&(j=W.content.length,!(!j||j>=4096)&&(W.start=U,J(j+63>>6)));for(;b.l&511;)b.write_shift(-4,be.ENDOFCHAIN);for(A=0;A<y[4]<<2;++A){var ae=v.FullPaths[A];if(!ae||ae.length===0){for(B=0;B<17;++B)b.write_shift(4,0);for(B=0;B<3;++B)b.write_shift(4,-1);for(B=0;B<12;++B)b.write_shift(4,0);continue}W=v.FileIndex[A],A===0&&(W.start=W.size?W.start-1:de);var pe=A===0&&x.root||W.name;if(j=2*(pe.length+1),b.write_shift(64,pe,"utf16le"),b.write_shift(2,j),b.write_shift(1,W.type),b.write_shift(1,W.color),b.write_shift(-4,W.L),b.write_shift(-4,W.R),b.write_shift(-4,W.C),W.clsid)b.write_shift(16,W.clsid,"hex");else for(B=0;B<4;++B)b.write_shift(4,0);b.write_shift(4,W.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,W.start),b.write_shift(4,W.size),b.write_shift(4,0)}for(A=1;A<v.FileIndex.length;++A)if(W=v.FileIndex[A],W.size>=4096)if(b.l=W.start+1<<9,je&&Buffer.isBuffer(W.content))W.content.copy(b,b.l,0,W.size),b.l+=W.size+511&-512;else{for(B=0;B<W.size;++B)b.write_shift(1,W.content[B]);for(;B&511;++B)b.write_shift(1,0)}for(A=1;A<v.FileIndex.length;++A)if(W=v.FileIndex[A],W.size>0&&W.size<4096)if(je&&Buffer.isBuffer(W.content))W.content.copy(b,b.l,0,W.size),b.l+=W.size+63&-64;else{for(B=0;B<W.size;++B)b.write_shift(1,W.content[B]);for(;B&63;++B)b.write_shift(1,0)}if(je)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function ne(v,S){var x=v.FullPaths.map(function(B){return B.toUpperCase()}),y=x.map(function(B){var j=B.split("/");return j[j.length-(B.slice(-1)=="/"?2:1)]}),b=!1;S.charCodeAt(0)===47?(b=!0,S=x[0].slice(0,-1)+S):b=S.indexOf("/")!==-1;var A=S.toUpperCase(),U=b===!0?x.indexOf(A):y.indexOf(A);if(U!==-1)return v.FileIndex[U];var J=!A.match(ua);for(A=A.replace(gs,""),J&&(A=A.replace(ua,"!")),U=0;U<x.length;++U)if((J?x[U].replace(ua,"!"):x[U]).replace(gs,"")==A||(J?y[U].replace(ua,"!"):y[U]).replace(gs,"")==A)return v.FileIndex[U];return null}var se=64,de=-2,Be="d0cf11e0a1b11ae1",Oe=[208,207,17,224,161,177,26,225],Me="00000000000000000000000000000000",be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:de,FREESECT:-1,HEADER_SIGNATURE:Be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Pe(v,S,x){c();var y=te(v,x);l.writeFileSync(S,y)}function Xe(v){for(var S=new Array(v.length),x=0;x<v.length;++x)S[x]=String.fromCharCode(v[x]);return S.join("")}function ht(v,S){var x=te(v,S);switch(S&&S.type||"buffer"){case"file":return c(),l.writeFileSync(S.filename,x),x;case"binary":return typeof x=="string"?x:Xe(x);case"base64":return Rs(typeof x=="string"?x:Xe(x));case"buffer":if(je)return Buffer.isBuffer(x)?x:dn(x);case"array":return typeof x=="string"?Cr(x):x}return x}var it;function R(v){try{var S=v.InflateRaw,x=new S;if(x._processChunk(new Uint8Array([3,0]),x._finishFlushFlag),x.bytesRead)it=v;else throw new Error("zlib does not expose bytesRead")}catch(y){console.error("cannot use native zlib: "+(y.message||y))}}function H(v,S){if(!it)return Ki(v,S);var x=it.InflateRaw,y=new x,b=y._processChunk(v.slice(v.l),y._finishFlushFlag);return v.l+=y.bytesRead,b}function N(v){return it?it.deflateRawSync(v):bt(v)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(v){var S=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(S>>16|S>>8|S)&255}for(var K=typeof Uint8Array<"u",X=K?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)X[Ee]=Q(Ee);function E(v,S){var x=X[v&255];return S<=8?x>>>8-S:(x=x<<8|X[v>>8&255],S<=16?x>>>16-S:(x=x<<8|X[v>>16&255],x>>>24-S))}function C(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=6?0:v[y+1]<<8))>>>x&3}function F(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=5?0:v[y+1]<<8))>>>x&7}function Y(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=4?0:v[y+1]<<8))>>>x&15}function z(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=3?0:v[y+1]<<8))>>>x&31}function D(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=1?0:v[y+1]<<8))>>>x&127}function ue(v,S,x){var y=S&7,b=S>>>3,A=(1<<x)-1,U=v[b]>>>y;return x<8-y||(U|=v[b+1]<<8-y,x<16-y)||(U|=v[b+2]<<16-y,x<24-y)||(U|=v[b+3]<<24-y),U&A}function le(v,S,x){var y=S&7,b=S>>>3;return y<=5?v[b]|=(x&7)<<y:(v[b]|=x<<y&255,v[b+1]=(x&7)>>8-y),S+3}function oe(v,S,x){var y=S&7,b=S>>>3;return x=(x&1)<<y,v[b]|=x,S+1}function ie(v,S,x){var y=S&7,b=S>>>3;return x<<=y,v[b]|=x&255,x>>>=8,v[b+1]=x,S+8}function Se(v,S,x){var y=S&7,b=S>>>3;return x<<=y,v[b]|=x&255,x>>>=8,v[b+1]=x&255,v[b+2]=x>>>8,S+16}function ge(v,S){var x=v.length,y=2*x>S?2*x:S+5,b=0;if(x>=S)return v;if(je){var A=yf(y);if(v.copy)v.copy(A);else for(;b<v.length;++b)A[b]=v[b];return A}else if(K){var U=new Uint8Array(y);if(U.set)U.set(v);else for(;b<x;++b)U[b]=v[b];return U}return v.length=y,v}function ye(v){for(var S=new Array(v),x=0;x<v;++x)S[x]=0;return S}function Ae(v,S,x){var y=1,b=0,A=0,U=0,J=0,B=v.length,j=K?new Uint16Array(32):ye(32);for(A=0;A<32;++A)j[A]=0;for(A=B;A<x;++A)v[A]=0;B=v.length;var W=K?new Uint16Array(B):ye(B);for(A=0;A<B;++A)j[b=v[A]]++,y<b&&(y=b),W[A]=0;for(j[0]=0,A=1;A<=y;++A)j[A+16]=J=J+j[A-1]<<1;for(A=0;A<B;++A)J=v[A],J!=0&&(W[A]=j[J+16]++);var ae=0;for(A=0;A<B;++A)if(ae=v[A],ae!=0)for(J=E(W[A],y)>>y-ae,U=(1<<y+4-ae)-1;U>=0;--U)S[J|U<<ae]=ae&15|A<<4;return y}var De=K?new Uint16Array(512):ye(512),$e=K?new Uint16Array(32):ye(32);if(!K){for(var Le=0;Le<512;++Le)De[Le]=0;for(Le=0;Le<32;++Le)$e[Le]=0}(function(){for(var v=[],S=0;S<32;S++)v.push(5);Ae(v,$e,32);var x=[];for(S=0;S<=143;S++)x.push(8);for(;S<=255;S++)x.push(9);for(;S<=279;S++)x.push(7);for(;S<=287;S++)x.push(8);Ae(x,De,288)})();var Nt=(function(){for(var S=K?new Uint8Array(32768):[],x=0,y=0;x<L.length-1;++x)for(;y<L[x+1];++y)S[y]=x;for(;y<32768;++y)S[y]=29;var b=K?new Uint8Array(259):[];for(x=0,y=0;x<Z.length-1;++x)for(;y<Z[x+1];++y)b[y]=x;function A(J,B){for(var j=0;j<J.length;){var W=Math.min(65535,J.length-j),ae=j+W==J.length;for(B.write_shift(1,+ae),B.write_shift(2,W),B.write_shift(2,~W&65535);W-- >0;)B[B.l++]=J[j++]}return B.l}function U(J,B){for(var j=0,W=0,ae=K?new Uint16Array(32768):[];W<J.length;){var pe=Math.min(65535,J.length-W);if(pe<10){for(j=le(B,j,+(W+pe==J.length)),j&7&&(j+=8-(j&7)),B.l=j/8|0,B.write_shift(2,pe),B.write_shift(2,~pe&65535);pe-- >0;)B[B.l++]=J[W++];j=B.l*8;continue}j=le(B,j,+(W+pe==J.length)+2);for(var xe=0;pe-- >0;){var ce=J[W];xe=(xe<<5^ce)&32767;var ve=-1,Ie=0;if((ve=ae[xe])&&(ve|=W&-32768,ve>W&&(ve-=32768),ve<W))for(;J[ve+Ie]==J[W+Ie]&&Ie<250;)++Ie;if(Ie>2){ce=b[Ie],ce<=22?j=ie(B,j,X[ce+1]>>1)-1:(ie(B,j,3),j+=5,ie(B,j,X[ce-23]>>5),j+=3);var at=ce<8?0:ce-4>>2;at>0&&(Se(B,j,Ie-Z[ce]),j+=at),ce=S[W-ve],j=ie(B,j,X[ce]>>3),j-=3;var ot=ce<4?0:ce-2>>1;ot>0&&(Se(B,j,W-ve-L[ce]),j+=ot);for(var Lt=0;Lt<Ie;++Lt)ae[xe]=W&32767,xe=(xe<<5^J[W])&32767,++W;pe-=Ie-1}else ce<=143?ce=ce+48:j=oe(B,j,1),j=ie(B,j,X[ce]),ae[xe]=W&32767,++W}j=ie(B,j,0)-1}return B.l=(j+7)/8|0,B.l}return function(B,j){return B.length<8?A(B,j):U(B,j)}})();function bt(v){var S=G(50+Math.floor(v.length*1.1)),x=Nt(v,S);return S.slice(0,x)}var nr=K?new Uint16Array(32768):ye(32768),ir=K?new Uint16Array(32768):ye(32768),pn=K?new Uint16Array(128):ye(128),Vi=1,Dt=1;function gr(v,S){var x=z(v,S)+257;S+=5;var y=z(v,S)+1;S+=5;var b=Y(v,S)+4;S+=4;for(var A=0,U=K?new Uint8Array(19):ye(19),J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,j=K?new Uint8Array(8):ye(8),W=K?new Uint8Array(8):ye(8),ae=U.length,pe=0;pe<b;++pe)U[P[pe]]=A=F(v,S),B<A&&(B=A),j[A]++,S+=3;var xe=0;for(j[0]=0,pe=1;pe<=B;++pe)W[pe]=xe=xe+j[pe-1]<<1;for(pe=0;pe<ae;++pe)(xe=U[pe])!=0&&(J[pe]=W[xe]++);var ce=0;for(pe=0;pe<ae;++pe)if(ce=U[pe],ce!=0){xe=X[J[pe]]>>8-ce;for(var ve=(1<<7-ce)-1;ve>=0;--ve)pn[xe|ve<<ce]=ce&7|pe<<3}var Ie=[];for(B=1;Ie.length<x+y;)switch(xe=pn[D(v,S)],S+=xe&7,xe>>>=3){case 16:for(A=3+C(v,S),S+=2,xe=Ie[Ie.length-1];A-- >0;)Ie.push(xe);break;case 17:for(A=3+F(v,S),S+=3;A-- >0;)Ie.push(0);break;case 18:for(A=11+D(v,S),S+=7;A-- >0;)Ie.push(0);break;default:Ie.push(xe),B<xe&&(B=xe);break}var at=Ie.slice(0,x),ot=Ie.slice(x);for(pe=x;pe<286;++pe)at[pe]=0;for(pe=y;pe<30;++pe)ot[pe]=0;return Vi=Ae(at,nr,286),Dt=Ae(ot,ir,30),S}function Xs(v,S){if(v[0]==3&&!(v[1]&3))return[Yn(S),2];for(var x=0,y=0,b=yf(S||1<<18),A=0,U=b.length>>>0,J=0,B=0;(y&1)==0;){if(y=F(v,x),x+=3,y>>>1)y>>1==1?(J=9,B=5):(x=gr(v,x),J=Vi,B=Dt);else{x&7&&(x+=8-(x&7));var j=v[x>>>3]|v[(x>>>3)+1]<<8;if(x+=32,j>0)for(!S&&U<A+j&&(b=ge(b,A+j),U=b.length);j-- >0;)b[A++]=v[x>>>3],x+=8;continue}for(;;){!S&&U<A+32767&&(b=ge(b,A+32767),U=b.length);var W=ue(v,x,J),ae=y>>>1==1?De[W]:nr[W];if(x+=ae&15,ae>>>=4,(ae>>>8&255)===0)b[A++]=ae;else{if(ae==256)break;ae-=257;var pe=ae<8?0:ae-4>>2;pe>5&&(pe=0);var xe=A+Z[ae];pe>0&&(xe+=ue(v,x,pe),x+=pe),W=ue(v,x,B),ae=y>>>1==1?$e[W]:ir[W],x+=ae&15,ae>>>=4;var ce=ae<4?0:ae-2>>1,ve=L[ae];for(ce>0&&(ve+=ue(v,x,ce),x+=ce),!S&&U<xe&&(b=ge(b,xe+100),U=b.length);A<xe;)b[A]=b[A-ve],++A}}}return S?[b,x+7>>>3]:[b.slice(0,A),x+7>>>3]}function Ki(v,S){var x=v.slice(v.l||0),y=Xs(x,S);return v.l+=y[1],y[0]}function Gc(v,S){if(v)typeof console<"u"&&console.error(S);else throw new Error(S)}function qc(v,S){var x=v;or(x,0);var y=[],b=[],A={FileIndex:y,FullPaths:b};I(A,{root:S.root});for(var U=x.length-4;(x[U]!=80||x[U+1]!=75||x[U+2]!=5||x[U+3]!=6)&&U>=0;)--U;x.l=U+4,x.l+=4;var J=x.read_shift(2);x.l+=6;var B=x.read_shift(4);for(x.l=B,U=0;U<J;++U){x.l+=20;var j=x.read_shift(4),W=x.read_shift(4),ae=x.read_shift(2),pe=x.read_shift(2),xe=x.read_shift(2);x.l+=8;var ce=x.read_shift(4),ve=o(x.slice(x.l+ae,x.l+ae+pe));x.l+=ae+pe+xe;var Ie=x.l;x.l=ce+4,y1(x,j,W,A,ve),x.l=Ie}return A}function y1(v,S,x,y,b){v.l+=2;var A=v.read_shift(2),U=v.read_shift(2),J=a(v);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var B=v.read_shift(4),j=v.read_shift(4),W=v.read_shift(4),ae=v.read_shift(2),pe=v.read_shift(2),xe="",ce=0;ce<ae;++ce)xe+=String.fromCharCode(v[v.l++]);if(pe){var ve=o(v.slice(v.l,v.l+pe));(ve[21589]||{}).mt&&(J=ve[21589].mt),((b||{})[21589]||{}).mt&&(J=b[21589].mt)}v.l+=pe;var Ie=v.slice(v.l,v.l+j);switch(U){case 8:Ie=H(v,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+U)}var at=!1;A&8&&(B=v.read_shift(4),B==134695760&&(B=v.read_shift(4),at=!0),j=v.read_shift(4),W=v.read_shift(4)),j!=S&&Gc(at,"Bad compressed size: "+S+" != "+j),W!=x&&Gc(at,"Bad uncompressed size: "+x+" != "+W),No(y,xe,Ie,{unsafe:!0,mt:J})}function E1(v,S){var x=S||{},y=[],b=[],A=G(1),U=x.compression?8:0,J=0,B=0,j=0,W=0,ae=0,pe=v.FullPaths[0],xe=pe,ce=v.FileIndex[0],ve=[],Ie=0;for(B=1;B<v.FullPaths.length;++B)if(xe=v.FullPaths[B].slice(pe.length),ce=v.FileIndex[B],!(!ce.size||!ce.content||xe=="Sh33tJ5")){var at=W,ot=G(xe.length);for(j=0;j<xe.length;++j)ot.write_shift(1,xe.charCodeAt(j)&127);ot=ot.slice(0,ot.l),ve[ae]=ay.buf(ce.content,0);var Lt=ce.content;U==8&&(Lt=N(Lt)),A=G(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,J),A.write_shift(2,U),ce.mt?s(A,ce.mt):A.write_shift(4,0),A.write_shift(-4,ve[ae]),A.write_shift(4,Lt.length),A.write_shift(4,ce.content.length),A.write_shift(2,ot.length),A.write_shift(2,0),W+=A.length,y.push(A),W+=ot.length,y.push(ot),W+=Lt.length,y.push(Lt),A=G(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,J),A.write_shift(2,U),A.write_shift(4,0),A.write_shift(-4,ve[ae]),A.write_shift(4,Lt.length),A.write_shift(4,ce.content.length),A.write_shift(2,ot.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,at),Ie+=A.l,b.push(A),Ie+=ot.length,b.push(ot),++ae}return A=G(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,ae),A.write_shift(2,ae),A.write_shift(4,Ie),A.write_shift(4,W),A.write_shift(2,0),Rt([Rt(y),Rt(b),A])}var Ys={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function T1(v,S){if(v.ctype)return v.ctype;var x=v.name||"",y=x.match(/\.([^\.]+)$/);return y&&Ys[y[1]]||S&&(y=(x=S).match(/[\.\\]([^\.\\])+$/),y&&Ys[y[1]])?Ys[y[1]]:"application/octet-stream"}function S1(v){for(var S=Rs(v),x=[],y=0;y<S.length;y+=76)x.push(S.slice(y,y+76));return x.join(`\r
`)+`\r
`}function b1(v){var S=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(j){var W=j.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var x=[],y=S.split(`\r
`),b=0;b<y.length;++b){var A=y[b];if(A.length==0){x.push("");continue}for(var U=0;U<A.length;){var J=76,B=A.slice(U,U+J);B.charAt(J-1)=="="?J--:B.charAt(J-2)=="="?J-=2:B.charAt(J-3)=="="&&(J-=3),B=A.slice(U,U+J),U+=J,U<A.length&&(B+="="),x.push(B)}}return x.join(`\r
`)}function A1(v){for(var S=[],x=0;x<v.length;++x){for(var y=v[x];x<=v.length&&y.charAt(y.length-1)=="=";)y=y.slice(0,y.length-1)+v[++x];S.push(y)}for(var b=0;b<S.length;++b)S[b]=S[b].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return Cr(S.join(`\r
`))}function k1(v,S,x){for(var y="",b="",A="",U,J=0;J<10;++J){var B=S[J];if(!B||B.match(/^\s*$/))break;var j=B.match(/^(.*?):\s*([^\s].*)$/);if(j)switch(j[1].toLowerCase()){case"content-location":y=j[2].trim();break;case"content-type":A=j[2].trim();break;case"content-transfer-encoding":b=j[2].trim();break}}switch(++J,b.toLowerCase()){case"base64":U=Cr(cn(S.slice(J).join("")));break;case"quoted-printable":U=A1(S.slice(J));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var W=No(v,y.slice(x.length),U,{unsafe:!0});A&&(W.ctype=A)}function O1(v,S){if(Xe(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var x=S&&S.root||"",y=(je&&Buffer.isBuffer(v)?v.toString("binary"):Xe(v)).split(`\r
`),b=0,A="";for(b=0;b<y.length;++b)if(A=y[b],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),x||(x=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,x.length)!=x))for(;x.length>0&&(x=x.slice(0,x.length-1),x=x.slice(0,x.lastIndexOf("/")+1),A.slice(0,x.length)!=x););var U=(y[1]||"").match(/boundary="(.*?)"/);if(!U)throw new Error("MAD cannot find boundary");var J="--"+(U[1]||""),B=[],j=[],W={FileIndex:B,FullPaths:j};I(W);var ae,pe=0;for(b=0;b<y.length;++b){var xe=y[b];xe!==J&&xe!==J+"--"||(pe++&&k1(W,y.slice(ae,b),x),ae=b)}return W}function C1(v,S){var x=S||{},y=x.boundary||"SheetJS";y="------="+y;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+y.slice(2)+'"',"","",""],A=v.FullPaths[0],U=A,J=v.FileIndex[0],B=1;B<v.FullPaths.length;++B)if(U=v.FullPaths[B].slice(A.length),J=v.FileIndex[B],!(!J.size||!J.content||U=="Sh33tJ5")){U=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var j=J.content,W=je&&Buffer.isBuffer(j)?j.toString("binary"):Xe(j),ae=0,pe=Math.min(1024,W.length),xe=0,ce=0;ce<=pe;++ce)(xe=W.charCodeAt(ce))>=32&&xe<128&&++ae;var ve=ae>=pe*4/5;b.push(y),b.push("Content-Location: "+(x.root||"file:///C:/SheetJS/")+U),b.push("Content-Transfer-Encoding: "+(ve?"quoted-printable":"base64")),b.push("Content-Type: "+T1(J,U)),b.push(""),b.push(ve?b1(W):S1(W))}return b.push(y+`--\r
`),b.join(`\r
`)}function R1(v){var S={};return I(S,v),S}function No(v,S,x,y){var b=y&&y.unsafe;b||I(v);var A=!b&&Ye.find(v,S);if(!A){var U=v.FullPaths[0];S.slice(0,U.length)==U?U=S:(U.slice(-1)!="/"&&(U+="/"),U=(U+S).replace("//","/")),A={name:i(S),type:2},v.FileIndex.push(A),v.FullPaths.push(U),b||Ye.utils.cfb_gc(v)}return A.content=x,A.size=x?x.length:0,y&&(y.CLSID&&(A.clsid=y.CLSID),y.mt&&(A.mt=y.mt),y.ct&&(A.ct=y.ct)),A}function I1(v,S){I(v);var x=Ye.find(v,S);if(x){for(var y=0;y<v.FileIndex.length;++y)if(v.FileIndex[y]==x)return v.FileIndex.splice(y,1),v.FullPaths.splice(y,1),!0}return!1}function F1(v,S,x){I(v);var y=Ye.find(v,S);if(y){for(var b=0;b<v.FileIndex.length;++b)if(v.FileIndex[b]==y)return v.FileIndex[b].name=i(x),v.FullPaths[b]=x,!0}return!1}function P1(v){M(v,!0)}return t.find=ne,t.read=ee,t.parse=u,t.write=ht,t.writeFile=Pe,t.utils={cfb_new:R1,cfb_add:No,cfb_del:I1,cfb_mov:F1,cfb_gc:P1,ReadShift:vs,CheckField:_p,prep_blob:or,bconcat:Rt,use_zlib:R,_deflateRaw:bt,_inflateRaw:Ki,consts:be},t})();function oy(e){return typeof e=="string"?Ao(e):Array.isArray(e)?Pw(e):e}function Vs(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ao(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Fs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([oy(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ws(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Pt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Cf(e,t){for(var r=[],n=Pt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Oc(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Co(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function ly(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Ya=new Date(1899,11,30,0,0,0);function tr(e,t){var r=e.getTime(),n=Ya.getTime()+(e.getTimezoneOffset()-Ya.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var tp=new Date,cy=Ya.getTime()+(tp.getTimezoneOffset()-Ya.getTimezoneOffset())*6e4,Rf=tp.getTimezoneOffset();function rp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+cy),t.getTimezoneOffset()!==Rf&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Rf)*6e4),t}var If=new Date("2017-02-19T19:06:09.000Z"),np=isNaN(If.getFullYear())?new Date("2/19/17"):If,uy=np.getFullYear()==2017;function Xt(e,t){var r=new Date(e);if(uy)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(np.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ro(e,t){if(je&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function rr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=rr(e[r]));return t}function ut(e,t){for(var r="";r.length<t;)r+=e;return r}function nn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var fy=["january","february","march","april","may","june","july","august","september","october","november","december"];function Is(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&fy.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ne(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return je?n=dn(r):n=Nw(r),Ye.utils.cfb_add(e,t,n)}Ye.utils.cfb_add(e,t,r)}else e.file(t,r)}function Cc(){return Ye.utils.cfb_new()}var _t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,hy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Rc=Oc(hy),Ic=/[&<>'"]/g,dy=/[\u0000-\u0008\u000b-\u001f]/g;function Ge(e){var t=e+"";return t.replace(Ic,function(r){return Rc[r]}).replace(dy,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ff(e){return Ge(e).replace(/ /g,"_x0020_")}var ip=/[\u0000-\u001f]/g;function py(e){var t=e+"";return t.replace(Ic,function(r){return Rc[r]}).replace(/\n/g,"<br/>").replace(ip,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function gy(e){var t=e+"";return t.replace(Ic,function(r){return Rc[r]}).replace(ip,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function my(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vy(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sl(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Pf(e){var t=Yn(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Nf(e){return dn(e,"binary").toString("utf8")}var ha="foo bar baz",ms=je&&(Nf(ha)==sl(ha)&&Nf||Pf(ha)==sl(ha)&&Pf)||sl,Fs=je?function(e){return dn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},_y=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),sp=/(^\s|\s$|\n)/;function It(e,t){return"<"+e+(t.match(sp)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ps(e){return Pt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function fe(e,t,r){return"<"+e+(r!=null?Ps(r):"")+(t!=null?(t.match(sp)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Gl(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function xy(e,t){switch(typeof e){case"string":var r=fe("vt:lpwstr",Ge(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return fe((e|0)==e?"vt:i4":"vt:r8",Ge(String(e)));case"boolean":return fe("vt:bool",e?"true":"false")}if(e instanceof Date)return fe("vt:filetime",Gl(e));throw new Error("Unable to serialize "+e)}var yt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ji=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],cr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function wy(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function yy(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var Df=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Lf=je?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:dn(t)})):Df(e)}:Df,Mf=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(as(e,i)));return n.join("").replace(gs,"")},Fc=je?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(gs,""):Mf(e,t,r)}:Mf,Bf=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},ap=je?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Bf(e,t,r)}:Bf,Uf=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(mi(e,i)));return n.join("")},Ks=je?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Uf(t,r,n)}:Uf,op=function(e,t){var r=ur(e,t);return r>0?Ks(e,t+4,t+4+r-1):""},lp=op,cp=function(e,t){var r=ur(e,t);return r>0?Ks(e,t+4,t+4+r-1):""},up=cp,fp=function(e,t){var r=2*ur(e,t);return r>0?Ks(e,t+4,t+4+r-1):""},hp=fp,dp=function(t,r){var n=ur(t,r);return n>0?Fc(t,r+4,r+4+n):""},pp=dp,gp=function(e,t){var r=ur(e,t);return r>0?Ks(e,t+4,t+4+r):""},mp=gp,vp=function(e,t){return wy(e,t)},Ja=vp,Pc=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};je&&(lp=function(t,r){if(!Buffer.isBuffer(t))return op(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},up=function(t,r){if(!Buffer.isBuffer(t))return cp(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},hp=function(t,r){if(!Buffer.isBuffer(t))return fp(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},pp=function(t,r){if(!Buffer.isBuffer(t))return dp(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},mp=function(t,r){if(!Buffer.isBuffer(t))return gp(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Ja=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):vp(t,r)},Pc=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var mi=function(e,t){return e[t]},as=function(e,t){return e[t+1]*256+e[t]},Ey=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ur=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Vn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ty=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function vs(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,je&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(as(this,c)),c+=2;e*=2;break;case"utf8":r=Ks(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Fc(this,this.l,this.l+e);break;case"wstr":return vs.call(this,e,"dbcs");case"lpstr-ansi":r=lp(this,this.l),e=4+ur(this,this.l);break;case"lpstr-cp":r=up(this,this.l),e=4+ur(this,this.l);break;case"lpwstr":r=hp(this,this.l),e=4+2*ur(this,this.l);break;case"lpp4":e=4+ur(this,this.l),r=pp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ur(this,this.l),r=mp(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=mi(this,this.l+e++))!==0;)s.push(ca(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=as(this,this.l+e))!==0;)s.push(ca(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=mi(this,c),this.l=c+1,o=vs.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ca(as(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=mi(this,c),this.l=c+1,o=vs.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(ca(mi(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=mi(this,this.l),this.l++,n;case 2:return n=(t==="i"?Ey:as)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Vn:Ty)(this,this.l),this.l+=4,n):(i=ur(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Ja(this,this.l):i=Ja([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=ap(this,this.l,e);break}}return this.l+=e,r}var Sy=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},by=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Ay=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function ky(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)Ay(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Sy(this,t,this.l);break;case 8:if(n=8,r==="f"){yy(this,t,this.l);break}case 16:break;case-4:n=4,by(this,t,this.l);break}return this.l+=n,this}function _p(e,t){var r=ap(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function or(e,t){e.l=t,e.read_shift=vs,e.chk=_p,e.write_shift=ky}function Kr(e,t){e.l+=t}function G(e){var t=Yn(e);return or(t,0),t}function er(){var e=[],t=je?256:2048,r=function(c){var u=G(c);return or(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),Rt(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function re(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=wA[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Pc(r)&&e.push(r)}}function _s(e,t,r){var n=rr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function jf(e,t,r){var n=rr(e);return n.s=_s(n.s,t.s,r),n.e=_s(n.e,t.s,r),n}function xs(e,t){if(e.cRel&&e.c<0)for(e=rr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=rr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=qe(e);return!e.cRel&&e.cRel!=null&&(r=Ry(r)),!e.rRel&&e.rRel!=null&&(r=Oy(r)),r}function al(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$t(e.s.c)+":"+(e.e.cRel?"":"$")+$t(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ft(e.s.r)+":"+(e.e.rRel?"":"$")+Ft(e.e.r):xs(e.s,t.biff)+":"+xs(e.e,t.biff)}function Nc(e){return parseInt(Cy(e),10)-1}function Ft(e){return""+(e+1)}function Oy(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Cy(e){return e.replace(/\$(\d+)$/,"$1")}function Dc(e){for(var t=Iy(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function $t(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Ry(e){return e.replace(/^([A-Z])/,"$$$1")}function Iy(e){return e.replace(/^\$([A-Z])/,"$1")}function Fy(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function qe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function pr(e){var t=e.indexOf(":");return t==-1?{s:Tt(e),e:Tt(e)}:{s:Tt(e.slice(0,t)),e:Tt(e.slice(t+1))}}function mt(e,t){return typeof t>"u"||typeof t=="number"?mt(e.s,e.e):(typeof e!="string"&&(e=qe(e)),typeof t!="string"&&(t=qe(t)),e==t?e:e+":"+t)}function nt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function $f(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=kn(e.z,r?tr(t):t)}catch{}try{return e.w=kn((e.XF||{}).numFmtId||(r?14:0),r?tr(t):t)}catch{return""+t}}function un(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zs[e.v]||e.v:t==null?$f(e,e.v):$f(e,t))}function Zn(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function xp(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Tt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=nt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var d={v:t[f][h]},g=a+f,p=o+h;if(c.s.r>g&&(c.s.r=g),c.s.c>p&&(c.s.c=p),c.e.r<g&&(c.e.r=g),c.e.c<p&&(c.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))d=t[f][h];else if(Array.isArray(d.v)&&(d.f=t[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||ft[14],n.cellDates?(d.t="d",d.w=kn(d.z,tr(d.v))):(d.t="n",d.v=tr(d.v),d.w=kn(d.z,d.v))):d.t="s";if(i)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(d.z=s[g][p].z),s[g][p]=d;else{var m=qe({c:p,r:g});s[m]&&s[m].z&&(d.z=s[m].z),s[m]=d}}}return c.s.c<1e7&&(s["!ref"]=mt(c)),s}function $i(e,t){return xp(null,e,t)}function Py(e){return e.read_shift(4,"i")}function Pr(e,t){return t||(t=G(4)),t.write_shift(4,e),t}function Ht(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function St(e,t){var r=!1;return t==null&&(r=!0,t=G(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Ny(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Dy(e,t){return t||(t=G(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Lc(e,t){var r=e.l,n=e.read_shift(1),i=Ht(e),s=[],a={t:i,h:i};if((n&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(Ny(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function Ly(e,t){var r=!1;return t==null&&(r=!0,t=G(15+4*e.t.length)),t.write_shift(1,0),St(e.t,t),r?t.slice(0,t.l):t}var My=Lc;function By(e,t){var r=!1;return t==null&&(r=!0,t=G(23+4*e.t.length)),t.write_shift(1,1),St(e.t,t),t.write_shift(4,1),Dy({},t),r?t.slice(0,t.l):t}function yr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ei(e,t){return t==null&&(t=G(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ti(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ri(e,t){return t==null&&(t=G(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Uy=Ht,wp=St;function Mc(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Qa(e,t){var r=!1;return t==null&&(r=!0,t=G(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var jy=Ht,ql=Mc,Bc=Qa;function yp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Ja([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Vn(t,0)>>2;return r?i/100:i}function Ep(e,t){t==null&&(t=G(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Tp(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function $y(e,t){return t||(t=G(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ni=Tp,Hi=$y;function Wi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Jn(e,t){return(t||G(8)).write_shift(8,e,"f")}function Hy(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=Jy[i];c&&(t.rgb=Qf(c));break;case 2:t.rgb=Qf([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Za(e,t){if(t||(t=G(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Wy(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Vy(e,t){t||(t=G(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Sp=2,ar=3,da=11,eo=19,pa=64,Ky=65,zy=71,Gy=4108,qy=4126,Ct=80,Hf={1:{n:"CodePage",t:Sp},2:{n:"Category",t:Ct},3:{n:"PresentationFormat",t:Ct},4:{n:"ByteCount",t:ar},5:{n:"LineCount",t:ar},6:{n:"ParagraphCount",t:ar},7:{n:"SlideCount",t:ar},8:{n:"NoteCount",t:ar},9:{n:"HiddenCount",t:ar},10:{n:"MultimediaClipCount",t:ar},11:{n:"ScaleCrop",t:da},12:{n:"HeadingPairs",t:Gy},13:{n:"TitlesOfParts",t:qy},14:{n:"Manager",t:Ct},15:{n:"Company",t:Ct},16:{n:"LinksUpToDate",t:da},17:{n:"CharacterCount",t:ar},19:{n:"SharedDoc",t:da},22:{n:"HyperlinksChanged",t:da},23:{n:"AppVersion",t:ar,p:"version"},24:{n:"DigSig",t:Ky},26:{n:"ContentType",t:Ct},27:{n:"ContentStatus",t:Ct},28:{n:"Language",t:Ct},29:{n:"Version",t:Ct},255:{},2147483648:{n:"Locale",t:eo},2147483651:{n:"Behavior",t:eo},1919054434:{}},Wf={1:{n:"CodePage",t:Sp},2:{n:"Title",t:Ct},3:{n:"Subject",t:Ct},4:{n:"Author",t:Ct},5:{n:"Keywords",t:Ct},6:{n:"Comments",t:Ct},7:{n:"Template",t:Ct},8:{n:"LastAuthor",t:Ct},9:{n:"RevNumber",t:Ct},10:{n:"EditTime",t:pa},11:{n:"LastPrinted",t:pa},12:{n:"CreatedDate",t:pa},13:{n:"ModifiedDate",t:pa},14:{n:"PageCount",t:ar},15:{n:"WordCount",t:ar},16:{n:"CharCount",t:ar},17:{n:"Thumbnail",t:zy},18:{n:"Application",t:Ct},19:{n:"DocSecurity",t:ar},255:{},2147483648:{n:"Locale",t:eo},2147483651:{n:"Behavior",t:eo},1919054434:{}};function Xy(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Yy=Xy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Jy=rr(Yy),zs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Qy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ga={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function bp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Ap(e,t){var r=ly(Qy),n=[],i;n[n.length]=_t,n[n.length]=fe("Types",null,{xmlns:yt.CT,"xmlns:xsd":yt.xsd,"xmlns:xsi":yt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return fe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=fe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ga[l][t.bookType]||ga[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=fe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:ga[l][t.bookType]||ga[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=fe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ue={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function kp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ki(e){var t=[_t,fe("Relationships",null,{xmlns:yt.RELS})];return Pt(e["!id"]).forEach(function(r){t[t.length]=fe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ze(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Ue.HLINK,Ue.XPATH,Ue.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function Zy(e){var t=[_t];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Vf(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function e2(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function t2(e){var t=[_t];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Vf(e[r][0],e[r][1])),t.push(e2("",e[r][0]));return t.push(Vf("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Op(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ka.version+"</meta:generator></office:meta></office:document-meta>"}var Xn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function ol(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Ge(t),n[n.length]=r?fe(e,t,r):It(e,t))}function Cp(e,t){var r=t||{},n=[_t,fe("cp:coreProperties",null,{"xmlns:cp":yt.CORE_PROPS,"xmlns:dc":yt.dc,"xmlns:dcterms":yt.dcterms,"xmlns:dcmitype":yt.dcmitype,"xmlns:xsi":yt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ol("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Gl(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&ol("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Gl(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Xn.length;++s){var a=Xn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ol(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Oi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Rp=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ip(e){var t=[],r=fe;return e||(e={}),e.Application="SheetJS",t[t.length]=_t,t[t.length]=fe("Properties",null,{xmlns:yt.EXT_PROPS,"xmlns:vt":yt.vt}),Oi.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ge(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ge(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Fp(e){var t=[_t,fe("Properties",null,{xmlns:yt.CUST_PROPS,"xmlns:vt":yt.vt})];if(!e)return t.join("");var r=1;return Pt(e).forEach(function(i){++r,t[t.length]=fe("property",xy(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ge(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Kf={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function r2(e,t){var r=[];return Pt(Kf).map(function(n){for(var i=0;i<Xn.length;++i)if(Xn[i][1]==n)return Xn[i];for(i=0;i<Oi.length;++i)if(Oi[i][1]==n)return Oi[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(It(Kf[n[1]]||n[1],i))}}),fe("DocumentProperties",r.join(""),{xmlns:cr.o})}function n2(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Pt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<Xn.length;++a)if(s==Xn[a][1])return;for(a=0;a<Oi.length;++a)if(s==Oi[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(fe(Ff(s),o,{"dt:dt":l}))}}),t&&Pt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(fe(Ff(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+cr.o+'">'+i.join("")+"</"+n+">"}function i2(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=G(8);return a.write_shift(4,n),a.write_shift(4,i),a}function zf(e,t){var r=G(4),n=G(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=G(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=i2(t);break;case 31:case 80:for(n=G(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Rt([r,n])}var Pp=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function s2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Gf(e,t,r){var n=G(8),i=[],s=[],a=8,o=0,l=G(8),c=G(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!t){c=G(8),c.write_shift(4,0),i.unshift(c);var u=[G(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(l=G(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Rt(u),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Pp.indexOf(e[o][0])>-1||Rp.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],d=0;if(t){d=+t[e[o][0]];var g=r[d];if(g.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=zf(g.t,h)}else{var m=s2(h);m==-1&&(m=31,h=String(h)),l=zf(m,h)}s.push(l),c=G(8),c.write_shift(4,t?d:2+o),i.push(c),a+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,w),w+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Rt([n].concat(i).concat(s))}function qf(e,t,r,n,i,s){var a=G(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=Gf(e,r,n);if(o.push(l),i){var c=Gf(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Rt(o)}function a2(e,t){t||(t=G(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function o2(e,t){return e.read_shift(t)===1}function Gt(e,t){return t||(t=G(2)),t.write_shift(2,+!!e),t}function Np(e){return e.read_shift(2,"u")}function vr(e,t){return t||(t=G(2)),t.write_shift(2,e),t}function Dp(e,t,r){return r||(r=G(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Lp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function l2(e){var t=e.t||"",r=G(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=G(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Rt(i)}function c2(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function u2(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):c2(e,n,r)}function f2(e,t,r){if(r.biff>5)return u2(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Mp(e,t,r){return r||(r=G(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Xf(e,t){t||(t=G(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function h2(e){var t=G(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),Xf(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Xf(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Qn(e,t,r,n){return n||(n=G(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function d2(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function p2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Bp(e,t){return t||(t=G(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Uc(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=G(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function g2(e,t){var r=!t||t.biff==8,n=G(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function m2(e,t){var r=!t||t.biff>=8?2:1,n=G(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function v2(e,t){var r=G(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=l2(e[i]);var s=Rt([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function _2(){var e=G(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function x2(e){var t=G(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function w2(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=G(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function y2(e,t,r,n){var i=G(10);return Qn(e,t,n,i),i.write_shift(4,r),i}function E2(e,t,r,n,i){var s=!i||i.biff==8,a=G(8+ +s+(1+s)*r.length);return Qn(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function T2(e,t,r,n){var i=r&&r.biff==5;n||(n=G(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function S2(e,t){var r=t.biff==8||!t.biff?4:2,n=G(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Yf(e,t,r,n){var i=r&&r.biff==5;n||(n=G(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function b2(e){var t=G(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function A2(e,t,r,n,i,s){var a=G(8);return Qn(e,t,n,a),Dp(r,s,a),a}function k2(e,t,r,n){var i=G(14);return Qn(e,t,n,i),Jn(r,i),i}function O2(e,t,r){if(r.biff<8)return C2(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(d2(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function C2(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Lp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function R2(e){var t=G(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Bp(e[r],t);return t}function I2(e){var t=G(24),r=Tt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Rt([t,h2(e[1])])}function F2(e){var t=e[1].Tooltip,r=G(10+2*(t.length+1));r.write_shift(2,2048);var n=Tt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function P2(e){return e||(e=G(4)),e.write_shift(2,1),e.write_shift(2,1),e}function N2(e,t,r){if(!r.cellStyles)return Kr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function D2(e,t){var r=G(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function L2(e){for(var t=G(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function M2(e,t,r){var n=G(15);return qs(n,e,t),n.write_shift(8,r,"f"),n}function B2(e,t,r){var n=G(9);return qs(n,e,t),n.write_shift(2,r),n}var U2=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Oc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Yn(1);switch(l.type){case"base64":u=Cr(cn(o));break;case"binary":u=Cr(o);break;case"buffer":case"array":u=o;break}or(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,m=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(m=u.read_shift(2));var w=u.read_shift(2),T=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(T=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var _=[],O={},V=Math.min(u.length,f==2?521:m-10-(d?264:0)),ee=g?32:11;u.l<V&&u[u.l]!=13;)switch(O={},O.name=za.utils.decode(T,u.slice(u.l,u.l+ee)).replace(/[\u0000\r\n].*$/g,""),u.l+=ee,O.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(O.offset=u.read_shift(4)),O.len=u.read_shift(1),f==2&&(O.offset=u.read_shift(2)),O.dec=u.read_shift(1),O.name.length&&_.push(O),f!=2&&(u.l+=g?13:14),O.type){case"B":(!d||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(u[u.l]!==13&&(u.l=m-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=m;var I=0,q=0;for(c[0]=[],q=0;q!=_.length;++q)c[0][q]=_[q].name;for(;p-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++I]=[],q=0,q=0;q!=_.length;++q){var M=u.slice(u.l,u.l+_[q].len);u.l+=_[q].len,or(M,0);var te=za.utils.decode(T,M);switch(_[q].type){case"C":te.trim().length&&(c[I][q]=te.replace(/\s+$/,""));break;case"D":te.length===8?c[I][q]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):c[I][q]=te;break;case"F":c[I][q]=parseFloat(te.trim());break;case"+":case"I":c[I][q]=g?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":c[I][q]=!0;break;case"N":case"F":c[I][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[I][q]="##MEMO##"+(g?parseInt(te.trim(),10):M.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(c[I][q]=+te||0);break;case"@":c[I][q]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":c[I][q]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":c[I][q]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[I][q]=-M.read_shift(-8,"f");break;case"B":if(d&&_[q].len==8){c[I][q]=M.read_shift(8,"f");break}case"G":case"P":M.l+=_[q].len;break;case"0":if(_[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[q].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=$i(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(o,l){try{return Zn(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Cs(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=er(),f=so(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),g=o["!cols"]||[],p=0,m=0,w=0,T=1;for(p=0;p<h.length;++p){if(((g[p]||{}).DBF||{}).name){h[p]=g[p].DBF.name,++w;continue}if(h[p]!=null){if(++w,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(m=0;m<1024;++m)if(h.indexOf(h[p]+"_"+m)==-1){h[p]+="_"+m;break}}}}var _=nt(o["!ref"]),O=[],V=[],ee=[];for(p=0;p<=_.e.c-_.s.c;++p){var I="",q="",M=0,te=[];for(m=0;m<d.length;++m)d[m][p]!=null&&te.push(d[m][p]);if(te.length==0||h[p]==null){O[p]="?";continue}for(m=0;m<te.length;++m){switch(typeof te[m]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=te[m]instanceof Date?"D":"C";break;default:q="C"}M=Math.max(M,String(te[m]).length),I=I&&I!=q?"C":q}M>250&&(M=250),q=((g[p]||{}).DBF||{}).type,q=="C"&&g[p].DBF.len>M&&(M=g[p].DBF.len),I=="B"&&q=="N"&&(I="N",ee[p]=g[p].DBF.dec,M=g[p].DBF.len),V[p]=I=="C"||q=="N"?M:s[I]||0,T+=V[p],O[p]=I}var ne=u.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,d.length),ne.write_shift(2,296+32*w),ne.write_shift(2,T),p=0;p<4;++p)ne.write_shift(4,0);for(ne.write_shift(4,0|(+t[jd]||3)<<8),p=0,m=0;p<h.length;++p)if(h[p]!=null){var se=u.next(32),de=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);se.write_shift(1,de,"sbcs"),se.write_shift(1,O[p]=="?"?"C":O[p],"sbcs"),se.write_shift(4,m),se.write_shift(1,V[p]||s[O[p]]||0),se.write_shift(1,ee[p]||0),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(1,0),se.write_shift(4,0),se.write_shift(4,0),m+=V[p]||s[O[p]]||0}var Be=u.next(264);for(Be.write_shift(4,13),p=0;p<65;++p)Be.write_shift(4,0);for(p=0;p<d.length;++p){var Oe=u.next(T);for(Oe.write_shift(1,0),m=0;m<h.length;++m)if(h[m]!=null)switch(O[m]){case"L":Oe.write_shift(1,d[p][m]==null?63:d[p][m]?84:70);break;case"B":Oe.write_shift(8,d[p][m]||0,"f");break;case"N":var Me="0";for(typeof d[p][m]=="number"&&(Me=d[p][m].toFixed(ee[m]||0)),w=0;w<V[m]-Me.length;++w)Oe.write_shift(1,32);Oe.write_shift(1,Me,"sbcs");break;case"D":d[p][m]?(Oe.write_shift(4,("0000"+d[p][m].getFullYear()).slice(-4),"sbcs"),Oe.write_shift(2,("00"+(d[p][m].getMonth()+1)).slice(-2),"sbcs"),Oe.write_shift(2,("00"+d[p][m].getDate()).slice(-2),"sbcs")):Oe.write_shift(8,"00000000","sbcs");break;case"C":var be=String(d[p][m]!=null?d[p][m]:"").slice(0,V[m]);for(Oe.write_shift(1,be,"sbcs"),w=0;w<V[m]-be.length;++w)Oe.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}})(),j2=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Pt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var g=e[d];return typeof g=="number"?wf(g):g},n=function(h,d,g){var p=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?h:wf(p)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return s(cn(h),d);case"binary":return s(h,d);case"buffer":return s(je&&Buffer.isBuffer(h)?h.toString("binary"):Ws(h),d);case"array":return s(Ro(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var g=h.split(/[\n\r]+/),p=-1,m=-1,w=0,T=0,_=[],O=[],V=null,ee={},I=[],q=[],M=[],te=0,ne;for(+d.codepage>=0&&Cs(+d.codepage);w!==g.length;++w){te=0;var se=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),de=se.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),Be=de[0],Oe;if(se.length>0)switch(Be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":de[1].charAt(0)=="P"&&O.push(se.slice(3).replace(/;;/g,";"));break;case"C":var Me=!1,be=!1,Pe=!1,Xe=!1,ht=-1,it=-1;for(T=1;T<de.length;++T)switch(de[T].charAt(0)){case"A":break;case"X":m=parseInt(de[T].slice(1))-1,be=!0;break;case"Y":for(p=parseInt(de[T].slice(1))-1,be||(m=0),ne=_.length;ne<=p;++ne)_[ne]=[];break;case"K":Oe=de[T].slice(1),Oe.charAt(0)==='"'?Oe=Oe.slice(1,Oe.length-1):Oe==="TRUE"?Oe=!0:Oe==="FALSE"?Oe=!1:isNaN(nn(Oe))?isNaN(Is(Oe).getDate())||(Oe=Xt(Oe)):(Oe=nn(Oe),V!==null&&Qd(V)&&(Oe=rp(Oe))),Me=!0;break;case"E":Xe=!0;var R=BE(de[T].slice(1),{r:p,c:m});_[p][m]=[_[p][m],R];break;case"S":Pe=!0,_[p][m]=[_[p][m],"S5S"];break;case"G":break;case"R":ht=parseInt(de[T].slice(1))-1;break;case"C":it=parseInt(de[T].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+se)}if(Me&&(_[p][m]&&_[p][m].length==2?_[p][m][0]=Oe:_[p][m]=Oe,V=null),Pe){if(Xe)throw new Error("SYLK shared formula cannot have own formula");var H=ht>-1&&_[ht][it];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");_[p][m][1]=UE(H[1],{r:p-ht,c:m-it})}break;case"F":var N=0;for(T=1;T<de.length;++T)switch(de[T].charAt(0)){case"X":m=parseInt(de[T].slice(1))-1,++N;break;case"Y":for(p=parseInt(de[T].slice(1))-1,ne=_.length;ne<=p;++ne)_[ne]=[];break;case"M":te=parseInt(de[T].slice(1))/20;break;case"F":break;case"G":break;case"P":V=O[parseInt(de[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=de[T].slice(1).split(" "),ne=parseInt(M[0],10);ne<=parseInt(M[1],10);++ne)te=parseInt(M[2],10),q[ne-1]=te===0?{hidden:!0}:{wch:te},jc(q[ne-1]);break;case"C":m=parseInt(de[T].slice(1))-1,q[m]||(q[m]={});break;case"R":p=parseInt(de[T].slice(1))-1,I[p]||(I[p]={}),te>0?(I[p].hpt=te,I[p].hpx=Wp(te)):te===0&&(I[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+se)}N<1&&(V=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+se)}}return I.length>0&&(ee["!rows"]=I),q.length>0&&(ee["!cols"]=q),d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),[_,ee]}function a(h,d){var g=i(h,d),p=g[0],m=g[1],w=$i(p,d);return Pt(m).forEach(function(T){w[T]=m[T]}),w}function o(h,d){return Zn(a(h,d),d)}function l(h,d,g,p){var m="C;Y"+(g+1)+";X"+(p+1)+";K";switch(h.t){case"n":m+=h.v||0,h.f&&!h.F&&(m+=";E"+Hc(h.f,{r:g,c:p}));break;case"b":m+=h.v?"TRUE":"FALSE";break;case"e":m+=h.w||h.v;break;case"d":m+='"'+(h.w||h.v)+'"';break;case"s":m+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(h,d){d.forEach(function(g,p){var m="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=to(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=ro(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&h.push(m)})}function u(h,d){d.forEach(function(g,p){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*no(g.hpx)+";"),m.length>2&&h.push(m+"R"+(p+1))})}function f(h,d){var g=["ID;PWXL;N;E"],p=[],m=nt(h["!ref"]),w,T=Array.isArray(h),_=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&c(g,h["!cols"]),h["!rows"]&&u(g,h["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var O=m.s.r;O<=m.e.r;++O)for(var V=m.s.c;V<=m.e.c;++V){var ee=qe({r:O,c:V});w=T?(h[O]||[])[V]:h[ee],!(!w||w.v==null&&(!w.f||w.F))&&p.push(l(w,h,O,V))}return g.join(_)+_+p.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),$2=(function(){function e(s,a){switch(a.type){case"base64":return t(cn(s),a);case"binary":return t(s,a);case"buffer":return t(je&&Buffer.isBuffer(s)?s.toString("binary"):Ws(s),a);case"array":return t(Ro(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),d=h[0],g=h[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+d){case-1:if(p==="BOT"){f[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][c]=!0:p==="FALSE"?f[l][c]=!1:isNaN(nn(g))?isNaN(Is(g).getDate())?f[l][c]=g:f[l][c]=Xt(g):f[l][c]=nn(g),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return $i(e(s,a),a)}function n(s,a){return Zn(r(s,a),a)}var i=(function(){var s=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=nt(l["!ref"]),f,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=qe({r:d,c:g});if(f=h?(l[d]||[])[g]:l[p],!f){a(c,1,0,"");continue}switch(f.t){case"n":var m=f.w;!m&&f.v!=null&&(m=f.v),m==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,m,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=kn(f.z||ft[14],tr(Xt(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var w=`\r
`,T=c.join(w);return T}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),Up=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var d=f.split(`
`),g=-1,p=-1,m=0,w=[];m!==d.length;++m){var T=d[m].trim().split(":");if(T[0]==="cell"){var _=Tt(T[1]);if(w.length<=_.r)for(g=w.length;g<=_.r;++g)w[g]||(w[g]=[]);switch(g=_.r,p=_.c,T[2]){case"t":w[g][p]=e(T[3]);break;case"v":w[g][p]=+T[3];break;case"vtf":var O=T[T.length-1];case"vtc":switch(T[3]){case"nl":w[g][p]=!!+T[4];break;default:w[g][p]=+T[4];break}T[2]=="vtf"&&(w[g][p]=[w[g][p],O])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function n(f,h){return $i(r(f,h),h)}function i(f,h){return Zn(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],g,p="",m=pr(f["!ref"]),w=Array.isArray(f),T=m.s.r;T<=m.e.r;++T)for(var _=m.s.c;_<=m.e.c;++_)if(p=qe({r:T,c:_}),g=w?(f[T]||[])[_]:f[p],!(!g||g.v==null||g.t==="z")){switch(d=["cell",p,"t"],g.t){case"s":case"str":d.push(t(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=t(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var O=tr(Xt(g.v));d[2]="vtc",d[3]="nd",d[4]=""+O,d[5]=g.w||kn(g.z||ft[14],O);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}})(),H2=(function(){function e(u,f,h,d,g){g.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(nn(u))?isNaN(Is(u).getDate())?f[h][d]=u:f[h][d]=Xt(u):f[h][d]=nn(u))}function t(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var m=10,w=0,T=0;T<=p;++T)w=g[T].indexOf(" "),w==-1?w=g[T].length:w++,m=Math.max(m,w);for(T=0;T<=p;++T){d[T]=[];var _=0;for(e(g[T].slice(0,m).trim(),d,T,_,h),_=1;_<=(g[T].length-m)/10+1;++_)e(g[T].slice(m+(_-1)*10,m+_*10).trim(),d,T,_,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,g=0;d<u.length;++d)(g=u.charCodeAt(d))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&g.push([f[d],d]);if(!g.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&g.push([f[d],d])}return g.sort(function(p,m){return p[0]-m[0]||n[p[1]]-n[m[1]]}),r[g.pop()[1]]||44}function s(u,f){var h=f||{},d="",g=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var m=0,w=0,T=0,_=0,O=0,V=d.charCodeAt(0),ee=!1,I=0,q=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var M=h.dateNF!=null?iy(h.dateNF):null;function te(){var ne=u.slice(_,O),se={};if(ne.charAt(0)=='"'&&ne.charAt(ne.length-1)=='"'&&(ne=ne.slice(1,-1).replace(/""/g,'"')),ne.length===0)se.t="z";else if(h.raw)se.t="s",se.v=ne;else if(ne.trim().length===0)se.t="s",se.v=ne;else if(ne.charCodeAt(0)==61)ne.charCodeAt(1)==34&&ne.charCodeAt(ne.length-1)==34?(se.t="s",se.v=ne.slice(2,-1).replace(/""/g,'"')):jE(ne)?(se.t="n",se.f=ne.slice(1)):(se.t="s",se.v=ne);else if(ne=="TRUE")se.t="b",se.v=!0;else if(ne=="FALSE")se.t="b",se.v=!1;else if(!isNaN(T=nn(ne)))se.t="n",h.cellText!==!1&&(se.w=ne),se.v=T;else if(!isNaN(Is(ne).getDate())||M&&ne.match(M)){se.z=h.dateNF||ft[14];var de=0;M&&ne.match(M)&&(ne=sy(ne,h.dateNF,ne.match(M)||[]),de=1),h.cellDates?(se.t="d",se.v=Xt(ne,de)):(se.t="n",se.v=tr(Xt(ne,de))),h.cellText!==!1&&(se.w=kn(se.z,se.v instanceof Date?tr(se.v):se.v)),h.cellNF||delete se.z}else se.t="s",se.v=ne;if(se.t=="z"||(h.dense?(g[m]||(g[m]=[]),g[m][w]=se):g[qe({c:w,r:m})]=se),_=O+1,q=u.charCodeAt(_),p.e.c<w&&(p.e.c=w),p.e.r<m&&(p.e.r=m),I==V)++w;else if(w=0,++m,h.sheetRows&&h.sheetRows<=m)return!0}e:for(;O<u.length;++O)switch(I=u.charCodeAt(O)){case 34:q===34&&(ee=!ee);break;case V:case 10:case 13:if(!ee&&te())break e;break}return O-_>0&&te(),g["!ref"]=mt(p),g}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):$i(t(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:e4(u,f);switch(f.type){case"base64":h=cn(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof za<"u"||(h=je&&Buffer.isBuffer(u)?u.toString("binary"):Ws(u));break;case"array":h=Ro(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=ms(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=ms(h):f.type=="binary"&&typeof za<"u",h.slice(0,19)=="socialcalc:version:"?Up.to_sheet(f.type=="string"?h:ms(h),f):a(h,f)}function l(u,f){return Zn(o(u,f),f)}function c(u){for(var f=[],h=nt(u["!ref"]),d,g=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var m=[],w=h.s.c;w<=h.e.c;++w){var T=qe({r:p,c:w});if(d=g?(u[p]||[])[w]:u[T],!d||d.v==null){m.push("          ");continue}for(var _=(d.w||(un(d),d.w)||"").slice(0,10);_.length<10;)_+=" ";m.push(_+(w===0?" ":""))}f.push(m.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),Jf=(function(){function e(R,H,N){if(R){or(R,R.l||0);for(var P=N.Enum||ht;R.l<R.length;){var Z=R.read_shift(2),L=P[Z]||P[65535],Q=R.read_shift(2),K=R.l+Q,X=L.f&&L.f(R,Q,N);if(R.l=K,H(X,L,Z))return}}}function t(R,H){switch(H.type){case"base64":return r(Cr(cn(R)),H);case"binary":return r(Cr(R),H);case"buffer":case"array":return r(R,H)}throw"Unsupported type "+H.type}function r(R,H){if(!R)return R;var N=H||{},P=N.dense?[]:{},Z="Sheet1",L="",Q=0,K={},X=[],Ee=[],E={s:{r:0,c:0},e:{r:0,c:0}},C=N.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)N.Enum=ht,e(R,function(D,ue,le){switch(le){case 0:N.vers=D,D>=4096&&(N.qpro=!0);break;case 6:E=D;break;case 204:D&&(L=D);break;case 222:L=D;break;case 15:case 51:N.qpro||(D[1].v=D[1].v.slice(1));case 13:case 14:case 16:le==14&&(D[2]&112)==112&&(D[2]&15)>1&&(D[2]&15)<15&&(D[1].z=N.dateNF||ft[14],N.cellDates&&(D[1].t="d",D[1].v=rp(D[1].v))),N.qpro&&D[3]>Q&&(P["!ref"]=mt(E),K[Z]=P,X.push(Z),P=N.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},Q=D[3],Z=L||"Sheet"+(Q+1),L="");var oe=N.dense?(P[D[0].r]||[])[D[0].c]:P[qe(D[0])];if(oe){oe.t=D[1].t,oe.v=D[1].v,D[1].z!=null&&(oe.z=D[1].z),D[1].f!=null&&(oe.f=D[1].f);break}N.dense?(P[D[0].r]||(P[D[0].r]=[]),P[D[0].r][D[0].c]=D[1]):P[qe(D[0])]=D[1];break}},N);else if(R[2]==26||R[2]==14)N.Enum=it,R[2]==14&&(N.qpro=!0,R.l=0),e(R,function(D,ue,le){switch(le){case 204:Z=D;break;case 22:D[1].v=D[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(D[3]>Q&&(P["!ref"]=mt(E),K[Z]=P,X.push(Z),P=N.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},Q=D[3],Z="Sheet"+(Q+1)),C>0&&D[0].r>=C)break;N.dense?(P[D[0].r]||(P[D[0].r]=[]),P[D[0].r][D[0].c]=D[1]):P[qe(D[0])]=D[1],E.e.c<D[0].c&&(E.e.c=D[0].c),E.e.r<D[0].r&&(E.e.r=D[0].r);break;case 27:D[14e3]&&(Ee[D[14e3][0]]=D[14e3][1]);break;case 1537:Ee[D[0]]=D[1],D[0]==Q&&(Z=D[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(P["!ref"]=mt(E),K[L||Z]=P,X.push(L||Z),!Ee.length)return{SheetNames:X,Sheets:K};for(var F={},Y=[],z=0;z<Ee.length;++z)K[X[z]]?(Y.push(Ee[z]||X[z]),F[Ee[z]]=K[Ee[z]]||K[X[z]]):(Y.push(Ee[z]),F[Ee[z]]={"!ref":"A1"});return{SheetNames:Y,Sheets:F}}function n(R,H){var N=H||{};if(+N.codepage>=0&&Cs(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var P=er(),Z=nt(R["!ref"]),L=Array.isArray(R),Q=[];he(P,0,s(1030)),he(P,6,l(Z));for(var K=Math.min(Z.e.r,8191),X=Z.s.r;X<=K;++X)for(var Ee=Ft(X),E=Z.s.c;E<=Z.e.c;++E){X===Z.s.r&&(Q[E]=$t(E));var C=Q[E]+Ee,F=L?(R[X]||[])[E]:R[C];if(!(!F||F.t=="z"))if(F.t=="n")(F.v|0)==F.v&&F.v>=-32768&&F.v<=32767?he(P,13,d(X,E,F.v)):he(P,14,p(X,E,F.v));else{var Y=un(F);he(P,15,f(X,E,Y.slice(0,239)))}}return he(P,1),P.end()}function i(R,H){var N=H||{};if(+N.codepage>=0&&Cs(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var P=er();he(P,0,a(R));for(var Z=0,L=0;Z<R.SheetNames.length;++Z)(R.Sheets[R.SheetNames[Z]]||{})["!ref"]&&he(P,27,Xe(R.SheetNames[Z],L++));var Q=0;for(Z=0;Z<R.SheetNames.length;++Z){var K=R.Sheets[R.SheetNames[Z]];if(!(!K||!K["!ref"])){for(var X=nt(K["!ref"]),Ee=Array.isArray(K),E=[],C=Math.min(X.e.r,8191),F=X.s.r;F<=C;++F)for(var Y=Ft(F),z=X.s.c;z<=X.e.c;++z){F===X.s.r&&(E[z]=$t(z));var D=E[z]+Y,ue=Ee?(K[F]||[])[z]:K[D];if(!(!ue||ue.t=="z"))if(ue.t=="n")he(P,23,te(F,z,Q,ue.v));else{var le=un(ue);he(P,22,I(F,z,Q,le.slice(0,239)))}}++Q}}return he(P,1),P.end()}function s(R){var H=G(2);return H.write_shift(2,R),H}function a(R){var H=G(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var N=0,P=0,Z=0,L=0;L<R.SheetNames.length;++L){var Q=R.SheetNames[L],K=R.Sheets[Q];if(!(!K||!K["!ref"])){++Z;var X=pr(K["!ref"]);N<X.e.r&&(N=X.e.r),P<X.e.c&&(P=X.e.c)}}return N>8191&&(N=8191),H.write_shift(2,N),H.write_shift(1,Z),H.write_shift(1,P),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(R,H,N){var P={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&N.qpro?(P.s.c=R.read_shift(1),R.l++,P.s.r=R.read_shift(2),P.e.c=R.read_shift(1),R.l++,P.e.r=R.read_shift(2),P):(P.s.c=R.read_shift(2),P.s.r=R.read_shift(2),H==12&&N.qpro&&(R.l+=2),P.e.c=R.read_shift(2),P.e.r=R.read_shift(2),H==12&&N.qpro&&(R.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(R){var H=G(8);return H.write_shift(2,R.s.c),H.write_shift(2,R.s.r),H.write_shift(2,R.e.c),H.write_shift(2,R.e.r),H}function c(R,H,N){var P=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(P[0].c=R.read_shift(1),P[3]=R.read_shift(1),P[0].r=R.read_shift(2),R.l+=2):(P[2]=R.read_shift(1),P[0].c=R.read_shift(2),P[0].r=R.read_shift(2)),P}function u(R,H,N){var P=R.l+H,Z=c(R,H,N);if(Z[1].t="s",N.vers==20768){R.l++;var L=R.read_shift(1);return Z[1].v=R.read_shift(L,"utf8"),Z}return N.qpro&&R.l++,Z[1].v=R.read_shift(P-R.l,"cstr"),Z}function f(R,H,N){var P=G(7+N.length);P.write_shift(1,255),P.write_shift(2,H),P.write_shift(2,R),P.write_shift(1,39);for(var Z=0;Z<P.length;++Z){var L=N.charCodeAt(Z);P.write_shift(1,L>=128?95:L)}return P.write_shift(1,0),P}function h(R,H,N){var P=c(R,H,N);return P[1].v=R.read_shift(2,"i"),P}function d(R,H,N){var P=G(7);return P.write_shift(1,255),P.write_shift(2,H),P.write_shift(2,R),P.write_shift(2,N,"i"),P}function g(R,H,N){var P=c(R,H,N);return P[1].v=R.read_shift(8,"f"),P}function p(R,H,N){var P=G(13);return P.write_shift(1,255),P.write_shift(2,H),P.write_shift(2,R),P.write_shift(8,N,"f"),P}function m(R,H,N){var P=R.l+H,Z=c(R,H,N);if(Z[1].v=R.read_shift(8,"f"),N.qpro)R.l=P;else{var L=R.read_shift(2);O(R.slice(R.l,R.l+L),Z),R.l+=L}return Z}function w(R,H,N){var P=H&32768;return H&=-32769,H=(P?R:0)+(H>=8192?H-16384:H),(P?"":"$")+(N?$t(H):Ft(H))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(R,H){or(R,0);for(var N=[],P=0,Z="",L="",Q="",K="";R.l<R.length;){var X=R[R.l++];switch(X){case 0:N.push(R.read_shift(8,"f"));break;case 1:L=w(H[0].c,R.read_shift(2),!0),Z=w(H[0].r,R.read_shift(2),!1),N.push(L+Z);break;case 2:{var Ee=w(H[0].c,R.read_shift(2),!0),E=w(H[0].r,R.read_shift(2),!1);L=w(H[0].c,R.read_shift(2),!0),Z=w(H[0].r,R.read_shift(2),!1),N.push(Ee+E+":"+L+Z)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(R.read_shift(2));break;case 6:{for(var C="";X=R[R.l++];)C+=String.fromCharCode(X);N.push('"'+C.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:K=N.pop(),Q=N.pop(),N.push(["AND","OR"][X-20]+"("+Q+","+K+")");break;default:if(X<32&&_[X])K=N.pop(),Q=N.pop(),N.push(Q+_[X]+K);else if(T[X]){if(P=T[X][1],P==69&&(P=R[R.l++]),P>N.length){console.error("WK1 bad formula parse 0x"+X.toString(16)+":|"+N.join("|")+"|");return}var F=N.slice(-P);N.length-=P,N.push(T[X][0]+"("+F.join(",")+")")}else return X<=7?console.error("WK1 invalid opcode "+X.toString(16)):X<=24?console.error("WK1 unsupported op "+X.toString(16)):X<=30?console.error("WK1 invalid opcode "+X.toString(16)):X<=115?console.error("WK1 unsupported function opcode "+X.toString(16)):console.error("WK1 unrecognized opcode "+X.toString(16))}}N.length==1?H[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function V(R){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=R.read_shift(2),H[3]=R[R.l++],H[0].c=R[R.l++],H}function ee(R,H){var N=V(R);return N[1].t="s",N[1].v=R.read_shift(H-4,"cstr"),N}function I(R,H,N,P){var Z=G(6+P.length);Z.write_shift(2,R),Z.write_shift(1,N),Z.write_shift(1,H),Z.write_shift(1,39);for(var L=0;L<P.length;++L){var Q=P.charCodeAt(L);Z.write_shift(1,Q>=128?95:Q)}return Z.write_shift(1,0),Z}function q(R,H){var N=V(R);N[1].v=R.read_shift(2);var P=N[1].v>>1;if(N[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return N[1].v=P,N}function M(R,H){var N=V(R),P=R.read_shift(4),Z=R.read_shift(4),L=R.read_shift(2);if(L==65535)return P===0&&Z===3221225472?(N[1].t="e",N[1].v=15):P===0&&Z===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var Q=L&32768;return L=(L&32767)-16446,N[1].v=(1-Q*2)*(Z*Math.pow(2,L+32)+P*Math.pow(2,L)),N}function te(R,H,N,P){var Z=G(14);if(Z.write_shift(2,R),Z.write_shift(1,N),Z.write_shift(1,H),P==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var L=0,Q=0,K=0,X=0;return P<0&&(L=1,P=-P),Q=Math.log2(P)|0,P/=Math.pow(2,Q-31),X=P>>>0,(X&2147483648)==0&&(P/=2,++Q,X=P>>>0),P-=X,X|=2147483648,X>>>=0,P*=Math.pow(2,32),K=P>>>0,Z.write_shift(4,K),Z.write_shift(4,X),Q+=16383+(L?32768:0),Z.write_shift(2,Q),Z}function ne(R,H){var N=M(R);return R.l+=H-14,N}function se(R,H){var N=V(R),P=R.read_shift(4);return N[1].v=P>>6,N}function de(R,H){var N=V(R),P=R.read_shift(8,"f");return N[1].v=P,N}function Be(R,H){var N=de(R);return R.l+=H-10,N}function Oe(R,H){return R[R.l+H-1]==0?R.read_shift(H,"cstr"):""}function Me(R,H){var N=R[R.l++];N>H-1&&(N=H-1);for(var P="";P.length<N;)P+=String.fromCharCode(R[R.l++]);return P}function be(R,H,N){if(!(!N.qpro||H<21)){var P=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var Z=R.read_shift(H-21,"cstr");return[P,Z]}}function Pe(R,H){for(var N={},P=R.l+H;R.l<P;){var Z=R.read_shift(2);if(Z==14e3){for(N[Z]=[0,""],N[Z][0]=R.read_shift(2);R[R.l];)N[Z][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return N}function Xe(R,H){var N=G(5+R.length);N.write_shift(2,14e3),N.write_shift(2,H);for(var P=0;P<R.length;++P){var Z=R.charCodeAt(P);N[N.l++]=Z>127?95:Z}return N[N.l++]=0,N}var ht={0:{n:"BOF",f:Np},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Oe},222:{n:"SHEETNAMELP",f:Me},65535:{n:""}},it={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ee},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:se},38:{n:"??"},39:{n:"NUMBER27",f:de},40:{n:"FORMULA28",f:Be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:be},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}})(),W2=/^\s|\s$|[\t\n\r]/;function jp(e,t){if(!t.bookSST)return"";var r=[_t];r[r.length]=fe("sst",null,{xmlns:ji[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(W2)&&(s+=' xml:space="preserve"'),s+=">"+Ge(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function V2(e){return[e.read_shift(4),e.read_shift(4)]}function K2(e,t){return t||(t=G(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var z2=Ly;function G2(e){var t=er();re(t,159,K2(e));for(var r=0;r<e.length;++r)re(t,19,z2(e[r]));return re(t,160),t.end()}function q2(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function $p(e){var t=0,r,n=q2(e),i=n.length+1,s,a,o,l,c;for(r=Yn(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=(t&16384)===0?0:1,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var X2=(function(){function e(i,s){switch(s.type){case"base64":return t(cn(i),s);case"binary":return t(i,s);case"buffer":return t(je&&Buffer.isBuffer(i)?i.toString("binary"):Ws(i),s);case"array":return t(Ro(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,g,p=-1;g=h.exec(u);){switch(g[0]){case"\\cell":var m=u.slice(d,h.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++p,m.length){var w={v:m,t:"s"};Array.isArray(o)?o[f][p]=w:o[qe({r:f,c:p})]=w}break}d=h.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=mt(c),o}function r(i,s){return Zn(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=nt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=qe({r:c,c:u});o=l?(i[c]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(un(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Qf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Y2=6,sn=Y2;function to(e){return Math.floor((e+Math.round(128/sn)/256)*sn)}function ro(e){return Math.floor((e-5)/sn*100+.5)/100}function Xl(e){return Math.round((e*sn+5)/sn*256)/256}function jc(e){e.width?(e.wpx=to(e.width),e.wch=ro(e.wpx),e.MDW=sn):e.wpx?(e.wch=ro(e.wpx),e.width=Xl(e.wch),e.MDW=sn):typeof e.wch=="number"&&(e.width=Xl(e.wch),e.wpx=to(e.width),e.MDW=sn),e.customWidth&&delete e.customWidth}var J2=96,Hp=J2;function no(e){return e*96/Hp}function Wp(e){return e*Hp/96}function Q2(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=fe("numFmt",null,{numFmtId:n,formatCode:Ge(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=fe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Z2(e){var t=[];return t[t.length]=fe("cellXfs",null),e.forEach(function(r){t[t.length]=fe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=fe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Vp(e,t){var r=[_t,fe("styleSheet",null,{xmlns:ji[0],"xmlns:vt":yt.vt})],n;return e.SSF&&(n=Q2(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Z2(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function eE(e,t){var r=e.read_shift(2),n=Ht(e);return[r,n]}function tE(e,t,r){r||(r=G(6+4*t.length)),r.write_shift(2,e),St(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function rE(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Wy(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Hy(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ht(e),n}function nE(e,t){t||(t=G(153)),t.write_shift(2,e.sz*20),Vy(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Za(e.color,t);var n=0;return n=2,t.write_shift(1,n),St(e.name,t),t.length>t.l?t.slice(0,t.l):t}var iE=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ll,sE=Kr;function Zf(e,t){t||(t=G(84)),ll||(ll=Oc(iE));var r=ll[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Za({auto:1},t),Za({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function aE(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function Kp(e,t,r){r||(r=G(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ts(e,t){return t||(t=G(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var oE=Kr;function lE(e,t){return t||(t=G(51)),t.write_shift(1,0),ts(null,t),ts(null,t),ts(null,t),ts(null,t),ts(null,t),t.length>t.l?t.slice(0,t.l):t}function cE(e,t){return t||(t=G(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Qa(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function uE(e,t,r){var n=G(2052);return n.write_shift(4,e),Qa(t,n),Qa(r,n),n.length>n.l?n.slice(0,n.l):n}function fE(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(re(e,615,Pr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&re(e,44,tE(i,t[i]))}),re(e,616))}}function hE(e){var t=1;re(e,611,Pr(t)),re(e,43,nE({sz:12,color:{theme:1},name:"Calibri",family:2})),re(e,612)}function dE(e){var t=2;re(e,603,Pr(t)),re(e,45,Zf({patternType:"none"})),re(e,45,Zf({patternType:"gray125"})),re(e,604)}function pE(e){var t=1;re(e,613,Pr(t)),re(e,46,lE()),re(e,614)}function gE(e){var t=1;re(e,626,Pr(t)),re(e,47,Kp({numFmtId:0},65535)),re(e,627)}function mE(e,t){re(e,617,Pr(t.length)),t.forEach(function(r){re(e,47,Kp(r,0))}),re(e,618)}function vE(e){var t=1;re(e,619,Pr(t)),re(e,48,cE({xfId:0,name:"Normal"})),re(e,620)}function _E(e){var t=0;re(e,505,Pr(t)),re(e,506)}function xE(e){var t=0;re(e,508,uE(t,"TableStyleMedium9","PivotStyleMedium4")),re(e,509)}function wE(e,t){var r=er();return re(r,278),fE(r,e.SSF),hE(r),dE(r),pE(r),gE(r),mE(r,t.cellXfs),vE(r),_E(r),xE(r),re(r,279),r.end()}function zp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[_t];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yE(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ht(e)}}function EE(e){var t=G(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),St(e.name,t),t.slice(0,t.l)}function TE(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function SE(e){var t=G(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function bE(e,t){var r=G(8+2*t.length);return r.write_shift(4,e),St(t,r),r.slice(0,r.l)}function AE(e){return e.l+=4,e.read_shift(4)!=0}function kE(e,t){var r=G(8);return r.write_shift(4,e),r.write_shift(4,1),r}function OE(){var e=er();return re(e,332),re(e,334,Pr(1)),re(e,335,EE({name:"XLDAPR",version:12e4,flags:3496657072})),re(e,336),re(e,339,bE(1,"XLDAPR")),re(e,52),re(e,35,Pr(514)),re(e,4096,Pr(0)),re(e,4097,vr(1)),re(e,36),re(e,53),re(e,340),re(e,337,kE(1)),re(e,51,SE([[1,0]])),re(e,338),re(e,333),e.end()}function Gp(){var e=[_t];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function CE(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=qe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var vi=1024;function qp(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[fe("xml",null,{"xmlns:v":cr.v,"xmlns:o":cr.o,"xmlns:x":cr.x,"xmlns:mv":cr.mv}).replace(/\/>/,">"),fe("o:shapelayout",fe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),fe("v:shapetype",[fe("v:stroke",null,{joinstyle:"miter"}),fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];vi<e*1e3;)vi+=1e3;return t.forEach(function(s){var a=Tt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=fe("v:fill",l,o),u={on:"t",obscured:"t"};++vi,i=i.concat(["<v:shape"+Ps({id:"_x0000_s"+vi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,fe("v:shadow",null,u),fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",It("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),It("x:AutoFill","False"),It("x:Row",String(a.r)),It("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Xp(e){var t=[_t,fe("comments",null,{xmlns:ji[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Ge(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Ge(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(It("t",Ge(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(It("t",Ge(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function RE(e,t,r){var n=[_t,fe("ThreadedComments",null,{xmlns:yt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(fe("threadedComment",It("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function IE(e){var t=[_t,fe("personList",null,{xmlns:yt.TCMNT,"xmlns:x":ji[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(fe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function FE(e){var t={};t.iauthor=e.read_shift(4);var r=ni(e);return t.rfx=r.s,t.ref=qe(r.s),e.l+=16,t}function PE(e,t){return t==null&&(t=G(36)),t.write_shift(4,e[1].iauthor),Hi(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var NE=Ht;function DE(e){return St(e.slice(0,54))}function LE(e){var t=er(),r=[];return re(t,628),re(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),re(t,632,DE(i.a)))})}),re(t,631),re(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Tt(n[0]),e:Tt(n[0])};re(t,635,PE([s,i])),i.t&&i.t.length>0&&re(t,637,By(i)),re(t,636),delete i.iauthor})}),re(t,634),re(t,629),t.end()}function ME(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ye.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var Yp=["xlsb","xlsm","xlam","biff8","xla"],BE=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+$t(u)+(l?"":"$")+Ft(c)}return function(i,s){return t=s,i.replace(e,r)}})(),$c=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hc=(function(){return function(t,r){return t.replace($c,function(n,i,s,a,o,l){var c=Dc(a)-(s?0:r.c),u=Nc(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+h})}})();function UE(e,t){return e.replace($c,function(r,n,i,s,a,o){return n+(i=="$"?i+s:$t(Dc(s)+t.c))+(a=="$"?a+o:Ft(Nc(o)+t.r))})}function jE(e){return e.length!=1}function dt(e){e.l+=1}function On(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Jp(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Qp(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=On(e),o=On(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Qp(e){var t=On(e),r=On(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function $E(e,t,r){if(r.biff<8)return Qp(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=On(e),a=On(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Zp(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return HE(e);var n=e.read_shift(r&&r.biff==12?4:2),i=On(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function HE(e){var t=On(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function WE(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function VE(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return KE(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function KE(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function zE(e,t,r){var n=(e[e.l++]&96)>>5,i=Jp(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function GE(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=Jp(e,s,r);return[n,i,a]}function qE(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function XE(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function YE(e,t,r){var n=(e[e.l++]&96)>>5,i=$E(e,t-1,r);return[n,i]}function JE(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function e0(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function QE(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function ZE(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function eT(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function tT(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function rT(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function e1(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function nT(e){return e.read_shift(2),e1(e)}function iT(e){return e.read_shift(2),e1(e)}function sT(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Zp(e,0,r);return[n,i]}function aT(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=VE(e,0,r);return[n,i]}function oT(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Zp(e,0,r);return[n,i,s]}function lT(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[lS[i],n1[i],n]}function cT(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:uT(e);return[i,(s[0]===0?n1:oS)[s[1]]]}function uT(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function fT(e,t,r){e.l+=r&&r.biff==2?3:4}function hT(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function dT(e){return e.l++,zs[e.read_shift(1)]}function pT(e){return e.l++,e.read_shift(2)}function gT(e){return e.l++,e.read_shift(1)!==0}function mT(e){return e.l++,Wi(e)}function vT(e,t,r){return e.l++,Lp(e,t-1,r)}function _T(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=o2(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wi(e);break;case 2:r[1]=f2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function xT(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ni:p2)(e));return i}function wT(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=_T(e,r.biff);return a}function yT(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function ET(e,t,r){if(r.biff==5)return TT(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function TT(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function ST(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function bT(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function AT(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function kT(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var OT=Kr,CT=Kr,RT=Kr;function Gs(e,t,r){return e.l+=2,[WE(e)]}function Wc(e){return e.l+=6,[]}var IT=Gs,FT=Wc,PT=Wc,NT=Gs;function t1(e){return e.l+=2,[Np(e),e.read_shift(2)&1]}var DT=Gs,LT=t1,MT=Wc,BT=Gs,UT=Gs,jT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $T(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=jT[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function HT(e){return e.l+=2,[e.read_shift(4)]}function WT(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function VT(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function KT(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function zT(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function GT(e){return e.l+=4,[0,0]}var t0={1:{n:"PtgExp",f:hT},2:{n:"PtgTbl",f:RT},3:{n:"PtgAdd",f:dt},4:{n:"PtgSub",f:dt},5:{n:"PtgMul",f:dt},6:{n:"PtgDiv",f:dt},7:{n:"PtgPower",f:dt},8:{n:"PtgConcat",f:dt},9:{n:"PtgLt",f:dt},10:{n:"PtgLe",f:dt},11:{n:"PtgEq",f:dt},12:{n:"PtgGe",f:dt},13:{n:"PtgGt",f:dt},14:{n:"PtgNe",f:dt},15:{n:"PtgIsect",f:dt},16:{n:"PtgUnion",f:dt},17:{n:"PtgRange",f:dt},18:{n:"PtgUplus",f:dt},19:{n:"PtgUminus",f:dt},20:{n:"PtgPercent",f:dt},21:{n:"PtgParen",f:dt},22:{n:"PtgMissArg",f:dt},23:{n:"PtgStr",f:vT},26:{n:"PtgSheet",f:WT},27:{n:"PtgEndSheet",f:VT},28:{n:"PtgErr",f:dT},29:{n:"PtgBool",f:gT},30:{n:"PtgInt",f:pT},31:{n:"PtgNum",f:mT},32:{n:"PtgArray",f:JE},33:{n:"PtgFunc",f:lT},34:{n:"PtgFuncVar",f:cT},35:{n:"PtgName",f:yT},36:{n:"PtgRef",f:sT},37:{n:"PtgArea",f:zE},38:{n:"PtgMemArea",f:ST},39:{n:"PtgMemErr",f:OT},40:{n:"PtgMemNoMem",f:CT},41:{n:"PtgMemFunc",f:bT},42:{n:"PtgRefErr",f:AT},43:{n:"PtgAreaErr",f:qE},44:{n:"PtgRefN",f:aT},45:{n:"PtgAreaN",f:YE},46:{n:"PtgMemAreaN",f:KT},47:{n:"PtgMemNoMemN",f:zT},57:{n:"PtgNameX",f:ET},58:{n:"PtgRef3d",f:oT},59:{n:"PtgArea3d",f:GE},60:{n:"PtgRefErr3d",f:kT},61:{n:"PtgAreaErr3d",f:XE},255:{}},qT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},XT={1:{n:"PtgElfLel",f:t1},2:{n:"PtgElfRw",f:BT},3:{n:"PtgElfCol",f:IT},6:{n:"PtgElfRwV",f:UT},7:{n:"PtgElfColV",f:NT},10:{n:"PtgElfRadical",f:DT},11:{n:"PtgElfRadicalS",f:MT},13:{n:"PtgElfColS",f:FT},15:{n:"PtgElfColSV",f:PT},16:{n:"PtgElfRadicalLel",f:LT},25:{n:"PtgList",f:$T},29:{n:"PtgSxName",f:HT},255:{}},YT={0:{n:"PtgAttrNoop",f:GT},1:{n:"PtgAttrSemi",f:rT},2:{n:"PtgAttrIf",f:eT},4:{n:"PtgAttrChoose",f:QE},8:{n:"PtgAttrGoto",f:ZE},16:{n:"PtgAttrSum",f:fT},32:{n:"PtgAttrBaxcel",f:e0},33:{n:"PtgAttrBaxcel",f:e0},64:{n:"PtgAttrSpace",f:nT},65:{n:"PtgAttrSpaceSemi",f:iT},128:{n:"PtgAttrIfError",f:tT},255:{}};function JT(e,t,r,n){if(n.biff<8)return Kr(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=wT(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=xT(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Kr(e,t)),s}function QT(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=t0[s]||t0[qT[s]],(s===24||s===25)&&(i=(s===24?XT:YT)[e[e.l+1]]),!i||!i.f?Kr(e,t):a.push([i.n,i.f(e,t,r)]);return a}function ZT(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var eS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tS(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function r1(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function r0(e,t,r){var n=r1(e,t,r);return n=="#REF"?n:tS(n,r)}function Li(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,f=0,h=0,d,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",w=0,T=e[0].length;w<T;++w){var _=e[0][w];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=ut(" ",e[0][p][1][1]);break;case 1:m=ut("\r",e[0][p][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+m,p=-1}o.push(c+eS[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=_s(_[1][1],a,i),o.push(xs(u,s));break;case"PtgRefN":u=r?_s(_[1][1],r,i):_[1][1],o.push(xs(u,s));break;case"PtgRef3d":f=_[1][1],u=_s(_[1][2],a,i),g=r0(n,f,i),o.push(g+"!"+xs(u,s));break;case"PtgFunc":case"PtgFuncVar":var O=_[1][0],V=_[1][1];O||(O=0),O&=127;var ee=O==0?[]:o.slice(-O);o.length-=O,V==="User"&&(V=ee.shift()),o.push(V+"("+ee.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":d=jf(_[1][1],r?{s:r}:a,i),o.push(al(d,i));break;case"PtgArea":d=jf(_[1][1],a,i),o.push(al(d,i));break;case"PtgArea3d":f=_[1][1],d=_[1][2],g=r0(n,f,i),o.push(g+"!"+al(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=_[1][2];var I=(n.names||[])[h-1]||(n[0]||[])[h],q=I?I.Name:"SH33TJSNAME"+String(h);q&&q.slice(0,6)=="_xlfn."&&!i.xlfn&&(q=q.slice(6)),o.push(q);break;case"PtgNameX":var M=_[1][1];h=_[1][2];var te;if(i.biff<=5)M<0&&(M=-M),n[M]&&(te=n[M][h]);else{var ne="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][h]&&n[M][h].itab>0&&(ne=n.SheetNames[n[M][h].itab-1]+"!"):ne=n.SheetNames[h-1]+"!"),n[M]&&n[M][h])ne+=n[M][h].Name;else if(n[0]&&n[0][h])ne+=n[0][h].Name;else{var se=(r1(n,M,i)||"").split(";;");se[h-1]?ne=se[h-1]:ne+="SH33TJSERRX"}o.push(ne);break}te||(te={Name:"SH33TJSERRY"}),o.push(te.Name);break;case"PtgParen":var de="(",Be=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:de=ut(" ",e[0][p][1][1])+de;break;case 3:de=ut("\r",e[0][p][1][1])+de;break;case 4:Be=ut(" ",e[0][p][1][1])+Be;break;case 5:Be=ut("\r",e[0][p][1][1])+Be;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(de+o.pop()+Be);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var Oe={c:r.c,r:r.r};if(n.sharedf[qe(u)]){var Me=n.sharedf[qe(u)];o.push(Li(Me,a,Oe,n,i))}else{var be=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Li(c[1],a,Oe,n,i)),be=!0;break}be||o.push(_[1])}break;case"PtgArray":o.push("{"+ZT(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&Pe.indexOf(e[0][w][0])==-1){_=e[0][p];var Xe=!0;switch(_[1][0]){case 4:Xe=!1;case 0:m=ut(" ",_[1][1]);break;case 5:Xe=!1;case 1:m=ut("\r",_[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Xe?m:"")+o.pop()+(Xe?"":m)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function rS(e){if(e==null){var t=G(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Jn(e);return Jn(0)}function nS(e,t,r,n,i){var s=Qn(t,r,i),a=rS(e.v),o=G(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=G(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var f=Rt([s,a,o,c]);return f}function Io(e,t,r){var n=e.read_shift(4),i=QT(e,n,r),s=e.read_shift(4),a=s>0?JT(e,s,i,r):null;return[i,a]}var iS=Io,Fo=Io,sS=Io,aS=Io,oS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},n1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cS(e){var t="of:="+e.replace($c,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function uS(e){return e.replace(/\./,"!")}var ws=typeof Map<"u";function Vc(e,t,r){var n=0,i=e.length;if(r){if(ws?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=ws?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(ws?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Po(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(sn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ro(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Xl(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function i1(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function In(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Zd(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function fS(e,t,r){if(e&&e["!ref"]){var n=nt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function hS(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+mt(e[r])+'"/>';return t+"</mergeCells>"}function dS(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Fs(Ge(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+fe("outlinePr",null,c)}!s&&!o||(i[i.length]=fe("sheetPr",o,a))}var pS=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gS=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function mS(e){var t={sheet:1};return pS.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),gS.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=$p(e.password).toString(16).toUpperCase()),fe("sheetProtection",null,t)}function vS(e){return i1(e),fe("pageMargins",null,e)}function _S(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=fe("col",null,Po(i,n)));return r[r.length]="</cols>",r.join("")}function xS(e,t,r,n){var i=typeof e.ref=="string"?e.ref:mt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=pr(i);a.s.r==a.e.r&&(a.e.r=pr(t["!ref"]).e.r,i=mt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),fe("autoFilter",null,{ref:i})}function wS(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),fe("sheetViews",fe("sheetView",null,i),{})}function yS(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=zs[e.v];break;case"d":n&&n.cellDates?i=Xt(e.v,-1).toISOString():(e=rr(e),e.t="n",i=""+(e.v=tr(Xt(e.v)))),typeof e.z>"u"&&(e.z=ft[14]);break;default:i=e.v;break}var o=It("v",Ge(i)),l={r:t},c=In(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=It("v",""+Vc(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=fe("f",Ge(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),fe("c",o,l)}function ES(e,t,r,n){var i=[],s=[],a=nt(e["!ref"]),o="",l,c="",u=[],f=0,h=0,d=e["!rows"],g=Array.isArray(e),p={r:c},m,w=-1;for(h=a.s.c;h<=a.e.c;++h)u[h]=$t(h);for(f=a.s.r;f<=a.e.r;++f){for(s=[],c=Ft(f),h=a.s.c;h<=a.e.c;++h){l=u[h]+c;var T=g?(e[f]||[])[h]:e[l];T!==void 0&&(o=yS(T,l,e,t))!=null&&s.push(o)}(s.length>0||d&&d[f])&&(p={r:c},d&&d[f]&&(m=d[f],m.hidden&&(p.hidden=1),w=-1,m.hpx?w=no(m.hpx):m.hpt&&(w=m.hpt),w>-1&&(p.ht=w,p.customHeight=1),m.level&&(p.outlineLevel=m.level)),i[i.length]=fe("row",s.join(""),p))}if(d)for(;f<d.length;++f)d&&d[f]&&(p={r:f+1},m=d[f],m.hidden&&(p.hidden=1),w=-1,m.hpx?w=no(m.hpx):m.hpt&&(w=m.hpt),w>-1&&(p.ht=w,p.customHeight=1),m.level&&(p.outlineLevel=m.level),i[i.length]=fe("row","",p));return i.join("")}function s1(e,t,r,n){var i=[_t,fe("worksheet",null,{xmlns:ji[0],"xmlns:r":yt.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=nt(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=mt(u)}n||(n={}),l["!comments"]=[];var f=[];dS(l,r,e,t,i),i[i.length]=fe("dimension",null,{ref:c}),i[i.length]=wS(l,t,e,r),t.sheetFormat&&(i[i.length]=fe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=_S(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=ES(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=mS(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=xS(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=hS(l["!merges"]));var h=-1,d,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=ze(n,-1,Ge(p[1].Target).replace(/#.*$/,""),Ue.HLINK),d["r:id"]="rId"+g),(h=p[1].Target.indexOf("#"))>-1&&(d.location=Ge(p[1].Target.slice(h+1))),p[1].Tooltip&&(d.tooltip=Ge(p[1].Tooltip)),i[i.length]=fe("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=vS(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=It("ignoredErrors",fe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(g=ze(n,-1,"../drawings/drawing"+(e+1)+".xml",Ue.DRAW),i[i.length]=fe("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=f),l["!comments"].length>0&&(g=ze(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ue.VML),i[i.length]=fe("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function TS(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function SS(e,t,r){var n=G(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=no(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[qe(c)];g&&(f<0&&(f=d),h=d)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function bS(e,t,r,n){var i=SS(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&re(e,0,i)}var AS=ni,kS=Hi;function OS(){}function CS(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Uy(e),r}function RS(e,t,r){r==null&&(r=G(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Za({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),wp(e,r),r.slice(0,r.l)}function IS(e){var t=yr(e);return[t]}function FS(e,t,r){return r==null&&(r=G(8)),ei(t,r)}function PS(e){var t=ti(e);return[t]}function NS(e,t,r){return r==null&&(r=G(4)),ri(t,r)}function DS(e){var t=yr(e),r=e.read_shift(1);return[t,r,"b"]}function LS(e,t,r){return r==null&&(r=G(9)),ei(t,r),r.write_shift(1,e.v?1:0),r}function MS(e){var t=ti(e),r=e.read_shift(1);return[t,r,"b"]}function BS(e,t,r){return r==null&&(r=G(5)),ri(t,r),r.write_shift(1,e.v?1:0),r}function US(e){var t=yr(e),r=e.read_shift(1);return[t,r,"e"]}function jS(e,t,r){return r==null&&(r=G(9)),ei(t,r),r.write_shift(1,e.v),r}function $S(e){var t=ti(e),r=e.read_shift(1);return[t,r,"e"]}function HS(e,t,r){return r==null&&(r=G(8)),ri(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function WS(e){var t=yr(e),r=e.read_shift(4);return[t,r,"s"]}function VS(e,t,r){return r==null&&(r=G(12)),ei(t,r),r.write_shift(4,t.v),r}function KS(e){var t=ti(e),r=e.read_shift(4);return[t,r,"s"]}function zS(e,t,r){return r==null&&(r=G(8)),ri(t,r),r.write_shift(4,t.v),r}function GS(e){var t=yr(e),r=Wi(e);return[t,r,"n"]}function qS(e,t,r){return r==null&&(r=G(16)),ei(t,r),Jn(e.v,r),r}function XS(e){var t=ti(e),r=Wi(e);return[t,r,"n"]}function YS(e,t,r){return r==null&&(r=G(12)),ri(t,r),Jn(e.v,r),r}function JS(e){var t=yr(e),r=yp(e);return[t,r,"n"]}function QS(e,t,r){return r==null&&(r=G(12)),ei(t,r),Ep(e.v,r),r}function ZS(e){var t=ti(e),r=yp(e);return[t,r,"n"]}function eb(e,t,r){return r==null&&(r=G(8)),ri(t,r),Ep(e.v,r),r}function tb(e){var t=yr(e),r=Lc(e);return[t,r,"is"]}function rb(e){var t=yr(e),r=Ht(e);return[t,r,"str"]}function nb(e,t,r){return r==null&&(r=G(12+4*e.v.length)),ei(t,r),St(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ib(e){var t=ti(e),r=Ht(e);return[t,r,"str"]}function sb(e,t,r){return r==null&&(r=G(8+4*e.v.length)),ri(t,r),St(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ab(e,t,r){var n=e.l+t,i=yr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Fo(e,n-e.l,r);a[3]=Li(o,null,i,r.supbooks,r)}else e.l=n;return a}function ob(e,t,r){var n=e.l+t,i=yr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Fo(e,n-e.l,r);a[3]=Li(o,null,i,r.supbooks,r)}else e.l=n;return a}function lb(e,t,r){var n=e.l+t,i=yr(e);i.r=r["!row"];var s=Wi(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Fo(e,n-e.l,r);a[3]=Li(o,null,i,r.supbooks,r)}else e.l=n;return a}function cb(e,t,r){var n=e.l+t,i=yr(e);i.r=r["!row"];var s=Ht(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Fo(e,n-e.l,r);a[3]=Li(o,null,i,r.supbooks,r)}else e.l=n;return a}var ub=ni,fb=Hi;function hb(e,t){return t==null&&(t=G(4)),t.write_shift(4,e),t}function db(e,t){var r=e.l+t,n=ni(e),i=Mc(e),s=Ht(e),a=Ht(e),o=Ht(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function pb(e,t){var r=G(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Hi({s:Tt(e[0]),e:Tt(e[0])},r),Bc("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return St(i||"",r),St(e[1].Tooltip||"",r),St("",r),r.slice(0,r.l)}function gb(){}function mb(e,t,r){var n=e.l+t,i=Tp(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=iS(e,n-e.l,r);a[1]=o}else e.l=n;return a}function vb(e,t,r){var n=e.l+t,i=ni(e),s=[i];if(r.cellFormula){var a=aS(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function _b(e,t,r){r==null&&(r=G(18));var n=Po(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var a1=["left","right","top","bottom","header","footer"];function xb(e){var t={};return a1.forEach(function(r){t[r]=Wi(e)}),t}function wb(e,t){return t==null&&(t=G(48)),i1(e),a1.forEach(function(r){Jn(e[r],t)}),t}function yb(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Eb(e,t,r){r==null&&(r=G(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Tb(e){var t=G(24);return t.write_shift(4,4),t.write_shift(4,1),Hi(e,t),t}function Sb(e,t){return t==null&&(t=G(66)),t.write_shift(2,e.password?$p(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function bb(){}function Ab(){}function kb(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=rr(t),t.z=t.z||ft[14],t.v=tr(Xt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=In(i.cellXfs,t,i),t.l&&s["!links"].push([qe(l),t.l]),t.c&&s["!comments"].push([qe(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Vc(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?re(e,18,zS(t,l)):re(e,7,VS(t,l))):(l.t="str",a?re(e,17,sb(t,l)):re(e,6,nb(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?re(e,13,eb(t,l)):re(e,2,QS(t,l)):a?re(e,16,YS(t,l)):re(e,5,qS(t,l)),!0;case"b":return l.t="b",a?re(e,15,BS(t,l)):re(e,4,LS(t,l)),!0;case"e":return l.t="e",a?re(e,14,HS(t,l)):re(e,3,jS(t,l)),!0}return a?re(e,12,NS(t,l)):re(e,1,FS(t,l)),!0}function Ob(e,t,r,n){var i=nt(t["!ref"]||"A1"),s,a="",o=[];re(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){a=Ft(u),bS(e,t,i,u);var f=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(o[h]=$t(h)),s=o[h]+a;var d=l?(t[u]||[])[h]:t[s];if(!d){f=!1;continue}f=kb(e,d,u,h,n,t,f)}}re(e,146)}function Cb(e,t){!t||!t["!merges"]||(re(e,177,hb(t["!merges"].length)),t["!merges"].forEach(function(r){re(e,176,fb(r))}),re(e,178))}function Rb(e,t){!t||!t["!cols"]||(re(e,390),t["!cols"].forEach(function(r,n){r&&re(e,60,_b(n,r))}),re(e,391))}function Ib(e,t){!t||!t["!ref"]||(re(e,648),re(e,649,Tb(nt(t["!ref"]))),re(e,650))}function Fb(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=ze(r,-1,n[1].Target.replace(/#.*$/,""),Ue.HLINK);re(e,494,pb(n,i))}}),delete t["!links"]}function Pb(e,t,r,n){if(t["!comments"].length>0){var i=ze(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ue.VML);re(e,551,Bc("rId"+i)),t["!legacy"]=i}}function Nb(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:mt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=pr(s);o.s.r==o.e.r&&(o.e.r=pr(t["!ref"]).e.r,s=mt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),re(e,161,Hi(nt(s))),re(e,162)}}function Db(e,t,r){re(e,133),re(e,137,Eb(t,r)),re(e,138),re(e,134)}function Lb(e,t){t["!protect"]&&re(e,535,Sb(t["!protect"]))}function Mb(e,t,r,n){var i=er(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=nt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],re(i,129),(r.vbaraw||a["!outline"])&&re(i,147,RS(o,a["!outline"])),re(i,148,kS(l)),Db(i,a,r.Workbook),Rb(i,a),Ob(i,a,e,t),Lb(i,a),Nb(i,a,r,e),Cb(i,a),Fb(i,a,n),a["!margins"]&&re(i,476,wb(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Ib(i,a),Pb(i,a,e,n),re(i,130),i.end()}function Bb(e,t){e.l+=10;var r=Ht(e);return{name:r}}var Ub=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function jb(e){return!e.Workbook||!e.Workbook.WBProps?"false":vy(e.Workbook.WBProps.date1904)?"true":"false"}var $b="][*?/\\".split("");function o1(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $b.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Hb(e,t,r){e.forEach(function(n,i){o1(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Hb(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)fS(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function l1(e){var t=[_t];t[t.length]=fe("workbook",null,{xmlns:ji[0],"xmlns:r":yt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ub.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=fe("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:Ge(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=fe("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=fe("definedName",Ge(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Vb(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ql(e),r.name=Ht(e),r}function Kb(e,t){return t||(t=G(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Bc(e.strRelID,t),St(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function zb(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Ht(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Gb(e,t){t||(t=G(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),wp(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function qb(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=jy(e),a=sS(e,0,r),o=Mc(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function Xb(e,t){re(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};re(e,156,Kb(i))}re(e,144)}function Yb(e,t){t||(t=G(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return St("SheetJS",t),St(Ka.version,t),St(Ka.version,t),St("7262",t),t.length>t.l?t.slice(0,t.l):t}function Jb(e,t){t||(t=G(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Qb(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(re(e,135),re(e,158,Jb(i)),re(e,136))}}function Zb(e,t){var r=er();return re(r,131),re(r,128,Yb()),re(r,153,Gb(e.Workbook&&e.Workbook.WBProps||null)),Qb(r,e),Xb(r,e),re(r,132),r.end()}function eA(e,t,r){return(t.slice(-4)===".bin"?Zb:l1)(e)}function tA(e,t,r,n,i){return(t.slice(-4)===".bin"?Mb:s1)(e,r,n,i)}function rA(e,t,r){return(t.slice(-4)===".bin"?wE:Vp)(e,r)}function nA(e,t,r){return(t.slice(-4)===".bin"?G2:jp)(e,r)}function iA(e,t,r){return(t.slice(-4)===".bin"?LE:Xp)(e)}function sA(e){return(e.slice(-4)===".bin"?OE:Gp)()}function aA(e,t){var r=[];return e.Props&&r.push(r2(e.Props,t)),e.Custprops&&r.push(n2(e.Props,e.Custprops)),r.join("")}function oA(){return""}function lA(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(fe("NumberFormat",null,{"ss:Format":Ge(ft[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(fe("Style",s.join(""),a))}),fe("Styles",r.join(""))}function c1(e){return fe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Hc(e.Ref,{r:0,c:0})})}function cA(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(c1(i)))}return fe("Names",r.join(""))}function uA(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(c1(o)))}return s.join("")}function fA(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(fe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(fe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(fe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(fe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(It("ProtectContents","True")),e["!protect"].objects&&i.push(It("ProtectObjects","True")),e["!protect"].scenarios&&i.push(It("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(It("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(It("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":fe("WorksheetOptions",i.join(""),{xmlns:cr.x})}function hA(e){return e.map(function(t){var r=my(t.t||""),n=fe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return fe("Comment",n,{"ss:Author":t.a})}).join("")}function dA(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ge(Hc(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=Tt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ge(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ge(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=zs[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ft[14]);break;case"s":f="String",h=gy(e.v||"");break}var d=In(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var g=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=hA(e.c)),fe("Cell",p,o)}function pA(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Wp(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gA(e,t,r,n){if(!e["!ref"])return"";var i=nt(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(m,w){jc(m);var T=!!m.width,_=Po(w,m),O={"ss:Index":w+1};T&&(O["ss:Width"]=to(_.width)),m.hidden&&(O["ss:Hidden"]="1"),o.push(fe("Column",null,O))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[pA(c,(e["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>c)&&!(s[a].e.c<f)&&!(s[a].e.r<c)){(s[a].s.c!=f||s[a].s.r!=c)&&(h=!0);break}if(!h){var d={r:c,c:f},g=qe(d),p=l?(e[c]||[])[f]:e[g];u.push(dA(p,g,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function mA(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?uA(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?gA(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(fA(s,t,e,r)),n.join("")}function vA(e,t){t||(t={}),e.SSF||(e.SSF=rr(ft)),e.SSF&&(Oo(),ko(e.SSF),t.revssf=Co(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],In(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(aA(e,t)),r.push(oA()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(fe("Worksheet",mA(n,t,e),{"ss:Name":Ge(e.SheetNames[n])}));return r[2]=lA(e,t),r[3]=cA(e),_t+fe("Workbook",r.join(""),{xmlns:cr.ss,"xmlns:o":cr.o,"xmlns:x":cr.x,"xmlns:ss":cr.ss,"xmlns:dt":cr.dt,"xmlns:html":cr.html})}var cl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _A(e,t){var r=[],n=[],i=[],s=0,a,o=Cf(Hf,"n"),l=Cf(Wf,"n");if(e.Props)for(a=Pt(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=Pt(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)Pp.indexOf(i[s][0])>-1||Rp.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Ye.utils.cfb_add(t,"/SummaryInformation",qf(n,cl.SI,l,Wf)),(r.length||c.length)&&Ye.utils.cfb_add(t,"/DocumentSummaryInformation",qf(r,cl.DSI,o,Hf,c.length?c:null,cl.UDI))}function xA(e,t){var r=t||{},n=Ye.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ye.utils.cfb_add(n,i,u1(e,r)),r.biff==8&&(e.Props||e.Custprops)&&_A(e,n),r.biff==8&&e.vbaraw&&ME(n,Ye.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var wA={0:{f:TS},1:{f:IS},2:{f:JS},3:{f:US},4:{f:DS},5:{f:GS},6:{f:rb},7:{f:WS},8:{f:cb},9:{f:lb},10:{f:ab},11:{f:ob},12:{f:PS},13:{f:ZS},14:{f:$S},15:{f:MS},16:{f:XS},17:{f:ib},18:{f:KS},19:{f:Lc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:qb},40:{},42:{},43:{f:rE},44:{f:eE},45:{f:sE},46:{f:oE},47:{f:aE},48:{},49:{f:Py},50:{},51:{f:TE},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:N2},62:{f:tb},63:{f:CE},64:{f:bb},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yb},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CS},148:{f:AS,p:16},151:{f:gb},152:{},153:{f:zb},154:{},155:{},156:{f:Vb},157:{},158:{},159:{T:1,f:V2},160:{T:-1},161:{T:1,f:ni},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ub},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:yE},336:{T:-1},337:{f:AE,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ql},357:{},358:{},359:{},360:{T:1},361:{},362:{f:O2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mb},427:{f:vb},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xb},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:OS},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:db},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ql},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:NE},633:{T:1},634:{T:-1},635:{T:1,f:FE},636:{T:-1},637:{f:My},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Bb},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ab},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function he(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Pc(r)&&e.push(r)}}function yA(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return he(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function qs(e,t,r){return e||(e=G(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function EA(e,t,r,n){var i=G(9);return qs(i,e,t),Dp(r,n||"b",i),i}function TA(e,t,r){var n=G(8+2*r.length);return qs(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function SA(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?tr(Xt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?he(e,2,B2(r,n,i)):he(e,3,M2(r,n,i));return;case"b":case"e":he(e,5,EA(r,n,t.v,t.t));return;case"s":case"str":he(e,4,TA(r,n,(t.v||"").slice(0,255)));return}he(e,1,qs(null,r,n))}function bA(e,t,r,n){var i=Array.isArray(t),s=nt(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=mt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Ft(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=$t(u)),a=l[u]+o;var f=i?(t[c]||[])[u]:t[a];f&&SA(e,f,c,u)}}}function AA(e,t){for(var r=t||{},n=er(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return he(n,r.biff==4?1033:r.biff==3?521:9,Uc(e,16,r)),bA(n,e.Sheets[e.SheetNames[i]],i,r),he(n,10),n.end()}function kA(e,t,r){he(e,49,w2({sz:12,name:"Arial"},r))}function OA(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&he(e,1054,T2(i,t[i],r))})}function CA(e,t){var r=G(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),he(e,2151,r),r=G(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Bp(nt(t["!ref"]||"A1"),r),r.write_shift(4,4),he(e,2152,r)}function RA(e,t){for(var r=0;r<16;++r)he(e,224,Yf({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){he(e,224,Yf(n,0,t))})}function IA(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];he(e,440,I2(n)),n[1].Tooltip&&he(e,2048,F2(n))}delete t["!links"]}function FA(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&he(e,125,D2(Po(i,n),i))})}}function PA(e,t,r,n,i){var s=16+In(i.cellXfs,t,i);if(t.v==null&&!t.bf){he(e,513,Qn(r,n,s));return}if(t.bf)he(e,6,nS(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?tr(Xt(t.v)):t.v;he(e,515,k2(r,n,a,s));break;case"b":case"e":he(e,517,A2(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Vc(i.Strings,t.v,i.revStrings);he(e,253,y2(r,n,o,s))}else he(e,516,E2(r,n,(t.v||"").slice(0,255),s,i));break;default:he(e,513,Qn(r,n,s))}}function NA(e,t,r){var n=er(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,f="",h=[],d=nt(s["!ref"]||"A1"),g=c?65536:16384;if(d.e.c>255||d.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}he(n,2057,Uc(r,16,t)),he(n,13,vr(1)),he(n,12,vr(100)),he(n,15,Gt(!0)),he(n,17,Gt(!1)),he(n,16,Jn(.001)),he(n,95,Gt(!0)),he(n,42,Gt(!1)),he(n,43,Gt(!1)),he(n,130,vr(1)),he(n,128,b2()),he(n,131,Gt(!1)),he(n,132,Gt(!1)),c&&FA(n,s["!cols"]),he(n,512,S2(d,t)),c&&(s["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){f=Ft(p);for(var m=d.s.c;m<=d.e.c;++m){p===d.s.r&&(h[m]=$t(m)),u=h[m]+f;var w=l?(s[p]||[])[m]:s[u];w&&(PA(n,w,p,m,t),c&&w.l&&s["!links"].push([u,w.l]))}}var T=o.CodeName||o.name||i;return c&&he(n,574,x2((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&he(n,229,R2(s["!merges"])),c&&IA(n,s),he(n,442,Mp(T)),c&&CA(n,s),he(n,10),n.end()}function DA(e,t,r){var n=er(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(he(n,2057,Uc(e,5,r)),r.bookType=="xla"&&he(n,135),he(n,225,o?vr(1200):null),he(n,193,a2(2)),l&&he(n,191),l&&he(n,192),he(n,226),he(n,92,g2("SheetJS",r)),he(n,66,vr(o?1200:1252)),o&&he(n,353,vr(0)),o&&he(n,448),he(n,317,L2(e.SheetNames.length)),o&&e.vbaraw&&he(n,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";he(n,442,Mp(c))}he(n,156,vr(17)),he(n,25,Gt(!1)),he(n,18,Gt(!1)),he(n,19,vr(0)),o&&he(n,431,Gt(!1)),o&&he(n,444,vr(0)),he(n,61,_2()),he(n,64,Gt(!1)),he(n,141,vr(0)),he(n,34,Gt(jb(e)=="true")),he(n,14,Gt(!0)),o&&he(n,439,Gt(!1)),he(n,218,vr(0)),kA(n,e,r),OA(n,e.SSF,r),RA(n,r),o&&he(n,352,Gt(!1));var u=n.end(),f=er();o&&he(f,140,P2()),o&&r.Strings&&yA(f,252,v2(r.Strings)),he(f,10);var h=f.end(),d=er(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var m=u.length+g+h.length;for(p=0;p<e.SheetNames.length;++p){var w=s[p]||{};he(d,133,m2({pos:m,hs:w.Hidden||0,dt:0,name:e.SheetNames[p]},r)),m+=t[p].length}var T=d.end();if(g!=T.length)throw new Error("BS8 "+g+" != "+T.length);var _=[];return u.length&&_.push(u),T.length&&_.push(T),h.length&&_.push(h),Rt(_)}function LA(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=rr(ft)),e&&e.SSF&&(Oo(),ko(e.SSF),r.revssf=Co(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Kc(r),r.cellXfs=[],In(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=NA(i,r,e);return n.unshift(DA(e,n,r)),Rt(n)}function u1(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=pr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return LA(e,t);case 4:case 3:case 2:return AA(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function MA(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=qe({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],h=f&&f.v!=null&&(f.h||py(f.w||(un(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+u,s.push(fe("td",h,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var BA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',UA="</body></html>";function jA(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function f1(e,t){var r=t||{},n=r.header!=null?r.header:BA,i=r.footer!=null?r.footer:UA,s=[n],a=pr(e["!ref"]);r.dense=Array.isArray(e),s.push(jA(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(MA(e,a,o,r));return s.push("</table>"+i),s.join("")}function h1(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Tt(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=pr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),g=0,p=0,m=0,w=0,T=0,_=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&p<l;++g){var O=o[g];if(n0(O)){if(n.display)continue;d[p]={hidden:!0}}var V=O.children;for(m=w=0;m<V.length;++m){var ee=V[m];if(!(n.display&&n0(ee))){var I=ee.hasAttribute("data-v")?ee.getAttribute("data-v"):ee.hasAttribute("v")?ee.getAttribute("v"):_y(ee.innerHTML),q=ee.getAttribute("data-z")||ee.getAttribute("z");for(h=0;h<f.length;++h){var M=f[h];M.s.c==w+s&&M.s.r<p+i&&p+i<=M.e.r&&(w=M.e.c+1-s,h=-1)}_=+ee.getAttribute("colspan")||1,((T=+ee.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:p+i,c:w+s},e:{r:p+i+(T||1)-1,c:w+s+(_||1)-1}});var te={t:"s",v:I},ne=ee.getAttribute("data-t")||ee.getAttribute("t")||"";I!=null&&(I.length==0?te.t=ne||"z":n.raw||I.trim().length==0||ne=="s"||(I==="TRUE"?te={t:"b",v:!0}:I==="FALSE"?te={t:"b",v:!1}:isNaN(nn(I))?isNaN(Is(I).getDate())||(te={t:"d",v:Xt(I)},n.cellDates||(te={t:"n",v:tr(te.v)}),te.z=n.dateNF||ft[14]):te={t:"n",v:nn(I)})),te.z===void 0&&q!=null&&(te.z=q);var se="",de=ee.getElementsByTagName("A");if(de&&de.length)for(var Be=0;Be<de.length&&!(de[Be].hasAttribute("href")&&(se=de[Be].getAttribute("href"),se.charAt(0)!="#"));++Be);se&&se.charAt(0)!="#"&&(te.l={Target:se}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][w+s]=te):e[qe({c:w+s,r:p+i})]=te,c.e.c<w+s&&(c.e.c=w+s),w+=_}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=mt(c),p>=l&&(e["!fullref"]=mt((c.e.r=o.length-g+p-1+i,c))),e}function d1(e,t){var r=t||{},n=r.dense?[]:{};return h1(n,e,t)}function $A(e,t){return Zn(d1(e,t),t)}function n0(e){var t="",r=HA(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function HA(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var WA=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ps({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return _t+t}})(),i0=(function(){var e=function(s){return Ge(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Ge(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,f=pr(s["!ref"]||"A1"),h=s["!merges"]||[],d=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",m=s["!rows"]||[];for(c=0;c<f.s.r;++c)p=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=f.e.r;++c){for(p=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var w=!1,T={},_="";for(d=0;d!=h.length;++d)if(!(h[d].s.c>u)&&!(h[d].s.r>c)&&!(h[d].e.c<u)&&!(h[d].e.r<c)){(h[d].s.c!=u||h[d].s.r!=c)&&(w=!0),T["table:number-columns-spanned"]=h[d].e.c-h[d].s.c+1,T["table:number-rows-spanned"]=h[d].e.r-h[d].s.r+1;break}if(w){l.push(r);continue}var O=qe({r:c,c:u}),V=g?(s[c]||[])[u]:s[O];if(V&&V.f&&(T["table:formula"]=Ge(cS(V.f)),V.F&&V.F.slice(0,O.length)==O)){var ee=pr(V.F);T["table:number-matrix-columns-spanned"]=ee.e.c-ee.s.c+1,T["table:number-matrix-rows-spanned"]=ee.e.r-ee.s.r+1}if(!V){l.push(t);continue}switch(V.t){case"b":_=V.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=V.v?"true":"false";break;case"n":_=V.w||String(V.v||0),T["office:value-type"]="float",T["office:value"]=V.v||0;break;case"s":case"str":_=V.v==null?"":V.v,T["office:value-type"]="string";break;case"d":_=V.w||Xt(V.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=Xt(V.v).toISOString(),T["table:style-name"]="ce1";break;default:l.push(t);continue}var I=e(_);if(V.l&&V.l.Target){var q=V.l.Target;q=q.charAt(0)=="#"?"#"+uS(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),I=fe("text:a",I,{"xlink:href":q.replace(/&/g,"&amp;")})}l.push("          "+fe("table:table-cell",fe("text:p",I,{}),T)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;jc(f),f.ods=o;var h=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[_t],c=Ps({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ps({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(Op().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(n(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function p1(e,t){if(t.bookType=="fods")return i0(e,t);var r=Cc(),n="",i=[],s=[];return n="mimetype",Ne(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ne(r,n,i0(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ne(r,n,WA(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ne(r,n,_t+Op()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ne(r,n,t2(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ne(r,n,Zy(i)),r}function io(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function VA(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Cr(Fs(e))}function KA(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Cn(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function zA(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function Ns(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ke(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ci(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function wt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Ns(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Ns(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Ot(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Ke(n*8+i.type)),i.type==2&&t.push(Ke(i.data.length)),t.push(i.data))})}),Cn(t)}function Er(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Ns(e,n),s=wt(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:Ci(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=wt(o.data),c=Ci(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=Ci(s[3][0].data)>>>0>0),r.push(a)}return r}function ui(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ke(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ke(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ke(a.data.length)}],n[2].push({data:Ot(a.meta),type:2})});var s=Ot(n);t.push(Ke(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),Cn(t)}function GA(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ns(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Cn(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Cn(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Tr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(GA(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Cn(t)}function fi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Ke(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Cn(t)}function ul(e,t){var r=new Uint8Array(32),n=io(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,zA(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function fl(e,t){var r=new Uint8Array(32),n=io(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function mn(e){var t=wt(e);return Ns(t[1][0].data)}function qA(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&Ci(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=io(e[7][0].data),u=0,f=[],h=io(e[4][0].data),d=0,g=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),h.setUint16(p*2,d,!0);var m,w;switch(typeof t[p]){case"string":m=ul({t:"s",v:t[p]},r),w=fl({t:"s",v:t[p]},r);break;case"number":m=ul({t:"n",v:t[p]},r),w=fl({t:"n",v:t[p]},r);break;case"boolean":m=ul({t:"b",v:t[p]},r),w=fl({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(m),u+=m.length,g.push(w),d+=w.length,++l}for(e[2][0].data=Ke(l);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=Cn(f),e[3][0].data=Cn(g),l}function XA(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=pr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(mt(n)));var s=so(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(N){typeof N=="string"&&a.push(N)})});var o={},l=[],c=Ye.read(t.numbers,{type:"base64"});c.FileIndex.map(function(H,N){return[H,c.FullPaths[N]]}).forEach(function(H){var N=H[0],P=H[1];if(N.type==2&&N.name.match(/\.iwa/)){var Z=N.content,L=Tr(Z),Q=Er(L);Q.forEach(function(K){l.push(K.id),o[K.id]={deps:[],location:P,type:Ci(K.messages[0].meta[1][0].data)}})}}),l.sort(function(H,N){return H-N});var u=l.filter(function(H){return H>1}).map(function(H){return[H,Ke(H)]});c.FileIndex.map(function(H,N){return[H,c.FullPaths[N]]}).forEach(function(H){var N=H[0];if(H[1],!!N.name.match(/\.iwa/)){var P=Er(Tr(N.content));P.forEach(function(Z){Z.messages.forEach(function(L){u.forEach(function(Q){Z.messages.some(function(K){return Ci(K.meta[1][0].data)!=11006&&KA(K.data,Q[1])})&&o[Q[0]].deps.push(Z.id)})})})}});for(var f=Ye.find(c,o[1].location),h=Er(Tr(f.content)),d,g=0;g<h.length;++g){var p=h[g];p.id==1&&(d=p)}var m=mn(wt(d.messages[0].data)[1][0].data);for(f=Ye.find(c,o[m].location),h=Er(Tr(f.content)),g=0;g<h.length;++g)p=h[g],p.id==m&&(d=p);for(m=mn(wt(d.messages[0].data)[2][0].data),f=Ye.find(c,o[m].location),h=Er(Tr(f.content)),g=0;g<h.length;++g)p=h[g],p.id==m&&(d=p);for(m=mn(wt(d.messages[0].data)[2][0].data),f=Ye.find(c,o[m].location),h=Er(Tr(f.content)),g=0;g<h.length;++g)p=h[g],p.id==m&&(d=p);var w=wt(d.messages[0].data);{w[6][0].data=Ke(n.e.r+1),w[7][0].data=Ke(n.e.c+1);var T=mn(w[46][0].data),_=Ye.find(c,o[T].location),O=Er(Tr(_.content));{for(var V=0;V<O.length&&O[V].id!=T;++V);if(O[V].id!=T)throw"Bad ColumnRowUIDMapArchive";var ee=wt(O[V].messages[0].data);ee[1]=[],ee[2]=[],ee[3]=[];for(var I=0;I<=n.e.c;++I){var q=[];q[1]=q[2]=[{type:0,data:Ke(I+420690)}],ee[1].push({type:2,data:Ot(q)}),ee[2].push({type:0,data:Ke(I)}),ee[3].push({type:0,data:Ke(I)})}ee[4]=[],ee[5]=[],ee[6]=[];for(var M=0;M<=n.e.r;++M)q=[],q[1]=q[2]=[{type:0,data:Ke(M+726270)}],ee[4].push({type:2,data:Ot(q)}),ee[5].push({type:0,data:Ke(M)}),ee[6].push({type:0,data:Ke(M)});O[V].messages[0].data=Ot(ee)}_.content=fi(ui(O)),_.size=_.content.length,delete w[46];var te=wt(w[4][0].data);{te[7][0].data=Ke(n.e.r+1);var ne=wt(te[1][0].data),se=mn(ne[2][0].data);_=Ye.find(c,o[se].location),O=Er(Tr(_.content));{if(O[0].id!=se)throw"Bad HeaderStorageBucket";var de=wt(O[0].messages[0].data);for(M=0;M<s.length;++M){var Be=wt(de[2][0].data);Be[1][0].data=Ke(M),Be[4][0].data=Ke(s[M].length),de[2][M]={type:de[2][0].type,data:Ot(Be)}}O[0].messages[0].data=Ot(de)}_.content=fi(ui(O)),_.size=_.content.length;var Oe=mn(te[2][0].data);_=Ye.find(c,o[Oe].location),O=Er(Tr(_.content));{if(O[0].id!=Oe)throw"Bad HeaderStorageBucket";for(de=wt(O[0].messages[0].data),I=0;I<=n.e.c;++I)Be=wt(de[2][0].data),Be[1][0].data=Ke(I),Be[4][0].data=Ke(n.e.r+1),de[2][I]={type:de[2][0].type,data:Ot(Be)};O[0].messages[0].data=Ot(de)}_.content=fi(ui(O)),_.size=_.content.length;var Me=mn(te[4][0].data);(function(){for(var H=Ye.find(c,o[Me].location),N=Er(Tr(H.content)),P,Z=0;Z<N.length;++Z){var L=N[Z];L.id==Me&&(P=L)}var Q=wt(P.messages[0].data);{Q[3]=[];var K=[];a.forEach(function(E,C){K[1]=[{type:0,data:Ke(C)}],K[2]=[{type:0,data:Ke(1)}],K[3]=[{type:2,data:VA(E)}],Q[3].push({type:2,data:Ot(K)})})}P.messages[0].data=Ot(Q);var X=ui(N),Ee=fi(X);H.content=Ee,H.size=H.content.length})();var be=wt(te[3][0].data);{var Pe=be[1][0];delete be[2];var Xe=wt(Pe.data);{var ht=mn(Xe[2][0].data);(function(){for(var H=Ye.find(c,o[ht].location),N=Er(Tr(H.content)),P,Z=0;Z<N.length;++Z){var L=N[Z];L.id==ht&&(P=L)}var Q=wt(P.messages[0].data);{delete Q[6],delete be[7];var K=new Uint8Array(Q[5][0].data);Q[5]=[];for(var X=0,Ee=0;Ee<=n.e.r;++Ee){var E=wt(K);X+=qA(E,s[Ee],a),E[1][0].data=Ke(Ee),Q[5].push({data:Ot(E),type:2})}Q[1]=[{type:0,data:Ke(n.e.c+1)}],Q[2]=[{type:0,data:Ke(n.e.r+1)}],Q[3]=[{type:0,data:Ke(X)}],Q[4]=[{type:0,data:Ke(n.e.r+1)}]}P.messages[0].data=Ot(Q);var C=ui(N),F=fi(C);H.content=F,H.size=H.content.length})()}Pe.data=Ot(Xe)}te[3][0].data=Ot(be)}w[4][0].data=Ot(te)}d.messages[0].data=Ot(w);var it=ui(h),R=fi(it);return f.content=R,f.size=f.content.length,c}function YA(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Kc(e){YA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function JA(e,t){return t.bookType=="ods"?p1(e,t):t.bookType=="numbers"?XA(e,t):t.bookType=="xlsb"?QA(e,t):ZA(e,t)}function QA(e,t){vi=1024,e&&!e.SSF&&(e.SSF=rr(ft)),e&&e.SSF&&(Oo(),ko(e.SSF),t.revssf=Co(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ws?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Yp.indexOf(t.bookType)>-1,i=bp();Kc(t=t||{});var s=Cc(),a="",o=0;if(t.cellXfs=[],In(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Ne(s,a,Cp(e.Props,t)),i.coreprops.push(a),ze(t.rels,2,a,Ue.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ne(s,a,Ip(e.Props)),i.extprops.push(a),ze(t.rels,3,a,Ue.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Ne(s,a,Fp(e.Custprops)),i.custprops.push(a),ze(t.rels,4,a,Ue.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ne(s,a,tA(o-1,a,t,e,u)),i.sheets.push(a),ze(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ue.WS[0])}if(f){var d=f["!comments"],g=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+r,Ne(s,p,iA(d,p)),i.comments.push(p),ze(u,-1,"../comments"+o+"."+r,Ue.CMNT),g=!0),f["!legacy"]&&g&&Ne(s,"xl/drawings/vmlDrawing"+o+".vml",qp(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Ne(s,kp(a),ki(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Ne(s,a,nA(t.Strings,a,t)),i.strs.push(a),ze(t.wbrels,-1,"sharedStrings."+r,Ue.SST)),a="xl/workbook."+r,Ne(s,a,eA(e,a)),i.workbooks.push(a),ze(t.rels,1,a,Ue.WB),a="xl/theme/theme1.xml",Ne(s,a,zp(e.Themes,t)),i.themes.push(a),ze(t.wbrels,-1,"theme/theme1.xml",Ue.THEME),a="xl/styles."+r,Ne(s,a,rA(e,a,t)),i.styles.push(a),ze(t.wbrels,-1,"styles."+r,Ue.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Ne(s,a,e.vbaraw),i.vba.push(a),ze(t.wbrels,-1,"vbaProject.bin",Ue.VBA)),a="xl/metadata."+r,Ne(s,a,sA(a)),i.metadata.push(a),ze(t.wbrels,-1,"metadata."+r,Ue.XLMETA),Ne(s,"[Content_Types].xml",Ap(i,t)),Ne(s,"_rels/.rels",ki(t.rels)),Ne(s,"xl/_rels/workbook."+r+".rels",ki(t.wbrels)),delete t.revssf,delete t.ssf,s}function ZA(e,t){vi=1024,e&&!e.SSF&&(e.SSF=rr(ft)),e&&e.SSF&&(Oo(),ko(e.SSF),t.revssf=Co(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ws?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Yp.indexOf(t.bookType)>-1,i=bp();Kc(t=t||{});var s=Cc(),a="",o=0;if(t.cellXfs=[],In(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Ne(s,a,Cp(e.Props,t)),i.coreprops.push(a),ze(t.rels,2,a,Ue.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ne(s,a,Ip(e.Props)),i.extprops.push(a),ze(t.rels,3,a,Ue.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Ne(s,a,Fp(e.Custprops)),i.custprops.push(a),ze(t.rels,4,a,Ue.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ne(s,a,s1(o-1,t,e,f)),i.sheets.push(a),ze(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ue.WS[0])}if(h){var g=h["!comments"],p=!1,m="";if(g&&g.length>0){var w=!1;g.forEach(function(T){T[1].forEach(function(_){_.T==!0&&(w=!0)})}),w&&(m="xl/threadedComments/threadedComment"+o+"."+r,Ne(s,m,RE(g,u,t)),i.threadedcomments.push(m),ze(f,-1,"../threadedComments/threadedComment"+o+"."+r,Ue.TCMNT)),m="xl/comments"+o+"."+r,Ne(s,m,Xp(g)),i.comments.push(m),ze(f,-1,"../comments"+o+"."+r,Ue.CMNT),p=!0}h["!legacy"]&&p&&Ne(s,"xl/drawings/vmlDrawing"+o+".vml",qp(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ne(s,kp(a),ki(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Ne(s,a,jp(t.Strings,t)),i.strs.push(a),ze(t.wbrels,-1,"sharedStrings."+r,Ue.SST)),a="xl/workbook."+r,Ne(s,a,l1(e)),i.workbooks.push(a),ze(t.rels,1,a,Ue.WB),a="xl/theme/theme1.xml",Ne(s,a,zp(e.Themes,t)),i.themes.push(a),ze(t.wbrels,-1,"theme/theme1.xml",Ue.THEME),a="xl/styles."+r,Ne(s,a,Vp(e,t)),i.styles.push(a),ze(t.wbrels,-1,"styles."+r,Ue.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Ne(s,a,e.vbaraw),i.vba.push(a),ze(t.wbrels,-1,"vbaProject.bin",Ue.VBA)),a="xl/metadata."+r,Ne(s,a,Gp()),i.metadata.push(a),ze(t.wbrels,-1,"metadata."+r,Ue.XLMETA),u.length>1&&(a="xl/persons/person.xml",Ne(s,a,IE(u)),i.people.push(a),ze(t.wbrels,-1,"persons/person.xml",Ue.PEOPLE)),Ne(s,"[Content_Types].xml",Ap(i,t)),Ne(s,"_rels/.rels",ki(t.rels)),Ne(s,"xl/_rels/workbook."+r+".rels",ki(t.wbrels)),delete t.revssf,delete t.ssf,s}function e4(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=cn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function g1(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Vs(t.file,Ye.write(e,{type:je?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ye.write(e,t)}function t4(e,t){var r=rr(t||{}),n=JA(e,r);return r4(n,r)}function r4(e,t){var r={},n=je?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Ye.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Ao(i))}return t.password&&typeof encrypt_agile<"u"?g1(encrypt_agile(i,t.password),t):t.type==="file"?Vs(t.file,i):t.type=="string"?ms(i):i}function n4(e,t){var r=t||{},n=xA(e,r);return g1(n,r)}function Br(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Rs(Fs(n));case"binary":return Fs(n);case"string":return e;case"file":return Vs(t.file,n,"utf8");case"buffer":return je?dn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Br(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function i4(e,t){switch(t.type){case"base64":return Rs(e);case"binary":return e;case"string":return e;case"file":return Vs(t.file,e,"binary");case"buffer":return je?dn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ma(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Rs(r):t.type=="string"?ms(r):r;case"file":return Vs(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function m1(e,t){Fw(),Wb(e);var r=rr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=m1(e,r);return r.type="array",Ao(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Br(vA(e,r),r);case"slk":case"sylk":return Br(j2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Br(f1(e.Sheets[e.SheetNames[i]],r),r);case"txt":return i4(v1(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Br(zc(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Br($2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return ma(U2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Br(H2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Br(X2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Br(Up.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Br(p1(e,r),r);case"wk1":return ma(Jf.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return ma(Jf.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ma(u1(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),n4(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return t4(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function s4(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function a4(e,t,r){var n={};return n.type="file",n.file=t,s4(n),m1(e,n)}function o4(e,t,r,n,i,s,a,o){var l=Ft(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var g=a?e[r][d]:e[n[d]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[d]!=null&&(h[s[d]]=c);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(p==null)if(g.t=="e"&&p===null)h[s[d]]=null;else if(c!==void 0)h[s[d]]=c;else if(u&&p===null)h[s[d]]=null;else continue;else h[s[d]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:un(g,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function so(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=nt(u);break;case"number":l=nt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=Ft(l.s.r),h=[],d=[],g=0,p=0,m=Array.isArray(e),w=l.s.r,T=0,_={};m&&!e[w]&&(e[w]=[]);var O=c.skipHidden&&e["!cols"]||[],V=c.skipHidden&&e["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(O[T]||{}).hidden)switch(h[T]=$t(T),r=m?e[w][T]:e[h[T]+f],n){case 1:s[T]=T-l.s.c;break;case 2:s[T]=h[T];break;case 3:s[T]=c.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=un(r,null,c),p=_[a]||0,!p)_[a]=1;else{do o=a+"_"+p++;while(_[o]);_[a]=p,_[o]=1}s[T]=o}for(w=l.s.r+i;w<=l.e.r;++w)if(!(V[w]||{}).hidden){var ee=o4(e,l,w,h,n,s,m,c);(ee.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[g++]=ee.row)}return d.length=g,d}var s0=/"/g;function l4(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",f=Ft(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=o.dense?(e[r]||[])[h]:e[n[h]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:un(d,null,o));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===i||p===s||p===34||o.forceQuotes){u='"'+u.replace(s0,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(s0,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function zc(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=nt(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(h[g]||{}).hidden||(f[g]=$t(g));for(var p=0,m=i.s.r;m<=i.e.r;++m)(d[m]||{}).hidden||(u=l4(e,i,m,f,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function v1(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=zc(e,t);return r}function c4(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=nt(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=$t(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Ft(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function _1(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Tt(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var f=nt(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(p,m){Pt(p).forEach(function(w){(d=h.indexOf(w))==-1&&(h[d=h.length]=w);var T=p[w],_="z",O="",V=qe({c:o+d,r:a+m+i});c=Ds(s,V),T&&typeof T=="object"&&!(T instanceof Date)?s[V]=T:(typeof T=="number"?_="n":typeof T=="boolean"?_="b":typeof T=="string"?_="s":T instanceof Date?(_="d",n.cellDates||(_="n",T=tr(T)),O=n.dateNF||ft[14]):T===null&&n.nullError&&(_="e",T=0),c?(c.t=_,c.v=T,delete c.w,delete c.R,O&&(c.z=O)):s[V]=c={t:_,v:T},O&&(c.z=O))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var g=Ft(a);if(i)for(d=0;d<h.length;++d)s[$t(d+o)+g]={t:"s",v:h[d]};return s["!ref"]=mt(u),s}function u4(e,t){return _1(null,e,t)}function Ds(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Tt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ds(e,qe(t)):Ds(e,qe({r:t,c:r||0}))}function f4(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function h4(){return{SheetNames:[],Sheets:{}}}function d4(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(o1(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function p4(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=f4(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function g4(e,t){return e.z=t,e}function x1(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function m4(e,t,r){return x1(e,"#"+t,r)}function v4(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function _4(e,t,r,n){for(var i=typeof t!="string"?t:nt(t),s=typeof t=="string"?t:mt(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Ds(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var hl={encode_col:$t,encode_row:Ft,encode_cell:qe,encode_range:mt,decode_col:Dc,decode_row:Nc,split_cell:Fy,decode_cell:Tt,decode_range:pr,format_cell:un,sheet_add_aoa:xp,sheet_add_json:_1,sheet_add_dom:h1,aoa_to_sheet:$i,json_to_sheet:u4,table_to_sheet:d1,table_to_book:$A,sheet_to_csv:zc,sheet_to_txt:v1,sheet_to_json:so,sheet_to_html:f1,sheet_to_formulae:c4,sheet_to_row_object_array:so,sheet_get_cell:Ds,book_new:h4,book_append_sheet:d4,book_set_sheet_visibility:p4,cell_set_number_format:g4,cell_set_hyperlink:x1,cell_set_internal_link:m4,cell_add_comment:v4,sheet_set_array_formula:_4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const x4={name:"HomePage",data(){return{dersler:[],dersIcerikSayilari:{},dersGmBilgisi:{},dersKatilimcilari:{},dersTamamlanmaYuzdeleri:{},loading:!0,exporting:!1,updateInterval:null}},computed:{dogmDersler(){return this.dersler.filter(e=>this.dersGmBilgisi[e]==="Din retimi Genel Mdrl")},oerhgmDersler(){return this.dersler.filter(e=>this.dersGmBilgisi[e]==="zel Eitim ve Rehberlik Hizmetleri Genel Mdrl")}},async mounted(){await this.loadDersler(),this.updateInterval=setInterval(()=>{this.loadDersler()},3e4)},beforeUnmount(){this.updateInterval&&clearInterval(this.updateInterval)},methods:{async loadDersler(){try{const{data:e,error:t}=await lt.from("icerik_kayitlari").select("ders_adi, gm, katilimci, tur_1_id, tur_2_id, tur_3_id, tur_4_id, tur_5_id");if(t)throw t;const r=[...new Set(e.map(n=>n.ders_adi).filter(Boolean))];this.dersler=r.sort(),this.dersler.forEach(n=>{const i=e.filter(o=>o.ders_adi===n);this.dersIcerikSayilari[n]=i.length,this.dersGmBilgisi[n]=i[0]?.gm||"",this.dersKatilimcilari[n]=i[0]?.katilimci||"";const s=i.filter(o=>o.tur_1_id&&o.tur_2_id&&o.tur_3_id&&o.tur_4_id&&o.tur_5_id).length,a=i.length>0?Math.round(s/i.length*100):0;this.dersTamamlanmaYuzdeleri[n]=a})}catch(e){console.error("Dersler yklenirken hata:",e),alert("Dersler yklenirken bir hata olutu: "+e.message)}finally{this.loading=!1}},goDersDetay(e){this.$router.push({name:"dersDetay",params:{dersAdi:e}})},async exportToExcel(){this.exporting=!0;try{const{data:e,error:t}=await lt.from("icerik_kayitlari").select("*").order("ders_adi").order("sinif").order("unite");if(t)throw t;const{data:r}=await lt.from("icerik_turleri").select("*"),{data:n}=await lt.from("alt_turler").select("*"),i={},s={};r?.forEach(c=>i[c.id]=c.tur_adi),n?.forEach(c=>s[c.id]=c.alt_tur_adi);const a=hl.book_new(),o={};e.forEach(c=>{const u=c.ders_adi||"Bilinmeyen";o[u]||(o[u]=[]),o[u].push(c)}),Object.keys(o).sort().forEach(c=>{const f=o[c].map(g=>({Snf:g.sinif||"","nite/Tema":g.unite||"","Kazanm/renme kts":g.kazanim||"",Aklama:g.aciklama||"","erik Tr":g.icerik_turu||"","1. ncelik Tr":i[g.tur_1_id]||"","1. ncelik Alt Tr":s[g.alt_tur_1_id]||"","2. ncelik Tr":i[g.tur_2_id]||"","2. ncelik Alt Tr":s[g.alt_tur_2_id]||"","3. ncelik Tr":i[g.tur_3_id]||"","3. ncelik Alt Tr":s[g.alt_tur_3_id]||"","4. ncelik Tr":i[g.tur_4_id]||"","4. ncelik Alt Tr":s[g.alt_tur_4_id]||"","5. ncelik Tr":i[g.tur_5_id]||"","5. ncelik Alt Tr":s[g.alt_tur_5_id]||"",Dier:g.diger_aciklama||"",GM:g.gm||"",Katlmc:g.katilimci||""}));let h=c.substring(0,31);h=h.replace(/[\\/*?:\[\]]/g,"");const d=hl.json_to_sheet(f);d["!cols"]=[{wch:12},{wch:40},{wch:60},{wch:40},{wch:15},{wch:20},{wch:25},{wch:20},{wch:25},{wch:20},{wch:25},{wch:20},{wch:25},{wch:20},{wch:25},{wch:30},{wch:35},{wch:30}],hl.book_append_sheet(a,d,h)});const l=new Date().toISOString().split("T")[0];a4(a,`EBA_Icerik_Analizi_${l}.xlsx`),alert("Excel dosyas baaryla oluturuldu!")}catch(e){console.error("Excel export hatas:",e),alert("Excel oluturulurken hata: "+e.message)}finally{this.exporting=!1}}}},w4={class:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100"},y4={class:"bg-white shadow-sm border-b border-slate-200 sticky top-0 z-10"},E4={class:"max-w-full mx-auto px-2 sm:px-3 py-3"},T4={class:"flex items-center justify-between"},S4={class:"flex items-center gap-2"},b4=["disabled"],A4={class:"max-w-full mx-auto px-2 sm:px-3 py-4"},k4={key:0,class:"text-center py-12"},O4={key:1},C4={class:"mb-6"},R4={class:"flex items-center gap-2 mb-3"},I4={class:"text-sm text-slate-500"},F4={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"},P4=["onClick"],N4={class:"flex items-start justify-between"},D4={class:"flex-1 min-w-0"},L4={class:"text-sm font-semibold text-slate-900 truncate group-hover:text-blue-600 transition-colors"},M4={class:"text-xs text-slate-500 mt-1"},B4=["title"],U4={class:"flex flex-col items-end gap-2"},j4={class:"mb-6"},$4={class:"flex items-center gap-2 mb-3"},H4={class:"text-sm text-slate-500"},W4={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"},V4=["onClick"],K4={class:"flex items-start justify-between"},z4={class:"flex-1 min-w-0"},G4={class:"text-sm font-semibold text-slate-900 truncate group-hover:text-green-600 transition-colors"},q4={class:"text-xs text-slate-500 mt-1"},X4=["title"],Y4={class:"flex flex-col items-end gap-2"};function J4(e,t,r,n,i,s){const a=Bs("router-link");return me(),_e("div",w4,[k("header",y4,[k("div",E4,[k("div",T4,[t[3]||(t[3]=k("div",null,[k("h1",{class:"text-2xl font-bold text-slate-900"},"EBA DJTAL ERK HTYA ANALZ")],-1)),k("div",S4,[k("button",{onClick:t[0]||(t[0]=(...o)=>s.exportToExcel&&s.exportToExcel(...o)),disabled:i.exporting,class:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all text-sm font-medium shadow-sm disabled:opacity-50"},[t[1]||(t[1]=k("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),_r(" "+Ce(i.exporting?"Da Aktarlyor...":"Excel'e Aktar"),1)],8,b4),Et(a,{to:"/tur-yonetimi",class:"inline-flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-all text-sm font-medium shadow-sm"},{default:uc(()=>[...t[2]||(t[2]=[k("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),_r(" Tr Ynetimi ",-1)])]),_:1})])])])]),k("main",A4,[i.loading?(me(),_e("div",k4,[...t[4]||(t[4]=[k("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-3 border-slate-300 border-t-blue-600"},null,-1)])])):(me(),_e("div",O4,[k("div",C4,[k("div",R4,[t[5]||(t[5]=k("h2",{class:"text-lg font-semibold text-slate-900"},"Din retimi Genel Mdrl",-1)),k("span",I4,"("+Ce(s.dogmDersler.length)+" ders)",1)]),k("div",F4,[(me(!0),_e(rt,null,lr(s.dogmDersler,o=>(me(),_e("button",{key:o,onClick:l=>s.goDersDetay(o),class:"group bg-white hover:bg-blue-50 border border-slate-200 hover:border-blue-300 rounded-xl p-4 transition-all shadow-sm hover:shadow-md text-left relative"},[k("div",N4,[k("div",D4,[k("h3",L4,Ce(o),1),k("p",M4,Ce(i.dersIcerikSayilari[o]||0)+" ierik ",1),i.dersKatilimcilari[o]?(me(),_e("p",{key:0,class:"text-xs text-slate-400 mt-2",title:i.dersKatilimcilari[o]},[t[6]||(t[6]=k("span",{class:"font-medium text-slate-500"},"Katlmclar:",-1)),_r(" "+Ce(i.dersKatilimcilari[o]),1)],8,B4)):tt("",!0)]),k("div",U4,[t[7]||(t[7]=k("svg",{class:"w-5 h-5 text-slate-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)),k("div",{class:Ir(["px-2.5 py-1 rounded-full text-xs font-bold shadow-sm",{"bg-green-100 text-green-700":i.dersTamamlanmaYuzdeleri[o]===100,"bg-yellow-100 text-yellow-700":i.dersTamamlanmaYuzdeleri[o]>=50&&i.dersTamamlanmaYuzdeleri[o]<100,"bg-red-100 text-red-700":i.dersTamamlanmaYuzdeleri[o]<50}])}," %"+Ce(i.dersTamamlanmaYuzdeleri[o]),3)])])],8,P4))),128))])]),k("div",j4,[k("div",$4,[t[8]||(t[8]=k("h2",{class:"text-lg font-semibold text-slate-900"},"zel Eitim ve Rehberlik Hizmetleri Genel Mdrl",-1)),k("span",H4,"("+Ce(s.oerhgmDersler.length)+" ders)",1)]),k("div",W4,[(me(!0),_e(rt,null,lr(s.oerhgmDersler,o=>(me(),_e("button",{key:o,onClick:l=>s.goDersDetay(o),class:"group bg-white hover:bg-green-50 border border-slate-200 hover:border-green-300 rounded-xl p-4 transition-all shadow-sm hover:shadow-md text-left relative"},[k("div",K4,[k("div",z4,[k("h3",G4,Ce(o),1),k("p",q4,Ce(i.dersIcerikSayilari[o]||0)+" ierik ",1),i.dersKatilimcilari[o]?(me(),_e("p",{key:0,class:"text-xs text-slate-400 mt-2",title:i.dersKatilimcilari[o]},[t[9]||(t[9]=k("span",{class:"font-medium text-slate-500"},"Katlmclar:",-1)),_r(" "+Ce(i.dersKatilimcilari[o]),1)],8,X4)):tt("",!0)]),k("div",Y4,[t[10]||(t[10]=k("svg",{class:"w-5 h-5 text-slate-400 group-hover:text-green-600 group-hover:translate-x-1 transition-all flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)),k("div",{class:Ir(["px-2.5 py-1 rounded-full text-xs font-bold shadow-sm",{"bg-green-100 text-green-700":i.dersTamamlanmaYuzdeleri[o]===100,"bg-yellow-100 text-yellow-700":i.dersTamamlanmaYuzdeleri[o]>=50&&i.dersTamamlanmaYuzdeleri[o]<100,"bg-red-100 text-red-700":i.dersTamamlanmaYuzdeleri[o]<50}])}," %"+Ce(i.dersTamamlanmaYuzdeleri[o]),3)])])],8,V4))),128))])])]))])])}const Q4=Mi(x4,[["render",J4]]),Z4={name:"TurSecici",props:{icerik:{type:Object,required:!0},column:{type:Number,required:!0},turler:{type:Array,required:!0},altTurler:{type:Array,required:!0}},data(){return{selectedTur:null,selectedAltTur:null,saving:!1,saved:!1,error:!1,savedTimer:null}},computed:{turFieldName(){return`tur_${this.column}_id`},altTurFieldName(){return`alt_tur_${this.column}_id`},currentTurId(){return this.icerik[this.turFieldName]},currentAltTurId(){return this.icerik[this.altTurFieldName]},isAdded(){return this.currentTurId&&this.currentAltTurId},filteredAltTurler(){return this.selectedTur?this.altTurler.filter(e=>e.icerik_turu_id===this.selectedTur):[]}},mounted(){this.currentTurId&&(this.selectedTur=this.currentTurId),this.currentAltTurId&&(this.selectedAltTur=this.currentAltTurId)},beforeUnmount(){this.savedTimer&&clearTimeout(this.savedTimer)},methods:{onTurChange(){this.selectedAltTur=null},onAltTurChange(){},async onEkle(){this.icerik[this.turFieldName]=this.selectedTur,this.icerik[this.altTurFieldName]=this.selectedAltTur,await this.saveWithFeedback(),this.selectedTur=null,this.selectedAltTur=null},async onSil(){this.icerik[this.turFieldName]=null,this.icerik[this.altTurFieldName]=null,await this.saveWithFeedback(),this.selectedTur=null,this.selectedAltTur=null},async saveWithFeedback(){this.savedTimer&&clearTimeout(this.savedTimer),this.saving=!0,this.saved=!1,this.error=!1;try{await this.$emit("save",this.icerik),this.saving=!1,this.saved=!0,this.savedTimer=setTimeout(()=>{this.saved=!1},1e3)}catch(e){this.saving=!1,this.error=!0,console.error("Kayt hatas:",e)}},getTurAdi(e){const t=this.turler.find(r=>r.id===e);return t?t.icerik_turu:""},getAltTurAdi(e){const t=this.altTurler.find(r=>r.id===e);return t?t.alt_tur_adi:""}}},ek={class:"space-y-1.5"},tk=["disabled"],rk=["value"],nk=["disabled"],ik=["value"],sk=["disabled"],ak={key:3,class:"flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-300 rounded-lg"},ok={key:4,class:"flex items-center gap-2 p-2 bg-red-50 border border-red-300 rounded-lg"},lk={key:5,class:"flex items-center gap-2 p-2 bg-green-50 border border-green-300 rounded-lg"},ck={key:6,class:"flex items-center justify-between gap-2 p-2 bg-blue-50 border border-blue-200 rounded-lg"},uk={class:"flex-1 min-w-0"},fk={class:"text-xs font-medium text-slate-900 truncate"},hk={class:"text-xs text-slate-600 truncate"};function dk(e,t,r,n,i,s){return me(),_e("div",ek,[s.isAdded?tt("",!0):Qt((me(),_e("select",{key:0,"onUpdate:modelValue":t[0]||(t[0]=a=>i.selectedTur=a),onChange:t[1]||(t[1]=(...a)=>s.onTurChange&&s.onTurChange(...a)),disabled:i.saving,class:"w-full text-xs px-2 py-1.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white disabled:bg-slate-100"},[t[6]||(t[6]=k("option",{value:null},"Seiniz...",-1)),(me(!0),_e(rt,null,lr(r.turler,a=>(me(),_e("option",{key:a.id,value:a.id},Ce(a.icerik_turu),9,rk))),128))],40,tk)),[[Sl,i.selectedTur]]),i.selectedTur&&!s.isAdded?Qt((me(),_e("select",{key:1,"onUpdate:modelValue":t[2]||(t[2]=a=>i.selectedAltTur=a),onChange:t[3]||(t[3]=(...a)=>s.onAltTurChange&&s.onAltTurChange(...a)),disabled:i.saving,class:"w-full text-xs px-2 py-1.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white disabled:bg-slate-100"},[t[7]||(t[7]=k("option",{value:null},"Alt tr seiniz...",-1)),(me(!0),_e(rt,null,lr(s.filteredAltTurler,a=>(me(),_e("option",{key:a.id,value:a.id},Ce(a.alt_tur_adi),9,ik))),128))],40,nk)),[[Sl,i.selectedAltTur]]):tt("",!0),i.selectedTur&&i.selectedAltTur&&!s.isAdded?(me(),_e("button",{key:2,onClick:t[4]||(t[4]=(...a)=>s.onEkle&&s.onEkle(...a)),disabled:i.saving,class:Ir([i.error?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700","w-full px-2 py-1.5 text-white text-xs rounded-lg transition-all disabled:bg-slate-400 disabled:cursor-not-allowed"])},Ce(i.saving?"Kaydediliyor...":i.error?"Tekrar Dene":"Ekle"),11,sk)):tt("",!0),i.saving?(me(),_e("div",ak,[...t[8]||(t[8]=[k("div",{class:"animate-spin h-3 w-3 border-2 border-yellow-600 border-t-transparent rounded-full"},null,-1),k("span",{class:"text-xs text-yellow-800"},"Kaydediliyor...",-1)])])):tt("",!0),i.error?(me(),_e("div",ok,[...t[9]||(t[9]=[k("svg",{class:"w-3.5 h-3.5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),k("span",{class:"text-xs text-red-800"},"Kayt baarsz",-1)])])):tt("",!0),i.saved?(me(),_e("div",lk,[...t[10]||(t[10]=[k("svg",{class:"w-3.5 h-3.5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),k("span",{class:"text-xs text-green-800"},"Kaydedildi",-1)])])):tt("",!0),s.isAdded&&!i.saving&&!i.saved&&!i.error?(me(),_e("div",ck,[k("div",uk,[k("div",fk,Ce(s.getTurAdi(s.currentTurId)),1),k("div",hk,Ce(s.getAltTurAdi(s.currentAltTurId)),1)]),k("button",{onClick:t[5]||(t[5]=(...a)=>s.onSil&&s.onSil(...a)),class:"flex-shrink-0 p-1 text-red-600 hover:bg-red-100 rounded transition-all",title:"Sil"},[...t[11]||(t[11]=[k("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])):tt("",!0)])}const pk=Mi(Z4,[["render",dk]]),gk={name:"SinifTablosu",components:{TurSecici:pk},props:{sinif:{type:String,required:!0},icerikler:{type:Array,required:!0}},data(){return{turler:[],altTurler:[],modalAciklama:null,modalDigerIcerik:null,modalDigerText:"",digerModalSaving:!1,showAddModal:!1,modalSelectedUnite:"",modalNewUnite:"",modalNewKazanim:"",addModalSaving:!1,showUniteModal:!1,editUniteAdi:"",originalUniteAdi:"",uniteIcerikler:[],uniteUpdateSaving:!1,uniteDeleteSaving:!1,showEditKazanimModal:!1,editKazanimIcerik:null,editKazanimText:"",kazanimSaving:!1,digerSaving:{},digerSaved:{},digerError:{},newKazanim:{},newUnite:{}}},computed:{uniteGruplari(){const e={};this.icerikler.forEach(r=>{let n=r.unite||"nite Belirtilmemi";n=n.replace(//g,"").trim(),e[n]||(e[n]=[]),e[n].push(r)});const t={};return Object.keys(e).sort((r,n)=>{if(r==="nite Belirtilmemi")return 1;if(n==="nite Belirtilmemi")return-1;const i=r.match(/\d+/),s=n.match(/\d+/);return i&&s?parseInt(i[0])-parseInt(s[0]):r.localeCompare(n,"tr")}).forEach(r=>{t[r]=e[r]}),t},uniteListesi(){return Object.keys(this.uniteGruplari)},canSaveAdd(){return!(!this.modalNewKazanim||!this.modalNewKazanim.trim()||!this.modalSelectedUnite||this.modalSelectedUnite==="__NEW__"&&(!this.modalNewUnite||!this.modalNewUnite.trim()))},uniteIcerikSayisi(){return this.uniteIcerikler.length}},async mounted(){await this.loadTurler(),await this.loadAltTurler(),this.$nextTick(()=>{this.resizeAllTextareas()})},updated(){this.$nextTick(()=>{this.resizeAllTextareas()})},methods:{resizeAllTextareas(){this.$el.querySelectorAll("textarea").forEach(t=>{t.value&&(t.style.height="auto",t.style.height=t.scrollHeight+"px")})},hasKazanim(e){return e.some(t=>t.kazanim&&t.kazanim.trim()!=="")},expandTextarea(e){const t=e.target;t.style.height="auto",t.style.height=t.scrollHeight+"px"},autoResize(e){const t=e.target;t.style.height="auto",t.style.height=t.scrollHeight+"px"},async loadTurler(){try{const{data:e,error:t}=await lt.from("icerik_turleri").select("*").order("icerik_turu");if(t)throw t;this.turler=e||[]}catch(e){console.error("Trler yklenirken hata:",e)}},async loadAltTurler(){try{const{data:e,error:t}=await lt.from("icerik_alt_turleri").select("*").order("alt_tur_adi");if(t)throw t;this.altTurler=e||[]}catch(e){console.error("Alt trler yklenirken hata:",e)}},showAciklama(e){e&&e!=="-"&&(this.modalAciklama=e)},closeModal(){this.modalAciklama=null},openDigerModal(e){this.modalDigerIcerik=e,this.modalDigerText=e.diger_aciklama||""},closeDigerModal(){this.modalDigerIcerik=null,this.modalDigerText="",this.digerModalSaving=!1},openAddModal(e){this.showAddModal=!0,this.modalSelectedUnite="",this.modalNewUnite="",this.modalNewKazanim=""},closeAddModal(){this.showAddModal=!1,this.modalSelectedUnite="",this.modalNewUnite="",this.modalNewKazanim="",this.addModalSaving=!1},openUniteModal(e,t){this.showUniteModal=!0,this.originalUniteAdi=e,this.editUniteAdi=e,this.uniteIcerikler=t},closeUniteModal(){this.showUniteModal=!1,this.originalUniteAdi="",this.editUniteAdi="",this.uniteIcerikler=[],this.uniteUpdateSaving=!1,this.uniteDeleteSaving=!1},async updateUnite(){const e=this.editUniteAdi?.trim();if(!(!e||e===this.originalUniteAdi)){this.uniteUpdateSaving=!0;try{const t=this.uniteIcerikler.map(n=>n.id),{error:r}=await lt.from("icerik_kayitlari").update({unite:e}).in("id",t);if(r)throw r;this.closeUniteModal(),alert("nite baaryla gncellendi! Sayfa yenilenecek."),location.reload()}catch(t){console.error("Gncelleme hatas:",t),alert("nite gncellenirken hata olutu: "+t.message)}finally{this.uniteUpdateSaving=!1}}},confirmDeleteUnite(){confirm(`"${this.originalUniteAdi}" nitesini ve iindeki ${this.uniteIcerikSayisi} kayd silmek istediinizden emin misiniz? Bu ilem geri alnamaz!`)&&this.deleteUnite()},async deleteUnite(){this.uniteDeleteSaving=!0;try{const e=this.uniteIcerikler.map(r=>r.id),{error:t}=await lt.from("icerik_kayitlari").delete().in("id",e);if(t)throw t;this.closeUniteModal(),alert("nite baaryla silindi! Sayfa yenilenecek."),location.reload()}catch(e){console.error("Silme hatas:",e),alert("nite silinirken hata olutu: "+e.message)}finally{this.uniteDeleteSaving=!1}},editKazanim(e){this.showEditKazanimModal=!0,this.editKazanimIcerik=e,this.editKazanimText=e.kazanim||""},closeEditKazanimModal(){this.showEditKazanimModal=!1,this.editKazanimIcerik=null,this.editKazanimText="",this.kazanimSaving=!1},async saveEditKazanim(){const e=this.editKazanimText?.trim();if(!(!e||!this.editKazanimIcerik)){this.kazanimSaving=!0;try{const{error:t}=await lt.from("icerik_kayitlari").update({kazanim:e}).eq("id",this.editKazanimIcerik.id);if(t)throw t;this.editKazanimIcerik.kazanim=e,this.closeEditKazanimModal(),alert("Kazanm baaryla gncellendi!")}catch(t){console.error("Gncelleme hatas:",t),alert("Kazanm gncellenirken hata olutu: "+t.message)}finally{this.kazanimSaving=!1}}},async deleteKazanim(e){if(confirm(`"${e.kazanim||"Bu kazanm"}" kaydn silmek istediinizden emin misiniz? Bu ilem geri alnamaz!`))try{const{error:r}=await lt.from("icerik_kayitlari").delete().eq("id",e.id);if(r)throw r;const n=this.uniteIcerikler.findIndex(i=>i.id===e.id);n>-1&&this.uniteIcerikler.splice(n,1),alert("Kazanm baaryla silindi!"),this.uniteIcerikler.length===0&&(this.closeUniteModal(),location.reload())}catch(r){console.error("Silme hatas:",r),alert("Kazanm silinirken hata olutu: "+r.message)}},async saveAddModal(){const e=this.modalNewKazanim?.trim(),t=this.modalSelectedUnite,r=this.modalNewUnite?.trim();if(!(!e||!t)&&!(t==="__NEW__"&&!r)){this.addModalSaving=!0;try{const n=this.icerikler[0],i={ders_adi:n?.ders_adi||"",sinif:this.sinif,unite:t==="__NEW__"?r:t,kazanim:e,aciklama:null,icerik_turu:n?.icerik_turu||null,gm:n?.gm||null,katilimci:n?.katilimci||null},{data:s,error:a}=await lt.from("icerik_kayitlari").insert([i]).select();if(a)throw a;this.closeAddModal(),alert("Yeni kayt baaryla eklendi! Sayfa yenilenecek."),location.reload()}catch(n){console.error("Ekleme hatas:",n),alert("Kayt eklenirken hata olutu: "+n.message)}finally{this.addModalSaving=!1}}},async saveDigerModal(){if(!this.modalDigerIcerik)return;this.digerModalSaving=!0;const e=this.modalDigerIcerik;try{const{error:t}=await lt.from("icerik_kayitlari").update({diger_aciklama:this.modalDigerText||null}).eq("id",e.id);if(t)throw t;e.diger_aciklama=this.modalDigerText,this.digerSaved[e.id]=!0,setTimeout(()=>{this.digerSaved[e.id]=!1},2e3),this.closeDigerModal()}catch(t){console.error("Kayt hatas:",t),this.digerError[e.id]=!0,setTimeout(()=>{this.digerError[e.id]=!1},2e3)}finally{this.digerModalSaving=!1}},async saveDiger(e){const t=e.id;this.digerSaving[t]=!0,this.digerSaved[t]=!1,this.digerError[t]=!1;try{const{error:r}=await lt.from("icerik_kayitlari").update({diger_aciklama:e.diger_aciklama||null}).eq("id",t);if(r)throw r;this.digerSaving[t]=!1,this.digerSaved[t]=!0,setTimeout(()=>{this.digerSaved[t]=!1},1e3)}catch(r){console.error("Kayt hatas:",r),this.digerSaving[t]=!1,this.digerError[t]=!0}},async saveIcerik(e){try{const{error:t}=await lt.from("icerik_kayitlari").update({tur_1_id:e.tur_1_id||null,alt_tur_1_id:e.alt_tur_1_id||null,tur_2_id:e.tur_2_id||null,alt_tur_2_id:e.alt_tur_2_id||null,tur_3_id:e.tur_3_id||null,alt_tur_3_id:e.alt_tur_3_id||null,tur_4_id:e.tur_4_id||null,alt_tur_4_id:e.alt_tur_4_id||null,tur_5_id:e.tur_5_id||null,alt_tur_5_id:e.alt_tur_5_id||null,diger_aciklama:e.diger_aciklama||null}).eq("id",e.id);if(t)throw t}catch(t){throw console.error("Kayt hatas:",t),t}}}},mk={class:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden mb-4"},vk={class:"bg-gradient-to-r from-slate-800 to-slate-700 px-3 py-2.5"},_k={class:"flex items-center justify-between"},xk={class:"text-xl font-bold text-white"},wk={class:"text-sm font-normal text-slate-300 ml-2"},yk={class:"overflow-x-auto"},Ek={class:"w-full"},Tk={class:"bg-gradient-to-r from-slate-100 to-slate-50"},Sk={key:0,colspan:"9",class:"px-2 py-2"},bk=["onClick"],Ak={class:"px-2 py-2 align-top"},kk={class:"text-xs font-bold text-slate-800"},Ok={class:"px-2 py-2 text-xs text-slate-600 align-top"},Ck=["onClick"],Rk={key:1,class:"text-slate-400"},Ik={class:"px-2 py-2 text-xs text-slate-600 align-middle text-center"},Fk={class:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs leading-tight inline-block"},Pk={class:"px-2 py-2 align-top"},Nk=["onClick"],Dk={class:"text-xs text-slate-700 line-clamp-2"},Lk={key:0,class:"absolute right-2 top-1/2 -translate-y-1/2"},Mk={key:1,class:"absolute right-2 top-1/2 -translate-y-1/2 text-green-600 text-xs font-semibold"},Bk={key:2,class:"absolute right-2 top-1/2 -translate-y-1/2 text-red-600 text-xs font-semibold"},Uk={class:"px-2 py-2 text-xs text-slate-700 align-top"},jk={class:"px-2 py-2 text-xs text-slate-600 align-top"},$k=["onClick"],Hk={class:"px-2 py-2 text-xs text-slate-600 align-middle text-center"},Wk={class:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs leading-tight inline-block"},Vk={class:"px-2 py-2 align-top"},Kk=["onClick"],zk={class:"text-xs text-slate-700 line-clamp-2"},Gk={key:0,class:"absolute right-2 top-1/2 -translate-y-1/2"},qk={key:1,class:"absolute right-2 top-1/2 -translate-y-1/2 text-green-600 text-xs font-semibold"},Xk={key:2,class:"absolute right-2 top-1/2 -translate-y-1/2 text-red-600 text-xs font-semibold"},Yk={class:"flex items-center justify-between p-4 border-b border-slate-200 sticky top-0 bg-white"},Jk={class:"p-6"},Qk={class:"text-sm text-slate-700 whitespace-pre-wrap leading-relaxed"},Zk={class:"flex items-center justify-between p-4 border-b border-slate-200 bg-white"},eO={class:"p-6"},tO={class:"flex justify-end gap-2 mt-4"},rO=["disabled"],nO={class:"flex items-center justify-between p-4 border-b border-slate-200 bg-white"},iO={class:"p-6 space-y-4"},sO=["value"],aO={key:0},oO={class:"flex justify-end gap-2 mt-4"},lO=["disabled"],cO={class:"flex items-center justify-between p-4 border-b border-slate-200 bg-white"},uO={class:"p-6 space-y-4"},fO={class:"text-xs text-slate-500"},hO={class:"max-h-48 overflow-y-auto border border-slate-200 rounded-lg p-3 space-y-2"},dO={class:"flex-1"},pO={class:"font-semibold text-slate-500"},gO={class:"flex gap-1 flex-shrink-0"},mO=["onClick"],vO=["onClick"],_O={class:"flex gap-2 pt-4"},xO=["disabled"],wO=["disabled"],yO={class:"flex items-center justify-between p-4 border-b border-slate-200 bg-white"},EO={class:"p-6 space-y-4"},TO={class:"flex justify-end gap-2"},SO=["disabled"];function bO(e,t,r,n,i,s){const a=Bs("TurSecici");return me(),_e("div",mk,[k("div",vk,[k("div",_k,[k("h2",xk,[_r(" Snf: "+Ce(r.sinif)+" ",1),k("span",wk,"("+Ce(r.icerikler.length)+" ierik)",1)]),k("button",{onClick:t[0]||(t[0]=o=>s.openAddModal(null)),class:"px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors flex items-center gap-1"},[...t[30]||(t[30]=[k("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),_r(" Ekle ",-1)])])])]),k("div",yk,[k("table",Ek,[t[33]||(t[33]=k("thead",{class:"bg-slate-50 border-b-2 border-slate-200"},[k("tr",null,[k("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-80"},"renme kts"),k("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-60"},"Aklama"),k("th",{class:"px-2 py-2 text-center text-xs font-semibold text-slate-700 uppercase w-28"},"erk Tr"),k("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"1. NCELK"),k("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"2. NCELK"),k("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"3. NCELK"),k("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"4. NCELK"),k("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"5. NCELK"),k("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-40"},"DER")])],-1)),k("tbody",null,[(me(!0),_e(rt,null,lr(s.uniteGruplari,(o,l)=>(me(),_e(rt,{key:l},[k("tr",Tk,[s.hasKazanim(o)?(me(),_e("td",Sk,[k("h3",{onClick:c=>s.openUniteModal(l,o),class:"text-xs font-bold text-slate-800 cursor-pointer hover:text-blue-600 transition-colors"},Ce(l),9,bk)])):(me(),_e(rt,{key:1},[k("td",Ak,[k("h3",kk,Ce(l),1)]),k("td",Ok,[o[0]?.aciklama?(me(),_e("div",{key:0,class:"line-clamp-3 cursor-pointer hover:text-blue-600 transition-colors",onClick:c=>s.showAciklama(o[0].aciklama)},Ce(o[0].aciklama),9,Ck)):(me(),_e("span",Rk,"-"))]),k("td",Ik,[k("span",Fk,Ce(o[0]?.icerik_turu||"-"),1)]),(me(),_e(rt,null,lr(5,c=>k("td",{key:c,class:"px-2 py-2 align-top"},[Et(a,{icerik:o[0],column:c,turler:i.turler,altTurler:i.altTurler,onSave:s.saveIcerik},null,8,["icerik","column","turler","altTurler","onSave"])])),64)),k("td",Pk,[k("div",{onClick:c=>s.openDigerModal(o[0]),class:Ir(["relative cursor-pointer px-2 py-1.5 border border-slate-300 rounded-lg hover:border-blue-400 transition-all min-h-[32px] bg-white",{"border-yellow-400":i.digerSaving[o[0].id],"border-green-500":i.digerSaved[o[0].id],"border-red-500":i.digerError[o[0].id]}])},[k("div",Dk,Ce(o[0].diger_aciklama||"Dier..."),1),i.digerSaving[o[0].id]?(me(),_e("div",Lk,[...t[31]||(t[31]=[k("svg",{class:"animate-spin h-3 w-3 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[k("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),k("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):tt("",!0),i.digerSaved[o[0].id]?(me(),_e("div",Mk,"  ")):tt("",!0),i.digerError[o[0].id]?(me(),_e("div",Bk,"  ")):tt("",!0)],10,Nk)])],64))]),(me(!0),_e(rt,null,lr(o,(c,u)=>(me(),_e(rt,{key:c.id},[s.hasKazanim(o)&&c.kazanim?(me(),_e("tr",{key:0,class:Ir([u%2===0?"bg-white":"bg-slate-50","hover:bg-blue-50 transition-colors"])},[k("td",Uk,Ce(c.kazanim),1),k("td",jk,[k("div",{class:"line-clamp-3 cursor-pointer hover:text-blue-600 transition-colors",onClick:f=>s.showAciklama(c.aciklama)},Ce(c.aciklama||"-"),9,$k)]),k("td",Hk,[k("span",Wk,Ce(c.icerik_turu||"-"),1)]),(me(),_e(rt,null,lr(5,f=>k("td",{key:f,class:"px-2 py-2 align-top"},[Et(a,{icerik:c,column:f,turler:i.turler,altTurler:i.altTurler,onSave:s.saveIcerik},null,8,["icerik","column","turler","altTurler","onSave"])])),64)),k("td",Vk,[k("div",{onClick:f=>s.openDigerModal(c),class:Ir(["relative cursor-pointer px-2 py-1.5 border border-slate-300 rounded-lg hover:border-blue-400 transition-all min-h-[32px] bg-white",{"border-yellow-400":i.digerSaving[c.id],"border-green-500":i.digerSaved[c.id],"border-red-500":i.digerError[c.id]}])},[k("div",zk,Ce(c.diger_aciklama||"Dier..."),1),i.digerSaving[c.id]?(me(),_e("div",Gk,[...t[32]||(t[32]=[k("svg",{class:"animate-spin h-3 w-3 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[k("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),k("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):tt("",!0),i.digerSaved[c.id]?(me(),_e("div",qk,"  ")):tt("",!0),i.digerError[c.id]?(me(),_e("div",Xk,"  ")):tt("",!0)],10,Kk)])],2)):tt("",!0)],64))),128))],64))),128))])])]),i.modalAciklama?(me(),_e("div",{key:0,onClick:t[3]||(t[3]=(...o)=>s.closeModal&&s.closeModal(...o)),class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},[k("div",{onClick:t[2]||(t[2]=Ji(()=>{},["stop"])),class:"bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[80vh] overflow-auto"},[k("div",Yk,[t[35]||(t[35]=k("h3",{class:"text-lg font-semibold text-slate-900"},"Aklama",-1)),k("button",{onClick:t[1]||(t[1]=(...o)=>s.closeModal&&s.closeModal(...o)),class:"p-2 hover:bg-slate-100 rounded-lg transition-colors"},[...t[34]||(t[34]=[k("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),k("div",Jk,[k("p",Qk,Ce(i.modalAciklama),1)])])])):tt("",!0),i.modalDigerIcerik?(me(),_e("div",{key:1,onClick:t[9]||(t[9]=(...o)=>s.closeDigerModal&&s.closeDigerModal(...o)),class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},[k("div",{onClick:t[8]||(t[8]=Ji(()=>{},["stop"])),class:"bg-white rounded-xl shadow-2xl max-w-3xl w-full"},[k("div",Zk,[t[37]||(t[37]=k("h3",{class:"text-lg font-semibold text-slate-900"},"Dier Aklama",-1)),k("button",{onClick:t[4]||(t[4]=(...o)=>s.closeDigerModal&&s.closeDigerModal(...o)),class:"p-2 hover:bg-slate-100 rounded-lg transition-colors"},[...t[36]||(t[36]=[k("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),k("div",eO,[Qt(k("textarea",{"onUpdate:modelValue":t[5]||(t[5]=o=>i.modalDigerText=o),rows:"8",class:"w-full text-sm px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Dier aklamalar buraya yazn..."},null,512),[[kr,i.modalDigerText]]),k("div",tO,[k("button",{onClick:t[6]||(t[6]=(...o)=>s.closeDigerModal&&s.closeDigerModal(...o)),class:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors"}," ptal "),k("button",{onClick:t[7]||(t[7]=(...o)=>s.saveDigerModal&&s.saveDigerModal(...o)),disabled:i.digerModalSaving,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50"},Ce(i.digerModalSaving?"Kaydediliyor...":"Kaydet"),9,rO)])])])])):tt("",!0),i.showAddModal?(me(),_e("div",{key:2,onClick:t[17]||(t[17]=(...o)=>s.closeAddModal&&s.closeAddModal(...o)),class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},[k("div",{onClick:t[16]||(t[16]=Ji(()=>{},["stop"])),class:"bg-white rounded-xl shadow-2xl max-w-2xl w-full"},[k("div",nO,[t[39]||(t[39]=k("h3",{class:"text-lg font-semibold text-slate-900"},"Yeni Kayt Ekle",-1)),k("button",{onClick:t[10]||(t[10]=(...o)=>s.closeAddModal&&s.closeAddModal(...o)),class:"p-2 hover:bg-slate-100 rounded-lg transition-colors"},[...t[38]||(t[38]=[k("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),k("div",iO,[k("div",null,[t[42]||(t[42]=k("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"nite Sein",-1)),Qt(k("select",{"onUpdate:modelValue":t[11]||(t[11]=o=>i.modalSelectedUnite=o),class:"w-full text-sm px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[t[40]||(t[40]=k("option",{value:"",disabled:""},"Seiniz...",-1)),(me(!0),_e(rt,null,lr(s.uniteListesi,o=>(me(),_e("option",{key:o,value:o},Ce(o),9,sO))),128)),t[41]||(t[41]=k("option",{value:"__NEW__"},"+ Yeni nite",-1))],512),[[Sl,i.modalSelectedUnite]])]),i.modalSelectedUnite==="__NEW__"?(me(),_e("div",aO,[t[43]||(t[43]=k("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Yeni nite Ad",-1)),Qt(k("input",{"onUpdate:modelValue":t[12]||(t[12]=o=>i.modalNewUnite=o),type:"text",placeholder:"Yeni nite ad girin",class:"w-full text-sm px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[kr,i.modalNewUnite]])])):tt("",!0),k("div",null,[t[44]||(t[44]=k("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Kazanm",-1)),Qt(k("textarea",{"onUpdate:modelValue":t[13]||(t[13]=o=>i.modalNewKazanim=o),rows:"3",placeholder:"Yeni kazanm girin...",class:"w-full text-sm px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"},null,512),[[kr,i.modalNewKazanim]])]),k("div",oO,[k("button",{onClick:t[14]||(t[14]=(...o)=>s.closeAddModal&&s.closeAddModal(...o)),class:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors"}," ptal "),k("button",{onClick:t[15]||(t[15]=(...o)=>s.saveAddModal&&s.saveAddModal(...o)),disabled:!s.canSaveAdd||i.addModalSaving,class:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:opacity-50"},Ce(i.addModalSaving?"Ekleniyor...":"Ekle"),9,lO)])])])])):tt("",!0),i.showUniteModal?(me(),_e("div",{key:3,onClick:t[23]||(t[23]=(...o)=>s.closeUniteModal&&s.closeUniteModal(...o)),class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},[k("div",{onClick:t[22]||(t[22]=Ji(()=>{},["stop"])),class:"bg-white rounded-xl shadow-2xl max-w-md w-full"},[k("div",cO,[t[46]||(t[46]=k("h3",{class:"text-lg font-semibold text-slate-900"},"nite lemleri",-1)),k("button",{onClick:t[18]||(t[18]=(...o)=>s.closeUniteModal&&s.closeUniteModal(...o)),class:"p-2 hover:bg-slate-100 rounded-lg transition-colors"},[...t[45]||(t[45]=[k("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),k("div",uO,[k("div",null,[t[47]||(t[47]=k("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"nite Ad",-1)),Qt(k("input",{"onUpdate:modelValue":t[19]||(t[19]=o=>i.editUniteAdi=o),type:"text",class:"w-full text-sm px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[kr,i.editUniteAdi]])]),k("div",fO," Bu nitede "+Ce(s.uniteIcerikSayisi)+" ierik bulunmaktadr. ",1),k("div",null,[t[50]||(t[50]=k("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"renme ktlar",-1)),k("div",hO,[(me(!0),_e(rt,null,lr(i.uniteIcerikler,(o,l)=>(me(),_e("div",{key:o.id,class:"text-xs text-slate-700 pb-2 border-b border-slate-100 last:border-0 flex items-start gap-2"},[k("div",dO,[k("span",pO,Ce(l+1)+".",1),_r(" "+Ce(o.kazanim||"(Kazanm belirtilmemi)"),1)]),k("div",gO,[k("button",{onClick:c=>s.editKazanim(o),class:"p-1 hover:bg-blue-100 rounded transition-colors text-blue-600",title:"Dzenle"},[...t[48]||(t[48]=[k("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,mO),k("button",{onClick:c=>s.deleteKazanim(o),class:"p-1 hover:bg-red-100 rounded transition-colors text-red-600",title:"Sil"},[...t[49]||(t[49]=[k("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,vO)])]))),128))])]),k("div",_O,[k("button",{onClick:t[20]||(t[20]=(...o)=>s.updateUnite&&s.updateUnite(...o)),disabled:i.uniteUpdateSaving||!i.editUniteAdi||i.editUniteAdi.trim()==="",class:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50 flex items-center justify-center gap-2"},[t[51]||(t[51]=k("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)),_r(" "+Ce(i.uniteUpdateSaving?"Gncelleniyor...":"Dzenle"),1)],8,xO),k("button",{onClick:t[21]||(t[21]=(...o)=>s.confirmDeleteUnite&&s.confirmDeleteUnite(...o)),disabled:i.uniteDeleteSaving,class:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:opacity-50 flex items-center justify-center gap-2"},[t[52]||(t[52]=k("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),_r(" "+Ce(i.uniteDeleteSaving?"Siliniyor...":"Sil"),1)],8,wO)])])])])):tt("",!0),i.showEditKazanimModal?(me(),_e("div",{key:4,onClick:t[29]||(t[29]=(...o)=>s.closeEditKazanimModal&&s.closeEditKazanimModal(...o)),class:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4"},[k("div",{onClick:t[28]||(t[28]=Ji(()=>{},["stop"])),class:"bg-white rounded-xl shadow-2xl max-w-2xl w-full"},[k("div",yO,[t[54]||(t[54]=k("h3",{class:"text-lg font-semibold text-slate-900"},"Kazanm Dzenle",-1)),k("button",{onClick:t[24]||(t[24]=(...o)=>s.closeEditKazanimModal&&s.closeEditKazanimModal(...o)),class:"p-2 hover:bg-slate-100 rounded-lg transition-colors"},[...t[53]||(t[53]=[k("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),k("div",EO,[k("div",null,[t[55]||(t[55]=k("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Kazanm",-1)),Qt(k("textarea",{"onUpdate:modelValue":t[25]||(t[25]=o=>i.editKazanimText=o),rows:"4",class:"w-full text-sm px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"},null,512),[[kr,i.editKazanimText]])]),k("div",TO,[k("button",{onClick:t[26]||(t[26]=(...o)=>s.closeEditKazanimModal&&s.closeEditKazanimModal(...o)),class:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors"}," ptal "),k("button",{onClick:t[27]||(t[27]=(...o)=>s.saveEditKazanim&&s.saveEditKazanim(...o)),disabled:!i.editKazanimText||i.editKazanimText.trim()===""||i.kazanimSaving,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50"},Ce(i.kazanimSaving?"Kaydediliyor...":"Kaydet"),9,SO)])])])])):tt("",!0)])}const AO=Mi(gk,[["render",bO]]),kO={name:"DersDetay",components:{SinifTablosu:AO},props:{dersAdi:{type:String,required:!0}},data(){return{icerikler:[],gmBilgisi:"",loading:!0}},computed:{sinifBazindaIcerikler(){const e={};this.icerikler.forEach(r=>{const n=r.sinif||"Belirtilmemi";e[n]||(e[n]=[]),e[n].push(r)});const t={};return Object.keys(e).sort((r,n)=>r==="Belirtilmemi"?1:n==="Belirtilmemi"?-1:r.localeCompare(n,"tr")).forEach(r=>{t[r]=e[r]}),t},toplamIcerik(){return this.icerikler.length},tamamlananIcerik(){return this.icerikler.filter(e=>e.tur_1_id&&e.tur_2_id&&e.tur_3_id&&e.tur_4_id&&e.tur_5_id).length},tamamlanmaYuzdesi(){return this.toplamIcerik===0?"0.00":(this.tamamlananIcerik/this.toplamIcerik*100).toFixed(2)},tamamlanmaRenk(){const e=this.tamamlanmaYuzdesi;return e===100?"text-green-600":e>=50?"text-yellow-600":"text-red-600"}},async mounted(){await this.loadIcerikler(),this.updateInterval=setInterval(()=>{this.loadIcerikler()},3e4)},beforeUnmount(){this.updateInterval&&clearInterval(this.updateInterval)},methods:{async loadIcerikler(){try{const{data:e,error:t}=await lt.from("icerik_kayitlari").select("*").eq("ders_adi",this.dersAdi).order("sinif",{ascending:!0});if(t)throw t;this.icerikler=e||[],this.icerikler.length>0&&(this.gmBilgisi=this.icerikler[0].gm||"")}catch(e){console.error("erikler yklenirken hata:",e),alert("erikler yklenirken bir hata olutu: "+e.message)}finally{this.loading=!1}}}},OO={class:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100"},CO={class:"bg-white shadow-sm border-b border-slate-200 sticky top-0 z-10"},RO={class:"max-w-full mx-auto px-2 sm:px-3 py-3"},IO={class:"flex items-center gap-4"},FO={class:"flex-1"},PO={class:"text-2xl font-bold text-slate-900"},NO={class:"text-sm text-slate-600 mt-0.5"},DO={class:"max-w-full mx-auto px-2 sm:px-3 py-4"},LO={key:0,class:"text-center py-12"},MO={key:1},BO={key:0,class:"text-center py-12"};function UO(e,t,r,n,i,s){const a=Bs("SinifTablosu");return me(),_e("div",OO,[k("header",CO,[k("div",RO,[k("div",IO,[k("button",{onClick:t[0]||(t[0]=o=>e.$router.push("/")),class:"p-2 hover:bg-slate-100 rounded-lg transition-colors"},[...t[1]||(t[1]=[k("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),k("div",FO,[k("h1",PO,Ce(r.dersAdi),1),k("p",NO,[_r(Ce(s.toplamIcerik)+" ierik ",1),k("span",{class:Ir(["ml-2 font-semibold",s.tamamlanmaRenk])}," ("+Ce(s.tamamlananIcerik)+"/"+Ce(s.toplamIcerik)+" tamamland - %"+Ce(s.tamamlanmaYuzdesi)+") ",3)])]),i.gmBilgisi?(me(),_e("span",{key:0,class:Ir([i.gmBilgisi==="Din retimi Genel Mdrl"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800","text-sm font-bold px-3 py-1 rounded-full"])},Ce(i.gmBilgisi),3)):tt("",!0)])])]),k("main",DO,[i.loading?(me(),_e("div",LO,[...t[2]||(t[2]=[k("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-3 border-slate-300 border-t-blue-600"},null,-1)])])):(me(),_e("div",MO,[(me(!0),_e(rt,null,lr(s.sinifBazindaIcerikler,(o,l)=>(me(),_e("div",{key:l,class:"mb-4"},[Et(a,{sinif:l,icerikler:o},null,8,["sinif","icerikler"])]))),128)),Object.keys(s.sinifBazindaIcerikler).length===0?(me(),_e("div",BO,[...t[3]||(t[3]=[k("div",{class:"text-slate-400 text-sm"},"Bu ders iin ierik bulunamad.",-1)])])):tt("",!0)]))])])}const jO=Mi(kO,[["render",UO]]),$O={name:"TurYonetimi",data(){return{yukleniyor:!0,turler:[],altTurler:[],yeniTur:"",yeniAltTur:{},yeniAltTurAciklama:{},duzenleniyorTur:null,duzenleniyorTurAdi:"",duzenleniyorAltTur:null,duzenleniyorAltTurAdi:"",duzenleniyorAltTurAciklama:""}},computed:{altTurlerByTur(){const e={};return this.altTurler.forEach(t=>{e[t.icerik_turu_id]||(e[t.icerik_turu_id]=[]),e[t.icerik_turu_id].push(t)}),e}},async mounted(){await this.verileriYukle()},methods:{async verileriYukle(){try{this.yukleniyor=!0;const{data:e,error:t}=await lt.from("icerik_turleri").select("*").order("icerik_turu");if(t)throw t;this.turler=e;const{data:r,error:n}=await lt.from("icerik_alt_turleri").select("*").order("alt_tur_adi");if(n)throw n;this.altTurler=r}catch(e){console.error("Veriler yklenirken hata:",e),alert("Veriler yklenirken bir hata olutu: "+e.message)}finally{this.yukleniyor=!1}},async turEkle(){if(this.yeniTur.trim())try{const{data:e,error:t}=await lt.from("icerik_turleri").insert([{icerik_turu:this.yeniTur.trim()}]).select();if(t)throw t;this.turler.push(e[0]),this.turler.sort((r,n)=>r.icerik_turu.localeCompare(n.icerik_turu,"tr")),this.yeniTur="",alert("Tr baaryla eklendi!")}catch(e){console.error("Tr eklenirken hata:",e),alert("Tr eklenirken bir hata olutu: "+e.message)}},turDuzenleBaslat(e){this.duzenleniyorTur=e.id,this.duzenleniyorTurAdi=e.icerik_turu},async turGuncelle(e){if(this.duzenleniyorTurAdi.trim())try{const{error:t}=await lt.from("icerik_turleri").update({icerik_turu:this.duzenleniyorTurAdi.trim()}).eq("id",e.id);if(t)throw t;e.icerik_turu=this.duzenleniyorTurAdi.trim(),this.duzenleniyorTur=null,this.turler.sort((r,n)=>r.icerik_turu.localeCompare(n.icerik_turu,"tr")),alert("Tr baaryla gncellendi!")}catch(t){console.error("Tr gncellenirken hata:",t),alert("Tr gncellenirken bir hata olutu: "+t.message)}},async turSil(e){const t=this.altTurlerByTur[e.id]?.length||0,r=t>0?`"${e.icerik_turu}" trn ve ${t} alt trn silmek istediinize emin misiniz?`:`"${e.icerik_turu}" trn silmek istediinize emin misiniz?`;if(confirm(r))try{const{error:n}=await lt.from("icerik_turleri").delete().eq("id",e.id);if(n)throw n;this.turler=this.turler.filter(i=>i.id!==e.id),this.altTurler=this.altTurler.filter(i=>i.icerik_turu_id!==e.id),alert("Tr baaryla silindi!")}catch(n){console.error("Tr silinirken hata:",n),alert("Tr silinirken bir hata olutu: "+n.message)}},async altTurEkle(e){if(this.yeniAltTur[e]?.trim())try{const{data:t,error:r}=await lt.from("icerik_alt_turleri").insert([{icerik_turu_id:e,alt_tur_adi:this.yeniAltTur[e].trim(),aciklama:this.yeniAltTurAciklama[e]?.trim()||null}]).select();if(r)throw r;this.altTurler.push(t[0]),this.yeniAltTur[e]="",this.yeniAltTurAciklama[e]="",alert("Alt tr baaryla eklendi!")}catch(t){console.error("Alt tr eklenirken hata:",t),alert("Alt tr eklenirken bir hata olutu: "+t.message)}},altTurDuzenleBaslat(e){this.duzenleniyorAltTur=e.id,this.duzenleniyorAltTurAdi=e.alt_tur_adi,this.duzenleniyorAltTurAciklama=e.aciklama||""},async altTurGuncelle(e){if(this.duzenleniyorAltTurAdi.trim())try{const{error:t}=await lt.from("icerik_alt_turleri").update({alt_tur_adi:this.duzenleniyorAltTurAdi.trim(),aciklama:this.duzenleniyorAltTurAciklama.trim()||null}).eq("id",e.id);if(t)throw t;e.alt_tur_adi=this.duzenleniyorAltTurAdi.trim(),e.aciklama=this.duzenleniyorAltTurAciklama.trim()||null,this.duzenleniyorAltTur=null,alert("Alt tr baaryla gncellendi!")}catch(t){console.error("Alt tr gncellenirken hata:",t),alert("Alt tr gncellenirken bir hata olutu: "+t.message)}},async altTurSil(e){if(confirm(`"${e.alt_tur_adi}" alt trn silmek istediinize emin misiniz?`))try{const{error:t}=await lt.from("icerik_alt_turleri").delete().eq("id",e.id);if(t)throw t;this.altTurler=this.altTurler.filter(r=>r.id!==e.id),alert("Alt tr baaryla silindi!")}catch(t){console.error("Alt tr silinirken hata:",t),alert("Alt tr silinirken bir hata olutu: "+t.message)}}}},HO={class:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100"},WO={class:"bg-white shadow-sm border-b border-slate-200 sticky top-0 z-10"},VO={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},KO={class:"flex items-center justify-between"},zO={class:"max-w-full mx-auto px-2 sm:px-3 py-4"},GO={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-6"},qO={class:"flex gap-3"},XO=["disabled"],YO={key:0,class:"text-center py-12"},JO={key:1,class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},QO={class:"bg-gradient-to-r from-slate-800 to-slate-700 px-4 py-3"},ZO={key:0,class:"flex items-center gap-2"},eC=["onKeyup"],tC=["onClick"],rC={key:1,class:"flex items-center justify-between"},nC={class:"flex items-center gap-2"},iC={class:"text-base font-semibold text-white"},sC={class:"text-xs text-slate-300 bg-slate-600/50 px-2 py-0.5 rounded-full"},aC={class:"flex gap-1.5"},oC=["onClick"],lC=["onClick"],cC={class:"px-4 py-2.5 bg-slate-50 border-b border-slate-200"},uC={class:"flex gap-2"},fC=["onUpdate:modelValue","onKeyup"],hC=["onUpdate:modelValue","onKeyup"],dC=["onClick","disabled"],pC={class:"p-3 max-h-64 overflow-y-auto"},gC={key:0,class:"text-center py-6 text-slate-400 text-sm"},mC={key:1,class:"space-y-1.5"},vC={class:"flex-1 min-w-0"},_C={key:0,class:"flex gap-2"},xC=["onKeyup"],wC=["onKeyup"],yC=["onClick"],EC={class:"text-sm font-medium text-slate-800 truncate"},TC={key:0,class:"text-xs text-slate-500 truncate mt-0.5"},SC={key:0,class:"flex gap-1 ml-2 opacity-0 group-hover:opacity-100 transition-opacity"},bC=["onClick"],AC=["onClick"];function kC(e,t,r,n,i,s){const a=Bs("router-link");return me(),_e("div",HO,[k("header",WO,[k("div",VO,[k("div",KO,[t[12]||(t[12]=k("div",null,[k("h1",{class:"text-2xl font-bold text-slate-900"},"Tr Ynetimi"),k("p",{class:"text-sm text-slate-600 mt-0.5"},"erik trleri ve alt trler")],-1)),Et(a,{to:"/",class:"inline-flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-all text-sm font-medium shadow-sm"},{default:uc(()=>[...t[11]||(t[11]=[k("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),_r(" Ana Sayfa ",-1)])]),_:1})])])]),k("div",zO,[k("div",GO,[k("div",qO,[Qt(k("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>i.yeniTur=o),type:"text",placeholder:"Yeni tr ad...",class:"flex-1 px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",onKeyup:t[1]||(t[1]=qr((...o)=>s.turEkle&&s.turEkle(...o),["enter"]))},null,544),[[kr,i.yeniTur]]),k("button",{onClick:t[2]||(t[2]=(...o)=>s.turEkle&&s.turEkle(...o)),disabled:!i.yeniTur.trim(),class:"px-5 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all shadow-sm"}," + Tr Ekle ",8,XO)])]),i.yukleniyor?(me(),_e("div",YO,[...t[13]||(t[13]=[k("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-3 border-slate-300 border-t-blue-600"},null,-1)])])):(me(),_e("div",JO,[(me(!0),_e(rt,null,lr(i.turler,o=>(me(),_e("div",{key:o.id,class:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-all"},[k("div",QO,[i.duzenleniyorTur===o.id?(me(),_e("div",ZO,[Qt(k("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>i.duzenleniyorTurAdi=l),type:"text",class:"flex-1 px-3 py-1.5 text-sm border border-slate-300 rounded-lg",onKeyup:[qr(l=>s.turGuncelle(o),["enter"]),t[4]||(t[4]=qr(l=>i.duzenleniyorTur=null,["esc"]))]},null,40,eC),[[kr,i.duzenleniyorTurAdi]]),k("button",{onClick:l=>s.turGuncelle(o),class:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700"},"  ",8,tC),k("button",{onClick:t[5]||(t[5]=l=>i.duzenleniyorTur=null),class:"px-3 py-1.5 bg-slate-600 text-white text-sm rounded-lg hover:bg-slate-700"},"  ")])):(me(),_e("div",rC,[k("div",nC,[k("h2",iC,Ce(o.icerik_turu),1),k("span",sC,Ce(s.altTurlerByTur[o.id]?.length||0),1)]),k("div",aC,[k("button",{onClick:l=>s.turDuzenleBaslat(o),class:"p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded transition-all",title:"Dzenle"},[...t[14]||(t[14]=[k("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,oC),k("button",{onClick:l=>s.turSil(o),class:"p-1.5 text-white/80 hover:text-red-300 hover:bg-red-500/20 rounded transition-all",title:"Sil"},[...t[15]||(t[15]=[k("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,lC)])]))]),k("div",cC,[k("div",uC,[Qt(k("input",{"onUpdate:modelValue":l=>i.yeniAltTur[o.id]=l,type:"text",placeholder:"Alt tr ad...",class:"flex-1 px-3 py-1.5 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyup:qr(l=>s.altTurEkle(o.id),["enter"])},null,40,fC),[[kr,i.yeniAltTur[o.id]]]),Qt(k("input",{"onUpdate:modelValue":l=>i.yeniAltTurAciklama[o.id]=l,type:"text",placeholder:"Aklama...",class:"flex-1 px-3 py-1.5 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyup:qr(l=>s.altTurEkle(o.id),["enter"])},null,40,hC),[[kr,i.yeniAltTurAciklama[o.id]]]),k("button",{onClick:l=>s.altTurEkle(o.id),disabled:!i.yeniAltTur[o.id]?.trim(),class:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all"}," + ",8,dC)])]),k("div",pC,[s.altTurlerByTur[o.id]?.length?(me(),_e("div",mC,[(me(!0),_e(rt,null,lr(s.altTurlerByTur[o.id],l=>(me(),_e("div",{key:l.id,class:"group flex items-center justify-between p-2.5 bg-slate-50 rounded-lg hover:bg-slate-100 transition-all"},[k("div",vC,[i.duzenleniyorAltTur===l.id?(me(),_e("div",_C,[Qt(k("input",{"onUpdate:modelValue":t[6]||(t[6]=c=>i.duzenleniyorAltTurAdi=c),type:"text",class:"flex-1 px-2 py-1 text-sm border border-slate-300 rounded",onKeyup:[qr(c=>s.altTurGuncelle(l),["enter"]),t[7]||(t[7]=qr(c=>i.duzenleniyorAltTur=null,["esc"]))]},null,40,xC),[[kr,i.duzenleniyorAltTurAdi]]),Qt(k("input",{"onUpdate:modelValue":t[8]||(t[8]=c=>i.duzenleniyorAltTurAciklama=c),type:"text",placeholder:"Aklama",class:"flex-1 px-2 py-1 text-sm border border-slate-300 rounded",onKeyup:[qr(c=>s.altTurGuncelle(l),["enter"]),t[9]||(t[9]=qr(c=>i.duzenleniyorAltTur=null,["esc"]))]},null,40,wC),[[kr,i.duzenleniyorAltTurAciklama]]),k("button",{onClick:c=>s.altTurGuncelle(l),class:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700"},"  ",8,yC),k("button",{onClick:t[10]||(t[10]=c=>i.duzenleniyorAltTur=null),class:"px-2 py-1 bg-slate-600 text-white text-xs rounded hover:bg-slate-700"},"  ")])):(me(),_e(rt,{key:1},[k("div",EC,Ce(l.alt_tur_adi),1),l.aciklama?(me(),_e("div",TC,Ce(l.aciklama),1)):tt("",!0)],64))]),i.duzenleniyorAltTur!==l.id?(me(),_e("div",SC,[k("button",{onClick:c=>s.altTurDuzenleBaslat(l),class:"p-1.5 text-slate-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-all",title:"Dzenle"},[...t[16]||(t[16]=[k("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,bC),k("button",{onClick:c=>s.altTurSil(l),class:"p-1.5 text-slate-600 hover:text-red-600 hover:bg-red-50 rounded transition-all",title:"Sil"},[...t[17]||(t[17]=[k("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,AC)])):tt("",!0)]))),128))])):(me(),_e("div",gC," Alt tr yok "))])]))),128))]))])])}const OC=Mi($O,[["render",kC]]),CC=m_({history:qv(),routes:[{path:"/",name:"home",component:Q4},{path:"/ders/:dersAdi",name:"dersDetay",component:jO,props:!0},{path:"/tur-yonetimi",name:"turYonetimi",component:OC}]}),w1=iv(cv);w1.use(CC);w1.mount("#app");
