function P1(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function ql(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const Ye={},_i=[],Ur=()=>{},s0=()=>!1,so=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Xl=e=>e.startsWith("onUpdate:"),Wt=Object.assign,Jl=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},N1=Object.prototype.hasOwnProperty,Ve=(e,t)=>N1.call(e,t),Ce=Array.isArray,xi=e=>Ds(e)==="[object Map]",ao=e=>Ds(e)==="[object Set]",zc=e=>Ds(e)==="[object Date]",Ie=e=>typeof e=="function",mt=e=>typeof e=="string",jr=e=>typeof e=="symbol",Qe=e=>e!==null&&typeof e=="object",a0=e=>(Qe(e)||Ie(e))&&Ie(e.then)&&Ie(e.catch),o0=Object.prototype.toString,Ds=e=>o0.call(e),D1=e=>Ds(e).slice(8,-1),l0=e=>Ds(e)==="[object Object]",Yl=e=>mt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,as=ql(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),oo=e=>{const t=Object.create(null);return(r=>t[r]||(t[r]=e(r)))},L1=/-\w/g,vr=oo(e=>e.replace(L1,t=>t.slice(1).toUpperCase())),B1=/\B([A-Z])/g,Cn=oo(e=>e.replace(B1,"-$1").toLowerCase()),lo=oo(e=>e.charAt(0).toUpperCase()+e.slice(1)),Do=oo(e=>e?`on${lo(e)}`:""),Tn=(e,t)=>!Object.is(e,t),ma=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},c0=(e,t,r,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:r})},co=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let qc;const uo=()=>qc||(qc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ql(e){if(Ce(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=mt(n)?$1(n):Ql(n);if(i)for(const s in i)t[s]=i[s]}return t}else if(mt(e)||Qe(e))return e}const M1=/;(?![^(]*\))/g,U1=/:([^]+)/,j1=/\/\*[^]*?\*\//g;function $1(e){const t={};return e.replace(j1,"").split(M1).forEach(r=>{if(r){const n=r.split(U1);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Sn(e){let t="";if(mt(e))t=e;else if(Ce(e))for(let r=0;r<e.length;r++){const n=Sn(e[r]);n&&(t+=n+" ")}else if(Qe(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const H1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",W1=ql(H1);function u0(e){return!!e||e===""}function V1(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=fo(e[n],t[n]);return r}function fo(e,t){if(e===t)return!0;let r=zc(e),n=zc(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=jr(e),n=jr(t),r||n)return e===t;if(r=Ce(e),n=Ce(t),r||n)return r&&n?V1(e,t):!1;if(r=Qe(e),n=Qe(t),r||n){if(!r||!n)return!1;const i=Object.keys(e).length,s=Object.keys(t).length;if(i!==s)return!1;for(const a in e){const o=e.hasOwnProperty(a),l=t.hasOwnProperty(a);if(o&&!l||!o&&l||!fo(e[a],t[a]))return!1}}return String(e)===String(t)}function G1(e,t){return e.findIndex(r=>fo(r,t))}const f0=e=>!!(e&&e.__v_isRef===!0),Ue=e=>mt(e)?e:e==null?"":Ce(e)||Qe(e)&&(e.toString===o0||!Ie(e.toString))?f0(e)?Ue(e.value):JSON.stringify(e,h0,2):String(e),h0=(e,t)=>f0(t)?h0(e,t.value):xi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,i],s)=>(r[Lo(n,s)+" =>"]=i,r),{})}:ao(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>Lo(r))}:jr(t)?Lo(t):Qe(t)&&!Ce(t)&&!l0(t)?String(t):t,Lo=(e,t="")=>{var r;return jr(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};let Yt;class K1{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Yt,!t&&Yt&&(this.index=(Yt.scopes||(Yt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].pause();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].resume();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].resume()}}run(t){if(this._active){const r=Yt;try{return Yt=this,t()}finally{Yt=r}}}on(){++this._on===1&&(this.prevScope=Yt,Yt=this)}off(){this._on>0&&--this._on===0&&(Yt=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function z1(){return Yt}let et;const Bo=new WeakSet;class d0{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Yt&&Yt.active&&Yt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Bo.has(this)&&(Bo.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||g0(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Xc(this),m0(this);const t=et,r=kr;et=this,kr=!0;try{return this.fn()}finally{v0(this),et=t,kr=r,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)tc(t);this.deps=this.depsTail=void 0,Xc(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Bo.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){hl(this)&&this.run()}get dirty(){return hl(this)}}let p0=0,os,ls;function g0(e,t=!1){if(e.flags|=8,t){e.next=ls,ls=e;return}e.next=os,os=e}function Zl(){p0++}function ec(){if(--p0>0)return;if(ls){let t=ls;for(ls=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let e;for(;os;){let t=os;for(os=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function m0(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function v0(e){let t,r=e.depsTail,n=r;for(;n;){const i=n.prevDep;n.version===-1?(n===r&&(r=i),tc(n),q1(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}e.deps=t,e.depsTail=r}function hl(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(_0(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function _0(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ws)||(e.globalVersion=ws,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!hl(e))))return;e.flags|=2;const t=e.dep,r=et,n=kr;et=e,kr=!0;try{m0(e);const i=e.fn(e._value);(t.version===0||Tn(i,e._value))&&(e.flags|=128,e._value=i,t.version++)}catch(i){throw t.version++,i}finally{et=r,kr=n,v0(e),e.flags&=-3}}function tc(e,t=!1){const{dep:r,prevSub:n,nextSub:i}=e;if(n&&(n.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let s=r.computed.deps;s;s=s.nextDep)tc(s,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function q1(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let kr=!0;const x0=[];function rn(){x0.push(kr),kr=!1}function nn(){const e=x0.pop();kr=e===void 0?!0:e}function Xc(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const r=et;et=void 0;try{t()}finally{et=r}}}let ws=0;class X1{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class rc{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!et||!kr||et===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==et)r=this.activeLink=new X1(et,this),et.deps?(r.prevDep=et.depsTail,et.depsTail.nextDep=r,et.depsTail=r):et.deps=et.depsTail=r,w0(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=et.depsTail,r.nextDep=void 0,et.depsTail.nextDep=r,et.depsTail=r,et.deps===r&&(et.deps=n)}return r}trigger(t){this.version++,ws++,this.notify(t)}notify(t){Zl();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{ec()}}}function w0(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)w0(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}}const dl=new WeakMap,zn=Symbol(""),pl=Symbol(""),ys=Symbol("");function Mt(e,t,r){if(kr&&et){let n=dl.get(e);n||dl.set(e,n=new Map);let i=n.get(r);i||(n.set(r,i=new rc),i.map=n,i.key=r),i.track()}}function Jr(e,t,r,n,i,s){const a=dl.get(e);if(!a){ws++;return}const o=l=>{l&&l.trigger()};if(Zl(),t==="clear")a.forEach(o);else{const l=Ce(e),c=l&&Yl(r);if(l&&r==="length"){const u=Number(n);a.forEach((f,h)=>{(h==="length"||h===ys||!jr(h)&&h>=u)&&o(f)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),c&&o(a.get(ys)),t){case"add":l?c&&o(a.get("length")):(o(a.get(zn)),xi(e)&&o(a.get(pl)));break;case"delete":l||(o(a.get(zn)),xi(e)&&o(a.get(pl)));break;case"set":xi(e)&&o(a.get(zn));break}}ec()}function ii(e){const t=We(e);return t===e?t:(Mt(t,"iterate",ys),mr(e)?t:t.map(Rr))}function ho(e){return Mt(e=We(e),"iterate",ys),e}function pn(e,t){return sn(e)?qn(e)?Ri(Rr(t)):Ri(t):Rr(t)}const J1={__proto__:null,[Symbol.iterator](){return Mo(this,Symbol.iterator,e=>pn(this,e))},concat(...e){return ii(this).concat(...e.map(t=>Ce(t)?ii(t):t))},entries(){return Mo(this,"entries",e=>(e[1]=pn(this,e[1]),e))},every(e,t){return Vr(this,"every",e,t,void 0,arguments)},filter(e,t){return Vr(this,"filter",e,t,r=>r.map(n=>pn(this,n)),arguments)},find(e,t){return Vr(this,"find",e,t,r=>pn(this,r),arguments)},findIndex(e,t){return Vr(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Vr(this,"findLast",e,t,r=>pn(this,r),arguments)},findLastIndex(e,t){return Vr(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Vr(this,"forEach",e,t,void 0,arguments)},includes(...e){return Uo(this,"includes",e)},indexOf(...e){return Uo(this,"indexOf",e)},join(e){return ii(this).join(e)},lastIndexOf(...e){return Uo(this,"lastIndexOf",e)},map(e,t){return Vr(this,"map",e,t,void 0,arguments)},pop(){return Xi(this,"pop")},push(...e){return Xi(this,"push",e)},reduce(e,...t){return Jc(this,"reduce",e,t)},reduceRight(e,...t){return Jc(this,"reduceRight",e,t)},shift(){return Xi(this,"shift")},some(e,t){return Vr(this,"some",e,t,void 0,arguments)},splice(...e){return Xi(this,"splice",e)},toReversed(){return ii(this).toReversed()},toSorted(e){return ii(this).toSorted(e)},toSpliced(...e){return ii(this).toSpliced(...e)},unshift(...e){return Xi(this,"unshift",e)},values(){return Mo(this,"values",e=>pn(this,e))}};function Mo(e,t,r){const n=ho(e),i=n[t]();return n!==e&&!mr(e)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.done||(s.value=r(s.value)),s}),i}const Y1=Array.prototype;function Vr(e,t,r,n,i,s){const a=ho(e),o=a!==e&&!mr(e),l=a[t];if(l!==Y1[t]){const f=l.apply(e,s);return o?Rr(f):f}let c=r;a!==e&&(o?c=function(f,h){return r.call(this,pn(e,f),h,e)}:r.length>2&&(c=function(f,h){return r.call(this,f,h,e)}));const u=l.call(a,c,n);return o&&i?i(u):u}function Jc(e,t,r,n){const i=ho(e);let s=r;return i!==e&&(mr(e)?r.length>3&&(s=function(a,o,l){return r.call(this,a,o,l,e)}):s=function(a,o,l){return r.call(this,a,pn(e,o),l,e)}),i[t](s,...n)}function Uo(e,t,r){const n=We(e);Mt(n,"iterate",ys);const i=n[t](...r);return(i===-1||i===!1)&&sc(r[0])?(r[0]=We(r[0]),n[t](...r)):i}function Xi(e,t,r=[]){rn(),Zl();const n=We(e)[t].apply(e,r);return ec(),nn(),n}const Q1=ql("__proto__,__v_isRef,__isVue"),y0=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(jr));function Z1(e){jr(e)||(e=String(e));const t=We(this);return Mt(t,"has",e),t.hasOwnProperty(e)}class E0{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){if(r==="__v_skip")return t.__v_skip;const i=this._isReadonly,s=this._isShallow;if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return s;if(r==="__v_raw")return n===(i?s?cg:b0:s?A0:S0).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const a=Ce(t);if(!i){let l;if(a&&(l=J1[r]))return l;if(r==="hasOwnProperty")return Z1}const o=Reflect.get(t,r,jt(t)?t:n);if((jr(r)?y0.has(r):Q1(r))||(i||Mt(t,"get",r),s))return o;if(jt(o)){const l=a&&Yl(r)?o:o.value;return i&&Qe(l)?ml(l):l}return Qe(o)?i?ml(o):po(o):o}}class T0 extends E0{constructor(t=!1){super(!1,t)}set(t,r,n,i){let s=t[r];const a=Ce(t)&&Yl(r);if(!this._isShallow){const c=sn(s);if(!mr(n)&&!sn(n)&&(s=We(s),n=We(n)),!a&&jt(s)&&!jt(n))return c||(s.value=n),!0}const o=a?Number(r)<t.length:Ve(t,r),l=Reflect.set(t,r,n,jt(t)?t:i);return t===We(i)&&(o?Tn(n,s)&&Jr(t,"set",r,n):Jr(t,"add",r,n)),l}deleteProperty(t,r){const n=Ve(t,r);t[r];const i=Reflect.deleteProperty(t,r);return i&&n&&Jr(t,"delete",r,void 0),i}has(t,r){const n=Reflect.has(t,r);return(!jr(r)||!y0.has(r))&&Mt(t,"has",r),n}ownKeys(t){return Mt(t,"iterate",Ce(t)?"length":zn),Reflect.ownKeys(t)}}class eg extends E0{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const tg=new T0,rg=new eg,ng=new T0(!0);const gl=e=>e,Js=e=>Reflect.getPrototypeOf(e);function ig(e,t,r){return function(...n){const i=this.__v_raw,s=We(i),a=xi(s),o=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,c=i[e](...n),u=r?gl:t?Ri:Rr;return!t&&Mt(s,"iterate",l?pl:zn),{next(){const{value:f,done:h}=c.next();return h?{value:f,done:h}:{value:o?[u(f[0]),u(f[1])]:u(f),done:h}},[Symbol.iterator](){return this}}}}function Ys(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function sg(e,t){const r={get(i){const s=this.__v_raw,a=We(s),o=We(i);e||(Tn(i,o)&&Mt(a,"get",i),Mt(a,"get",o));const{has:l}=Js(a),c=t?gl:e?Ri:Rr;if(l.call(a,i))return c(s.get(i));if(l.call(a,o))return c(s.get(o));s!==a&&s.get(i)},get size(){const i=this.__v_raw;return!e&&Mt(We(i),"iterate",zn),i.size},has(i){const s=this.__v_raw,a=We(s),o=We(i);return e||(Tn(i,o)&&Mt(a,"has",i),Mt(a,"has",o)),i===o?s.has(i):s.has(i)||s.has(o)},forEach(i,s){const a=this,o=a.__v_raw,l=We(o),c=t?gl:e?Ri:Rr;return!e&&Mt(l,"iterate",zn),o.forEach((u,f)=>i.call(s,c(u),c(f),a))}};return Wt(r,e?{add:Ys("add"),set:Ys("set"),delete:Ys("delete"),clear:Ys("clear")}:{add(i){!t&&!mr(i)&&!sn(i)&&(i=We(i));const s=We(this);return Js(s).has.call(s,i)||(s.add(i),Jr(s,"add",i,i)),this},set(i,s){!t&&!mr(s)&&!sn(s)&&(s=We(s));const a=We(this),{has:o,get:l}=Js(a);let c=o.call(a,i);c||(i=We(i),c=o.call(a,i));const u=l.call(a,i);return a.set(i,s),c?Tn(s,u)&&Jr(a,"set",i,s):Jr(a,"add",i,s),this},delete(i){const s=We(this),{has:a,get:o}=Js(s);let l=a.call(s,i);l||(i=We(i),l=a.call(s,i)),o&&o.call(s,i);const c=s.delete(i);return l&&Jr(s,"delete",i,void 0),c},clear(){const i=We(this),s=i.size!==0,a=i.clear();return s&&Jr(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{r[i]=ig(i,e,t)}),r}function nc(e,t){const r=sg(e,t);return(n,i,s)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(Ve(r,i)&&i in n?r:n,i,s)}const ag={get:nc(!1,!1)},og={get:nc(!1,!0)},lg={get:nc(!0,!1)};const S0=new WeakMap,A0=new WeakMap,b0=new WeakMap,cg=new WeakMap;function ug(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fg(e){return e.__v_skip||!Object.isExtensible(e)?0:ug(D1(e))}function po(e){return sn(e)?e:ic(e,!1,tg,ag,S0)}function O0(e){return ic(e,!1,ng,og,A0)}function ml(e){return ic(e,!0,rg,lg,b0)}function ic(e,t,r,n,i){if(!Qe(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=fg(e);if(s===0)return e;const a=i.get(e);if(a)return a;const o=new Proxy(e,s===2?n:r);return i.set(e,o),o}function qn(e){return sn(e)?qn(e.__v_raw):!!(e&&e.__v_isReactive)}function sn(e){return!!(e&&e.__v_isReadonly)}function mr(e){return!!(e&&e.__v_isShallow)}function sc(e){return e?!!e.__v_raw:!1}function We(e){const t=e&&e.__v_raw;return t?We(t):e}function hg(e){return!Ve(e,"__v_skip")&&Object.isExtensible(e)&&c0(e,"__v_skip",!0),e}const Rr=e=>Qe(e)?po(e):e,Ri=e=>Qe(e)?ml(e):e;function jt(e){return e?e.__v_isRef===!0:!1}function dg(e){return k0(e,!1)}function pg(e){return k0(e,!0)}function k0(e,t){return jt(e)?e:new gg(e,t)}class gg{constructor(t,r){this.dep=new rc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:We(t),this._value=r?t:Rr(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||mr(t)||sn(t);t=n?t:We(t),Tn(t,r)&&(this._rawValue=t,this._value=n?t:Rr(t),this.dep.trigger())}}function wi(e){return jt(e)?e.value:e}const mg={get:(e,t,r)=>t==="__v_raw"?e:wi(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return jt(i)&&!jt(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function C0(e){return qn(e)?e:new Proxy(e,mg)}class vg{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new rc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ws-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&et!==this)return g0(this,!0),!0}get value(){const t=this.dep.track();return _0(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function _g(e,t,r=!1){let n,i;return Ie(e)?n=e:(n=e.get,i=e.set),new vg(n,i,r)}const Qs={},Aa=new WeakMap;let Ln;function xg(e,t=!1,r=Ln){if(r){let n=Aa.get(r);n||Aa.set(r,n=[]),n.push(e)}}function wg(e,t,r=Ye){const{immediate:n,deep:i,once:s,scheduler:a,augmentJob:o,call:l}=r,c=O=>i?O:mr(O)||i===!1||i===0?Yr(O,1):Yr(O);let u,f,h,d,g=!1,p=!1;if(jt(e)?(f=()=>e.value,g=mr(e)):qn(e)?(f=()=>c(e),g=!0):Ce(e)?(p=!0,g=e.some(O=>qn(O)||mr(O)),f=()=>e.map(O=>{if(jt(O))return O.value;if(qn(O))return c(O);if(Ie(O))return l?l(O,2):O()})):Ie(e)?t?f=l?()=>l(e,2):e:f=()=>{if(h){rn();try{h()}finally{nn()}}const O=Ln;Ln=u;try{return l?l(e,3,[d]):e(d)}finally{Ln=O}}:f=Ur,t&&i){const O=f,V=i===!0?1/0:i;f=()=>Yr(O(),V)}const m=z1(),w=()=>{u.stop(),m&&m.active&&Jl(m.effects,u)};if(s&&t){const O=t;t=(...V)=>{O(...V),w()}}let T=p?new Array(e.length).fill(Qs):Qs;const _=O=>{if(!(!(u.flags&1)||!u.dirty&&!O))if(t){const V=u.run();if(i||g||(p?V.some((ee,R)=>Tn(ee,T[R])):Tn(V,T))){h&&h();const ee=Ln;Ln=u;try{const R=[V,T===Qs?void 0:p&&T[0]===Qs?[]:T,d];T=V,l?l(t,3,R):t(...R)}finally{Ln=ee}}}else u.run()};return o&&o(_),u=new d0(f),u.scheduler=a?()=>a(_,!1):_,d=O=>xg(O,!1,u),h=u.onStop=()=>{const O=Aa.get(u);if(O){if(l)l(O,4);else for(const V of O)V();Aa.delete(u)}},t?n?_(!0):T=u.run():a?a(_.bind(null,!0),!0):u.run(),w.pause=u.pause.bind(u),w.resume=u.resume.bind(u),w.stop=w,w}function Yr(e,t=1/0,r){if(t<=0||!Qe(e)||e.__v_skip||(r=r||new Map,(r.get(e)||0)>=t))return e;if(r.set(e,t),t--,jt(e))Yr(e.value,t,r);else if(Ce(e))for(let n=0;n<e.length;n++)Yr(e[n],t,r);else if(ao(e)||xi(e))e.forEach(n=>{Yr(n,t,r)});else if(l0(e)){for(const n in e)Yr(e[n],t,r);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&Yr(e[n],t,r)}return e}function Ls(e,t,r,n){try{return n?e(...n):e()}catch(i){go(i,t,r)}}function $r(e,t,r,n){if(Ie(e)){const i=Ls(e,t,r,n);return i&&a0(i)&&i.catch(s=>{go(s,t,r)}),i}if(Ce(e)){const i=[];for(let s=0;s<e.length;s++)i.push($r(e[s],t,r,n));return i}}function go(e,t,r,n=!0){const i=t?t.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||Ye;if(t){let o=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const u=o.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](e,l,c)===!1)return}o=o.parent}if(s){rn(),Ls(s,null,10,[e,l,c]),nn();return}}yg(e,r,i,n,a)}function yg(e,t,r,n=!0,i=!1){if(i)throw e;console.error(e)}const qt=[];let Dr=-1;const yi=[];let gn=null,hi=0;const R0=Promise.resolve();let ba=null;function ac(e){const t=ba||R0;return e?t.then(this?e.bind(this):e):t}function Eg(e){let t=Dr+1,r=qt.length;for(;t<r;){const n=t+r>>>1,i=qt[n],s=Es(i);s<e||s===e&&i.flags&2?t=n+1:r=n}return t}function oc(e){if(!(e.flags&1)){const t=Es(e),r=qt[qt.length-1];!r||!(e.flags&2)&&t>=Es(r)?qt.push(e):qt.splice(Eg(t),0,e),e.flags|=1,I0()}}function I0(){ba||(ba=R0.then(P0))}function Tg(e){Ce(e)?yi.push(...e):gn&&e.id===-1?gn.splice(hi+1,0,e):e.flags&1||(yi.push(e),e.flags|=1),I0()}function Yc(e,t,r=Dr+1){for(;r<qt.length;r++){const n=qt[r];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;qt.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function F0(e){if(yi.length){const t=[...new Set(yi)].sort((r,n)=>Es(r)-Es(n));if(yi.length=0,gn){gn.push(...t);return}for(gn=t,hi=0;hi<gn.length;hi++){const r=gn[hi];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}gn=null,hi=0}}const Es=e=>e.id==null?e.flags&2?-1:1/0:e.id;function P0(e){try{for(Dr=0;Dr<qt.length;Dr++){const t=qt[Dr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ls(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Dr<qt.length;Dr++){const t=qt[Dr];t&&(t.flags&=-2)}Dr=-1,qt.length=0,F0(),ba=null,(qt.length||yi.length)&&P0()}}let ur=null,N0=null;function Oa(e){const t=ur;return ur=e,N0=e&&e.type.__scopeId||null,t}function lc(e,t=ur,r){if(!t||e._n)return e;const n=(...i)=>{n._d&&Ra(-1);const s=Oa(t);let a;try{a=e(...i)}finally{Oa(s),n._d&&Ra(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Br(e,t){if(ur===null)return e;const r=xo(ur),n=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,a,o,l=Ye]=t[i];s&&(Ie(s)&&(s={mounted:s,updated:s}),s.deep&&Yr(a),n.push({dir:s,instance:r,value:a,oldValue:void 0,arg:o,modifiers:l}))}return e}function Fn(e,t,r,n){const i=e.dirs,s=t&&t.dirs;for(let a=0;a<i.length;a++){const o=i[a];s&&(o.oldValue=s[a].value);let l=o.dir[n];l&&(rn(),$r(l,r,8,[e.el,o,e,t]),nn())}}const Sg=Symbol("_vte"),Ag=e=>e.__isTeleport,bg=Symbol("_leaveCb");function cc(e,t){e.shapeFlag&6&&e.component?(e.transition=t,cc(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function D0(e,t){return Ie(e)?Wt({name:e.name},t,{setup:e}):e}function L0(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const ka=new WeakMap;function cs(e,t,r,n,i=!1){if(Ce(e)){e.forEach((g,p)=>cs(g,t&&(Ce(t)?t[p]:t),r,n,i));return}if(us(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&cs(e,t,r,n.component.subTree);return}const s=n.shapeFlag&4?xo(n.component):n.el,a=i?null:s,{i:o,r:l}=e,c=t&&t.r,u=o.refs===Ye?o.refs={}:o.refs,f=o.setupState,h=We(f),d=f===Ye?s0:g=>Ve(h,g);if(c!=null&&c!==l){if(Qc(t),mt(c))u[c]=null,d(c)&&(f[c]=null);else if(jt(c)){c.value=null;const g=t;g.k&&(u[g.k]=null)}}if(Ie(l))Ls(l,o,12,[a,u]);else{const g=mt(l),p=jt(l);if(g||p){const m=()=>{if(e.f){const w=g?d(l)?f[l]:u[l]:l.value;if(i)Ce(w)&&Jl(w,s);else if(Ce(w))w.includes(s)||w.push(s);else if(g)u[l]=[s],d(l)&&(f[l]=u[l]);else{const T=[s];l.value=T,e.k&&(u[e.k]=T)}}else g?(u[l]=a,d(l)&&(f[l]=a)):p&&(l.value=a,e.k&&(u[e.k]=a))};if(a){const w=()=>{m(),ka.delete(e)};w.id=-1,ka.set(e,w),ir(w,r)}else Qc(e),m()}}}function Qc(e){const t=ka.get(e);t&&(t.flags|=8,ka.delete(e))}uo().requestIdleCallback;uo().cancelIdleCallback;const us=e=>!!e.type.__asyncLoader,B0=e=>e.type.__isKeepAlive;function Og(e,t){M0(e,"a",t)}function kg(e,t){M0(e,"da",t)}function M0(e,t,r=Ut){const n=e.__wdc||(e.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(mo(t,n,r),r){let i=r.parent;for(;i&&i.parent;)B0(i.parent.vnode)&&Cg(n,t,r,i),i=i.parent}}function Cg(e,t,r,n){const i=mo(t,e,n,!0);U0(()=>{Jl(n[t],i)},r)}function mo(e,t,r=Ut,n=!1){if(r){const i=r[e]||(r[e]=[]),s=t.__weh||(t.__weh=(...a)=>{rn();const o=Ms(r),l=$r(t,r,e,a);return o(),nn(),l});return n?i.unshift(s):i.push(s),s}}const ln=e=>(t,r=Ut)=>{(!Ss||e==="sp")&&mo(e,(...n)=>t(...n),r)},Rg=ln("bm"),Ig=ln("m"),Fg=ln("bu"),Pg=ln("u"),Ng=ln("bum"),U0=ln("um"),Dg=ln("sp"),Lg=ln("rtg"),Bg=ln("rtc");function Mg(e,t=Ut){mo("ec",e,t)}const Ug="components";function Bs(e,t){return $g(Ug,e,!0,t)||e}const jg=Symbol.for("v-ndc");function $g(e,t,r=!0,n=!1){const i=ur||Ut;if(i){const s=i.type;{const o=Cm(s,!1);if(o&&(o===t||o===vr(t)||o===lo(vr(t))))return s}const a=Zc(i[e]||s[e],t)||Zc(i.appContext[e],t);return!a&&n?s:a}}function Zc(e,t){return e&&(e[t]||e[vr(t)]||e[lo(vr(t))])}function br(e,t,r,n){let i;const s=r,a=Ce(e);if(a||mt(e)){const o=a&&qn(e);let l=!1,c=!1;o&&(l=!mr(e),c=sn(e),e=ho(e)),i=new Array(e.length);for(let u=0,f=e.length;u<f;u++)i[u]=t(l?c?Ri(Rr(e[u])):Rr(e[u]):e[u],u,void 0,s)}else if(typeof e=="number"){i=new Array(e);for(let o=0;o<e;o++)i[o]=t(o+1,o,void 0,s)}else if(Qe(e))if(e[Symbol.iterator])i=Array.from(e,(o,l)=>t(o,l,void 0,s));else{const o=Object.keys(e);i=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const u=o[l];i[l]=t(e[u],u,l,s)}}else i=[];return i}const vl=e=>e?ah(e)?xo(e):vl(e.parent):null,fs=Wt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>vl(e.parent),$root:e=>vl(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>$0(e),$forceUpdate:e=>e.f||(e.f=()=>{oc(e.update)}),$nextTick:e=>e.n||(e.n=ac.bind(e.proxy)),$watch:e=>Qg.bind(e)}),jo=(e,t)=>e!==Ye&&!e.__isScriptSetup&&Ve(e,t),Hg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:n,data:i,props:s,accessCache:a,type:o,appContext:l}=e;if(t[0]!=="$"){const h=a[t];if(h!==void 0)switch(h){case 1:return n[t];case 2:return i[t];case 4:return r[t];case 3:return s[t]}else{if(jo(n,t))return a[t]=1,n[t];if(i!==Ye&&Ve(i,t))return a[t]=2,i[t];if(Ve(s,t))return a[t]=3,s[t];if(r!==Ye&&Ve(r,t))return a[t]=4,r[t];_l&&(a[t]=0)}}const c=fs[t];let u,f;if(c)return t==="$attrs"&&Mt(e.attrs,"get",""),c(e);if((u=o.__cssModules)&&(u=u[t]))return u;if(r!==Ye&&Ve(r,t))return a[t]=4,r[t];if(f=l.config.globalProperties,Ve(f,t))return f[t]},set({_:e},t,r){const{data:n,setupState:i,ctx:s}=e;return jo(i,t)?(i[t]=r,!0):n!==Ye&&Ve(n,t)?(n[t]=r,!0):Ve(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:i,props:s,type:a}},o){let l;return!!(r[o]||e!==Ye&&o[0]!=="$"&&Ve(e,o)||jo(t,o)||Ve(s,o)||Ve(n,o)||Ve(fs,o)||Ve(i.config.globalProperties,o)||(l=a.__cssModules)&&l[o])},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Ve(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function eu(e){return Ce(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let _l=!0;function Wg(e){const t=$0(e),r=e.proxy,n=e.ctx;_l=!1,t.beforeCreate&&tu(t.beforeCreate,e,"bc");const{data:i,computed:s,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:f,mounted:h,beforeUpdate:d,updated:g,activated:p,deactivated:m,beforeDestroy:w,beforeUnmount:T,destroyed:_,unmounted:O,render:V,renderTracked:ee,renderTriggered:R,errorCaptured:q,serverPrefetch:B,expose:te,inheritAttrs:ne,components:se,directives:de,filters:Be}=t;if(c&&Vg(c,n,null),a)for(const Ae in a){const Fe=a[Ae];Ie(Fe)&&(n[Ae]=Fe.bind(r))}if(i){const Ae=i.call(r,r);Qe(Ae)&&(e.data=po(Ae))}if(_l=!0,s)for(const Ae in s){const Fe=s[Ae],Xe=Ie(Fe)?Fe.bind(r,r):Ie(Fe.get)?Fe.get.bind(r,r):Ur,ut=!Ie(Fe)&&Ie(Fe.set)?Fe.set.bind(r):Ur,rt=Sr({get:Xe,set:ut});Object.defineProperty(n,Ae,{enumerable:!0,configurable:!0,get:()=>rt.value,set:C=>rt.value=C})}if(o)for(const Ae in o)j0(o[Ae],n,r,Ae);if(l){const Ae=Ie(l)?l.call(r):l;Reflect.ownKeys(Ae).forEach(Fe=>{va(Fe,Ae[Fe])})}u&&tu(u,e,"c");function Le(Ae,Fe){Ce(Fe)?Fe.forEach(Xe=>Ae(Xe.bind(r))):Fe&&Ae(Fe.bind(r))}if(Le(Rg,f),Le(Ig,h),Le(Fg,d),Le(Pg,g),Le(Og,p),Le(kg,m),Le(Mg,q),Le(Bg,ee),Le(Lg,R),Le(Ng,T),Le(U0,O),Le(Dg,B),Ce(te))if(te.length){const Ae=e.exposed||(e.exposed={});te.forEach(Fe=>{Object.defineProperty(Ae,Fe,{get:()=>r[Fe],set:Xe=>r[Fe]=Xe,enumerable:!0})})}else e.exposed||(e.exposed={});V&&e.render===Ur&&(e.render=V),ne!=null&&(e.inheritAttrs=ne),se&&(e.components=se),de&&(e.directives=de),B&&L0(e)}function Vg(e,t,r=Ur){Ce(e)&&(e=xl(e));for(const n in e){const i=e[n];let s;Qe(i)?"default"in i?s=Qr(i.from||n,i.default,!0):s=Qr(i.from||n):s=Qr(i),jt(s)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):t[n]=s}}function tu(e,t,r){$r(Ce(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function j0(e,t,r,n){let i=n.includes(".")?V0(r,n):()=>r[n];if(mt(e)){const s=t[e];Ie(s)&&_a(i,s)}else if(Ie(e))_a(i,e.bind(r));else if(Qe(e))if(Ce(e))e.forEach(s=>j0(s,t,r,n));else{const s=Ie(e.handler)?e.handler.bind(r):t[e.handler];Ie(s)&&_a(i,s,e)}}function $0(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:i,optionsCache:s,config:{optionMergeStrategies:a}}=e.appContext,o=s.get(t);let l;return o?l=o:!i.length&&!r&&!n?l=t:(l={},i.length&&i.forEach(c=>Ca(l,c,a,!0)),Ca(l,t,a)),Qe(t)&&s.set(t,l),l}function Ca(e,t,r,n=!1){const{mixins:i,extends:s}=t;s&&Ca(e,s,r,!0),i&&i.forEach(a=>Ca(e,a,r,!0));for(const a in t)if(!(n&&a==="expose")){const o=Gg[a]||r&&r[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const Gg={data:ru,props:nu,emits:nu,methods:ts,computed:ts,beforeCreate:Vt,created:Vt,beforeMount:Vt,mounted:Vt,beforeUpdate:Vt,updated:Vt,beforeDestroy:Vt,beforeUnmount:Vt,destroyed:Vt,unmounted:Vt,activated:Vt,deactivated:Vt,errorCaptured:Vt,serverPrefetch:Vt,components:ts,directives:ts,watch:zg,provide:ru,inject:Kg};function ru(e,t){return t?e?function(){return Wt(Ie(e)?e.call(this,this):e,Ie(t)?t.call(this,this):t)}:t:e}function Kg(e,t){return ts(xl(e),xl(t))}function xl(e){if(Ce(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Vt(e,t){return e?[...new Set([].concat(e,t))]:t}function ts(e,t){return e?Wt(Object.create(null),e,t):t}function nu(e,t){return e?Ce(e)&&Ce(t)?[...new Set([...e,...t])]:Wt(Object.create(null),eu(e),eu(t??{})):t}function zg(e,t){if(!e)return t;if(!t)return e;const r=Wt(Object.create(null),e);for(const n in t)r[n]=Vt(e[n],t[n]);return r}function H0(){return{app:null,config:{isNativeTag:s0,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let qg=0;function Xg(e,t){return function(n,i=null){Ie(n)||(n=Wt({},n)),i!=null&&!Qe(i)&&(i=null);const s=H0(),a=new WeakSet,o=[];let l=!1;const c=s.app={_uid:qg++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:Im,get config(){return s.config},set config(u){},use(u,...f){return a.has(u)||(u&&Ie(u.install)?(a.add(u),u.install(c,...f)):Ie(u)&&(a.add(u),u(c,...f))),c},mixin(u){return s.mixins.includes(u)||s.mixins.push(u),c},component(u,f){return f?(s.components[u]=f,c):s.components[u]},directive(u,f){return f?(s.directives[u]=f,c):s.directives[u]},mount(u,f,h){if(!l){const d=c._ceVNode||yt(n,i);return d.appContext=s,h===!0?h="svg":h===!1&&(h=void 0),e(d,u,h),l=!0,c._container=u,u.__vue_app__=c,xo(d.component)}},onUnmount(u){o.push(u)},unmount(){l&&($r(o,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(u,f){return s.provides[u]=f,c},runWithContext(u){const f=Ei;Ei=c;try{return u()}finally{Ei=f}}};return c}}let Ei=null;function va(e,t){if(Ut){let r=Ut.provides;const n=Ut.parent&&Ut.parent.provides;n===r&&(r=Ut.provides=Object.create(n)),r[e]=t}}function Qr(e,t,r=!1){const n=Sm();if(n||Ei){let i=Ei?Ei._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return r&&Ie(t)?t.call(n&&n.proxy):t}}const Jg=Symbol.for("v-scx"),Yg=()=>Qr(Jg);function _a(e,t,r){return W0(e,t,r)}function W0(e,t,r=Ye){const{immediate:n,deep:i,flush:s,once:a}=r,o=Wt({},r),l=t&&n||!t&&s!=="post";let c;if(Ss){if(s==="sync"){const d=Yg();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=Ur,d.resume=Ur,d.pause=Ur,d}}const u=Ut;o.call=(d,g,p)=>$r(d,u,g,p);let f=!1;s==="post"?o.scheduler=d=>{ir(d,u&&u.suspense)}:s!=="sync"&&(f=!0,o.scheduler=(d,g)=>{g?d():oc(d)}),o.augmentJob=d=>{t&&(d.flags|=4),f&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const h=wg(e,t,o);return Ss&&(c?c.push(h):l&&h()),h}function Qg(e,t,r){const n=this.proxy,i=mt(e)?e.includes(".")?V0(n,e):()=>n[e]:e.bind(n,n);let s;Ie(t)?s=t:(s=t.handler,r=t);const a=Ms(this),o=W0(i,s.bind(n),r);return a(),o}function V0(e,t){const r=t.split(".");return()=>{let n=e;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}const Zg=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${vr(t)}Modifiers`]||e[`${Cn(t)}Modifiers`];function em(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Ye;let i=r;const s=t.startsWith("update:"),a=s&&Zg(n,t.slice(7));a&&(a.trim&&(i=r.map(u=>mt(u)?u.trim():u)),a.number&&(i=r.map(co)));let o,l=n[o=Do(t)]||n[o=Do(vr(t))];!l&&s&&(l=n[o=Do(Cn(t))]),l&&$r(l,e,6,i);const c=n[o+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,$r(c,e,6,i)}}const tm=new WeakMap;function G0(e,t,r=!1){const n=r?tm:t.emitsCache,i=n.get(e);if(i!==void 0)return i;const s=e.emits;let a={},o=!1;if(!Ie(e)){const l=c=>{const u=G0(c,t,!0);u&&(o=!0,Wt(a,u))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!s&&!o?(Qe(e)&&n.set(e,null),null):(Ce(s)?s.forEach(l=>a[l]=null):Wt(a,s),Qe(e)&&n.set(e,a),a)}function vo(e,t){return!e||!so(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ve(e,t[0].toLowerCase()+t.slice(1))||Ve(e,Cn(t))||Ve(e,t))}function iu(e){const{type:t,vnode:r,proxy:n,withProxy:i,propsOptions:[s],slots:a,attrs:o,emit:l,render:c,renderCache:u,props:f,data:h,setupState:d,ctx:g,inheritAttrs:p}=e,m=Oa(e);let w,T;try{if(r.shapeFlag&4){const O=i||n,V=O;w=Mr(c.call(V,O,u,f,d,h,g)),T=o}else{const O=t;w=Mr(O.length>1?O(f,{attrs:o,slots:a,emit:l}):O(f,null)),T=t.props?o:rm(o)}}catch(O){hs.length=0,go(O,e,1),w=yt(An)}let _=w;if(T&&p!==!1){const O=Object.keys(T),{shapeFlag:V}=_;O.length&&V&7&&(s&&O.some(Xl)&&(T=nm(T,s)),_=Ii(_,T,!1,!0))}return r.dirs&&(_=Ii(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(r.dirs):r.dirs),r.transition&&cc(_,r.transition),w=_,Oa(m),w}const rm=e=>{let t;for(const r in e)(r==="class"||r==="style"||so(r))&&((t||(t={}))[r]=e[r]);return t},nm=(e,t)=>{const r={};for(const n in e)(!Xl(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function im(e,t,r){const{props:n,children:i,component:s}=e,{props:a,children:o,patchFlag:l}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?su(n,a,c):!!a;if(l&8){const u=t.dynamicProps;for(let f=0;f<u.length;f++){const h=u[f];if(a[h]!==n[h]&&!vo(c,h))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?su(n,a,c):!0:!!a;return!1}function su(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(t[s]!==e[s]&&!vo(r,s))return!0}return!1}function sm({vnode:e,parent:t},r){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=r,t=t.parent;else break}}const K0={},z0=()=>Object.create(K0),q0=e=>Object.getPrototypeOf(e)===K0;function am(e,t,r,n=!1){const i={},s=z0();e.propsDefaults=Object.create(null),X0(e,t,i,s);for(const a in e.propsOptions[0])a in i||(i[a]=void 0);r?e.props=n?i:O0(i):e.type.props?e.props=i:e.props=s,e.attrs=s}function om(e,t,r,n){const{props:i,attrs:s,vnode:{patchFlag:a}}=e,o=We(i),[l]=e.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=e.vnode.dynamicProps;for(let f=0;f<u.length;f++){let h=u[f];if(vo(e.emitsOptions,h))continue;const d=t[h];if(l)if(Ve(s,h))d!==s[h]&&(s[h]=d,c=!0);else{const g=vr(h);i[g]=wl(l,o,g,d,e,!1)}else d!==s[h]&&(s[h]=d,c=!0)}}}else{X0(e,t,i,s)&&(c=!0);let u;for(const f in o)(!t||!Ve(t,f)&&((u=Cn(f))===f||!Ve(t,u)))&&(l?r&&(r[f]!==void 0||r[u]!==void 0)&&(i[f]=wl(l,o,f,void 0,e,!0)):delete i[f]);if(s!==o)for(const f in s)(!t||!Ve(t,f))&&(delete s[f],c=!0)}c&&Jr(e.attrs,"set","")}function X0(e,t,r,n){const[i,s]=e.propsOptions;let a=!1,o;if(t)for(let l in t){if(as(l))continue;const c=t[l];let u;i&&Ve(i,u=vr(l))?!s||!s.includes(u)?r[u]=c:(o||(o={}))[u]=c:vo(e.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(s){const l=We(r),c=o||Ye;for(let u=0;u<s.length;u++){const f=s[u];r[f]=wl(i,l,f,c[f],e,!Ve(c,f))}}return a}function wl(e,t,r,n,i,s){const a=e[r];if(a!=null){const o=Ve(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&Ie(l)){const{propsDefaults:c}=i;if(r in c)n=c[r];else{const u=Ms(i);n=c[r]=l.call(null,t),u()}}else n=l;i.ce&&i.ce._setProp(r,n)}a[0]&&(s&&!o?n=!1:a[1]&&(n===""||n===Cn(r))&&(n=!0))}return n}const lm=new WeakMap;function J0(e,t,r=!1){const n=r?lm:t.propsCache,i=n.get(e);if(i)return i;const s=e.props,a={},o=[];let l=!1;if(!Ie(e)){const u=f=>{l=!0;const[h,d]=J0(f,t,!0);Wt(a,h),d&&o.push(...d)};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!s&&!l)return Qe(e)&&n.set(e,_i),_i;if(Ce(s))for(let u=0;u<s.length;u++){const f=vr(s[u]);au(f)&&(a[f]=Ye)}else if(s)for(const u in s){const f=vr(u);if(au(f)){const h=s[u],d=a[f]=Ce(h)||Ie(h)?{type:h}:Wt({},h),g=d.type;let p=!1,m=!0;if(Ce(g))for(let w=0;w<g.length;++w){const T=g[w],_=Ie(T)&&T.name;if(_==="Boolean"){p=!0;break}else _==="String"&&(m=!1)}else p=Ie(g)&&g.name==="Boolean";d[0]=p,d[1]=m,(p||Ve(d,"default"))&&o.push(f)}}const c=[a,o];return Qe(e)&&n.set(e,c),c}function au(e){return e[0]!=="$"&&!as(e)}const uc=e=>e==="_"||e==="_ctx"||e==="$stable",fc=e=>Ce(e)?e.map(Mr):[Mr(e)],cm=(e,t,r)=>{if(t._n)return t;const n=lc((...i)=>fc(t(...i)),r);return n._c=!1,n},Y0=(e,t,r)=>{const n=e._ctx;for(const i in e){if(uc(i))continue;const s=e[i];if(Ie(s))t[i]=cm(i,s,n);else if(s!=null){const a=fc(s);t[i]=()=>a}}},Q0=(e,t)=>{const r=fc(t);e.slots.default=()=>r},Z0=(e,t,r)=>{for(const n in t)(r||!uc(n))&&(e[n]=t[n])},um=(e,t,r)=>{const n=e.slots=z0();if(e.vnode.shapeFlag&32){const i=t._;i?(Z0(n,t,r),r&&c0(n,"_",i,!0)):Y0(t,n)}else t&&Q0(e,t)},fm=(e,t,r)=>{const{vnode:n,slots:i}=e;let s=!0,a=Ye;if(n.shapeFlag&32){const o=t._;o?r&&o===1?s=!1:Z0(i,t,r):(s=!t.$stable,Y0(t,i)),a=t}else t&&(Q0(e,t),a={default:1});if(s)for(const o in i)!uc(o)&&a[o]==null&&delete i[o]},ir=mm;function hm(e){return dm(e)}function dm(e,t){const r=uo();r.__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:h,setScopeId:d=Ur,insertStaticContent:g}=e,p=(E,k,I,J=null,K=null,N=null,ue=void 0,le=null,oe=!!k.dynamicChildren)=>{if(E===k)return;E&&!Ji(E,k)&&(J=D(E),C(E,K,N,!0),E=null),k.patchFlag===-2&&(oe=!1,k.dynamicChildren=null);const{type:ie,ref:Se,shapeFlag:ge}=k;switch(ie){case _o:m(E,k,I,J);break;case An:w(E,k,I,J);break;case Ho:E==null&&T(k,I,J,ue);break;case it:se(E,k,I,J,K,N,ue,le,oe);break;default:ge&1?V(E,k,I,J,K,N,ue,le,oe):ge&6?de(E,k,I,J,K,N,ue,le,oe):(ge&64||ge&128)&&ie.process(E,k,I,J,K,N,ue,le,oe,X)}Se!=null&&K?cs(Se,E&&E.ref,N,k||E,!k):Se==null&&E&&E.ref!=null&&cs(E.ref,null,N,E,!0)},m=(E,k,I,J)=>{if(E==null)n(k.el=o(k.children),I,J);else{const K=k.el=E.el;k.children!==E.children&&c(K,k.children)}},w=(E,k,I,J)=>{E==null?n(k.el=l(k.children||""),I,J):k.el=E.el},T=(E,k,I,J)=>{[E.el,E.anchor]=g(E.children,k,I,J,E.el,E.anchor)},_=({el:E,anchor:k},I,J)=>{let K;for(;E&&E!==k;)K=h(E),n(E,I,J),E=K;n(k,I,J)},O=({el:E,anchor:k})=>{let I;for(;E&&E!==k;)I=h(E),i(E),E=I;i(k)},V=(E,k,I,J,K,N,ue,le,oe)=>{if(k.type==="svg"?ue="svg":k.type==="math"&&(ue="mathml"),E==null)ee(k,I,J,K,N,ue,le,oe);else{const ie=E.el&&E.el._isVueCE?E.el:null;try{ie&&ie._beginPatch(),B(E,k,K,N,ue,le,oe)}finally{ie&&ie._endPatch()}}},ee=(E,k,I,J,K,N,ue,le)=>{let oe,ie;const{props:Se,shapeFlag:ge,transition:we,dirs:be}=E;if(oe=E.el=a(E.type,N,Se&&Se.is,Se),ge&8?u(oe,E.children):ge&16&&q(E.children,oe,null,J,K,$o(E,N),ue,le),be&&Fn(E,null,J,"created"),R(oe,E,E.scopeId,ue,J),Se){for(const $e in Se)$e!=="value"&&!as($e)&&s(oe,$e,null,Se[$e],N,J);"value"in Se&&s(oe,"value",null,Se.value,N),(ie=Se.onVnodeBeforeMount)&&Fr(ie,J,E)}be&&Fn(E,null,J,"beforeMount");const Ne=pm(K,we);Ne&&we.beforeEnter(oe),n(oe,k,I),((ie=Se&&Se.onVnodeMounted)||Ne||be)&&ir(()=>{ie&&Fr(ie,J,E),Ne&&we.enter(oe),be&&Fn(E,null,J,"mounted")},K)},R=(E,k,I,J,K)=>{if(I&&d(E,I),J)for(let N=0;N<J.length;N++)d(E,J[N]);if(K){let N=K.subTree;if(k===N||rh(N.type)&&(N.ssContent===k||N.ssFallback===k)){const ue=K.vnode;R(E,ue,ue.scopeId,ue.slotScopeIds,K.parent)}}},q=(E,k,I,J,K,N,ue,le,oe=0)=>{for(let ie=oe;ie<E.length;ie++){const Se=E[ie]=le?mn(E[ie]):Mr(E[ie]);p(null,Se,k,I,J,K,N,ue,le)}},B=(E,k,I,J,K,N,ue)=>{const le=k.el=E.el;let{patchFlag:oe,dynamicChildren:ie,dirs:Se}=k;oe|=E.patchFlag&16;const ge=E.props||Ye,we=k.props||Ye;let be;if(I&&Pn(I,!1),(be=we.onVnodeBeforeUpdate)&&Fr(be,I,k,E),Se&&Fn(k,E,I,"beforeUpdate"),I&&Pn(I,!0),(ge.innerHTML&&we.innerHTML==null||ge.textContent&&we.textContent==null)&&u(le,""),ie?te(E.dynamicChildren,ie,le,I,J,$o(k,K),N):ue||Fe(E,k,le,null,I,J,$o(k,K),N,!1),oe>0){if(oe&16)ne(le,ge,we,I,K);else if(oe&2&&ge.class!==we.class&&s(le,"class",null,we.class,K),oe&4&&s(le,"style",ge.style,we.style,K),oe&8){const Ne=k.dynamicProps;for(let $e=0;$e<Ne.length;$e++){const De=Ne[$e],Nt=ge[De],St=we[De];(St!==Nt||De==="value")&&s(le,De,Nt,St,K,I)}}oe&1&&E.children!==k.children&&u(le,k.children)}else!ue&&ie==null&&ne(le,ge,we,I,K);((be=we.onVnodeUpdated)||Se)&&ir(()=>{be&&Fr(be,I,k,E),Se&&Fn(k,E,I,"updated")},J)},te=(E,k,I,J,K,N,ue)=>{for(let le=0;le<k.length;le++){const oe=E[le],ie=k[le],Se=oe.el&&(oe.type===it||!Ji(oe,ie)||oe.shapeFlag&198)?f(oe.el):I;p(oe,ie,Se,null,J,K,N,ue,!0)}},ne=(E,k,I,J,K)=>{if(k!==I){if(k!==Ye)for(const N in k)!as(N)&&!(N in I)&&s(E,N,k[N],null,K,J);for(const N in I){if(as(N))continue;const ue=I[N],le=k[N];ue!==le&&N!=="value"&&s(E,N,le,ue,K,J)}"value"in I&&s(E,"value",k.value,I.value,K)}},se=(E,k,I,J,K,N,ue,le,oe)=>{const ie=k.el=E?E.el:o(""),Se=k.anchor=E?E.anchor:o("");let{patchFlag:ge,dynamicChildren:we,slotScopeIds:be}=k;be&&(le=le?le.concat(be):be),E==null?(n(ie,I,J),n(Se,I,J),q(k.children||[],I,Se,K,N,ue,le,oe)):ge>0&&ge&64&&we&&E.dynamicChildren?(te(E.dynamicChildren,we,I,K,N,ue,le),(k.key!=null||K&&k===K.subTree)&&eh(E,k,!0)):Fe(E,k,I,Se,K,N,ue,le,oe)},de=(E,k,I,J,K,N,ue,le,oe)=>{k.slotScopeIds=le,E==null?k.shapeFlag&512?K.ctx.activate(k,I,J,ue,oe):Be(k,I,J,K,N,ue,oe):ke(E,k,oe)},Be=(E,k,I,J,K,N,ue)=>{const le=E.component=Tm(E,J,K);if(B0(E)&&(le.ctx.renderer=X),Am(le,!1,ue),le.asyncDep){if(K&&K.registerDep(le,Le,ue),!E.el){const oe=le.subTree=yt(An);w(null,oe,k,I),E.placeholder=oe.el}}else Le(le,E,k,I,K,N,ue)},ke=(E,k,I)=>{const J=k.component=E.component;if(im(E,k,I))if(J.asyncDep&&!J.asyncResolved){Ae(J,k,I);return}else J.next=k,J.update();else k.el=E.el,J.vnode=k},Le=(E,k,I,J,K,N,ue)=>{const le=()=>{if(E.isMounted){let{next:ge,bu:we,u:be,parent:Ne,vnode:$e}=E;{const nr=th(E);if(nr){ge&&(ge.el=$e.el,Ae(E,ge,ue)),nr.asyncDep.then(()=>{E.isUnmounted||le()});return}}let De=ge,Nt;Pn(E,!1),ge?(ge.el=$e.el,Ae(E,ge,ue)):ge=$e,we&&ma(we),(Nt=ge.props&&ge.props.onVnodeBeforeUpdate)&&Fr(Nt,Ne,ge,$e),Pn(E,!0);const St=iu(E),rr=E.subTree;E.subTree=St,p(rr,St,f(rr.el),D(rr),E,K,N),ge.el=St.el,De===null&&sm(E,St.el),be&&ir(be,K),(Nt=ge.props&&ge.props.onVnodeUpdated)&&ir(()=>Fr(Nt,Ne,ge,$e),K)}else{let ge;const{el:we,props:be}=k,{bm:Ne,m:$e,parent:De,root:Nt,type:St}=E,rr=us(k);Pn(E,!1),Ne&&ma(Ne),!rr&&(ge=be&&be.onVnodeBeforeMount)&&Fr(ge,De,k),Pn(E,!0);{Nt.ce&&Nt.ce._def.shadowRoot!==!1&&Nt.ce._injectChildStyle(St);const nr=E.subTree=iu(E);p(null,nr,I,J,E,K,N),k.el=nr.el}if($e&&ir($e,K),!rr&&(ge=be&&be.onVnodeMounted)){const nr=k;ir(()=>Fr(ge,De,nr),K)}(k.shapeFlag&256||De&&us(De.vnode)&&De.vnode.shapeFlag&256)&&E.a&&ir(E.a,K),E.isMounted=!0,k=I=J=null}};E.scope.on();const oe=E.effect=new d0(le);E.scope.off();const ie=E.update=oe.run.bind(oe),Se=E.job=oe.runIfDirty.bind(oe);Se.i=E,Se.id=E.uid,oe.scheduler=()=>oc(Se),Pn(E,!0),ie()},Ae=(E,k,I)=>{k.component=E;const J=E.vnode.props;E.vnode=k,E.next=null,om(E,k.props,J,I),fm(E,k.children,I),rn(),Yc(E),nn()},Fe=(E,k,I,J,K,N,ue,le,oe=!1)=>{const ie=E&&E.children,Se=E?E.shapeFlag:0,ge=k.children,{patchFlag:we,shapeFlag:be}=k;if(we>0){if(we&128){ut(ie,ge,I,J,K,N,ue,le,oe);return}else if(we&256){Xe(ie,ge,I,J,K,N,ue,le,oe);return}}be&8?(Se&16&&Z(ie,K,N),ge!==ie&&u(I,ge)):Se&16?be&16?ut(ie,ge,I,J,K,N,ue,le,oe):Z(ie,K,N,!0):(Se&8&&u(I,""),be&16&&q(ge,I,J,K,N,ue,le,oe))},Xe=(E,k,I,J,K,N,ue,le,oe)=>{E=E||_i,k=k||_i;const ie=E.length,Se=k.length,ge=Math.min(ie,Se);let we;for(we=0;we<ge;we++){const be=k[we]=oe?mn(k[we]):Mr(k[we]);p(E[we],be,I,null,K,N,ue,le,oe)}ie>Se?Z(E,K,N,!0,!1,ge):q(k,I,J,K,N,ue,le,oe,ge)},ut=(E,k,I,J,K,N,ue,le,oe)=>{let ie=0;const Se=k.length;let ge=E.length-1,we=Se-1;for(;ie<=ge&&ie<=we;){const be=E[ie],Ne=k[ie]=oe?mn(k[ie]):Mr(k[ie]);if(Ji(be,Ne))p(be,Ne,I,null,K,N,ue,le,oe);else break;ie++}for(;ie<=ge&&ie<=we;){const be=E[ge],Ne=k[we]=oe?mn(k[we]):Mr(k[we]);if(Ji(be,Ne))p(be,Ne,I,null,K,N,ue,le,oe);else break;ge--,we--}if(ie>ge){if(ie<=we){const be=we+1,Ne=be<Se?k[be].el:J;for(;ie<=we;)p(null,k[ie]=oe?mn(k[ie]):Mr(k[ie]),I,Ne,K,N,ue,le,oe),ie++}}else if(ie>we)for(;ie<=ge;)C(E[ie],K,N,!0),ie++;else{const be=ie,Ne=ie,$e=new Map;for(ie=Ne;ie<=we;ie++){const Dt=k[ie]=oe?mn(k[ie]):Mr(k[ie]);Dt.key!=null&&$e.set(Dt.key,ie)}let De,Nt=0;const St=we-Ne+1;let rr=!1,nr=0;const fn=new Array(St);for(ie=0;ie<St;ie++)fn[ie]=0;for(ie=be;ie<=ge;ie++){const Dt=E[ie];if(Nt>=St){C(Dt,K,N,!0);continue}let dr;if(Dt.key!=null)dr=$e.get(Dt.key);else for(De=Ne;De<=we;De++)if(fn[De-Ne]===0&&Ji(Dt,k[De])){dr=De;break}dr===void 0?C(Dt,K,N,!0):(fn[dr-Ne]=ie+1,dr>=nr?nr=dr:rr=!0,p(Dt,k[dr],I,null,K,N,ue,le,oe),Nt++)}const Vi=rr?gm(fn):_i;for(De=Vi.length-1,ie=St-1;ie>=0;ie--){const Dt=Ne+ie,dr=k[Dt],qs=k[Dt+1],Gi=Dt+1<Se?qs.el||qs.placeholder:J;fn[ie]===0?p(null,dr,I,Gi,K,N,ue,le,oe):rr&&(De<0||ie!==Vi[De]?rt(dr,I,Gi,2):De--)}}},rt=(E,k,I,J,K=null)=>{const{el:N,type:ue,transition:le,children:oe,shapeFlag:ie}=E;if(ie&6){rt(E.component.subTree,k,I,J);return}if(ie&128){E.suspense.move(k,I,J);return}if(ie&64){ue.move(E,k,I,X);return}if(ue===it){n(N,k,I);for(let ge=0;ge<oe.length;ge++)rt(oe[ge],k,I,J);n(E.anchor,k,I);return}if(ue===Ho){_(E,k,I);return}if(J!==2&&ie&1&&le)if(J===0)le.beforeEnter(N),n(N,k,I),ir(()=>le.enter(N),K);else{const{leave:ge,delayLeave:we,afterLeave:be}=le,Ne=()=>{E.ctx.isUnmounted?i(N):n(N,k,I)},$e=()=>{N._isLeaving&&N[bg](!0),ge(N,()=>{Ne(),be&&be()})};we?we(N,Ne,$e):$e()}else n(N,k,I)},C=(E,k,I,J=!1,K=!1)=>{const{type:N,props:ue,ref:le,children:oe,dynamicChildren:ie,shapeFlag:Se,patchFlag:ge,dirs:we,cacheIndex:be}=E;if(ge===-2&&(K=!1),le!=null&&(rn(),cs(le,null,I,E,!0),nn()),be!=null&&(k.renderCache[be]=void 0),Se&256){k.ctx.deactivate(E);return}const Ne=Se&1&&we,$e=!us(E);let De;if($e&&(De=ue&&ue.onVnodeBeforeUnmount)&&Fr(De,k,E),Se&6)F(E.component,I,J);else{if(Se&128){E.suspense.unmount(I,J);return}Ne&&Fn(E,null,k,"beforeUnmount"),Se&64?E.type.remove(E,k,I,X,J):ie&&!ie.hasOnce&&(N!==it||ge>0&&ge&64)?Z(ie,k,I,!1,!0):(N===it&&ge&384||!K&&Se&16)&&Z(oe,k,I),J&&H(E)}($e&&(De=ue&&ue.onVnodeUnmounted)||Ne)&&ir(()=>{De&&Fr(De,k,E),Ne&&Fn(E,null,k,"unmounted")},I)},H=E=>{const{type:k,el:I,anchor:J,transition:K}=E;if(k===it){P(I,J);return}if(k===Ho){O(E);return}const N=()=>{i(I),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(E.shapeFlag&1&&K&&!K.persisted){const{leave:ue,delayLeave:le}=K,oe=()=>ue(I,N);le?le(E.el,N,oe):oe()}else N()},P=(E,k)=>{let I;for(;E!==k;)I=h(E),i(E),E=I;i(k)},F=(E,k,I)=>{const{bum:J,scope:K,job:N,subTree:ue,um:le,m:oe,a:ie}=E;ou(oe),ou(ie),J&&ma(J),K.stop(),N&&(N.flags|=8,C(ue,E,k,I)),le&&ir(le,k),ir(()=>{E.isUnmounted=!0},k)},Z=(E,k,I,J=!1,K=!1,N=0)=>{for(let ue=N;ue<E.length;ue++)C(E[ue],k,I,J,K)},D=E=>{if(E.shapeFlag&6)return D(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const k=h(E.anchor||E.el),I=k&&k[Sg];return I?h(I):k};let Q=!1;const G=(E,k,I)=>{E==null?k._vnode&&C(k._vnode,null,null,!0):p(k._vnode||null,E,k,null,null,null,I),k._vnode=E,Q||(Q=!0,Yc(),F0(),Q=!1)},X={p,um:C,m:rt,r:H,mt:Be,mc:q,pc:Fe,pbc:te,n:D,o:e};return{render:G,hydrate:void 0,createApp:Xg(G)}}function $o({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function Pn({effect:e,job:t},r){r?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function pm(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function eh(e,t,r=!1){const n=e.children,i=t.children;if(Ce(n)&&Ce(i))for(let s=0;s<n.length;s++){const a=n[s];let o=i[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[s]=mn(i[s]),o.el=a.el),!r&&o.patchFlag!==-2&&eh(a,o)),o.type===_o&&o.patchFlag!==-1&&(o.el=a.el),o.type===An&&!o.el&&(o.el=a.el)}}function gm(e){const t=e.slice(),r=[0];let n,i,s,a,o;const l=e.length;for(n=0;n<l;n++){const c=e[n];if(c!==0){if(i=r[r.length-1],e[i]<c){t[n]=i,r.push(n);continue}for(s=0,a=r.length-1;s<a;)o=s+a>>1,e[r[o]]<c?s=o+1:a=o;c<e[r[s]]&&(s>0&&(t[n]=r[s-1]),r[s]=n)}}for(s=r.length,a=r[s-1];s-- >0;)r[s]=a,a=t[a];return r}function th(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:th(t)}function ou(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const rh=e=>e.__isSuspense;function mm(e,t){t&&t.pendingBranch?Ce(e)?t.effects.push(...e):t.effects.push(e):Tg(e)}const it=Symbol.for("v-fgt"),_o=Symbol.for("v-txt"),An=Symbol.for("v-cmt"),Ho=Symbol.for("v-stc"),hs=[];let fr=null;function xe(e=!1){hs.push(fr=e?null:[])}function vm(){hs.pop(),fr=hs[hs.length-1]||null}let Ts=1;function Ra(e,t=!1){Ts+=e,e<0&&fr&&t&&(fr.hasOnce=!0)}function nh(e){return e.dynamicChildren=Ts>0?fr||_i:null,vm(),Ts>0&&fr&&fr.push(e),e}function Ee(e,t,r,n,i,s){return nh(L(e,t,r,n,i,s,!0))}function ih(e,t,r,n,i){return nh(yt(e,t,r,n,i,!0))}function Ia(e){return e?e.__v_isVNode===!0:!1}function Ji(e,t){return e.type===t.type&&e.key===t.key}const sh=({key:e})=>e??null,xa=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?mt(e)||jt(e)||Ie(e)?{i:ur,r:e,k:t,f:!!r}:e:null);function L(e,t=null,r=null,n=0,i=null,s=e===it?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&sh(t),ref:t&&xa(t),scopeId:N0,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:ur};return o?(hc(l,r),s&128&&e.normalize(l)):r&&(l.shapeFlag|=mt(r)?8:16),Ts>0&&!a&&fr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&fr.push(l),l}const yt=_m;function _m(e,t=null,r=null,n=0,i=null,s=!1){if((!e||e===jg)&&(e=An),Ia(e)){const o=Ii(e,t,!0);return r&&hc(o,r),Ts>0&&!s&&fr&&(o.shapeFlag&6?fr[fr.indexOf(e)]=o:fr.push(o)),o.patchFlag=-2,o}if(Rm(e)&&(e=e.__vccOpts),t){t=xm(t);let{class:o,style:l}=t;o&&!mt(o)&&(t.class=Sn(o)),Qe(l)&&(sc(l)&&!Ce(l)&&(l=Wt({},l)),t.style=Ql(l))}const a=mt(e)?1:rh(e)?128:Ag(e)?64:Qe(e)?4:Ie(e)?2:0;return L(e,t,r,n,i,a,s,!0)}function xm(e){return e?sc(e)||q0(e)?Wt({},e):e:null}function Ii(e,t,r=!1,n=!1){const{props:i,ref:s,patchFlag:a,children:o,transition:l}=e,c=t?wm(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&sh(c),ref:t&&t.ref?r&&s?Ce(s)?s.concat(xa(t)):[s,xa(t)]:xa(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==it?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ii(e.ssContent),ssFallback:e.ssFallback&&Ii(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&n&&cc(u,l.clone(u)),u}function Vn(e=" ",t=0){return yt(_o,null,e,t)}function ft(e="",t=!1){return t?(xe(),ih(An,null,e)):yt(An,null,e)}function Mr(e){return e==null||typeof e=="boolean"?yt(An):Ce(e)?yt(it,null,e.slice()):Ia(e)?mn(e):yt(_o,null,String(e))}function mn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ii(e)}function hc(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Ce(t))r=16;else if(typeof t=="object")if(n&65){const i=t.default;i&&(i._c&&(i._d=!1),hc(e,i()),i._c&&(i._d=!0));return}else{r=32;const i=t._;!i&&!q0(t)?t._ctx=ur:i===3&&ur&&(ur.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Ie(t)?(t={default:t,_ctx:ur},r=32):(t=String(t),n&64?(r=16,t=[Vn(t)]):r=8);e.children=t,e.shapeFlag|=r}function wm(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=Sn([t.class,n.class]));else if(i==="style")t.style=Ql([t.style,n.style]);else if(so(i)){const s=t[i],a=n[i];a&&s!==a&&!(Ce(s)&&s.includes(a))&&(t[i]=s?[].concat(s,a):a)}else i!==""&&(t[i]=n[i])}return t}function Fr(e,t,r,n=null){$r(e,t,7,[r,n])}const ym=H0();let Em=0;function Tm(e,t,r){const n=e.type,i=(t?t.appContext:e.appContext)||ym,s={uid:Em++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new K1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:J0(n,i),emitsOptions:G0(n,i),emit:null,emitted:null,propsDefaults:Ye,inheritAttrs:n.inheritAttrs,ctx:Ye,data:Ye,props:Ye,attrs:Ye,slots:Ye,refs:Ye,setupState:Ye,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=em.bind(null,s),e.ce&&e.ce(s),s}let Ut=null;const Sm=()=>Ut||ur;let Fa,yl;{const e=uo(),t=(r,n)=>{let i;return(i=e[r])||(i=e[r]=[]),i.push(n),s=>{i.length>1?i.forEach(a=>a(s)):i[0](s)}};Fa=t("__VUE_INSTANCE_SETTERS__",r=>Ut=r),yl=t("__VUE_SSR_SETTERS__",r=>Ss=r)}const Ms=e=>{const t=Ut;return Fa(e),e.scope.on(),()=>{e.scope.off(),Fa(t)}},lu=()=>{Ut&&Ut.scope.off(),Fa(null)};function ah(e){return e.vnode.shapeFlag&4}let Ss=!1;function Am(e,t=!1,r=!1){t&&yl(t);const{props:n,children:i}=e.vnode,s=ah(e);am(e,n,s,t),um(e,i,r||t);const a=s?bm(e,t):void 0;return t&&yl(!1),a}function bm(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Hg);const{setup:n}=r;if(n){rn();const i=e.setupContext=n.length>1?km(e):null,s=Ms(e),a=Ls(n,e,0,[e.props,i]),o=a0(a);if(nn(),s(),(o||e.sp)&&!us(e)&&L0(e),o){if(a.then(lu,lu),t)return a.then(l=>{cu(e,l)}).catch(l=>{go(l,e,0)});e.asyncDep=a}else cu(e,a)}else oh(e)}function cu(e,t,r){Ie(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Qe(t)&&(e.setupState=C0(t)),oh(e)}function oh(e,t,r){const n=e.type;e.render||(e.render=n.render||Ur);{const i=Ms(e);rn();try{Wg(e)}finally{nn(),i()}}}const Om={get(e,t){return Mt(e,"get",""),e[t]}};function km(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,Om),slots:e.slots,emit:e.emit,expose:t}}function xo(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(C0(hg(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in fs)return fs[r](e)},has(t,r){return r in t||r in fs}})):e.proxy}function Cm(e,t=!0){return Ie(e)?e.displayName||e.name:e.name||t&&e.__name}function Rm(e){return Ie(e)&&"__vccOpts"in e}const Sr=(e,t)=>_g(e,t,Ss);function lh(e,t,r){try{Ra(-1);const n=arguments.length;return n===2?Qe(t)&&!Ce(t)?Ia(t)?yt(e,null,[t]):yt(e,t):yt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Ia(r)&&(r=[r]),yt(e,t,r))}finally{Ra(1)}}const Im="3.5.25";let El;const uu=typeof window<"u"&&window.trustedTypes;if(uu)try{El=uu.createPolicy("vue",{createHTML:e=>e})}catch{}const ch=El?e=>El.createHTML(e):e=>e,Fm="http://www.w3.org/2000/svg",Pm="http://www.w3.org/1998/Math/MathML",Xr=typeof document<"u"?document:null,fu=Xr&&Xr.createElement("template"),Nm={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t==="svg"?Xr.createElementNS(Fm,e):t==="mathml"?Xr.createElementNS(Pm,e):r?Xr.createElement(e,{is:r}):Xr.createElement(e);return e==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:e=>Xr.createTextNode(e),createComment:e=>Xr.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Xr.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,i,s){const a=r?r.previousSibling:t.lastChild;if(i&&(i===s||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),r),!(i===s||!(i=i.nextSibling)););else{fu.innerHTML=ch(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const o=fu.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},Dm=Symbol("_vtc");function Lm(e,t,r){const n=e[Dm];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const hu=Symbol("_vod"),Bm=Symbol("_vsh"),Mm=Symbol(""),Um=/(?:^|;)\s*display\s*:/;function jm(e,t,r){const n=e.style,i=mt(r);let s=!1;if(r&&!i){if(t)if(mt(t))for(const a of t.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&wa(n,o,"")}else for(const a in t)r[a]==null&&wa(n,a,"");for(const a in r)a==="display"&&(s=!0),wa(n,a,r[a])}else if(i){if(t!==r){const a=n[Mm];a&&(r+=";"+a),n.cssText=r,s=Um.test(r)}}else t&&e.removeAttribute("style");hu in e&&(e[hu]=s?n.display:"",e[Bm]&&(n.display="none"))}const du=/\s*!important$/;function wa(e,t,r){if(Ce(r))r.forEach(n=>wa(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=$m(e,t);du.test(r)?e.setProperty(Cn(n),r.replace(du,""),"important"):e[n]=r}}const pu=["Webkit","Moz","ms"],Wo={};function $m(e,t){const r=Wo[t];if(r)return r;let n=vr(t);if(n!=="filter"&&n in e)return Wo[t]=n;n=lo(n);for(let i=0;i<pu.length;i++){const s=pu[i]+n;if(s in e)return Wo[t]=s}return t}const gu="http://www.w3.org/1999/xlink";function mu(e,t,r,n,i,s=W1(t)){n&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(gu,t.slice(6,t.length)):e.setAttributeNS(gu,t,r):r==null||s&&!u0(r)?e.removeAttribute(t):e.setAttribute(t,s?"":jr(r)?String(r):r)}function vu(e,t,r,n,i){if(t==="innerHTML"||t==="textContent"){r!=null&&(e[t]=t==="innerHTML"?ch(r):r);return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?e.getAttribute("value")||"":e.value,l=r==null?e.type==="checkbox"?"on":"":String(r);(o!==l||!("_value"in e))&&(e.value=l),r==null&&e.removeAttribute(t),e._value=r;return}let a=!1;if(r===""||r==null){const o=typeof e[t];o==="boolean"?r=u0(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{e[t]=r}catch{}a&&e.removeAttribute(i||t)}function jn(e,t,r,n){e.addEventListener(t,r,n)}function Hm(e,t,r,n){e.removeEventListener(t,r,n)}const _u=Symbol("_vei");function Wm(e,t,r,n,i=null){const s=e[_u]||(e[_u]={}),a=s[t];if(n&&a)a.value=n;else{const[o,l]=Vm(t);if(n){const c=s[t]=zm(n,i);jn(e,o,c,l)}else a&&(Hm(e,o,a,l),s[t]=void 0)}}const xu=/(?:Once|Passive|Capture)$/;function Vm(e){let t;if(xu.test(e)){t={};let n;for(;n=e.match(xu);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Cn(e.slice(2)),t]}let Vo=0;const Gm=Promise.resolve(),Km=()=>Vo||(Gm.then(()=>Vo=0),Vo=Date.now());function zm(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;$r(qm(n,r.value),t,5,[n])};return r.value=e,r.attached=Km(),r}function qm(e,t){if(Ce(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>i=>!i._stopped&&n&&n(i))}else return t}const wu=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Xm=(e,t,r,n,i,s)=>{const a=i==="svg";t==="class"?Lm(e,n,a):t==="style"?jm(e,r,n):so(t)?Xl(t)||Wm(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Jm(e,t,n,a))?(vu(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&mu(e,t,n,a,s,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!mt(n))?vu(e,vr(t),n,s,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),mu(e,t,n,a))};function Jm(e,t,r,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&wu(t)&&Ie(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return wu(t)&&mt(r)?!1:t in e}const Pa=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Ce(t)?r=>ma(t,r):t};function Ym(e){e.target.composing=!0}function yu(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ti=Symbol("_assign");function Eu(e,t,r){return t&&(e=e.trim()),r&&(e=co(e)),e}const vn={created(e,{modifiers:{lazy:t,trim:r,number:n}},i){e[Ti]=Pa(i);const s=n||i.props&&i.props.type==="number";jn(e,t?"change":"input",a=>{a.target.composing||e[Ti](Eu(e.value,r,s))}),(r||s)&&jn(e,"change",()=>{e.value=Eu(e.value,r,s)}),t||(jn(e,"compositionstart",Ym),jn(e,"compositionend",yu),jn(e,"change",yu))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:r,modifiers:{lazy:n,trim:i,number:s}},a){if(e[Ti]=Pa(a),e.composing)return;const o=(s||e.type==="number")&&!/^0\d/.test(e.value)?co(e.value):e.value,l=t??"";o!==l&&(document.activeElement===e&&e.type!=="range"&&(n&&t===r||i&&e.value.trim()===l)||(e.value=l))}},Tu={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const i=ao(t);jn(e,"change",()=>{const s=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>r?co(Na(a)):Na(a));e[Ti](e.multiple?i?new Set(s):s:s[0]),e._assigning=!0,ac(()=>{e._assigning=!1})}),e[Ti]=Pa(n)},mounted(e,{value:t}){Su(e,t)},beforeUpdate(e,t,r){e[Ti]=Pa(r)},updated(e,{value:t}){e._assigning||Su(e,t)}};function Su(e,t){const r=e.multiple,n=Ce(t);if(!(r&&!n&&!ao(t))){for(let i=0,s=e.options.length;i<s;i++){const a=e.options[i],o=Na(a);if(r)if(n){const l=typeof o;l==="string"||l==="number"?a.selected=t.some(c=>String(c)===String(o)):a.selected=G1(t,o)>-1}else a.selected=t.has(o);else if(fo(Na(a),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Na(e){return"_value"in e?e._value:e.value}const Qm=["ctrl","shift","alt","meta"],Zm={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Qm.some(r=>e[`${r}Key`]&&!t.includes(r))},ev=(e,t)=>{const r=e._withMods||(e._withMods={}),n=t.join(".");return r[n]||(r[n]=((i,...s)=>{for(let a=0;a<t.length;a++){const o=Zm[t[a]];if(o&&o(i,t))return}return e(i,...s)}))},tv={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Gr=(e,t)=>{const r=e._withKeys||(e._withKeys={}),n=t.join(".");return r[n]||(r[n]=(i=>{if(!("key"in i))return;const s=Cn(i.key);if(t.some(a=>a===s||tv[a]===s))return e(i)}))},rv=Wt({patchProp:Xm},Nm);let Au;function nv(){return Au||(Au=hm(rv))}const iv=((...e)=>{const t=nv().createApp(...e),{mount:r}=t;return t.mount=n=>{const i=av(n);if(!i)return;const s=t._component;!Ie(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=r(i,!1,sv(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},t});function sv(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function av(e){return mt(e)?document.querySelector(e):e}const Bi=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r},ov={name:"App"};function lv(e,t,r,n,i,s){const a=Bs("RouterView");return xe(),ih(a)}const cv=Bi(ov,[["render",lv]]);const di=typeof document<"u";function uh(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function uv(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&uh(e.default)}const He=Object.assign;function Go(e,t){const r={};for(const n in t){const i=t[n];r[n]=Ir(i)?i.map(e):e(i)}return r}const ds=()=>{},Ir=Array.isArray;function bu(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}const fh=/#/g,fv=/&/g,hv=/\//g,dv=/=/g,pv=/\?/g,hh=/\+/g,gv=/%5B/g,mv=/%5D/g,dh=/%5E/g,vv=/%60/g,ph=/%7B/g,_v=/%7C/g,gh=/%7D/g,xv=/%20/g;function dc(e){return e==null?"":encodeURI(""+e).replace(_v,"|").replace(gv,"[").replace(mv,"]")}function wv(e){return dc(e).replace(ph,"{").replace(gh,"}").replace(dh,"^")}function Tl(e){return dc(e).replace(hh,"%2B").replace(xv,"+").replace(fh,"%23").replace(fv,"%26").replace(vv,"`").replace(ph,"{").replace(gh,"}").replace(dh,"^")}function yv(e){return Tl(e).replace(dv,"%3D")}function Ev(e){return dc(e).replace(fh,"%23").replace(pv,"%3F")}function Tv(e){return Ev(e).replace(hv,"%2F")}function As(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Sv=/\/$/,Av=e=>e.replace(Sv,"");function Ko(e,t,r="/"){let n,i={},s="",a="";const o=t.indexOf("#");let l=t.indexOf("?");return l=o>=0&&l>o?-1:l,l>=0&&(n=t.slice(0,l),s=t.slice(l,o>0?o:t.length),i=e(s.slice(1))),o>=0&&(n=n||t.slice(0,o),a=t.slice(o,t.length)),n=Cv(n??t,r),{fullPath:n+s+a,path:n,query:i,hash:As(a)}}function bv(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function Ou(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Ov(e,t,r){const n=t.matched.length-1,i=r.matched.length-1;return n>-1&&n===i&&Fi(t.matched[n],r.matched[i])&&mh(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Fi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function mh(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!kv(e[r],t[r]))return!1;return!0}function kv(e,t){return Ir(e)?ku(e,t):Ir(t)?ku(t,e):e===t}function ku(e,t){return Ir(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function Cv(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/"),i=n[n.length-1];(i===".."||i===".")&&n.push("");let s=r.length-1,a,o;for(a=0;a<n.length;a++)if(o=n[a],o!==".")if(o==="..")s>1&&s--;else break;return r.slice(0,s).join("/")+"/"+n.slice(a).join("/")}const hn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Sl=(function(e){return e.pop="pop",e.push="push",e})({}),zo=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Rv(e){if(!e)if(di){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Av(e)}const Iv=/^[^#]+#/;function Fv(e,t){return e.replace(Iv,"#")+t}function Pv(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const wo=()=>({left:window.scrollX,top:window.scrollY});function Nv(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),i=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!i)return;t=Pv(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Cu(e,t){return(history.state?history.state.position-t:-1)+e}const Al=new Map;function Dv(e,t){Al.set(e,t)}function Lv(e){const t=Al.get(e);return Al.delete(e),t}function Bv(e){return typeof e=="string"||e&&typeof e=="object"}function vh(e){return typeof e=="string"||typeof e=="symbol"}let ot=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const _h=Symbol("");ot.MATCHER_NOT_FOUND+"",ot.NAVIGATION_GUARD_REDIRECT+"",ot.NAVIGATION_ABORTED+"",ot.NAVIGATION_CANCELLED+"",ot.NAVIGATION_DUPLICATED+"";function Pi(e,t){return He(new Error,{type:e,[_h]:!0},t)}function Kr(e,t){return e instanceof Error&&_h in e&&(t==null||!!(e.type&t))}const Mv=["params","query","hash"];function Uv(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const r of Mv)r in e&&(t[r]=e[r]);return JSON.stringify(t,null,2)}function jv(e){const t={};if(e===""||e==="?")return t;const r=(e[0]==="?"?e.slice(1):e).split("&");for(let n=0;n<r.length;++n){const i=r[n].replace(hh," "),s=i.indexOf("="),a=As(s<0?i:i.slice(0,s)),o=s<0?null:As(i.slice(s+1));if(a in t){let l=t[a];Ir(l)||(l=t[a]=[l]),l.push(o)}else t[a]=o}return t}function Ru(e){let t="";for(let r in e){const n=e[r];if(r=yv(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Ir(n)?n.map(i=>i&&Tl(i)):[n&&Tl(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function $v(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Ir(n)?n.map(i=>i==null?null:""+i):n==null?n:""+n)}return t}const Hv=Symbol(""),Iu=Symbol(""),pc=Symbol(""),xh=Symbol(""),bl=Symbol("");function Yi(){let e=[];function t(n){return e.push(n),()=>{const i=e.indexOf(n);i>-1&&e.splice(i,1)}}function r(){e=[]}return{add:t,list:()=>e.slice(),reset:r}}function _n(e,t,r,n,i,s=a=>a()){const a=n&&(n.enterCallbacks[i]=n.enterCallbacks[i]||[]);return()=>new Promise((o,l)=>{const c=h=>{h===!1?l(Pi(ot.NAVIGATION_ABORTED,{from:r,to:t})):h instanceof Error?l(h):Bv(h)?l(Pi(ot.NAVIGATION_GUARD_REDIRECT,{from:t,to:h})):(a&&n.enterCallbacks[i]===a&&typeof h=="function"&&a.push(h),o())},u=s(()=>e.call(n&&n.instances[i],t,r,c));let f=Promise.resolve(u);e.length<3&&(f=f.then(c)),f.catch(h=>l(h))})}function qo(e,t,r,n,i=s=>s()){const s=[];for(const a of e)for(const o in a.components){let l=a.components[o];if(!(t!=="beforeRouteEnter"&&!a.instances[o]))if(uh(l)){const c=(l.__vccOpts||l)[t];c&&s.push(_n(c,r,n,a,o,i))}else{let c=l();s.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${o}" at "${a.path}"`);const f=uv(u)?u.default:u;a.mods[o]=u,a.components[o]=f;const h=(f.__vccOpts||f)[t];return h&&_n(h,r,n,a,o,i)()}))}}return s}function Wv(e,t){const r=[],n=[],i=[],s=Math.max(t.matched.length,e.matched.length);for(let a=0;a<s;a++){const o=t.matched[a];o&&(e.matched.find(c=>Fi(c,o))?n.push(o):r.push(o));const l=e.matched[a];l&&(t.matched.find(c=>Fi(c,l))||i.push(l))}return[r,n,i]}let Vv=()=>location.protocol+"//"+location.host;function wh(e,t){const{pathname:r,search:n,hash:i}=t,s=e.indexOf("#");if(s>-1){let a=i.includes(e.slice(s))?e.slice(s).length:1,o=i.slice(a);return o[0]!=="/"&&(o="/"+o),Ou(o,"")}return Ou(r,e)+n+i}function Gv(e,t,r,n){let i=[],s=[],a=null;const o=({state:h})=>{const d=wh(e,location),g=r.value,p=t.value;let m=0;if(h){if(r.value=d,t.value=h,a&&a===g){a=null;return}m=p?h.position-p.position:0}else n(d);i.forEach(w=>{w(r.value,g,{delta:m,type:Sl.pop,direction:m?m>0?zo.forward:zo.back:zo.unknown})})};function l(){a=r.value}function c(h){i.push(h);const d=()=>{const g=i.indexOf(h);g>-1&&i.splice(g,1)};return s.push(d),d}function u(){if(document.visibilityState==="hidden"){const{history:h}=window;if(!h.state)return;h.replaceState(He({},h.state,{scroll:wo()}),"")}}function f(){for(const h of s)h();s=[],window.removeEventListener("popstate",o),window.removeEventListener("pagehide",u),document.removeEventListener("visibilitychange",u)}return window.addEventListener("popstate",o),window.addEventListener("pagehide",u),document.addEventListener("visibilitychange",u),{pauseListeners:l,listen:c,destroy:f}}function Fu(e,t,r,n=!1,i=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:i?wo():null}}function Kv(e){const{history:t,location:r}=window,n={value:wh(e,r)},i={value:t.state};i.value||s(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const f=e.indexOf("#"),h=f>-1?(r.host&&document.querySelector("base")?e:e.slice(f))+l:Vv()+e+l;try{t[u?"replaceState":"pushState"](c,"",h),i.value=c}catch(d){console.error(d),r[u?"replace":"assign"](h)}}function a(l,c){s(l,He({},t.state,Fu(i.value.back,l,i.value.forward,!0),c,{position:i.value.position}),!0),n.value=l}function o(l,c){const u=He({},i.value,t.state,{forward:l,scroll:wo()});s(u.current,u,!0),s(l,He({},Fu(n.value,l,null),{position:u.position+1},c),!1),n.value=l}return{location:n,state:i,push:o,replace:a}}function zv(e){e=Rv(e);const t=Kv(e),r=Gv(e,t.state,t.location,t.replace);function n(s,a=!0){a||r.pauseListeners(),history.go(s)}const i=He({location:"",base:e,go:n,createHref:Fv.bind(null,e)},t,r);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>t.state.value}),i}function qv(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),zv(e)}let Gn=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var _t=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(_t||{});const Xv={type:Gn.Static,value:""},Jv=/[a-zA-Z0-9_]/;function Yv(e){if(!e)return[[]];if(e==="/")return[[Xv]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(d){throw new Error(`ERR (${r})/"${c}": ${d}`)}let r=_t.Static,n=r;const i=[];let s;function a(){s&&i.push(s),s=[]}let o=0,l,c="",u="";function f(){c&&(r===_t.Static?s.push({type:Gn.Static,value:c}):r===_t.Param||r===_t.ParamRegExp||r===_t.ParamRegExpEnd?(s.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:Gn.Param,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;o<e.length;){if(l=e[o++],l==="\\"&&r!==_t.ParamRegExp){n=r,r=_t.EscapeNext;continue}switch(r){case _t.Static:l==="/"?(c&&f(),a()):l===":"?(f(),r=_t.Param):h();break;case _t.EscapeNext:h(),r=n;break;case _t.Param:l==="("?r=_t.ParamRegExp:Jv.test(l)?h():(f(),r=_t.Static,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case _t.ParamRegExp:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:r=_t.ParamRegExpEnd:u+=l;break;case _t.ParamRegExpEnd:f(),r=_t.Static,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:t("Unknown state");break}}return r===_t.ParamRegExp&&t(`Unfinished custom RegExp for param "${c}"`),f(),a(),i}const Pu="[^/]+?",Qv={sensitive:!1,strict:!1,start:!0,end:!0};var Gt=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(Gt||{});const Zv=/[.+*?^${}()[\]/\\]/g;function e_(e,t){const r=He({},Qv,t),n=[];let i=r.start?"^":"";const s=[];for(const c of e){const u=c.length?[]:[Gt.Root];r.strict&&!c.length&&(i+="/");for(let f=0;f<c.length;f++){const h=c[f];let d=Gt.Segment+(r.sensitive?Gt.BonusCaseSensitive:0);if(h.type===Gn.Static)f||(i+="/"),i+=h.value.replace(Zv,"\\$&"),d+=Gt.Static;else if(h.type===Gn.Param){const{value:g,repeatable:p,optional:m,regexp:w}=h;s.push({name:g,repeatable:p,optional:m});const T=w||Pu;if(T!==Pu){d+=Gt.BonusCustomRegExp;try{`${T}`}catch(O){throw new Error(`Invalid custom RegExp for param "${g}" (${T}): `+O.message)}}let _=p?`((?:${T})(?:/(?:${T}))*)`:`(${T})`;f||(_=m&&c.length<2?`(?:/${_})`:"/"+_),m&&(_+="?"),i+=_,d+=Gt.Dynamic,m&&(d+=Gt.BonusOptional),p&&(d+=Gt.BonusRepeatable),T===".*"&&(d+=Gt.BonusWildcard)}u.push(d)}n.push(u)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=Gt.BonusStrict}r.strict||(i+="/?"),r.end?i+="$":r.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const a=new RegExp(i,r.sensitive?"":"i");function o(c){const u=c.match(a),f={};if(!u)return null;for(let h=1;h<u.length;h++){const d=u[h]||"",g=s[h-1];f[g.name]=d&&g.repeatable?d.split("/"):d}return f}function l(c){let u="",f=!1;for(const h of e){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const d of h)if(d.type===Gn.Static)u+=d.value;else if(d.type===Gn.Param){const{value:g,repeatable:p,optional:m}=d,w=g in c?c[g]:"";if(Ir(w)&&!p)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const T=Ir(w)?w.join("/"):w;if(!T)if(m)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);u+=T}}return u||"/"}return{re:a,score:n,keys:s,parse:o,stringify:l}}function t_(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===Gt.Static+Gt.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===Gt.Static+Gt.Segment?1:-1:0}function yh(e,t){let r=0;const n=e.score,i=t.score;for(;r<n.length&&r<i.length;){const s=t_(n[r],i[r]);if(s)return s;r++}if(Math.abs(i.length-n.length)===1){if(Nu(n))return 1;if(Nu(i))return-1}return i.length-n.length}function Nu(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const r_={strict:!1,end:!0,sensitive:!1};function n_(e,t,r){const n=e_(Yv(e.path),r),i=He(n,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf==!t.record.aliasOf&&t.children.push(i),i}function i_(e,t){const r=[],n=new Map;t=bu(r_,t);function i(f){return n.get(f)}function s(f,h,d){const g=!d,p=Lu(f);p.aliasOf=d&&d.record;const m=bu(t,f),w=[p];if("alias"in f){const O=typeof f.alias=="string"?[f.alias]:f.alias;for(const V of O)w.push(Lu(He({},p,{components:d?d.record.components:p.components,path:V,aliasOf:d?d.record:p})))}let T,_;for(const O of w){const{path:V}=O;if(h&&V[0]!=="/"){const ee=h.record.path,R=ee[ee.length-1]==="/"?"":"/";O.path=h.record.path+(V&&R+V)}if(T=n_(O,h,m),d?d.alias.push(T):(_=_||T,_!==T&&_.alias.push(T),g&&f.name&&!Bu(T)&&a(f.name)),Eh(T)&&l(T),p.children){const ee=p.children;for(let R=0;R<ee.length;R++)s(ee[R],T,d&&d.children[R])}d=d||T}return _?()=>{a(_)}:ds}function a(f){if(vh(f)){const h=n.get(f);h&&(n.delete(f),r.splice(r.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=r.indexOf(f);h>-1&&(r.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function o(){return r}function l(f){const h=o_(f,r);r.splice(h,0,f),f.record.name&&!Bu(f)&&n.set(f.record.name,f)}function c(f,h){let d,g={},p,m;if("name"in f&&f.name){if(d=n.get(f.name),!d)throw Pi(ot.MATCHER_NOT_FOUND,{location:f});m=d.record.name,g=He(Du(h.params,d.keys.filter(_=>!_.optional).concat(d.parent?d.parent.keys.filter(_=>_.optional):[]).map(_=>_.name)),f.params&&Du(f.params,d.keys.map(_=>_.name))),p=d.stringify(g)}else if(f.path!=null)p=f.path,d=r.find(_=>_.re.test(p)),d&&(g=d.parse(p),m=d.record.name);else{if(d=h.name?n.get(h.name):r.find(_=>_.re.test(h.path)),!d)throw Pi(ot.MATCHER_NOT_FOUND,{location:f,currentLocation:h});m=d.record.name,g=He({},h.params,f.params),p=d.stringify(g)}const w=[];let T=d;for(;T;)w.unshift(T.record),T=T.parent;return{name:m,path:p,params:g,matched:w,meta:a_(w)}}e.forEach(f=>s(f));function u(){r.length=0,n.clear()}return{addRoute:s,resolve:c,removeRoute:a,clearRoutes:u,getRoutes:o,getRecordMatcher:i}}function Du(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function Lu(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:s_(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function s_(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="object"?r[n]:r;return t}function Bu(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function a_(e){return e.reduce((t,r)=>He(t,r.meta),{})}function o_(e,t){let r=0,n=t.length;for(;r!==n;){const s=r+n>>1;yh(e,t[s])<0?n=s:r=s+1}const i=l_(e);return i&&(n=t.lastIndexOf(i,n-1)),n}function l_(e){let t=e;for(;t=t.parent;)if(Eh(t)&&yh(e,t)===0)return t}function Eh({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Mu(e){const t=Qr(pc),r=Qr(xh),n=Sr(()=>{const l=wi(e.to);return t.resolve(l)}),i=Sr(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],f=r.matched;if(!u||!f.length)return-1;const h=f.findIndex(Fi.bind(null,u));if(h>-1)return h;const d=Uu(l[c-2]);return c>1&&Uu(u)===d&&f[f.length-1].path!==d?f.findIndex(Fi.bind(null,l[c-2])):h}),s=Sr(()=>i.value>-1&&d_(r.params,n.value.params)),a=Sr(()=>i.value>-1&&i.value===r.matched.length-1&&mh(r.params,n.value.params));function o(l={}){if(h_(l)){const c=t[wi(e.replace)?"replace":"push"](wi(e.to)).catch(ds);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:Sr(()=>n.value.href),isActive:s,isExactActive:a,navigate:o}}function c_(e){return e.length===1?e[0]:e}const u_=D0({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Mu,setup(e,{slots:t}){const r=po(Mu(e)),{options:n}=Qr(pc),i=Sr(()=>({[ju(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[ju(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const s=t.default&&c_(t.default(r));return e.custom?s:lh("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:i.value},s)}}}),f_=u_;function h_(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function d_(e,t){for(const r in t){const n=t[r],i=e[r];if(typeof n=="string"){if(n!==i)return!1}else if(!Ir(i)||i.length!==n.length||n.some((s,a)=>s!==i[a]))return!1}return!0}function Uu(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ju=(e,t,r)=>e??t??r,p_=D0({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=Qr(bl),i=Sr(()=>e.route||n.value),s=Qr(Iu,0),a=Sr(()=>{let c=wi(s);const{matched:u}=i.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),o=Sr(()=>i.value.matched[a.value]);va(Iu,Sr(()=>a.value+1)),va(Hv,o),va(bl,i);const l=dg();return _a(()=>[l.value,o.value,e.name],([c,u,f],[h,d,g])=>{u&&(u.instances[f]=c,d&&d!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=d.leaveGuards),u.updateGuards.size||(u.updateGuards=d.updateGuards))),c&&u&&(!d||!Fi(u,d)||!h)&&(u.enterCallbacks[f]||[]).forEach(p=>p(c))},{flush:"post"}),()=>{const c=i.value,u=e.name,f=o.value,h=f&&f.components[u];if(!h)return $u(r.default,{Component:h,route:c});const d=f.props[u],g=d?d===!0?c.params:typeof d=="function"?d(c):d:null,m=lh(h,He({},g,t,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return $u(r.default,{Component:m,route:c})||m}}});function $u(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const g_=p_;function m_(e){const t=i_(e.routes,e),r=e.parseQuery||jv,n=e.stringifyQuery||Ru,i=e.history,s=Yi(),a=Yi(),o=Yi(),l=pg(hn);let c=hn;di&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Go.bind(null,D=>""+D),f=Go.bind(null,Tv),h=Go.bind(null,As);function d(D,Q){let G,X;return vh(D)?(G=t.getRecordMatcher(D),X=Q):X=D,t.addRoute(X,G)}function g(D){const Q=t.getRecordMatcher(D);Q&&t.removeRoute(Q)}function p(){return t.getRoutes().map(D=>D.record)}function m(D){return!!t.getRecordMatcher(D)}function w(D,Q){if(Q=He({},Q||l.value),typeof D=="string"){const I=Ko(r,D,Q.path),J=t.resolve({path:I.path},Q),K=i.createHref(I.fullPath);return He(I,J,{params:h(J.params),hash:As(I.hash),redirectedFrom:void 0,href:K})}let G;if(D.path!=null)G=He({},D,{path:Ko(r,D.path,Q.path).path});else{const I=He({},D.params);for(const J in I)I[J]==null&&delete I[J];G=He({},D,{params:f(I)}),Q.params=f(Q.params)}const X=t.resolve(G,Q),ye=D.hash||"";X.params=u(h(X.params));const E=bv(n,He({},D,{hash:wv(ye),path:X.path})),k=i.createHref(E);return He({fullPath:E,hash:ye,query:n===Ru?$v(D.query):D.query||{}},X,{redirectedFrom:void 0,href:k})}function T(D){return typeof D=="string"?Ko(r,D,l.value.path):He({},D)}function _(D,Q){if(c!==D)return Pi(ot.NAVIGATION_CANCELLED,{from:Q,to:D})}function O(D){return R(D)}function V(D){return O(He(T(D),{replace:!0}))}function ee(D,Q){const G=D.matched[D.matched.length-1];if(G&&G.redirect){const{redirect:X}=G;let ye=typeof X=="function"?X(D,Q):X;return typeof ye=="string"&&(ye=ye.includes("?")||ye.includes("#")?ye=T(ye):{path:ye},ye.params={}),He({query:D.query,hash:D.hash,params:ye.path!=null?{}:D.params},ye)}}function R(D,Q){const G=c=w(D),X=l.value,ye=D.state,E=D.force,k=D.replace===!0,I=ee(G,X);if(I)return R(He(T(I),{state:typeof I=="object"?He({},ye,I.state):ye,force:E,replace:k}),Q||G);const J=G;J.redirectedFrom=Q;let K;return!E&&Ov(n,X,G)&&(K=Pi(ot.NAVIGATION_DUPLICATED,{to:J,from:X}),rt(X,X,!0,!1)),(K?Promise.resolve(K):te(J,X)).catch(N=>Kr(N)?Kr(N,ot.NAVIGATION_GUARD_REDIRECT)?N:ut(N):Fe(N,J,X)).then(N=>{if(N){if(Kr(N,ot.NAVIGATION_GUARD_REDIRECT))return R(He({replace:k},T(N.to),{state:typeof N.to=="object"?He({},ye,N.to.state):ye,force:E}),Q||J)}else N=se(J,X,!0,k,ye);return ne(J,X,N),N})}function q(D,Q){const G=_(D,Q);return G?Promise.reject(G):Promise.resolve()}function B(D){const Q=P.values().next().value;return Q&&typeof Q.runWithContext=="function"?Q.runWithContext(D):D()}function te(D,Q){let G;const[X,ye,E]=Wv(D,Q);G=qo(X.reverse(),"beforeRouteLeave",D,Q);for(const I of X)I.leaveGuards.forEach(J=>{G.push(_n(J,D,Q))});const k=q.bind(null,D,Q);return G.push(k),Z(G).then(()=>{G=[];for(const I of s.list())G.push(_n(I,D,Q));return G.push(k),Z(G)}).then(()=>{G=qo(ye,"beforeRouteUpdate",D,Q);for(const I of ye)I.updateGuards.forEach(J=>{G.push(_n(J,D,Q))});return G.push(k),Z(G)}).then(()=>{G=[];for(const I of E)if(I.beforeEnter)if(Ir(I.beforeEnter))for(const J of I.beforeEnter)G.push(_n(J,D,Q));else G.push(_n(I.beforeEnter,D,Q));return G.push(k),Z(G)}).then(()=>(D.matched.forEach(I=>I.enterCallbacks={}),G=qo(E,"beforeRouteEnter",D,Q,B),G.push(k),Z(G))).then(()=>{G=[];for(const I of a.list())G.push(_n(I,D,Q));return G.push(k),Z(G)}).catch(I=>Kr(I,ot.NAVIGATION_CANCELLED)?I:Promise.reject(I))}function ne(D,Q,G){o.list().forEach(X=>B(()=>X(D,Q,G)))}function se(D,Q,G,X,ye){const E=_(D,Q);if(E)return E;const k=Q===hn,I=di?history.state:{};G&&(X||k?i.replace(D.fullPath,He({scroll:k&&I&&I.scroll},ye)):i.push(D.fullPath,ye)),l.value=D,rt(D,Q,G,k),ut()}let de;function Be(){de||(de=i.listen((D,Q,G)=>{if(!F.listening)return;const X=w(D),ye=ee(X,F.currentRoute.value);if(ye){R(He(ye,{replace:!0,force:!0}),X).catch(ds);return}c=X;const E=l.value;di&&Dv(Cu(E.fullPath,G.delta),wo()),te(X,E).catch(k=>Kr(k,ot.NAVIGATION_ABORTED|ot.NAVIGATION_CANCELLED)?k:Kr(k,ot.NAVIGATION_GUARD_REDIRECT)?(R(He(T(k.to),{force:!0}),X).then(I=>{Kr(I,ot.NAVIGATION_ABORTED|ot.NAVIGATION_DUPLICATED)&&!G.delta&&G.type===Sl.pop&&i.go(-1,!1)}).catch(ds),Promise.reject()):(G.delta&&i.go(-G.delta,!1),Fe(k,X,E))).then(k=>{k=k||se(X,E,!1),k&&(G.delta&&!Kr(k,ot.NAVIGATION_CANCELLED)?i.go(-G.delta,!1):G.type===Sl.pop&&Kr(k,ot.NAVIGATION_ABORTED|ot.NAVIGATION_DUPLICATED)&&i.go(-1,!1)),ne(X,E,k)}).catch(ds)}))}let ke=Yi(),Le=Yi(),Ae;function Fe(D,Q,G){ut(D);const X=Le.list();return X.length?X.forEach(ye=>ye(D,Q,G)):console.error(D),Promise.reject(D)}function Xe(){return Ae&&l.value!==hn?Promise.resolve():new Promise((D,Q)=>{ke.add([D,Q])})}function ut(D){return Ae||(Ae=!D,Be(),ke.list().forEach(([Q,G])=>D?G(D):Q()),ke.reset()),D}function rt(D,Q,G,X){const{scrollBehavior:ye}=e;if(!di||!ye)return Promise.resolve();const E=!G&&Lv(Cu(D.fullPath,0))||(X||!G)&&history.state&&history.state.scroll||null;return ac().then(()=>ye(D,Q,E)).then(k=>k&&Nv(k)).catch(k=>Fe(k,D,Q))}const C=D=>i.go(D);let H;const P=new Set,F={currentRoute:l,listening:!0,addRoute:d,removeRoute:g,clearRoutes:t.clearRoutes,hasRoute:m,getRoutes:p,resolve:w,options:e,push:O,replace:V,go:C,back:()=>C(-1),forward:()=>C(1),beforeEach:s.add,beforeResolve:a.add,afterEach:o.add,onError:Le.add,isReady:Xe,install(D){D.component("RouterLink",f_),D.component("RouterView",g_),D.config.globalProperties.$router=F,Object.defineProperty(D.config.globalProperties,"$route",{enumerable:!0,get:()=>wi(l)}),di&&!H&&l.value===hn&&(H=!0,O(i.location).catch(X=>{}));const Q={};for(const X in hn)Object.defineProperty(Q,X,{get:()=>l.value[X],enumerable:!0});D.provide(pc,F),D.provide(xh,O0(Q)),D.provide(bl,l);const G=D.unmount;P.add(D),D.unmount=function(){P.delete(D),P.size<1&&(c=hn,de&&de(),de=null,l.value=hn,H=!1,Ae=!1),G()}}};function Z(D){return D.reduce((Q,G)=>Q.then(()=>B(G)),Promise.resolve())}return F}function v_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Us(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var zr={},Zs={},Ol=function(e,t){return Ol=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Ol(e,t)};function Th(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ol(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Da=function(){return Da=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Da.apply(this,arguments)};function Mi(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Sh(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Ah(e,t){return function(r,n){t(r,n,e)}}function bh(e,t,r,n,i,s){function a(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var o=n.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?n.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),f,h=!1,d=r.length-1;d>=0;d--){var g={};for(var p in n)g[p]=p==="access"?{}:n[p];for(var p in n.access)g.access[p]=n.access[p];g.addInitializer=function(w){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(w||null))};var m=(0,r[d])(o==="accessor"?{get:u.get,set:u.set}:u[l],g);if(o==="accessor"){if(m===void 0)continue;if(m===null||typeof m!="object")throw new TypeError("Object expected");(f=a(m.get))&&(u.get=f),(f=a(m.set))&&(u.set=f),(f=a(m.init))&&i.unshift(f)}else(f=a(m))&&(o==="field"?i.unshift(f):u[l]=f)}c&&Object.defineProperty(c,n.name,u),h=!0}function Oh(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function kh(e){return typeof e=="symbol"?e:"".concat(e)}function Ch(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function Rh(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function _e(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})}function Ih(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){r.label=c[1];break}if(c[0]===6&&r.label<s[1]){r.label=s[1],s=c;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(c);break}s[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var yo=Object.create?(function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}):(function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]});function Fh(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&yo(t,e,r)}function La(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function gc(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Ph(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(gc(arguments[t]));return e}function Nh(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,i++)n[i]=s[a];return n}function Dh(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function Ni(e){return this instanceof Ni?(this.v=e,this):new Ni(e)}function Lh(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(d){return function(g){return Promise.resolve(g).then(d,f)}}function o(d,g){n[d]&&(i[d]=function(p){return new Promise(function(m,w){s.push([d,p,m,w])>1||l(d,p)})},g&&(i[d]=g(i[d])))}function l(d,g){try{c(n[d](g))}catch(p){h(s[0][3],p)}}function c(d){d.value instanceof Ni?Promise.resolve(d.value.v).then(u,f):h(s[0][2],d)}function u(d){l("next",d)}function f(d){l("throw",d)}function h(d,g){d(g),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Bh(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:Ni(e[i](a)),done:!1}:s?s(a):a}:s}}function Mh(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof La=="function"?La(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(o,l){a=e[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(c){s({value:c,done:o})},a)}}function Uh(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var __=Object.create?(function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}):function(e,t){e.default=t},kl=function(e){return kl=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},kl(e)};function jh(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=kl(e),n=0;n<r.length;n++)r[n]!=="default"&&yo(t,e,r[n]);return __(t,e),t}function $h(e){return e&&e.__esModule?e:{default:e}}function Hh(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function Wh(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r}function Vh(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function Gh(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var x_=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function Kh(e){function t(s){e.error=e.hasError?new x_(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var r,n=0;function i(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(i,function(a){return t(a),i()})}else n|=1}catch(a){t(a)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function zh(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,s,a){return n?t?".jsx":".js":i&&(!s||!a)?r:i+s+"."+a.toLowerCase()+"js"}):e}const w_={__extends:Th,__assign:Da,__rest:Mi,__decorate:Sh,__param:Ah,__esDecorate:bh,__runInitializers:Oh,__propKey:kh,__setFunctionName:Ch,__metadata:Rh,__awaiter:_e,__generator:Ih,__createBinding:yo,__exportStar:Fh,__values:La,__read:gc,__spread:Ph,__spreadArrays:Nh,__spreadArray:Dh,__await:Ni,__asyncGenerator:Lh,__asyncDelegator:Bh,__asyncValues:Mh,__makeTemplateObject:Uh,__importStar:jh,__importDefault:$h,__classPrivateFieldGet:Hh,__classPrivateFieldSet:Wh,__classPrivateFieldIn:Vh,__addDisposableResource:Gh,__disposeResources:Kh,__rewriteRelativeImportExtension:zh},y_=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Gh,get __assign(){return Da},__asyncDelegator:Bh,__asyncGenerator:Lh,__asyncValues:Mh,__await:Ni,__awaiter:_e,__classPrivateFieldGet:Hh,__classPrivateFieldIn:Vh,__classPrivateFieldSet:Wh,__createBinding:yo,__decorate:Sh,__disposeResources:Kh,__esDecorate:bh,__exportStar:Fh,__extends:Th,__generator:Ih,__importDefault:$h,__importStar:jh,__makeTemplateObject:Uh,__metadata:Rh,__param:Ah,__propKey:kh,__read:gc,__rest:Mi,__rewriteRelativeImportExtension:zh,__runInitializers:Oh,__setFunctionName:Ch,__spread:Ph,__spreadArray:Dh,__spreadArrays:Nh,__values:La,default:w_},Symbol.toStringTag,{value:"Module"})),E_=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);let Eo=class extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}},qh=class extends Eo{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},Cl=class extends Eo{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},Rl=class extends Eo{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}};var Ba;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Ba||(Ba={}));class T_{constructor(t,{headers:r={},customFetch:n,region:i=Ba.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=E_(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return _e(this,arguments,void 0,function*(r,n={}){var i;let s,a;try{const{headers:o,method:l,body:c,signal:u,timeout:f}=n;let h={},{region:d}=n;d||(d=this.region);const g=new URL(`${this.url}/${r}`);d&&d!=="any"&&(h["x-region"]=d,g.searchParams.set("forceFunctionRegion",d));let p;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",p=c):typeof c=="string"?(h["Content-Type"]="text/plain",p=c):typeof FormData<"u"&&c instanceof FormData?p=c:(h["Content-Type"]="application/json",p=JSON.stringify(c)):p=c;let m=u;f&&(a=new AbortController,s=setTimeout(()=>a.abort(),f),u?(m=a.signal,u.addEventListener("abort",()=>a.abort())):m=a.signal);const w=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:p,signal:m}).catch(V=>{throw new qh(V)}),T=w.headers.get("x-relay-error");if(T&&T==="true")throw new Cl(w);if(!w.ok)throw new Rl(w);let _=((i=w.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),O;return _==="application/json"?O=yield w.json():_==="application/octet-stream"||_==="application/pdf"?O=yield w.blob():_==="text/event-stream"?O=w:_==="multipart/form-data"?O=yield w.formData():O=yield w.text(),{data:O,error:null,response:w}}catch(o){return{data:null,error:o,response:o instanceof Rl||o instanceof Cl?o.context:void 0}}finally{s&&clearTimeout(s)}})}}const S_=Object.freeze(Object.defineProperty({__proto__:null,get FunctionRegion(){return Ba},FunctionsClient:T_,FunctionsError:Eo,FunctionsFetchError:qh,FunctionsHttpError:Rl,FunctionsRelayError:Cl},Symbol.toStringTag,{value:"Module"})),Xh=Us(S_);var Bt={};const Ui=Us(y_);var ea={},ta={},ra={},na={},ia={},sa={},Hu;function Jh(){if(Hu)return sa;Hu=1,Object.defineProperty(sa,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return sa.default=e,sa}var Wu;function Yh(){if(Wu)return ia;Wu=1,Object.defineProperty(ia,"__esModule",{value:!0});const t=Ui.__importDefault(Jh());let r=class{constructor(i){var s,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(s=i.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,s){return this.headers=new Headers(this.headers),this.headers.set(i,s),this}then(i,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let o=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,u,f,h;let d=null,g=null,p=null,m=l.status,w=l.statusText;if(l.ok){if(this.method!=="HEAD"){const V=await l.text();V===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((c=this.headers.get("Accept"))===null||c===void 0)&&c.includes("application/vnd.pgrst.plan+text"))?g=V:g=JSON.parse(V))}const _=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),O=(f=l.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");_&&O&&O.length>1&&(p=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(d={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,p=null,m=406,w="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const _=await l.text();try{d=JSON.parse(_),Array.isArray(d)&&l.status===404&&(g=[],d=null,m=200,w="OK")}catch{l.status===404&&_===""?(m=204,w="No Content"):d={message:_}}if(d&&this.isMaybeSingle&&(!((h=d?.details)===null||h===void 0)&&h.includes("0 rows"))&&(d=null,m=200,w="OK"),d&&this.shouldThrowOnError)throw new t.default(d)}return{error:d,data:g,count:p,status:m,statusText:w}});return this.shouldThrowOnError||(o=o.catch(l=>{var c,u,f,h,d,g;let p="";const m=l?.cause;if(m){const w=(c=m?.message)!==null&&c!==void 0?c:"",T=(u=m?.code)!==null&&u!==void 0?u:"";p=`${(f=l?.name)!==null&&f!==void 0?f:"FetchError"}: ${l?.message}`,p+=`

Caused by: ${(h=m?.name)!==null&&h!==void 0?h:"Error"}: ${w}`,T&&(p+=` (${T})`),m?.stack&&(p+=`
${m.stack}`)}else p=(d=l?.stack)!==null&&d!==void 0?d:"";return{error:{message:`${(g=l?.name)!==null&&g!==void 0?g:"FetchError"}: ${l?.message}`,details:p,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),o.then(i,s)}returns(){return this}overrideTypes(){return this}};return ia.default=r,ia}var Vu;function Qh(){if(Vu)return na;Vu=1,Object.defineProperty(na,"__esModule",{value:!0});const t=Ui.__importDefault(Yh());let r=class extends t.default{select(i){let s=!1;const a=(i??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this.url.searchParams.set(c,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const f=[i?"analyze":null,s?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${h}"; options=${f};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};return na.default=r,na}var Gu;function mc(){if(Gu)return ra;Gu=1,Object.defineProperty(ra,"__esModule",{value:!0});const t=Ui.__importDefault(Qh()),r=new RegExp("[,()]");let n=class extends t.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}regexMatch(s,a){return this.url.searchParams.append(s,`match.${a}`),this}regexIMatch(s,a){return this.url.searchParams.append(s,`imatch.${a}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}isDistinct(s,a){return this.url.searchParams.append(s,`isdistinct.${a}`),this}in(s,a){const o=Array.from(new Set(a)).map(l=>typeof l=="string"&&r.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:o,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const u=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${c}fts${u}.${a}`),this}match(s){return Object.entries(s).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(s,a,o){return this.url.searchParams.append(s,`not.${a}.${o}`),this}or(s,{foreignTable:a,referencedTable:o=a}={}){const l=o?`${o}.or`:"or";return this.url.searchParams.append(l,`(${s})`),this}filter(s,a,o){return this.url.searchParams.append(s,`${a}.${o}`),this}};return ra.default=n,ra}var Ku;function Zh(){if(Ku)return ta;Ku=1,Object.defineProperty(ta,"__esModule",{value:!0});const t=Ui.__importDefault(mc());let r=class{constructor(i,{headers:s={},schema:a,fetch:o}){this.url=i,this.headers=new Headers(s),this.schema=a,this.fetch=o}select(i,s){const{head:a=!1,count:o}=s??{},l=a?"HEAD":"GET";let c=!1;const u=(i??"*").split("").map(f=>/\s/.test(f)&&!c?"":(f==='"'&&(c=!c),f)).join("");return this.url.searchParams.set("select",u),o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:s,defaultToNull:a=!0}={}){var o;const l="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const c=i.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(c.length>0){const u=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){var c;const u="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(f.length>0){const h=[...new Set(f)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(i,{count:s}={}){var a;const o="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:i}={}){var s;const a="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};return ta.default=r,ta}var zu;function A_(){if(zu)return ea;zu=1,Object.defineProperty(ea,"__esModule",{value:!0});const e=Ui,t=e.__importDefault(Zh()),r=e.__importDefault(mc());let n=class ed{constructor(s,{headers:a={},schema:o,fetch:l}={}){this.url=s,this.headers=new Headers(a),this.schemaName=o,this.fetch=l}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const a=new URL(`${this.url}/${s}`);return new t.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new ed(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,a={},{head:o=!1,get:l=!1,count:c}={}){var u;let f;const h=new URL(`${this.url}/rpc/${s}`);let d;o||l?(f=o?"HEAD":"GET",Object.entries(a).filter(([p,m])=>m!==void 0).map(([p,m])=>[p,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([p,m])=>{h.searchParams.append(p,m)})):(f="POST",d=a);const g=new Headers(this.headers);return c&&g.set("Prefer",`count=${c}`),new r.default({method:f,url:h,headers:g,schema:this.schemaName,body:d,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}};return ea.default=n,ea}var qu;function td(){if(qu)return Bt;qu=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.PostgrestError=Bt.PostgrestBuilder=Bt.PostgrestTransformBuilder=Bt.PostgrestFilterBuilder=Bt.PostgrestQueryBuilder=Bt.PostgrestClient=void 0;const e=Ui,t=e.__importDefault(A_());Bt.PostgrestClient=t.default;const r=e.__importDefault(Zh());Bt.PostgrestQueryBuilder=r.default;const n=e.__importDefault(mc());Bt.PostgrestFilterBuilder=n.default;const i=e.__importDefault(Qh());Bt.PostgrestTransformBuilder=i.default;const s=e.__importDefault(Yh());Bt.PostgrestBuilder=s.default;const a=e.__importDefault(Jh());return Bt.PostgrestError=a.default,Bt.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:s.default,PostgrestError:a.default},Bt}class rd{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const b_="2.87.1",O_=`realtime-js/${b_}`,nd="1.0.0",k_="2.0.0",Xu=nd,Il=1e4,C_=1e3,R_=100;var $n;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})($n||($n={}));var dt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(dt||(dt={}));var Tr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Tr||(Tr={}));var Fl;(function(e){e.websocket="websocket"})(Fl||(Fl={}));var Hn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Hn||(Hn={}));class I_{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},a=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(t,r,n){var i,s;const a=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",l=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+c.length+f.length,d=new ArrayBuffer(this.HEADER_LENGTH+h);let g=new DataView(d),p=0;g.setUint8(p++,this.KINDS.userBroadcastPush),g.setUint8(p++,l.length),g.setUint8(p++,o.length),g.setUint8(p++,a.length),g.setUint8(p++,c.length),g.setUint8(p++,f.length),g.setUint8(p++,r),Array.from(l,w=>g.setUint8(p++,w.charCodeAt(0))),Array.from(o,w=>g.setUint8(p++,w.charCodeAt(0))),Array.from(a,w=>g.setUint8(p++,w.charCodeAt(0))),Array.from(c,w=>g.setUint8(p++,w.charCodeAt(0))),Array.from(f,w=>g.setUint8(p++,w.charCodeAt(0)));var m=new Uint8Array(d.byteLength+n.byteLength);return m.set(new Uint8Array(d),0),m.set(new Uint8Array(n),d.byteLength),m.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,a,o,l]=n;return r({join_ref:i,ref:s,topic:a,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(t.slice(l,l+i));l=l+i;const u=n.decode(t.slice(l,l+s));l=l+s;const f=n.decode(t.slice(l,l+a));l=l+a;const h=t.slice(l,t.byteLength),d=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,g={type:this.BROADCAST_EVENT,event:u,payload:d};return a>0&&(g.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:g}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class id{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ze;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ze||(Ze={}));const Ju=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,a)=>(s[a]=F_(a,e,t,i),s),{}):{}},F_=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i?.type,a=r[e];return s&&!n.includes(s)?sd(s,a):Pl(a)},sd=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return L_(t,r)}switch(e){case Ze.bool:return P_(t);case Ze.float4:case Ze.float8:case Ze.int2:case Ze.int4:case Ze.int8:case Ze.numeric:case Ze.oid:return N_(t);case Ze.json:case Ze.jsonb:return D_(t);case Ze.timestamp:return B_(t);case Ze.abstime:case Ze.date:case Ze.daterange:case Ze.int4range:case Ze.int8range:case Ze.money:case Ze.reltime:case Ze.text:case Ze.time:case Ze.timestamptz:case Ze.timetz:case Ze.tsrange:case Ze.tstzrange:return Pl(t);default:return Pl(t)}},Pl=e=>e,P_=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},N_=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},D_=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},L_=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>sd(t,o))}return e},B_=e=>typeof e=="string"?e.replace(" ","T"):e,ad=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Xo{constructor(t,r,n={},i=Il){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Nl;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Nl||(Nl={}));let od=class ya{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ya.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=ya.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ya.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const f=s[c];if(f){const h=u.map(m=>m.presence_ref),d=f.map(m=>m.presence_ref),g=u.filter(m=>d.indexOf(m.presence_ref)<0),p=f.filter(m=>h.indexOf(m.presence_ref)<0);g.length>0&&(o[c]=g),p.length>0&&(l[c]=p)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(d=>d.presence_ref),h=u.filter(d=>f.indexOf(d.presence_ref)<0);t[o].unshift(...h)}n(o,u,l)}),this.map(a,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,i(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var Dl;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Dl||(Dl={}));var Si;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Si||(Si={}));var Lr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Lr||(Lr={}));const M_=dt;let ld=class rs{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=dt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Xo(this,Tr.join,this.params,this.timeout),this.rejoinTimer=new id(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=dt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=dt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=dt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Tr.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new od(this),this.broadcastEndpointURL=ad(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==dt.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[Si.PRESENCE]&&this.bindings[Si.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(d=>t?.(Lr.CHANNEL_ERROR,d)),this._onClose(()=>t?.(Lr.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var g;if(this.socket._isManualToken()||this.socket.setAuth(),d===void 0){t?.(Lr.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,m=(g=p?.length)!==null&&g!==void 0?g:0,w=[];for(let T=0;T<m;T++){const _=p[T],{filter:{event:O,schema:V,table:ee,filter:R}}=_,q=d&&d[T];if(q&&q.event===O&&rs.isFilterValueEqual(q.schema,V)&&rs.isFilterValueEqual(q.table,ee)&&rs.isFilterValueEqual(q.filter,R))w.push(Object.assign(Object.assign({},_),{id:q.id}));else{this.unsubscribe(),this.state=dt.errored,t?.(Lr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(Lr.SUBSCRIBED);return}}).receive("error",d=>{this.state=dt.errored,t?.(Lr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t?.(Lr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===dt.joined&&t===Si.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=dt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Tr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Xo(this,Tr.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=dt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Xo(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>R_){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Tr;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(d=>{var g,p,m;return((g=d.filter)===null||g===void 0?void 0:g.event)==="*"||((m=(p=d.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(d=>d.callback(h,n)):(s=this.bindings[a])===null||s===void 0||s.filter(d=>{var g,p,m,w,T,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in d){const O=d.id,V=(g=d.filter)===null||g===void 0?void 0:g.event;return O&&((p=r.ids)===null||p===void 0?void 0:p.includes(O))&&(V==="*"||V?.toLocaleLowerCase()===((m=r.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const O=(T=(w=d?.filter)===null||w===void 0?void 0:w.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return O==="*"||O===((_=r?.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===a}).map(d=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:p,table:m,commit_timestamp:w,type:T,errors:_}=g;h=Object.assign(Object.assign({},{schema:p,table:m,commit_timestamp:w,eventType:T,new:{},old:{},errors:_}),this._getPayloadRecords(g))}d.callback(h,n)})}_isClosed(){return this.state===dt.closed}_isJoined(){return this.state===dt.joined}_isJoining(){return this.state===dt.joining}_isLeaving(){return this.state===dt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&rs.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Tr.close,{},t)}_onError(t){this._on(Tr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=dt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ju(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ju(t.columns,t.old_record)),r}};const Jo=()=>{},aa={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},U_=[1e3,2e3,5e3,1e4],j_=1e4,$_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;let H_=class{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Il,this.transport=null,this.heartbeatIntervalMs=aa.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jo,this.ref=0,this.reconnectTimer=null,this.vsn=Xu,this.logger=Jo,this.conn=null,this.sendBuffer=[],this.serializer=new I_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Fl.websocket}`,this.httpEndpoint=ad(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rd.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case $n.connecting:return Hn.Connecting;case $n.open:return Hn.Open;case $n.closing:return Hn.Closing;default:return Hn.Closed}}isConnected(){return this.connectionState()===Hn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new ld(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(C_,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},aa.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:a}=r,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===$n.open||this.conn.readyState===$n.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Tr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([$_],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:O_};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(Tr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new id(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},aa.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,a,o,l,c,u,f,h,d;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Il,this.heartbeatIntervalMs=(i=t?.heartbeatIntervalMs)!==null&&i!==void 0?i:aa.HEARTBEAT_INTERVAL,this.worker=(s=t?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=t?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=t?.heartbeatCallback)!==null&&o!==void 0?o:Jo,this.vsn=(l=t?.vsn)!==null&&l!==void 0?l:Xu,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:(g=>U_[g-1]||j_),this.vsn){case nd:this.encode=(u=t?.encode)!==null&&u!==void 0?u:((g,p)=>p(JSON.stringify(g))),this.decode=(f=t?.decode)!==null&&f!==void 0?f:((g,p)=>p(JSON.parse(g)));break;case k_:this.encode=(h=t?.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(d=t?.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}};const W_=Object.freeze(Object.defineProperty({__proto__:null,REALTIME_CHANNEL_STATES:M_,get REALTIME_LISTEN_TYPES(){return Si},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return Dl},get REALTIME_PRESENCE_LISTEN_EVENTS(){return Nl},get REALTIME_SUBSCRIBE_STATES(){return Lr},RealtimeChannel:ld,RealtimeClient:H_,RealtimePresence:od,WebSocketFactory:rd},Symbol.toStringTag,{value:"Module"})),cd=Us(W_);class js extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function nt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class ud extends js{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ma extends js{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const vc=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),V_=()=>Response,Ll=e=>{if(Array.isArray(e))return e.map(r=>Ll(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Ll(n)}),t},G_=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},K_=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e),Yo=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},z_=(e,t,r)=>_e(void 0,void 0,void 0,function*(){const n=yield V_();e instanceof n&&!r?.noResolveJson?e.json().then(i=>{const s=e.status||500,a=i?.statusCode||s+"";t(new ud(Yo(i),s,a))}).catch(i=>{t(new Ma(Yo(i),i))}):t(new Ma(Yo(e),e))}),q_=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"||!n?i:(G_(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,t?.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r))};function $s(e,t,r,n,i,s){return _e(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,q_(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>z_(l,o,n))})})}function bs(e,t,r,n){return _e(this,void 0,void 0,function*(){return $s(e,"GET",t,r,n)})}function Er(e,t,r,n,i){return _e(this,void 0,void 0,function*(){return $s(e,"POST",t,n,i,r)})}function Bl(e,t,r,n,i){return _e(this,void 0,void 0,function*(){return $s(e,"PUT",t,n,i,r)})}function X_(e,t,r,n){return _e(this,void 0,void 0,function*(){return $s(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function _c(e,t,r,n,i){return _e(this,void 0,void 0,function*(){return $s(e,"DELETE",t,n,i,r)})}class J_{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return _e(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(nt(t))return{data:null,error:t};throw t}})}}var fd;class Y_{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[fd]="BlobDownloadBuilder",this.promise=null}asStream(){return new J_(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return _e(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(nt(t))return{data:null,error:t};throw t}})}}fd=Symbol.toStringTag;const Q_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Yu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Z_{constructor(t,r={},n,i){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=vc(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,i){return _e(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Yu),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",a.cacheControl),l&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!a.duplex&&(a.duplex="half")),i?.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield(t=="PUT"?Bl:Er)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},a?.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(nt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return _e(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return _e(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Yu.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield Bl(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(nt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return _e(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r?.upsert&&(i["x-upsert"]="true");const s=yield Er(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new js("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(nt(n))return{data:null,error:n};throw n}})}update(t,r,n){return _e(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return _e(this,void 0,void 0,function*(){try{return{data:yield Er(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(nt(i))return{data:null,error:i};throw i}})}copy(t,r,n){return _e(this,void 0,void 0,function*(){try{return{data:{path:(yield Er(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(nt(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return _e(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield Er(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(nt(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return _e(this,void 0,void 0,function*(){try{const i=yield Er(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(nt(i))return{data:null,error:i};throw i}})}download(t,r){const i=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),a=s?`?${s}`:"",o=this._getFinalPath(t),l=()=>bs(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new Y_(l,this.shouldThrowOnError)}info(t){return _e(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield bs(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ll(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(nt(n))return{data:null,error:n};throw n}})}exists(t){return _e(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield X_(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(nt(n)&&n instanceof Ma){const i=n.originalError;if([400,404].includes(i?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return _e(this,void 0,void 0,function*(){try{return{data:yield _c(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(nt(r))return{data:null,error:r};throw r}})}list(t,r,n){return _e(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Q_),r),{prefix:t||""});return{data:yield Er(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(nt(i))return{data:null,error:i};throw i}})}listV2(t,r){return _e(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Er(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(nt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const hd="2.87.1",dd={"X-Client-Info":`storage-js/${hd}`};class ex{constructor(t,r={},n,i){this.shouldThrowOnError=!1;const s=new URL(t);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},dd),r),this.fetch=vc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return _e(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield bs(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(nt(r))return{data:null,error:r};throw r}})}getBucket(t){return _e(this,void 0,void 0,function*(){try{return{data:yield bs(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(nt(r))return{data:null,error:r};throw r}})}createBucket(t){return _e(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Er(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(nt(i))return{data:null,error:i};throw i}})}updateBucket(t,r){return _e(this,void 0,void 0,function*(){try{return{data:yield Bl(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(nt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return _e(this,void 0,void 0,function*(){try{return{data:yield Er(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(nt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return _e(this,void 0,void 0,function*(){try{return{data:yield _c(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(nt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var Os=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function tx(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function rx(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function nx(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:a}){const o=tx(e.baseUrl,n,i),l=await rx(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...a},body:s?JSON.stringify(s):void 0}),u=await c.text(),f=(c.headers.get("content-type")||"").includes("application/json"),h=f&&u?JSON.parse(u):u;if(!c.ok){const d=f?h:void 0,g=d?.error;throw new Os(g?.message??`Request failed with status ${c.status}`,{status:c.status,icebergType:g?.type,icebergCode:g?.code,details:d})}return{status:c.status,headers:c.headers,data:h}}}}function oa(e){return e.join("")}var ix=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:oa(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${oa(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${oa(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${oa(e.namespace)}`}),!0}catch(t){if(t instanceof Os&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Os&&r.status===409)return;throw r}}};function si(e){return e.join("")}var sx=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${si(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Os&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Os&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},ax=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=nx({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new ix(this.client,t),this.tableOps=new sx(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};class pd{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},dd),r),this.fetch=vc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return _e(this,void 0,void 0,function*(){try{return{data:yield Er(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(nt(r))return{data:null,error:r};throw r}})}listBuckets(t){return _e(this,void 0,void 0,function*(){try{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield bs(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(nt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return _e(this,void 0,void 0,function*(){try{return{data:yield _c(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(nt(r))return{data:null,error:r};throw r}})}from(t){if(!K_(t))throw new js("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new ax({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:()=>_e(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(s,a){const o=s[a];return typeof o!="function"?o:(...l)=>_e(this,void 0,void 0,function*(){try{return{data:yield o.apply(s,l),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}})}})}}const xc={"X-Client-Info":`storage-js/${hd}`,"Content-Type":"application/json"};class wc extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Qt(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class Ea extends wc{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class gd extends wc{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var Ml;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Ml||(Ml={}));const To=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ox=()=>Response,md=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},lx=e=>Array.from(new Float32Array(e)),cx=(e,t)=>{if(t!==void 0&&e.float32.length!==t)throw new Error(`Vector dimension mismatch: expected ${t}, got ${e.float32.length}`)},Qu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ux=(e,t,r)=>_e(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const i=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const o=a?.statusCode||a?.code||i+"";t(new Ea(Qu(a),i,o))}).catch(()=>{const a=i+"",o=s.statusText||`HTTP ${i} error`;t(new Ea(o,i,a))});else{const a=i+"",o=s.statusText||`HTTP ${i} error`;t(new Ea(o,i,a))}}else t(new gd(Qu(e),e))}),fx=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return n?(md(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function hx(e,t,r,n,i,s){return _e(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,fx(t,n,i,s)).then(l=>{if(!l.ok)throw l;if(n?.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>ux(l,o,n))})})}function cr(e,t,r,n,i){return _e(this,void 0,void 0,function*(){return hx(e,"POST",t,n,i,r)})}class vd{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},xc),r),this.fetch=To(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return _e(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}getIndex(t,r){return _e(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qt(n))return{data:null,error:n};throw n}})}listIndexes(t){return _e(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return _e(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qt(n))return{data:null,error:n};throw n}})}}class _d{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},xc),r),this.fetch=To(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return _e(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield cr(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}getVectors(t){return _e(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}listVectors(t){return _e(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield cr(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}queryVectors(t){return _e(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}deleteVectors(t){return _e(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield cr(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}}class xd{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},xc),r),this.fetch=To(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return _e(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}getBucket(t){return _e(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}listBuckets(){return _e(this,arguments,void 0,function*(t={}){try{return{data:yield cr(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return _e(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qt(r))return{data:null,error:r};throw r}})}}class wd extends xd{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new yd(this.url,this.headers,t,this.fetch)}createBucket(t){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return _e(this,void 0,void 0,function*(){return r.createBucket.call(this,t)})}getBucket(t){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return _e(this,void 0,void 0,function*(){return r.getBucket.call(this,t)})}listBuckets(){const t=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return _e(this,arguments,void 0,function*(r={}){return t.listBuckets.call(this,r)})}deleteBucket(t){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return _e(this,void 0,void 0,function*(){return r.deleteBucket.call(this,t)})}}class yd extends vd{constructor(t,r,n,i){super(t,r,i),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return _e(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return _e(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return _e(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return _e(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new Ed(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class Ed extends _d{constructor(t,r,n,i,s){super(t,r,s),this.vectorBucketName=n,this.indexName=i}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return _e(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return _e(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return _e(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return _e(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return _e(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class dx extends ex{constructor(t,r={},n,i){super(t,r,n,i)}from(t){return new Z_(this.url,this.headers,t,this.fetch)}get vectors(){return new wd(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new pd(this.url+"/iceberg",this.headers,this.fetch)}}const px=Object.freeze(Object.defineProperty({__proto__:null,StorageAnalyticsClient:pd,StorageApiError:ud,StorageClient:dx,StorageError:js,StorageUnknownError:Ma,StorageVectorsApiError:Ea,StorageVectorsClient:wd,StorageVectorsError:wc,get StorageVectorsErrorCode(){return Ml},StorageVectorsUnknownError:gd,VectorBucketApi:xd,VectorBucketScope:yd,VectorDataApi:_d,VectorIndexApi:vd,VectorIndexScope:Ed,isPlainObject:md,isStorageError:nt,isStorageVectorsError:Qt,normalizeToFloat32:lx,resolveFetch:To,resolveResponse:ox,validateVectorDimension:cx},Symbol.toStringTag,{value:"Module"})),gx=Us(px);var Qo={},Qi={},Zu;function mx(){return Zu||(Zu=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.version=void 0,Qi.version="2.87.1"),Qi}var ef;function vx(){return ef||(ef=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_REALTIME_OPTIONS=e.DEFAULT_AUTH_OPTIONS=e.DEFAULT_DB_OPTIONS=e.DEFAULT_GLOBAL_OPTIONS=e.DEFAULT_HEADERS=void 0;const t=mx();let r="";typeof Deno<"u"?r="deno":typeof document<"u"?r="web":typeof navigator<"u"&&navigator.product==="ReactNative"?r="react-native":r="node",e.DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${r}/${t.version}`},e.DEFAULT_GLOBAL_OPTIONS={headers:e.DEFAULT_HEADERS},e.DEFAULT_DB_OPTIONS={schema:"public"},e.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},e.DEFAULT_REALTIME_OPTIONS={}})(Qo)),Qo}var Zo={},tf;function _x(){return tf||(tf=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.fetchWithAuth=e.resolveHeadersConstructor=e.resolveFetch=void 0;const t=i=>i?(...s)=>i(...s):(...s)=>fetch(...s);e.resolveFetch=t;const r=()=>Headers;e.resolveHeadersConstructor=r;const n=(i,s,a)=>{const o=(0,e.resolveFetch)(a),l=(0,e.resolveHeadersConstructor)();return async(c,u)=>{var f;const h=(f=await s())!==null&&f!==void 0?f:i;let d=new l(u?.headers);return d.has("apikey")||d.set("apikey",i),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),o(c,Object.assign(Object.assign({},u),{headers:d}))}};e.fetchWithAuth=n})(Zo)),Zo}var qr={},rf;function xx(){if(rf)return qr;rf=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.isBrowser=void 0,qr.uuid=e,qr.ensureTrailingSlash=t,qr.applySettingDefaults=n,qr.validateSupabaseUrl=i;function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var a=Math.random()*16|0,o=s=="x"?a:a&3|8;return o.toString(16)})}function t(s){return s.endsWith("/")?s:s+"/"}const r=()=>typeof window<"u";qr.isBrowser=r;function n(s,a){var o,l;const{db:c,auth:u,realtime:f,global:h}=s,{db:d,auth:g,realtime:p,global:m}=a,w={db:Object.assign(Object.assign({},d),c),auth:Object.assign(Object.assign({},g),u),realtime:Object.assign(Object.assign({},p),f),storage:{},global:Object.assign(Object.assign(Object.assign({},m),h),{headers:Object.assign(Object.assign({},(o=m?.headers)!==null&&o!==void 0?o:{}),(l=h?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return s.accessToken?w.accessToken=s.accessToken:delete w.accessToken,w}function i(s){const a=s?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(t(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}return qr}var Zi={};const Td="2.87.1",pi=30*1e3,Ul=3,el=Ul*pi,wx="http://localhost:9999",yx="supabase.auth.token",Ex={"X-Client-Info":`gotrue-js/${Td}`},jl="X-Supabase-Api-Version",Sd={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Tx=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Sx=600*1e3;let Di=class extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}};function Te(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}let Ad=class extends Di{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}};function bd(e){return Te(e)&&e.name==="AuthApiError"}let xn=class extends Di{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}},cn=class extends Di{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}},Jt=class extends cn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function Od(e){return Te(e)&&e.name==="AuthSessionMissingError"}let Bn=class extends cn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},ns=class extends cn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},is=class extends cn{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function kd(e){return Te(e)&&e.name==="AuthImplicitGrantRedirectError"}let $l=class extends cn{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Ua=class extends cn{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}};function Ta(e){return Te(e)&&e.name==="AuthRetryableFetchError"}let Hl=class extends cn{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}};function Ax(e){return Te(e)&&e.name==="AuthWeakPasswordError"}let ja=class extends cn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};const $a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),nf=` 	
\r=`.split(""),bx=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<nf.length;t+=1)e[nf[t].charCodeAt(0)]=-2;for(let t=0;t<$a.length;t+=1)e[$a[t].charCodeAt(0)]=t;return e})();function sf(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r($a[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r($a[n]),t.queuedBits-=6}}function Cd(e,t,r){const n=bx[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function af(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Cx(a,n,r)};for(let a=0;a<e.length;a+=1)Cd(e.charCodeAt(a),i,s);return t.join("")}function Ox(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function kx(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Ox(n,t)}}function Cx(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ai(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Cd(e.charCodeAt(i),r,n);return new Uint8Array(t)}function Rx(e){const t=[];return kx(e,r=>t.push(r)),new Uint8Array(t)}function Kn(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>sf(i,r,n)),sf(null,r,n),t.join("")}function Ix(e){return Math.round(Date.now()/1e3)+e}function Fx(){return Symbol("auth-callback")}const bt=()=>typeof window<"u"&&typeof document<"u",Nn={tested:!1,writable:!1},Rd=()=>{if(!bt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Nn.tested)return Nn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Nn.tested=!0,Nn.writable=!0}catch{Nn.tested=!0,Nn.writable=!1}return Nn.writable};function Px(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Id=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Nx=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",gi=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Dn=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},At=async(e,t)=>{await e.removeItem(t)};class So{constructor(){this.promise=new So.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}So.promiseConstructor=Promise;function tl(e){const t=e.split(".");if(t.length!==3)throw new ja("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Tx.test(t[n]))throw new ja("JWT not in base64url format");return{header:JSON.parse(af(t[0])),payload:JSON.parse(af(t[1])),signature:Ai(t[2]),raw:{header:t[0],payload:t[1]}}}async function Dx(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Lx(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function Bx(e){return("0"+e.toString(16)).substr(-2)}function Mx(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,Bx).join("")}async function Ux(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function jx(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Ux(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ai(e,t,r=!1){const n=Mx();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await gi(e,`${t}-code-verifier`,i);const s=await jx(n);return[s,n===s?"plain":"s256"]}const $x=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Hx(e){const t=e.headers.get(jl);if(!t||!t.match($x))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Wx(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Vx(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Gx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function oi(e){if(!Gx.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function rl(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Kx(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function of(e){return JSON.parse(JSON.stringify(e))}const Mn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),zx=[502,503,504];async function lf(e){var t;if(!Nx(e))throw new Ua(Mn(e),0);if(zx.includes(e.status))throw new Ua(Mn(e),e.status);let r;try{r=await e.json()}catch(s){throw new xn(Mn(s),s)}let n;const i=Hx(e);if(i&&i.getTime()>=Sd["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Hl(Mn(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Jt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Hl(Mn(r),e.status,r.weak_password.reasons);throw new Ad(Mn(r),e.status||500,n)}const qx=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Oe(e,t,r,n){var i;const s=Object.assign({},n?.headers);s[jl]||(s[jl]=Sd["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n?.query)!==null&&i!==void 0?i:{};n?.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Xx(e,t,r+o,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function Xx(e,t,r,n,i,s){const a=qx(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new Ua(Mn(l),0)}if(o.ok||await lf(o),n?.noResolveJson)return o;try{return await o.json()}catch(l){await lf(l)}}function yr(e){var t;let r=null;Qx(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Ix(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function cf(e){const t=yr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function wn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Jx(e){return{data:e,error:null}}function Yx(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=Mi(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function uf(e){return e}function Qx(e){return e.access_token&&e.refresh_token&&e.expires_in}const Sa=["global","local","others"];let yc=class{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Id(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Sa[0]){if(Sa.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Sa.join(", ")}`);try{return await Oe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Te(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Oe(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:wn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Mi(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n?.newEmail,delete i.newEmail),await Oe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Yx,redirectTo:r?.redirectTo})}catch(r){if(Te(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Oe(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:wn})}catch(r){if(Te(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Oe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:uf});if(u.error)throw u.error;const f=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);c[`${m}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Te(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){oi(t);try{return await Oe(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:wn})}catch(r){if(Te(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){oi(t);try{return await Oe(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:wn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){oi(t);try{return await Oe(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:wn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){oi(t.userId);try{const{data:r,error:n}=await Oe(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _deleteFactor(t){oi(t.userId),oi(t.id);try{return{data:await Oe(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Oe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:uf});if(u.error)throw u.error;const f=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(g.split(";")[1].split("=")[1]);c[`${m}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Te(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Oe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Oe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Oe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Te(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Oe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Te(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Oe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Te(r))return{data:null,error:r};throw r}}};function ff(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Un={debug:!!(globalThis&&Rd()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ec extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}let Fd=class extends Ec{};class Zx extends Ec{}async function Pd(e,t,r){Un.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Un.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Un.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Un.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Un.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Fd(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Un.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}const hf={};async function ew(e,t,r){var n;const i=(n=hf[e])!==null&&n!==void 0?n:Promise.resolve(),s=Promise.race([i.catch(()=>null),t>=0?new Promise((a,o)=>{setTimeout(()=>{o(new Zx(`Acquring process lock with name "${e}" timed out`))},t)}):null].filter(a=>a)).catch(a=>{if(a&&a.isAcquireTimeout)throw a;return null}).then(async()=>await r());return hf[e]=s.catch(async a=>{if(a&&a.isAcquireTimeout)return await i,null;throw a}),await s}function tw(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Nd(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function rw(e){return parseInt(e,16)}function nw(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function iw(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const d=Nd(e.address),g=u?`${u}://${n}`:n,p=e.statement?`${e.statement}
`:"",m=`${g} wants you to sign in with your Ethereum account:
${d}

${p}`;let w=`URI: ${f}
Version: ${h}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(w+=`
Expiration Time: ${i.toISOString()}`),o&&(w+=`
Not Before: ${o.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let T=`
Resources:`;for(const _ of c){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);T+=`
- ${_}`}w+=T}return`${m}
${w}`}class pt extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Ha extends pt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function sw({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new pt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new pt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new pt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new pt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new pt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new pt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new pt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new pt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(Dd(a)){if(s.rp.id!==a)return new pt({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new pt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new pt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function aw({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new pt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new pt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Dd(n)){if(r.rpId!==n)return new pt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new pt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class ow{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const lw=new ow;function cw(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Mi(e,["challenge","user","excludeCredentials"]),s=Ai(t).buffer,a=Object.assign(Object.assign({},r),{id:Ai(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Ai(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function uw(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Mi(e,["challenge","allowCredentials"]),i=Ai(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const o=r[a];s.allowCredentials[a]=Object.assign(Object.assign({},o),{id:Ai(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function fw(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Kn(new Uint8Array(e.response.attestationObject)),clientDataJSON:Kn(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function hw(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Kn(new Uint8Array(i.authenticatorData)),clientDataJSON:Kn(new Uint8Array(i.clientDataJSON)),signature:Kn(new Uint8Array(i.signature)),userHandle:i.userHandle?Kn(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Dd(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function df(){var e,t;return!!(bt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function dw(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ha("Browser returned unexpected credential type",t)}:{data:null,error:new Ha("Empty credential response",t)}}catch(t){return{data:null,error:sw({error:t,options:e})}}}async function pw(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ha("Browser returned unexpected credential type",t)}:{data:null,error:new Ha("Empty credential response",t)}}catch(t){return{data:null,error:aw({error:t,options:e})}}}const gw={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},mw={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Wa(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))n[s]=a;else if(r(a))n[s]=a;else if(t(a)){const o=n[s];t(o)?n[s]=Wa(o,a):n[s]=Wa(a)}else n[s]=a}return n}function vw(e,t){return Wa(gw,e,t||{})}function _w(e,t){return Wa(mw,e,t||{})}class xw{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!a)return{data:null,error:o};const l=i??lw.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=vw(a.webauthn.credential_options.publicKey,s?.create),{data:u,error:f}=await dw({publicKey:c,signal:l});return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const c=_w(a.webauthn.credential_options.publicKey,s?.request),{data:u,error:f}=await pw(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(a){return Te(a)?{data:null,error:a}:{data:null,error:new xn("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Di("rpId is required for WebAuthn authentication")};try{if(!df())return{data:null,error:new xn("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return Te(a)?{data:null,error:a}:{data:null,error:new xn("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Di("rpId is required for WebAuthn registration")};try{if(!df())return{data:null,error:new xn("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return Te(a)?{data:null,error:a}:{data:null,error:new xn("Unexpected error in register",a)}}}}tw();const ww={url:wx,storageKey:yx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ex,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function pf(e,t,r){return await r()}const li={};let Tc=class Wl{get jwks(){var t,r;return(r=(t=li[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){li[this.storageKey]=Object.assign(Object.assign({},li[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=li[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){li[this.storageKey]=Object.assign(Object.assign({},li[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},ww),t);if(this.storageKey=s.storageKey,this.instanceID=(r=Wl.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Wl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&bt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new yc({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Id(s.fetch),this.lock=s.lock||pf,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:this.persistSession&&bt()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=Pd:this.lock=pf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new xw(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Rd()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ff(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=ff(this.memoryStorage)),bt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Td}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(bt()&&(r=Px(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),bt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),kd(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Te(r)?this._returnResult({error:r}):this._returnResult({error:new xn("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t?.options)===null||i===void 0?void 0:i.captchaToken}},xform:yr}),{data:a,error:o}=s;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(Te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:u,password:f,options:h}=t;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await ai(this.storage,this.storageKey)),s=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:u,password:f,data:(r=h?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:g},xform:yr})}else if("phone"in t){const{phone:u,password:f,options:h}=t;s=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h?.data)!==null&&n!==void 0?n:{},channel:(i=h?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:yr})}else throw new ns("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return await At(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:cf})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:cf})}else throw new ns("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Bn;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Te(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,a,o,l,c,u,f,h;let d,g;if("message"in t)d=t.message,g=t.signature;else{const{chain:p,wallet:m,statement:w,options:T}=t;let _;if(bt())if(typeof m=="object")_=m;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")_=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=m}const O=new URL((r=T?.url)!==null&&r!==void 0?r:window.location.href),V=await _.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!V||V.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const ee=Nd(V[0]);let R=(n=T?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!R){const B=await _.request({method:"eth_chainId"});R=rw(B)}const q={domain:O.host,address:ee,statement:w,uri:O.href,version:"1",chainId:R,nonce:(i=T?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=T?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=T?.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=T?.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=T?.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=T?.signInWithEthereum)===null||u===void 0?void 0:u.resources};d=iw(q),g=await _.request({method:"personal_sign",params:[nw(d),ee]})}try{const{data:p,error:m}=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:g},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:yr});if(m)throw m;if(!p||!p.session||!p.user){const w=new Bn;return this._returnResult({data:{user:null,session:null},error:w})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:m})}catch(p){if(Te(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(t){var r,n,i,s,a,o,l,c,u,f,h,d;let g,p;if("message"in t)g=t.message,p=t.signature;else{const{chain:m,wallet:w,statement:T,options:_}=t;let O;if(bt())if(typeof w=="object")O=w;else{const ee=window;if("solana"in ee&&typeof ee.solana=="object"&&("signIn"in ee.solana&&typeof ee.solana.signIn=="function"||"signMessage"in ee.solana&&typeof ee.solana.signMessage=="function"))O=ee.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=w}const V=new URL((r=_?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in O&&O.signIn){const ee=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_?.signInWithSolana),{version:"1",domain:V.host,uri:V.href}),T?{statement:T}:null));let R;if(Array.isArray(ee)&&ee[0]&&typeof ee[0]=="object")R=ee[0];else if(ee&&typeof ee=="object"&&"signedMessage"in ee&&"signature"in ee)R=ee;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)g=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),p=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${V.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${V.href}`,`Issued At: ${(i=(n=_?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=_?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_?.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((f=(u=_?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",..._.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const ee=await O.signMessage(new TextEncoder().encode(g),"utf8");if(!ee||!(ee instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=ee}}try{const{data:m,error:w}=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Kn(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:yr});if(w)throw w;if(!m||!m.session||!m.user){const T=new Bn;return this._returnResult({data:{user:null,session:null},error:T})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:w})}catch(m){if(Te(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(t){const r=await Dn(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:yr});if(await At(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!s||!s.session||!s.user){const o=new Bn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:yr}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Bn;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(Te(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await ai(this.storage,this.storageKey));const{error:f}=await Oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l?.data)!==null&&i!==void 0?i:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new ns("You must provide either an email or phone number.")}catch(o){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Oe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:yr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(Te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await ai(this.storage,this.storageKey));const c=await Oe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:Jx});return!((s=c.data)===null||s===void 0)&&s.url&&bt()&&!(!((a=t.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Jt;const{error:i}=await Oe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Te(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await Oe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await Oe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:o})}throw new ns("You must provide either an email or phone number and a type")}catch(r){if(Te(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Dn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<el:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await Dn(this.userStorage,this.storageKey+"-user");a?.user?t.user=a.user:t.user=rl()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=Kx(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:wn}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Jt}:await Oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:wn})})}catch(r){if(Te(r))return Od(r)&&(await this._removeSession(),await At(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Jt;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await ai(this.storage,this.storageKey));const{data:c,error:u}=await Oe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:wn});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Jt;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=tl(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Te(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Jt;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Te(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!bt())throw new is("No browser detected.");if(t.error||t.error_description||t.error_code)throw new is(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new $l("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new is("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new $l("No code detected.");const{data:T,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!a||!c)throw new is("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let h=u+f;l&&(h=parseInt(l));const d=h-u;d*1e3<=pi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${f}s`);const g=h-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,u);const{data:p,error:m}=await this._getUser(s);if(m)throw m;const w={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:h,refresh_token:a,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(n){if(Te(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Dn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({error:s});const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(bd(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await At(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Fx(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await ai(this.storage,this.storageKey,!0));try{return await Oe(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,u;const{data:f,error:h}=s;if(h)throw h;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Oe(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return bt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:t.provider,url:n?.url},error:null})}catch(n){if(Te(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:a,provider:o,token:l,access_token:c,nonce:u}=t,f=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:yr}),{data:h,error:d}=f;return d?this._returnResult({data:{user:null,session:null},error:d}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Bn}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:d}))}catch(i){if(await At(this.storage,`${this.storageKey}-code-verifier`),Te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await Oe(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Lx(async i=>(i>0&&await Dx(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Oe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:yr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Ta(s)&&Date.now()+a-n<pi})}catch(n){if(this._debug(r,"error",n),Te(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),bt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Dn(this.storage,this.storageKey);if(i&&this.userStorage){let a=await Dn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await gi(this.userStorage,this.storageKey+"-user",a)),i.user=(t=a?.user)!==null&&t!==void 0?t:rl()}else if(i&&!i.user&&!i.user){const a=await Dn(this.storage,this.storageKey+"-user");a&&a?.user?(i.user=a.user,await At(this.storage,this.storageKey+"-user"),await gi(this.storage,this.storageKey,i)):i.user=rl()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<el;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${el}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),Ta(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&a?.user?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Jt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new So;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Jt;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),Te(s)){const a={data:null,error:s};return Ta(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await At(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await gi(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=of(i);await gi(this.storage,this.storageKey,s)}else{const i=of(r);await gi(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await At(this.storage,this.storageKey),await At(this.storage,this.storageKey+"-code-verifier"),await At(this.storage,this.storageKey+"-user"),this.userStorage&&await At(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&bt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),pi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/pi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${pi}ms, refresh threshold is ${Ul} ticks`),i<=Ul&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Ec)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!bt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await ai(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n?.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await Oe(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await Oe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&l.type==="totp"&&(!((i=l?.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?fw(t.webauthn.credential_response):hw(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await Oe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const a=await Oe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:cw(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:uw(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r?.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=tl(n.access_token);let a=null;s.aal&&(a=s.aal);let o=a;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const c=s.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Oe(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Jt})})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Jt});const a=await Oe(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&bt()&&!r?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Jt});const a=await Oe(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&bt()&&!r?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Oe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Jt})})}catch(t){if(Te(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await Oe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Jt})})}catch(r){if(Te(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+Sx>i)return n;const{data:s,error:a}=await Oe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:d,error:g}=await this.getSession();if(g||!d.session)return this._returnResult({data:null,error:g});n=d.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=tl(n);r?.allowExpired||Wx(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:s,header:i,signature:a},error:null}}const u=Vx(i.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,Rx(`${o}.${l}`)))throw new ja("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(Te(n))return this._returnResult({data:null,error:n});throw n}}};Tc.nextInstanceID={};const yw=yc,Ew=Tc,Tw=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:yw,AuthApiError:Ad,AuthClient:Ew,AuthError:Di,AuthImplicitGrantRedirectError:is,AuthInvalidCredentialsError:ns,AuthInvalidJwtError:ja,AuthInvalidTokenResponseError:Bn,AuthPKCEGrantCodeExchangeError:$l,AuthRetryableFetchError:Ua,AuthSessionMissingError:Jt,AuthUnknownError:xn,AuthWeakPasswordError:Hl,CustomAuthError:cn,GoTrueAdminApi:yc,GoTrueClient:Tc,NavigatorLockAcquireTimeoutError:Fd,SIGN_OUT_SCOPES:Sa,isAuthApiError:bd,isAuthError:Te,isAuthImplicitGrantRedirectError:kd,isAuthRetryableFetchError:Ta,isAuthSessionMissingError:Od,isAuthWeakPasswordError:Ax,lockInternals:Un,navigatorLock:Pd,processLock:ew},Symbol.toStringTag,{value:"Module"})),Ld=Us(Tw);var gf;function Sw(){if(gf)return Zi;gf=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.SupabaseAuthClient=void 0;const e=Ld;let t=class extends e.AuthClient{constructor(n){super(n)}};return Zi.SupabaseAuthClient=t,Zi}var mf;function vf(){if(mf)return Zs;mf=1,Object.defineProperty(Zs,"__esModule",{value:!0});const e=Xh,t=td(),r=cd,n=gx,i=vx(),s=_x(),a=xx(),o=Sw();class l{constructor(u,f,h){var d,g,p;this.supabaseUrl=u,this.supabaseKey=f;const m=(0,a.validateSupabaseUrl)(u);if(!f)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const w=`sb-${m.hostname.split(".")[0]}-auth-token`,T={db:i.DEFAULT_DB_OPTIONS,realtime:i.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},i.DEFAULT_AUTH_OPTIONS),{storageKey:w}),global:i.DEFAULT_GLOBAL_OPTIONS},_=(0,a.applySettingDefaults)(h??{},T);this.storageKey=(d=_.auth.storageKey)!==null&&d!==void 0?d:"",this.headers=(g=_.global.headers)!==null&&g!==void 0?g:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(O,V)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(V)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((p=_.auth)!==null&&p!==void 0?p:{},this.headers,_.global.fetch),this.fetch=(0,s.fetchWithAuth)(f,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.accessToken&&this.accessToken().then(O=>this.realtime.setAuth(O)).catch(O=>console.warn("Failed to set initial Realtime auth token:",O)),this.rest=new t.PostgrestClient(new URL("rest/v1",m).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new n.StorageClient(this.storageUrl.href,this.headers,this.fetch,h?.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new e.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(u){return this.rest.from(u)}schema(u){return this.rest.schema(u)}rpc(u,f={},h={head:!1,get:!1,count:void 0}){return this.rest.rpc(u,f,h)}channel(u,f={config:{}}){return this.realtime.channel(u,f)}getChannels(){return this.realtime.getChannels()}removeChannel(u){return this.realtime.removeChannel(u)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var u,f;if(this.accessToken)return await this.accessToken();const{data:h}=await this.auth.getSession();return(f=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:u,persistSession:f,detectSessionInUrl:h,storage:d,userStorage:g,storageKey:p,flowType:m,lock:w,debug:T,throwOnError:_},O,V){const ee={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new o.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},ee),O),storageKey:p,autoRefreshToken:u,persistSession:f,detectSessionInUrl:h,storage:d,userStorage:g,flowType:m,lock:w,debug:T,throwOnError:_,fetch:V,hasCustomAuthorizationHeader:Object.keys(this.headers).some(R=>R.toLowerCase()==="authorization")})}_initRealtimeClient(u){return new r.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},u),{params:Object.assign({apikey:this.supabaseKey},u?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((f,h)=>{this._handleTokenChanged(f,"CLIENT",h?.access_token)})}_handleTokenChanged(u,f,h){(u==="TOKEN_REFRESHED"||u==="SIGNED_IN")&&this.changedAccessToken!==h?(this.changedAccessToken=h,this.realtime.setAuth(h)):u==="SIGNED_OUT"&&(this.realtime.setAuth(),f=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}return Zs.default=l,Zs}var _f;function Aw(){return _f||(_f=1,(function(e){var t=zr&&zr.__createBinding||(Object.create?(function(u,f,h,d){d===void 0&&(d=h);var g=Object.getOwnPropertyDescriptor(f,h);(!g||("get"in g?!f.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return f[h]}}),Object.defineProperty(u,d,g)}):(function(u,f,h,d){d===void 0&&(d=h),u[d]=f[h]})),r=zr&&zr.__exportStar||function(u,f){for(var h in u)h!=="default"&&!Object.prototype.hasOwnProperty.call(f,h)&&t(f,u,h)},n=zr&&zr.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(e,"__esModule",{value:!0}),e.createClient=e.SupabaseClient=e.FunctionRegion=e.FunctionsError=e.FunctionsRelayError=e.FunctionsFetchError=e.FunctionsHttpError=e.PostgrestError=void 0;const i=n(vf());r(Ld,e);var s=td();Object.defineProperty(e,"PostgrestError",{enumerable:!0,get:function(){return s.PostgrestError}});var a=Xh;Object.defineProperty(e,"FunctionsHttpError",{enumerable:!0,get:function(){return a.FunctionsHttpError}}),Object.defineProperty(e,"FunctionsFetchError",{enumerable:!0,get:function(){return a.FunctionsFetchError}}),Object.defineProperty(e,"FunctionsRelayError",{enumerable:!0,get:function(){return a.FunctionsRelayError}}),Object.defineProperty(e,"FunctionsError",{enumerable:!0,get:function(){return a.FunctionsError}}),Object.defineProperty(e,"FunctionRegion",{enumerable:!0,get:function(){return a.FunctionRegion}}),r(cd,e);var o=vf();Object.defineProperty(e,"SupabaseClient",{enumerable:!0,get:function(){return n(o).default}});const l=(u,f,h)=>new i.default(u,f,h);e.createClient=l;function c(){if(typeof window<"u"||typeof process>"u")return!1;const u=process.version;if(u==null)return!1;const f=u.match(/^v(\d+)\./);return f?parseInt(f[1],10)<=18:!1}c()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")})(zr)),zr}var Bd=Aw();const Md=v_(Bd),bw=P1({__proto__:null,default:Md},[Bd]),{PostgrestError:AC,FunctionsHttpError:bC,FunctionsFetchError:OC,FunctionsRelayError:kC,FunctionsError:CC,FunctionRegion:RC,SupabaseClient:IC,createClient:Ow,GoTrueAdminApi:FC,GoTrueClient:PC,AuthAdminApi:NC,AuthClient:DC,navigatorLock:LC,NavigatorLockAcquireTimeoutError:BC,lockInternals:MC,processLock:UC,SIGN_OUT_SCOPES:jC,AuthError:$C,AuthApiError:HC,AuthUnknownError:WC,CustomAuthError:VC,AuthSessionMissingError:GC,AuthInvalidTokenResponseError:KC,AuthInvalidCredentialsError:zC,AuthImplicitGrantRedirectError:qC,AuthPKCEGrantCodeExchangeError:XC,AuthRetryableFetchError:JC,AuthWeakPasswordError:YC,AuthInvalidJwtError:QC,isAuthError:ZC,isAuthApiError:eR,isAuthSessionMissingError:tR,isAuthImplicitGrantRedirectError:rR,isAuthRetryableFetchError:nR,isAuthWeakPasswordError:iR,RealtimePresence:sR,RealtimeChannel:aR,RealtimeClient:oR,REALTIME_LISTEN_TYPES:lR,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:cR,REALTIME_PRESENCE_LISTEN_EVENTS:uR,REALTIME_SUBSCRIBE_STATES:fR,REALTIME_CHANNEL_STATES:hR}=Md||bw,kw="https://ykmrystcfwjrrgkglyzr.supabase.co",Cw="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlrbXJ5c3RjZndqcnJna2dseXpyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ5MzQyODIsImV4cCI6MjA4MDUxMDI4Mn0.T4yy_DqaDxilkAW8NMRbYiXiEyQNWknr04TD0sDC_R8",Ct=Ow(kw,Cw);var Va={};Va.version="0.18.5";var Ud=1252,Rw=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jd=function(e){Rw.indexOf(e)!=-1&&(Ud=e)};function Iw(){jd(1252)}var ks=function(e){jd(e)};function Fw(){ks(1200),Iw()}var la=function(t){return String.fromCharCode(t)},xf=function(t){return String.fromCharCode(t)},Ga,yn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cs(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=yn.charAt(s)+yn.charAt(a)+yn.charAt(o)+yn.charAt(l);return t}function an(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=yn.indexOf(e.charAt(c++)),a=yn.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=yn.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=yn.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var je=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),un=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Jn(e){return je?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function wf(e){return je?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ar=function(t){return je?un(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ao(e){if(typeof ArrayBuffer>"u")return Ar(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Hs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Pw(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Rt=je?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:un(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Nw(e){for(var t=[],r=0,n=e.length+250,i=Jn(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Jn(65535),n=65530)}return t.push(i.slice(0,r)),Rt(t)}var ps=/\u0000/g,ca=/[\u0001-\u0006]/g;function bi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Or(e,t){var r=""+e;return r.length>=t?r:lt("0",t-r.length)+r}function Sc(e,t){var r=""+e;return r.length>=t?r:lt(" ",t-r.length)+r}function Ka(e,t){var r=""+e;return r.length>=t?r:r+lt(" ",t-r.length)}function Dw(e,t){var r=""+Math.round(e);return r.length>=t?r:lt("0",t-r.length)+r}function Lw(e,t){var r=""+e;return r.length>=t?r:lt("0",t-r.length)+r}var yf=Math.pow(2,32);function ci(e,t){if(e>yf||e<-yf)return Dw(e,t);var r=Math.round(e);return Lw(r,t)}function za(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ef=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],nl=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Bw(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Tf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Mw={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function qa(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*a+s,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function ua(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Gw(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var $d=new Date(1899,11,31,0,0,0),Uw=$d.getTime(),jw=new Date(1900,2,1,0,0,0);function Hd(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=jw&&(r+=1440*60*1e3),(r-(Uw+(e.getTimezoneOffset()-$d.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Ac(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $w(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Hw(e){var t=e<0?12:11,r=Ac(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Ww(e){var t=Ac(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Vw(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Hw(e):t===10?r=e.toFixed(10).substr(0,12):r=Ww(e),Ac($w(r.toUpperCase()))}function Vl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Vw(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return bn(14,Hd(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Gw(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Kw(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return nl[r.m-1][1];case 5:return nl[r.m-1][0];default:return nl[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Ef[r.q][0];default:return Ef[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Or(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Or(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Or(l,c):"";return u}function En(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Wd=/%/g;function zw(e,t,r){var n=t.replace(Wd,""),i=t.length-n.length;return Zr(e,n,r*Math.pow(10,2*i))+lt("%",i)}function qw(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Zr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Vd(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Vd(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Gd=/# (\?+)( ?)\/( ?)(\d+)/;function Xw(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?lt(" ",e[1].length+1+e[4].length):Sc(a,e[1].length)+e[2]+"/"+e[3]+Or(o,e[4].length))}function Jw(e,t,r){return r+(t===0?"":""+t)+lt(" ",e[1].length+2+e[4].length)}var Kd=/^#*0*\.([0#]+)/,zd=/\).*[0#]/,qd=/\(###\) ###\\?-####/;function Kt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Sf(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Af(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Yw(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Qw(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function pr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(zd)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pr("n",n,r):"("+pr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return qw(e,t,r);if(t.indexOf("%")!==-1)return zw(e,t,r);if(t.indexOf("E")!==-1)return Vd(t,r);if(t.charCodeAt(0)===36)return"$"+pr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ci(l,t.length);if(t.match(/^[#?]+$/))return i=ci(r,0),i==="0"&&(i=""),i.length>t.length?i:Kt(t.substr(0,t.length-i.length))+i;if(s=t.match(Gd))return Xw(s,l,c);if(t.match(/^#+0+$/))return c+ci(l,t.length-t.indexOf("0"));if(s=t.match(Kd))return i=Sf(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Kt(s[1])).replace(/\.$/,"."+Kt(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+lt("0",Kt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Sf(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+En(ci(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pr(e,t,-r):En(""+(Math.floor(r)+Yw(r,s[1].length)))+"."+Or(Af(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return pr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bi(pr(e,t.replace(/[\\-]/g,""),r)),a=0,bi(bi(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(qd))return i=pr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=qa(l,Math.pow(10,a)-1,!1),i=""+c,u=Zr("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Ka(o[2],a),u.length<s[4].length&&(u=Kt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=qa(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Sc(o[1],a)+s[2]+"/"+s[3]+Ka(o[2],a):lt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=ci(r,0),t.length<=i.length?i:Kt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return Kt(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=Af(r,s[1].length),r<0?"-"+pr(e,t,-r):En(Qw(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Or(0,3-g.length):"")+g})+"."+Or(a,s[1].length);switch(t){case"###,##0.00":return pr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=En(ci(l,0));return d!=="0"?c+d:"";case"###,###.00":return pr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return pr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Zw(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Zr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ey(e,t,r){var n=t.replace(Wd,""),i=t.length-n.length;return Zr(e,n,r*Math.pow(10,2*i))+lt("%",i)}function Xd(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Xd(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Pr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(zd)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pr("n",n,r):"("+Pr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Zw(e,t,r);if(t.indexOf("%")!==-1)return ey(e,t,r);if(t.indexOf("E")!==-1)return Xd(t,r);if(t.charCodeAt(0)===36)return"$"+Pr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Or(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Kt(t.substr(0,t.length-i.length))+i;if(s=t.match(Gd))return Jw(s,l,c);if(t.match(/^#+0+$/))return c+Or(l,t.length-t.indexOf("0"));if(s=t.match(Kd))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Kt(s[1])).replace(/\.$/,"."+Kt(s[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+lt("0",Kt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+En(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pr(e,t,-r):En(""+r)+"."+lt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Pr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bi(Pr(e,t.replace(/[\\-]/g,""),r)),a=0,bi(bi(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(qd))return i=Pr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=qa(l,Math.pow(10,a)-1,!1),i=""+c,u=Zr("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Ka(o[2],a),u.length<s[4].length&&(u=Kt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=qa(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Sc(o[1],a)+s[2]+"/"+s[3]+Ka(o[2],a):lt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Kt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return Kt(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Pr(e,t,-r):En(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Or(0,3-g.length):"")+g})+"."+Or(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=En(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return Pr(e,t.slice(0,t.lastIndexOf(".")),r)+Kt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Zr(e,t,r){return(r|0)===r?Pr(e,t,r):pr(e,t,r)}function ty(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Jd=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Yd(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":za(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Jd))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function ry(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,f,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!za(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=e.charAt(++a),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=ua(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ua(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var p={t:o,v:o};if(c==null&&(c=ua(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(p.v=c.H>=12?"":""),p.t="T",a+=5,h="h"):(p.t="t",++a),c==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Jd)){if(c==null&&(c=ua(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Yd(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var m=0,w=0,T;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",m<1&&(m=1);break;case"s":(T=i[a].v.match(/\.0+$/))&&(w=Math.max(w,T[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[a].v.match(/[Hh]/)&&(m=1),m<2&&i[a].v.match(/[Mm]/)&&(m=2),m<3&&i[a].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",O;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Kw(i[a].t.charCodeAt(0),i[a].v,c,w),i[a].t="t";break;case"n":case"?":for(O=a+1;i[O]!=null&&((o=i[O].t)==="?"||o==="D"||(o===" "||o==="t")&&i[O+1]!=null&&(i[O+1].t==="?"||i[O+1].t==="t"&&i[O+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[O].v==="/"||i[O].v===" "&&i[O+1]!=null&&i[O+1].t=="?"));)i[a].v+=i[O].v,i[O]={v:"",t:";"},++O;_+=i[a].v,a=O-1;break;case"G":i[a].t="t",i[a].v=Vl(t,r);break}var V="",ee,R;if(_.length>0){_.charCodeAt(0)==40?(ee=t<0&&_.charCodeAt(0)===45?-t:t,R=Zr("n",_,ee)):(ee=t<0&&n>1?-t:t,R=Zr("n",_,ee),ee<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),O=R.length-1;var q=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){q=a;break}var B=i.length;if(q===i.length&&R.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(O>=i[a].v.length-1?(O-=i[a].v.length,i[a].v=R.substr(O+1,i[a].v.length)):O<0?i[a].v="":(i[a].v=R.substr(0,O+1),O=-1),i[a].t="t",B=a);O>=0&&B<i.length&&(i[B].v=R.substr(0,O+1)+i[B].v)}else if(q!==i.length&&R.indexOf("E")===-1){for(O=R.indexOf(".")-1,a=q;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===q?i[a].v.indexOf(".")-1:i[a].v.length-1,V=i[a].v.substr(u+1);u>=0;--u)O>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(V=R.charAt(O--)+V);i[a].v=V,i[a].t="t",B=a}for(O>=0&&B<i.length&&(i[B].v=R.substr(0,O+1)+i[B].v),O=R.indexOf(".")+1,a=q;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==q)){for(u=i[a].v.indexOf(".")>-1&&a===q?i[a].v.indexOf(".")+1:0,V=i[a].v.substr(0,u);u<i[a].v.length;++u)O<R.length&&(V+=R.charAt(O++));i[a].v=V,i[a].t="t",B=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(ee=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Zr(i[a].t,i[a].v,ee),i[a].t="t");var te="";for(a=0;a!==i.length;++a)i[a]!=null&&(te+=i[a].v);return te}var bf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Of(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function ny(e,t){var r=ty(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(bf),o=r[1].match(bf);return Of(t,a)?[n,r[0]]:Of(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function bn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ct)[e],n==null&&(n=r.table&&r.table[Tf[e]]||ct[Tf[e]]),n==null&&(n=Mw[e]||"General");break}if(za(n,0))return Vl(t,r);t instanceof Date&&(t=Hd(t,r.date1904));var i=ny(n,t);if(za(i[1]))return Vl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return ry(i[1],t,r,i[0])}function Qd(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ct[r]==null){t<0&&(t=r);continue}if(ct[r]==e){t=r;break}}t<0&&(t=391)}return ct[t]=e,t}function bo(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Qd(e[t],t)}function Oo(){ct=Bw()}var Zd=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iy(e){var t=typeof e=="number"?ct[e]:e;return t=t.replace(Zd,"(\\d+)"),new RegExp("^"+t+"$")}function sy(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(Zd)||[]).forEach(function(f,h){var d=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var ay=(function(){var e={};e.version="1.2.0";function t(){for(var R=0,q=new Array(256),B=0;B!=256;++B)R=B,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,q[B]=R;return typeof Int32Array<"u"?new Int32Array(q):q}var r=t();function n(R){var q=0,B=0,te=0,ne=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)ne[te]=R[te];for(te=0;te!=256;++te)for(B=R[te],q=256+te;q<4096;q+=256)B=ne[q]=B>>>8^R[B&255];var se=[];for(te=1;te!=16;++te)se[te-1]=typeof Int32Array<"u"?ne.subarray(te*256,te*256+256):ne.slice(te*256,te*256+256);return se}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],d=i[8],g=i[9],p=i[10],m=i[11],w=i[12],T=i[13],_=i[14];function O(R,q){for(var B=q^-1,te=0,ne=R.length;te<ne;)B=B>>>8^r[(B^R.charCodeAt(te++))&255];return~B}function V(R,q){for(var B=q^-1,te=R.length-15,ne=0;ne<te;)B=_[R[ne++]^B&255]^T[R[ne++]^B>>8&255]^w[R[ne++]^B>>16&255]^m[R[ne++]^B>>>24]^p[R[ne++]]^g[R[ne++]]^d[R[ne++]]^h[R[ne++]]^f[R[ne++]]^u[R[ne++]]^c[R[ne++]]^l[R[ne++]]^o[R[ne++]]^a[R[ne++]]^s[R[ne++]]^r[R[ne++]];for(te+=15;ne<te;)B=B>>>8^r[(B^R[ne++])&255];return~B}function ee(R,q){for(var B=q^-1,te=0,ne=R.length,se=0,de=0;te<ne;)se=R.charCodeAt(te++),se<128?B=B>>>8^r[(B^se)&255]:se<2048?(B=B>>>8^r[(B^(192|se>>6&31))&255],B=B>>>8^r[(B^(128|se&63))&255]):se>=55296&&se<57344?(se=(se&1023)+64,de=R.charCodeAt(te++)&1023,B=B>>>8^r[(B^(240|se>>8&7))&255],B=B>>>8^r[(B^(128|se>>2&63))&255],B=B>>>8^r[(B^(128|de>>6&15|(se&3)<<4))&255],B=B>>>8^r[(B^(128|de&63))&255]):(B=B>>>8^r[(B^(224|se>>12&15))&255],B=B>>>8^r[(B^(128|se>>6&63))&255],B=B>>>8^r[(B^(128|se&63))&255]);return~B}return e.table=r,e.bstr=O,e.buf=V,e.str=ee,e})(),Je=(function(){var t={};t.version="1.2.1";function r(v,S){for(var x=v.split("/"),y=S.split("/"),A=0,b=0,U=Math.min(x.length,y.length);A<U;++A){if(b=x[A].length-y[A].length)return b;if(x[A]!=y[A])return x[A]<y[A]?-1:1}return x.length-y.length}function n(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:n(v.slice(0,-1));var S=v.lastIndexOf("/");return S===-1?v:v.slice(0,S+1)}function i(v){if(v.charAt(v.length-1)=="/")return i(v.slice(0,-1));var S=v.lastIndexOf("/");return S===-1?v:v.slice(S+1)}function s(v,S){typeof S=="string"&&(S=new Date(S));var x=S.getHours();x=x<<6|S.getMinutes(),x=x<<5|S.getSeconds()>>>1,v.write_shift(2,x);var y=S.getFullYear()-1980;y=y<<4|S.getMonth()+1,y=y<<5|S.getDate(),v.write_shift(2,y)}function a(v){var S=v.read_shift(2)&65535,x=v.read_shift(2)&65535,y=new Date,A=x&31;x>>>=5;var b=x&15;x>>>=4,y.setMilliseconds(0),y.setFullYear(x+1980),y.setMonth(b-1),y.setDate(A);var U=S&31;S>>>=5;var Y=S&63;return S>>>=6,y.setHours(S),y.setMinutes(Y),y.setSeconds(U<<1),y}function o(v){ar(v,0);for(var S={},x=0;v.l<=v.length-4;){var y=v.read_shift(2),A=v.read_shift(2),b=v.l+A,U={};switch(y){case 21589:x=v.read_shift(1),x&1&&(U.mtime=v.read_shift(4)),A>5&&(x&2&&(U.atime=v.read_shift(4)),x&4&&(U.ctime=v.read_shift(4))),U.mtime&&(U.mt=new Date(U.mtime*1e3));break}v.l=b,S[y]=U}return S}var l;function c(){return l||(l={})}function u(v,S){if(v[0]==80&&v[1]==75)return Kc(v,S);if((v[0]|32)==109&&(v[1]|32)==105)return O1(v,S);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var x=3,y=512,A=0,b=0,U=0,Y=0,M=0,j=[],W=v.slice(0,512);ar(W,0);var ae=f(W);switch(x=ae[0],x){case 3:y=512;break;case 4:y=4096;break;case 0:if(ae[1]==0)return Kc(v,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+x)}y!==512&&(W=v.slice(0,y),ar(W,28));var pe=v.slice(0,y);h(W,x);var ve=W.read_shift(4,"i");if(x===3&&ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ve);W.l+=4,U=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),Y=W.read_shift(4,"i"),A=W.read_shift(4,"i"),M=W.read_shift(4,"i"),b=W.read_shift(4,"i");for(var ce=-1,me=0;me<109&&(ce=W.read_shift(4,"i"),!(ce<0));++me)j[me]=ce;var Re=d(v,y);m(M,b,Re,y,j);var st=T(Re,U,j,y);st[U].name="!Directory",A>0&&Y!==de&&(st[Y].name="!MiniFAT"),st[j[0]].name="!FAT",st.fat_addrs=j,st.ssz=y;var at={},Lt=[],Ki=[],zi=[];_(U,st,Re,Lt,A,at,Ki,Y),g(Ki,zi,Lt),Lt.shift();var qi={FileIndex:Ki,FullPaths:zi};return S&&S.raw&&(qi.raw={header:pe,sectors:Re}),qi}function f(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(Be,"Header Signature: "),v.l+=16;var S=v.read_shift(2,"u");return[v.read_shift(2,"u"),S]}function h(v,S){var x=9;switch(v.l+=2,x=v.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+x);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+x);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+x)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function d(v,S){for(var x=Math.ceil(v.length/S)-1,y=[],A=1;A<x;++A)y[A-1]=v.slice(A*S,(A+1)*S);return y[x-1]=v.slice(x*S),y}function g(v,S,x){for(var y=0,A=0,b=0,U=0,Y=0,M=x.length,j=[],W=[];y<M;++y)j[y]=W[y]=y,S[y]=x[y];for(;Y<W.length;++Y)y=W[Y],A=v[y].L,b=v[y].R,U=v[y].C,j[y]===y&&(A!==-1&&j[A]!==A&&(j[y]=j[A]),b!==-1&&j[b]!==b&&(j[y]=j[b])),U!==-1&&(j[U]=y),A!==-1&&y!=j[y]&&(j[A]=j[y],W.lastIndexOf(A)<Y&&W.push(A)),b!==-1&&y!=j[y]&&(j[b]=j[y],W.lastIndexOf(b)<Y&&W.push(b));for(y=1;y<M;++y)j[y]===y&&(b!==-1&&j[b]!==b?j[y]=j[b]:A!==-1&&j[A]!==A&&(j[y]=j[A]));for(y=1;y<M;++y)if(v[y].type!==0){if(Y=y,Y!=j[Y])do Y=j[Y],S[y]=S[Y]+"/"+S[y];while(Y!==0&&j[Y]!==-1&&Y!=j[Y]);j[y]=-1}for(S[0]+="/",y=1;y<M;++y)v[y].type!==2&&(S[y]+="/")}function p(v,S,x){for(var y=v.start,A=v.size,b=[],U=y;x&&A>0&&U>=0;)b.push(S.slice(U*se,U*se+se)),A-=se,U=Wn(x,U*4);return b.length===0?z(0):Rt(b).slice(0,v.size)}function m(v,S,x,y,A){var b=de;if(v===de){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var U=x[v],Y=(y>>>2)-1;if(!U)return;for(var M=0;M<Y&&(b=Wn(U,M*4))!==de;++M)A.push(b);m(Wn(U,y-4),S-1,x,y,A)}}function w(v,S,x,y,A){var b=[],U=[];A||(A=[]);var Y=y-1,M=0,j=0;for(M=S;M>=0;){A[M]=!0,b[b.length]=M,U.push(v[M]);var W=x[Math.floor(M*4/y)];if(j=M*4&Y,y<4+j)throw new Error("FAT boundary crossed: "+M+" 4 "+y);if(!v[W])break;M=Wn(v[W],j)}return{nodes:b,data:Df([U])}}function T(v,S,x,y){var A=v.length,b=[],U=[],Y=[],M=[],j=y-1,W=0,ae=0,pe=0,ve=0;for(W=0;W<A;++W)if(Y=[],pe=W+S,pe>=A&&(pe-=A),!U[pe]){M=[];var ce=[];for(ae=pe;ae>=0;){ce[ae]=!0,U[ae]=!0,Y[Y.length]=ae,M.push(v[ae]);var me=x[Math.floor(ae*4/y)];if(ve=ae*4&j,y<4+ve)throw new Error("FAT boundary crossed: "+ae+" 4 "+y);if(!v[me]||(ae=Wn(v[me],ve),ce[ae]))break}b[pe]={nodes:Y,data:Df([M])}}return b}function _(v,S,x,y,A,b,U,Y){for(var M=0,j=y.length?2:0,W=S[v].data,ae=0,pe=0,ve;ae<W.length;ae+=128){var ce=W.slice(ae,ae+128);ar(ce,64),pe=ce.read_shift(2),ve=Rc(ce,0,pe-j),y.push(ve);var me={name:ve,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0},Re=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);Re!==0&&(me.ct=O(ce,ce.l-8));var st=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);st!==0&&(me.mt=O(ce,ce.l-8)),me.start=ce.read_shift(4,"i"),me.size=ce.read_shift(4,"i"),me.size<0&&me.start<0&&(me.size=me.type=0,me.start=de,me.name=""),me.type===5?(M=me.start,A>0&&M!==de&&(S[M].name="!StreamData")):me.size>=4096?(me.storage="fat",S[me.start]===void 0&&(S[me.start]=w(x,me.start,S.fat_addrs,S.ssz)),S[me.start].name=me.name,me.content=S[me.start].data.slice(0,me.size)):(me.storage="minifat",me.size<0?me.size=0:M!==de&&me.start!==de&&S[M]&&(me.content=p(me,S[M].data,(S[Y]||{}).data))),me.content&&ar(me.content,0),b[ve]=me,U.push(me)}}function O(v,S){return new Date((lr(v,S+4)/1e7*Math.pow(2,32)+lr(v,S)/1e7-11644473600)*1e3)}function V(v,S){return c(),u(l.readFileSync(v),S)}function ee(v,S){var x=S&&S.type;switch(x||je&&Buffer.isBuffer(v)&&(x="buffer"),x||"base64"){case"file":return V(v,S);case"base64":return u(Ar(an(v)),S);case"binary":return u(Ar(v),S)}return u(v,S)}function R(v,S){var x=S||{},y=x.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=y+"/",v.FileIndex[0]={name:y,type:5}),x.CLSID&&(v.FileIndex[0].clsid=x.CLSID),q(v)}function q(v){var S="Sh33tJ5";if(!Je.find(v,"/"+S)){var x=z(4);x[0]=55,x[1]=x[3]=50,x[2]=54,v.FileIndex.push({name:S,type:2,content:x,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+S),B(v)}}function B(v,S){R(v);for(var x=!1,y=!1,A=v.FullPaths.length-1;A>=0;--A){var b=v.FileIndex[A];switch(b.type){case 0:y?x=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:y=!0,isNaN(b.R*b.L*b.C)&&(x=!0),b.R>-1&&b.L>-1&&b.R==b.L&&(x=!0);break;default:x=!0;break}}if(!(!x&&!S)){var U=new Date(1987,1,19),Y=0,M=Object.create?Object.create(null):{},j=[];for(A=0;A<v.FullPaths.length;++A)M[v.FullPaths[A]]=!0,v.FileIndex[A].type!==0&&j.push([v.FullPaths[A],v.FileIndex[A]]);for(A=0;A<j.length;++A){var W=n(j[A][0]);y=M[W],y||(j.push([W,{name:i(W).replace("/",""),type:1,clsid:Le,ct:U,mt:U,content:null}]),M[W]=!0)}for(j.sort(function(ve,ce){return r(ve[0],ce[0])}),v.FullPaths=[],v.FileIndex=[],A=0;A<j.length;++A)v.FullPaths[A]=j[A][0],v.FileIndex[A]=j[A][1];for(A=0;A<j.length;++A){var ae=v.FileIndex[A],pe=v.FullPaths[A];if(ae.name=i(pe).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||Le,A===0)ae.C=j.length>1?1:-1,ae.size=0,ae.type=5;else if(pe.slice(-1)=="/"){for(Y=A+1;Y<j.length&&n(v.FullPaths[Y])!=pe;++Y);for(ae.C=Y>=j.length?-1:Y,Y=A+1;Y<j.length&&n(v.FullPaths[Y])!=n(pe);++Y);ae.R=Y>=j.length?-1:Y,ae.type=1}else n(v.FullPaths[A+1]||"")==n(pe)&&(ae.R=A+1),ae.type=2}}}function te(v,S){var x=S||{};if(x.fileType=="mad")return k1(v,x);switch(B(v),x.fileType){case"zip":return y1(v,x)}var y=(function(ve){for(var ce=0,me=0,Re=0;Re<ve.FileIndex.length;++Re){var st=ve.FileIndex[Re];if(st.content){var at=st.content.length;at>0&&(at<4096?ce+=at+63>>6:me+=at+511>>9)}}for(var Lt=ve.FullPaths.length+3>>2,Ki=ce+7>>3,zi=ce+127>>7,qi=Ki+me+Lt+zi,In=qi+127>>7,No=In<=109?0:Math.ceil((In-109)/127);qi+In+No+127>>7>In;)No=++In<=109?0:Math.ceil((In-109)/127);var Wr=[1,No,In,zi,Lt,me,ce,0];return ve.FileIndex[0].size=ce<<6,Wr[7]=(ve.FileIndex[0].start=Wr[0]+Wr[1]+Wr[2]+Wr[3]+Wr[4]+Wr[5])+(Wr[6]+7>>3),Wr})(v),A=z(y[7]<<9),b=0,U=0;{for(b=0;b<8;++b)A.write_shift(1,ke[b]);for(b=0;b<8;++b)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),b=0;b<3;++b)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,y[2]),A.write_shift(4,y[0]+y[1]+y[2]+y[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,y[3]?y[0]+y[1]+y[2]-1:de),A.write_shift(4,y[3]),A.write_shift(-4,y[1]?y[0]-1:de),A.write_shift(4,y[1]),b=0;b<109;++b)A.write_shift(-4,b<y[2]?y[1]+b:-1)}if(y[1])for(U=0;U<y[1];++U){for(;b<236+U*127;++b)A.write_shift(-4,b<y[2]?y[1]+b:-1);A.write_shift(-4,U===y[1]-1?de:U+1)}var Y=function(ve){for(U+=ve;b<U-1;++b)A.write_shift(-4,b+1);ve&&(++b,A.write_shift(-4,de))};for(U=b=0,U+=y[1];b<U;++b)A.write_shift(-4,Ae.DIFSECT);for(U+=y[2];b<U;++b)A.write_shift(-4,Ae.FATSECT);Y(y[3]),Y(y[4]);for(var M=0,j=0,W=v.FileIndex[0];M<v.FileIndex.length;++M)W=v.FileIndex[M],W.content&&(j=W.content.length,!(j<4096)&&(W.start=U,Y(j+511>>9)));for(Y(y[6]+7>>3);A.l&511;)A.write_shift(-4,Ae.ENDOFCHAIN);for(U=b=0,M=0;M<v.FileIndex.length;++M)W=v.FileIndex[M],W.content&&(j=W.content.length,!(!j||j>=4096)&&(W.start=U,Y(j+63>>6)));for(;A.l&511;)A.write_shift(-4,Ae.ENDOFCHAIN);for(b=0;b<y[4]<<2;++b){var ae=v.FullPaths[b];if(!ae||ae.length===0){for(M=0;M<17;++M)A.write_shift(4,0);for(M=0;M<3;++M)A.write_shift(4,-1);for(M=0;M<12;++M)A.write_shift(4,0);continue}W=v.FileIndex[b],b===0&&(W.start=W.size?W.start-1:de);var pe=b===0&&x.root||W.name;if(j=2*(pe.length+1),A.write_shift(64,pe,"utf16le"),A.write_shift(2,j),A.write_shift(1,W.type),A.write_shift(1,W.color),A.write_shift(-4,W.L),A.write_shift(-4,W.R),A.write_shift(-4,W.C),W.clsid)A.write_shift(16,W.clsid,"hex");else for(M=0;M<4;++M)A.write_shift(4,0);A.write_shift(4,W.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,W.start),A.write_shift(4,W.size),A.write_shift(4,0)}for(b=1;b<v.FileIndex.length;++b)if(W=v.FileIndex[b],W.size>=4096)if(A.l=W.start+1<<9,je&&Buffer.isBuffer(W.content))W.content.copy(A,A.l,0,W.size),A.l+=W.size+511&-512;else{for(M=0;M<W.size;++M)A.write_shift(1,W.content[M]);for(;M&511;++M)A.write_shift(1,0)}for(b=1;b<v.FileIndex.length;++b)if(W=v.FileIndex[b],W.size>0&&W.size<4096)if(je&&Buffer.isBuffer(W.content))W.content.copy(A,A.l,0,W.size),A.l+=W.size+63&-64;else{for(M=0;M<W.size;++M)A.write_shift(1,W.content[M]);for(;M&63;++M)A.write_shift(1,0)}if(je)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function ne(v,S){var x=v.FullPaths.map(function(M){return M.toUpperCase()}),y=x.map(function(M){var j=M.split("/");return j[j.length-(M.slice(-1)=="/"?2:1)]}),A=!1;S.charCodeAt(0)===47?(A=!0,S=x[0].slice(0,-1)+S):A=S.indexOf("/")!==-1;var b=S.toUpperCase(),U=A===!0?x.indexOf(b):y.indexOf(b);if(U!==-1)return v.FileIndex[U];var Y=!b.match(ca);for(b=b.replace(ps,""),Y&&(b=b.replace(ca,"!")),U=0;U<x.length;++U)if((Y?x[U].replace(ca,"!"):x[U]).replace(ps,"")==b||(Y?y[U].replace(ca,"!"):y[U]).replace(ps,"")==b)return v.FileIndex[U];return null}var se=64,de=-2,Be="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],Le="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:de,FREESECT:-1,HEADER_SIGNATURE:Be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Fe(v,S,x){c();var y=te(v,x);l.writeFileSync(S,y)}function Xe(v){for(var S=new Array(v.length),x=0;x<v.length;++x)S[x]=String.fromCharCode(v[x]);return S.join("")}function ut(v,S){var x=te(v,S);switch(S&&S.type||"buffer"){case"file":return c(),l.writeFileSync(S.filename,x),x;case"binary":return typeof x=="string"?x:Xe(x);case"base64":return Cs(typeof x=="string"?x:Xe(x));case"buffer":if(je)return Buffer.isBuffer(x)?x:un(x);case"array":return typeof x=="string"?Ar(x):x}return x}var rt;function C(v){try{var S=v.InflateRaw,x=new S;if(x._processChunk(new Uint8Array([3,0]),x._finishFlushFlag),x.bytesRead)rt=v;else throw new Error("zlib does not expose bytesRead")}catch(y){console.error("cannot use native zlib: "+(y.message||y))}}function H(v,S){if(!rt)return Gi(v,S);var x=rt.InflateRaw,y=new x,A=y._processChunk(v.slice(v.l),y._finishFlushFlag);return v.l+=y.bytesRead,A}function P(v){return rt?rt.deflateRawSync(v):St(v)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],D=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(v){var S=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(S>>16|S>>8|S)&255}for(var G=typeof Uint8Array<"u",X=G?new Uint8Array(256):[],ye=0;ye<256;++ye)X[ye]=Q(ye);function E(v,S){var x=X[v&255];return S<=8?x>>>8-S:(x=x<<8|X[v>>8&255],S<=16?x>>>16-S:(x=x<<8|X[v>>16&255],x>>>24-S))}function k(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=6?0:v[y+1]<<8))>>>x&3}function I(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=5?0:v[y+1]<<8))>>>x&7}function J(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=4?0:v[y+1]<<8))>>>x&15}function K(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=3?0:v[y+1]<<8))>>>x&31}function N(v,S){var x=S&7,y=S>>>3;return(v[y]|(x<=1?0:v[y+1]<<8))>>>x&127}function ue(v,S,x){var y=S&7,A=S>>>3,b=(1<<x)-1,U=v[A]>>>y;return x<8-y||(U|=v[A+1]<<8-y,x<16-y)||(U|=v[A+2]<<16-y,x<24-y)||(U|=v[A+3]<<24-y),U&b}function le(v,S,x){var y=S&7,A=S>>>3;return y<=5?v[A]|=(x&7)<<y:(v[A]|=x<<y&255,v[A+1]=(x&7)>>8-y),S+3}function oe(v,S,x){var y=S&7,A=S>>>3;return x=(x&1)<<y,v[A]|=x,S+1}function ie(v,S,x){var y=S&7,A=S>>>3;return x<<=y,v[A]|=x&255,x>>>=8,v[A+1]=x,S+8}function Se(v,S,x){var y=S&7,A=S>>>3;return x<<=y,v[A]|=x&255,x>>>=8,v[A+1]=x&255,v[A+2]=x>>>8,S+16}function ge(v,S){var x=v.length,y=2*x>S?2*x:S+5,A=0;if(x>=S)return v;if(je){var b=wf(y);if(v.copy)v.copy(b);else for(;A<v.length;++A)b[A]=v[A];return b}else if(G){var U=new Uint8Array(y);if(U.set)U.set(v);else for(;A<x;++A)U[A]=v[A];return U}return v.length=y,v}function we(v){for(var S=new Array(v),x=0;x<v;++x)S[x]=0;return S}function be(v,S,x){var y=1,A=0,b=0,U=0,Y=0,M=v.length,j=G?new Uint16Array(32):we(32);for(b=0;b<32;++b)j[b]=0;for(b=M;b<x;++b)v[b]=0;M=v.length;var W=G?new Uint16Array(M):we(M);for(b=0;b<M;++b)j[A=v[b]]++,y<A&&(y=A),W[b]=0;for(j[0]=0,b=1;b<=y;++b)j[b+16]=Y=Y+j[b-1]<<1;for(b=0;b<M;++b)Y=v[b],Y!=0&&(W[b]=j[Y+16]++);var ae=0;for(b=0;b<M;++b)if(ae=v[b],ae!=0)for(Y=E(W[b],y)>>y-ae,U=(1<<y+4-ae)-1;U>=0;--U)S[Y|U<<ae]=ae&15|b<<4;return y}var Ne=G?new Uint16Array(512):we(512),$e=G?new Uint16Array(32):we(32);if(!G){for(var De=0;De<512;++De)Ne[De]=0;for(De=0;De<32;++De)$e[De]=0}(function(){for(var v=[],S=0;S<32;S++)v.push(5);be(v,$e,32);var x=[];for(S=0;S<=143;S++)x.push(8);for(;S<=255;S++)x.push(9);for(;S<=279;S++)x.push(7);for(;S<=287;S++)x.push(8);be(x,Ne,288)})();var Nt=(function(){for(var S=G?new Uint8Array(32768):[],x=0,y=0;x<D.length-1;++x)for(;y<D[x+1];++y)S[y]=x;for(;y<32768;++y)S[y]=29;var A=G?new Uint8Array(259):[];for(x=0,y=0;x<Z.length-1;++x)for(;y<Z[x+1];++y)A[y]=x;function b(Y,M){for(var j=0;j<Y.length;){var W=Math.min(65535,Y.length-j),ae=j+W==Y.length;for(M.write_shift(1,+ae),M.write_shift(2,W),M.write_shift(2,~W&65535);W-- >0;)M[M.l++]=Y[j++]}return M.l}function U(Y,M){for(var j=0,W=0,ae=G?new Uint16Array(32768):[];W<Y.length;){var pe=Math.min(65535,Y.length-W);if(pe<10){for(j=le(M,j,+(W+pe==Y.length)),j&7&&(j+=8-(j&7)),M.l=j/8|0,M.write_shift(2,pe),M.write_shift(2,~pe&65535);pe-- >0;)M[M.l++]=Y[W++];j=M.l*8;continue}j=le(M,j,+(W+pe==Y.length)+2);for(var ve=0;pe-- >0;){var ce=Y[W];ve=(ve<<5^ce)&32767;var me=-1,Re=0;if((me=ae[ve])&&(me|=W&-32768,me>W&&(me-=32768),me<W))for(;Y[me+Re]==Y[W+Re]&&Re<250;)++Re;if(Re>2){ce=A[Re],ce<=22?j=ie(M,j,X[ce+1]>>1)-1:(ie(M,j,3),j+=5,ie(M,j,X[ce-23]>>5),j+=3);var st=ce<8?0:ce-4>>2;st>0&&(Se(M,j,Re-Z[ce]),j+=st),ce=S[W-me],j=ie(M,j,X[ce]>>3),j-=3;var at=ce<4?0:ce-2>>1;at>0&&(Se(M,j,W-me-D[ce]),j+=at);for(var Lt=0;Lt<Re;++Lt)ae[ve]=W&32767,ve=(ve<<5^Y[W])&32767,++W;pe-=Re-1}else ce<=143?ce=ce+48:j=oe(M,j,1),j=ie(M,j,X[ce]),ae[ve]=W&32767,++W}j=ie(M,j,0)-1}return M.l=(j+7)/8|0,M.l}return function(M,j){return M.length<8?b(M,j):U(M,j)}})();function St(v){var S=z(50+Math.floor(v.length*1.1)),x=Nt(v,S);return S.slice(0,x)}var rr=G?new Uint16Array(32768):we(32768),nr=G?new Uint16Array(32768):we(32768),fn=G?new Uint16Array(128):we(128),Vi=1,Dt=1;function dr(v,S){var x=K(v,S)+257;S+=5;var y=K(v,S)+1;S+=5;var A=J(v,S)+4;S+=4;for(var b=0,U=G?new Uint8Array(19):we(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=1,j=G?new Uint8Array(8):we(8),W=G?new Uint8Array(8):we(8),ae=U.length,pe=0;pe<A;++pe)U[F[pe]]=b=I(v,S),M<b&&(M=b),j[b]++,S+=3;var ve=0;for(j[0]=0,pe=1;pe<=M;++pe)W[pe]=ve=ve+j[pe-1]<<1;for(pe=0;pe<ae;++pe)(ve=U[pe])!=0&&(Y[pe]=W[ve]++);var ce=0;for(pe=0;pe<ae;++pe)if(ce=U[pe],ce!=0){ve=X[Y[pe]]>>8-ce;for(var me=(1<<7-ce)-1;me>=0;--me)fn[ve|me<<ce]=ce&7|pe<<3}var Re=[];for(M=1;Re.length<x+y;)switch(ve=fn[N(v,S)],S+=ve&7,ve>>>=3){case 16:for(b=3+k(v,S),S+=2,ve=Re[Re.length-1];b-- >0;)Re.push(ve);break;case 17:for(b=3+I(v,S),S+=3;b-- >0;)Re.push(0);break;case 18:for(b=11+N(v,S),S+=7;b-- >0;)Re.push(0);break;default:Re.push(ve),M<ve&&(M=ve);break}var st=Re.slice(0,x),at=Re.slice(x);for(pe=x;pe<286;++pe)st[pe]=0;for(pe=y;pe<30;++pe)at[pe]=0;return Vi=be(st,rr,286),Dt=be(at,nr,30),S}function qs(v,S){if(v[0]==3&&!(v[1]&3))return[Jn(S),2];for(var x=0,y=0,A=wf(S||1<<18),b=0,U=A.length>>>0,Y=0,M=0;(y&1)==0;){if(y=I(v,x),x+=3,y>>>1)y>>1==1?(Y=9,M=5):(x=dr(v,x),Y=Vi,M=Dt);else{x&7&&(x+=8-(x&7));var j=v[x>>>3]|v[(x>>>3)+1]<<8;if(x+=32,j>0)for(!S&&U<b+j&&(A=ge(A,b+j),U=A.length);j-- >0;)A[b++]=v[x>>>3],x+=8;continue}for(;;){!S&&U<b+32767&&(A=ge(A,b+32767),U=A.length);var W=ue(v,x,Y),ae=y>>>1==1?Ne[W]:rr[W];if(x+=ae&15,ae>>>=4,(ae>>>8&255)===0)A[b++]=ae;else{if(ae==256)break;ae-=257;var pe=ae<8?0:ae-4>>2;pe>5&&(pe=0);var ve=b+Z[ae];pe>0&&(ve+=ue(v,x,pe),x+=pe),W=ue(v,x,M),ae=y>>>1==1?$e[W]:nr[W],x+=ae&15,ae>>>=4;var ce=ae<4?0:ae-2>>1,me=D[ae];for(ce>0&&(me+=ue(v,x,ce),x+=ce),!S&&U<ve&&(A=ge(A,ve+100),U=A.length);b<ve;)A[b]=A[b-me],++b}}}return S?[A,x+7>>>3]:[A.slice(0,b),x+7>>>3]}function Gi(v,S){var x=v.slice(v.l||0),y=qs(x,S);return v.l+=y[1],y[0]}function Gc(v,S){if(v)typeof console<"u"&&console.error(S);else throw new Error(S)}function Kc(v,S){var x=v;ar(x,0);var y=[],A=[],b={FileIndex:y,FullPaths:A};R(b,{root:S.root});for(var U=x.length-4;(x[U]!=80||x[U+1]!=75||x[U+2]!=5||x[U+3]!=6)&&U>=0;)--U;x.l=U+4,x.l+=4;var Y=x.read_shift(2);x.l+=6;var M=x.read_shift(4);for(x.l=M,U=0;U<Y;++U){x.l+=20;var j=x.read_shift(4),W=x.read_shift(4),ae=x.read_shift(2),pe=x.read_shift(2),ve=x.read_shift(2);x.l+=8;var ce=x.read_shift(4),me=o(x.slice(x.l+ae,x.l+ae+pe));x.l+=ae+pe+ve;var Re=x.l;x.l=ce+4,w1(x,j,W,b,me),x.l=Re}return b}function w1(v,S,x,y,A){v.l+=2;var b=v.read_shift(2),U=v.read_shift(2),Y=a(v);if(b&8257)throw new Error("Unsupported ZIP encryption");for(var M=v.read_shift(4),j=v.read_shift(4),W=v.read_shift(4),ae=v.read_shift(2),pe=v.read_shift(2),ve="",ce=0;ce<ae;++ce)ve+=String.fromCharCode(v[v.l++]);if(pe){var me=o(v.slice(v.l,v.l+pe));(me[21589]||{}).mt&&(Y=me[21589].mt),((A||{})[21589]||{}).mt&&(Y=A[21589].mt)}v.l+=pe;var Re=v.slice(v.l,v.l+j);switch(U){case 8:Re=H(v,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+U)}var st=!1;b&8&&(M=v.read_shift(4),M==134695760&&(M=v.read_shift(4),st=!0),j=v.read_shift(4),W=v.read_shift(4)),j!=S&&Gc(st,"Bad compressed size: "+S+" != "+j),W!=x&&Gc(st,"Bad uncompressed size: "+x+" != "+W),Po(y,ve,Re,{unsafe:!0,mt:Y})}function y1(v,S){var x=S||{},y=[],A=[],b=z(1),U=x.compression?8:0,Y=0,M=0,j=0,W=0,ae=0,pe=v.FullPaths[0],ve=pe,ce=v.FileIndex[0],me=[],Re=0;for(M=1;M<v.FullPaths.length;++M)if(ve=v.FullPaths[M].slice(pe.length),ce=v.FileIndex[M],!(!ce.size||!ce.content||ve=="Sh33tJ5")){var st=W,at=z(ve.length);for(j=0;j<ve.length;++j)at.write_shift(1,ve.charCodeAt(j)&127);at=at.slice(0,at.l),me[ae]=ay.buf(ce.content,0);var Lt=ce.content;U==8&&(Lt=P(Lt)),b=z(30),b.write_shift(4,67324752),b.write_shift(2,20),b.write_shift(2,Y),b.write_shift(2,U),ce.mt?s(b,ce.mt):b.write_shift(4,0),b.write_shift(-4,me[ae]),b.write_shift(4,Lt.length),b.write_shift(4,ce.content.length),b.write_shift(2,at.length),b.write_shift(2,0),W+=b.length,y.push(b),W+=at.length,y.push(at),W+=Lt.length,y.push(Lt),b=z(46),b.write_shift(4,33639248),b.write_shift(2,0),b.write_shift(2,20),b.write_shift(2,Y),b.write_shift(2,U),b.write_shift(4,0),b.write_shift(-4,me[ae]),b.write_shift(4,Lt.length),b.write_shift(4,ce.content.length),b.write_shift(2,at.length),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(4,0),b.write_shift(4,st),Re+=b.l,A.push(b),Re+=at.length,A.push(at),++ae}return b=z(22),b.write_shift(4,101010256),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,ae),b.write_shift(2,ae),b.write_shift(4,Re),b.write_shift(4,W),b.write_shift(2,0),Rt([Rt(y),Rt(A),b])}var Xs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function E1(v,S){if(v.ctype)return v.ctype;var x=v.name||"",y=x.match(/\.([^\.]+)$/);return y&&Xs[y[1]]||S&&(y=(x=S).match(/[\.\\]([^\.\\])+$/),y&&Xs[y[1]])?Xs[y[1]]:"application/octet-stream"}function T1(v){for(var S=Cs(v),x=[],y=0;y<S.length;y+=76)x.push(S.slice(y,y+76));return x.join(`\r
`)+`\r
`}function S1(v){var S=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(j){var W=j.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var x=[],y=S.split(`\r
`),A=0;A<y.length;++A){var b=y[A];if(b.length==0){x.push("");continue}for(var U=0;U<b.length;){var Y=76,M=b.slice(U,U+Y);M.charAt(Y-1)=="="?Y--:M.charAt(Y-2)=="="?Y-=2:M.charAt(Y-3)=="="&&(Y-=3),M=b.slice(U,U+Y),U+=Y,U<b.length&&(M+="="),x.push(M)}}return x.join(`\r
`)}function A1(v){for(var S=[],x=0;x<v.length;++x){for(var y=v[x];x<=v.length&&y.charAt(y.length-1)=="=";)y=y.slice(0,y.length-1)+v[++x];S.push(y)}for(var A=0;A<S.length;++A)S[A]=S[A].replace(/[=][0-9A-Fa-f]{2}/g,function(b){return String.fromCharCode(parseInt(b.slice(1),16))});return Ar(S.join(`\r
`))}function b1(v,S,x){for(var y="",A="",b="",U,Y=0;Y<10;++Y){var M=S[Y];if(!M||M.match(/^\s*$/))break;var j=M.match(/^(.*?):\s*([^\s].*)$/);if(j)switch(j[1].toLowerCase()){case"content-location":y=j[2].trim();break;case"content-type":b=j[2].trim();break;case"content-transfer-encoding":A=j[2].trim();break}}switch(++Y,A.toLowerCase()){case"base64":U=Ar(an(S.slice(Y).join("")));break;case"quoted-printable":U=A1(S.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var W=Po(v,y.slice(x.length),U,{unsafe:!0});b&&(W.ctype=b)}function O1(v,S){if(Xe(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var x=S&&S.root||"",y=(je&&Buffer.isBuffer(v)?v.toString("binary"):Xe(v)).split(`\r
`),A=0,b="";for(A=0;A<y.length;++A)if(b=y[A],!!/^Content-Location:/i.test(b)&&(b=b.slice(b.indexOf("file")),x||(x=b.slice(0,b.lastIndexOf("/")+1)),b.slice(0,x.length)!=x))for(;x.length>0&&(x=x.slice(0,x.length-1),x=x.slice(0,x.lastIndexOf("/")+1),b.slice(0,x.length)!=x););var U=(y[1]||"").match(/boundary="(.*?)"/);if(!U)throw new Error("MAD cannot find boundary");var Y="--"+(U[1]||""),M=[],j=[],W={FileIndex:M,FullPaths:j};R(W);var ae,pe=0;for(A=0;A<y.length;++A){var ve=y[A];ve!==Y&&ve!==Y+"--"||(pe++&&b1(W,y.slice(ae,A),x),ae=A)}return W}function k1(v,S){var x=S||{},y=x.boundary||"SheetJS";y="------="+y;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+y.slice(2)+'"',"","",""],b=v.FullPaths[0],U=b,Y=v.FileIndex[0],M=1;M<v.FullPaths.length;++M)if(U=v.FullPaths[M].slice(b.length),Y=v.FileIndex[M],!(!Y.size||!Y.content||U=="Sh33tJ5")){U=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Re){return"_x"+Re.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Re){return"_u"+Re.charCodeAt(0).toString(16)+"_"});for(var j=Y.content,W=je&&Buffer.isBuffer(j)?j.toString("binary"):Xe(j),ae=0,pe=Math.min(1024,W.length),ve=0,ce=0;ce<=pe;++ce)(ve=W.charCodeAt(ce))>=32&&ve<128&&++ae;var me=ae>=pe*4/5;A.push(y),A.push("Content-Location: "+(x.root||"file:///C:/SheetJS/")+U),A.push("Content-Transfer-Encoding: "+(me?"quoted-printable":"base64")),A.push("Content-Type: "+E1(Y,U)),A.push(""),A.push(me?S1(W):T1(W))}return A.push(y+`--\r
`),A.join(`\r
`)}function C1(v){var S={};return R(S,v),S}function Po(v,S,x,y){var A=y&&y.unsafe;A||R(v);var b=!A&&Je.find(v,S);if(!b){var U=v.FullPaths[0];S.slice(0,U.length)==U?U=S:(U.slice(-1)!="/"&&(U+="/"),U=(U+S).replace("//","/")),b={name:i(S),type:2},v.FileIndex.push(b),v.FullPaths.push(U),A||Je.utils.cfb_gc(v)}return b.content=x,b.size=x?x.length:0,y&&(y.CLSID&&(b.clsid=y.CLSID),y.mt&&(b.mt=y.mt),y.ct&&(b.ct=y.ct)),b}function R1(v,S){R(v);var x=Je.find(v,S);if(x){for(var y=0;y<v.FileIndex.length;++y)if(v.FileIndex[y]==x)return v.FileIndex.splice(y,1),v.FullPaths.splice(y,1),!0}return!1}function I1(v,S,x){R(v);var y=Je.find(v,S);if(y){for(var A=0;A<v.FileIndex.length;++A)if(v.FileIndex[A]==y)return v.FileIndex[A].name=i(x),v.FullPaths[A]=x,!0}return!1}function F1(v){B(v,!0)}return t.find=ne,t.read=ee,t.parse=u,t.write=ut,t.writeFile=Fe,t.utils={cfb_new:C1,cfb_add:Po,cfb_del:R1,cfb_mov:I1,cfb_gc:F1,ReadShift:ms,CheckField:vp,prep_blob:ar,bconcat:Rt,use_zlib:C,_deflateRaw:St,_inflateRaw:Gi,consts:Ae},t})();function oy(e){return typeof e=="string"?Ao(e):Array.isArray(e)?Pw(e):e}function Ws(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ao(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Is(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([oy(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Hs(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Pt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function kf(e,t){for(var r=[],n=Pt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function bc(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ko(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function ly(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Xa=new Date(1899,11,30,0,0,0);function er(e,t){var r=e.getTime(),n=Xa.getTime()+(e.getTimezoneOffset()-Xa.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var ep=new Date,cy=Xa.getTime()+(ep.getTimezoneOffset()-Xa.getTimezoneOffset())*6e4,Cf=ep.getTimezoneOffset();function tp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+cy),t.getTimezoneOffset()!==Cf&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Cf)*6e4),t}var Rf=new Date("2017-02-19T19:06:09.000Z"),rp=isNaN(Rf.getFullYear())?new Date("2/19/17"):Rf,uy=rp.getFullYear()==2017;function Xt(e,t){var r=new Date(e);if(uy)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(rp.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Co(e,t){if(je&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function tr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=tr(e[r]));return t}function lt(e,t){for(var r="";r.length<t;)r+=e;return r}function en(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var fy=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rs(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&fy.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Pe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return je?n=un(r):n=Nw(r),Je.utils.cfb_add(e,t,n)}Je.utils.cfb_add(e,t,r)}else e.file(t,r)}function Oc(){return Je.utils.cfb_new()}var vt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,hy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kc=bc(hy),Cc=/[&<>'"]/g,dy=/[\u0000-\u0008\u000b-\u001f]/g;function ze(e){var t=e+"";return t.replace(Cc,function(r){return kc[r]}).replace(dy,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function If(e){return ze(e).replace(/ /g,"_x0020_")}var np=/[\u0000-\u001f]/g;function py(e){var t=e+"";return t.replace(Cc,function(r){return kc[r]}).replace(/\n/g,"<br/>").replace(np,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function gy(e){var t=e+"";return t.replace(Cc,function(r){return kc[r]}).replace(np,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function my(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vy(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function il(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Ff(e){var t=Jn(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Pf(e){return un(e,"binary").toString("utf8")}var fa="foo bar baz",gs=je&&(Pf(fa)==il(fa)&&Pf||Ff(fa)==il(fa)&&Ff)||il,Is=je?function(e){return un(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},_y=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),ip=/(^\s|\s$|\n)/;function It(e,t){return"<"+e+(t.match(ip)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Fs(e){return Pt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function fe(e,t,r){return"<"+e+(r!=null?Fs(r):"")+(t!=null?(t.match(ip)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Gl(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function xy(e,t){switch(typeof e){case"string":var r=fe("vt:lpwstr",ze(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return fe((e|0)==e?"vt:i4":"vt:r8",ze(String(e)));case"boolean":return fe("vt:bool",e?"true":"false")}if(e instanceof Date)return fe("vt:filetime",Gl(e));throw new Error("Unable to serialize "+e)}var wt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ji=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],or={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function wy(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function yy(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var Nf=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Df=je?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:un(t)})):Nf(e)}:Nf,Lf=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(ss(e,i)));return n.join("").replace(ps,"")},Rc=je?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ps,""):Lf(e,t,r)}:Lf,Bf=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},sp=je?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Bf(e,t,r)}:Bf,Mf=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(mi(e,i)));return n.join("")},Vs=je?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Mf(t,r,n)}:Mf,ap=function(e,t){var r=lr(e,t);return r>0?Vs(e,t+4,t+4+r-1):""},op=ap,lp=function(e,t){var r=lr(e,t);return r>0?Vs(e,t+4,t+4+r-1):""},cp=lp,up=function(e,t){var r=2*lr(e,t);return r>0?Vs(e,t+4,t+4+r-1):""},fp=up,hp=function(t,r){var n=lr(t,r);return n>0?Rc(t,r+4,r+4+n):""},dp=hp,pp=function(e,t){var r=lr(e,t);return r>0?Vs(e,t+4,t+4+r):""},gp=pp,mp=function(e,t){return wy(e,t)},Ja=mp,Ic=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};je&&(op=function(t,r){if(!Buffer.isBuffer(t))return ap(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},cp=function(t,r){if(!Buffer.isBuffer(t))return lp(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},fp=function(t,r){if(!Buffer.isBuffer(t))return up(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},dp=function(t,r){if(!Buffer.isBuffer(t))return hp(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},gp=function(t,r){if(!Buffer.isBuffer(t))return pp(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Ja=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):mp(t,r)},Ic=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var mi=function(e,t){return e[t]},ss=function(e,t){return e[t+1]*256+e[t]},Ey=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},lr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Wn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ty=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ms(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,je&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ss(this,c)),c+=2;e*=2;break;case"utf8":r=Vs(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Rc(this,this.l,this.l+e);break;case"wstr":return ms.call(this,e,"dbcs");case"lpstr-ansi":r=op(this,this.l),e=4+lr(this,this.l);break;case"lpstr-cp":r=cp(this,this.l),e=4+lr(this,this.l);break;case"lpwstr":r=fp(this,this.l),e=4+2*lr(this,this.l);break;case"lpp4":e=4+lr(this,this.l),r=dp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+lr(this,this.l),r=gp(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=mi(this,this.l+e++))!==0;)s.push(la(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=ss(this,this.l+e))!==0;)s.push(la(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=mi(this,c),this.l=c+1,o=ms.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(la(ss(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=mi(this,c),this.l=c+1,o=ms.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(la(mi(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=mi(this,this.l),this.l++,n;case 2:return n=(t==="i"?Ey:ss)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Wn:Ty)(this,this.l),this.l+=4,n):(i=lr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Ja(this,this.l):i=Ja([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=sp(this,this.l,e);break}}return this.l+=e,r}var Sy=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Ay=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},by=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Oy(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)by(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Sy(this,t,this.l);break;case 8:if(n=8,r==="f"){yy(this,t,this.l);break}case 16:break;case-4:n=4,Ay(this,t,this.l);break}return this.l+=n,this}function vp(e,t){var r=sp(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ar(e,t){e.l=t,e.read_shift=ms,e.chk=vp,e.write_shift=Oy}function Hr(e,t){e.l+=t}function z(e){var t=Jn(e);return ar(t,0),t}function Zt(){var e=[],t=je?256:2048,r=function(c){var u=z(c);return ar(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),Rt(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function re(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=wb[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Ic(r)&&e.push(r)}}function vs(e,t,r){var n=tr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Uf(e,t,r){var n=tr(e);return n.s=vs(n.s,t.s,r),n.e=vs(n.e,t.s,r),n}function _s(e,t){if(e.cRel&&e.c<0)for(e=tr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=tr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=qe(e);return!e.cRel&&e.cRel!=null&&(r=Ry(r)),!e.rRel&&e.rRel!=null&&(r=ky(r)),r}function sl(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$t(e.s.c)+":"+(e.e.cRel?"":"$")+$t(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ft(e.s.r)+":"+(e.e.rRel?"":"$")+Ft(e.e.r):_s(e.s,t.biff)+":"+_s(e.e,t.biff)}function Fc(e){return parseInt(Cy(e),10)-1}function Ft(e){return""+(e+1)}function ky(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Cy(e){return e.replace(/\$(\d+)$/,"$1")}function Pc(e){for(var t=Iy(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function $t(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Ry(e){return e.replace(/^([A-Z])/,"$$$1")}function Iy(e){return e.replace(/^\$([A-Z])/,"$1")}function Fy(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Et(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function qe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function hr(e){var t=e.indexOf(":");return t==-1?{s:Et(e),e:Et(e)}:{s:Et(e.slice(0,t)),e:Et(e.slice(t+1))}}function gt(e,t){return typeof t>"u"||typeof t=="number"?gt(e.s,e.e):(typeof e!="string"&&(e=qe(e)),typeof t!="string"&&(t=qe(t)),e==t?e:e+":"+t)}function tt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function jf(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=bn(e.z,r?er(t):t)}catch{}try{return e.w=bn((e.XF||{}).numFmtId||(r?14:0),r?er(t):t)}catch{return""+t}}function on(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Gs[e.v]||e.v:t==null?jf(e,e.v):jf(e,t))}function Zn(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function _p(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Et(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=tt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var d={v:t[f][h]},g=a+f,p=o+h;if(c.s.r>g&&(c.s.r=g),c.s.c>p&&(c.s.c=p),c.e.r<g&&(c.e.r=g),c.e.c<p&&(c.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))d=t[f][h];else if(Array.isArray(d.v)&&(d.f=t[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||ct[14],n.cellDates?(d.t="d",d.w=bn(d.z,er(d.v))):(d.t="n",d.v=er(d.v),d.w=bn(d.z,d.v))):d.t="s";if(i)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(d.z=s[g][p].z),s[g][p]=d;else{var m=qe({c:p,r:g});s[m]&&s[m].z&&(d.z=s[m].z),s[m]=d}}}return c.s.c<1e7&&(s["!ref"]=gt(c)),s}function $i(e,t){return _p(null,e,t)}function Py(e){return e.read_shift(4,"i")}function Cr(e,t){return t||(t=z(4)),t.write_shift(4,e),t}function Ht(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Tt(e,t){var r=!1;return t==null&&(r=!0,t=z(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Ny(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Dy(e,t){return t||(t=z(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Nc(e,t){var r=e.l,n=e.read_shift(1),i=Ht(e),s=[],a={t:i,h:i};if((n&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(Ny(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function Ly(e,t){var r=!1;return t==null&&(r=!0,t=z(15+4*e.t.length)),t.write_shift(1,0),Tt(e.t,t),r?t.slice(0,t.l):t}var By=Nc;function My(e,t){var r=!1;return t==null&&(r=!0,t=z(23+4*e.t.length)),t.write_shift(1,1),Tt(e.t,t),t.write_shift(4,1),Dy({},t),r?t.slice(0,t.l):t}function _r(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ei(e,t){return t==null&&(t=z(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ti(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ri(e,t){return t==null&&(t=z(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Uy=Ht,xp=Tt;function Dc(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ya(e,t){var r=!1;return t==null&&(r=!0,t=z(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var jy=Ht,Kl=Dc,Lc=Ya;function wp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Ja([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Wn(t,0)>>2;return r?i/100:i}function yp(e,t){t==null&&(t=z(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Ep(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function $y(e,t){return t||(t=z(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ni=Ep,Hi=$y;function Wi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Yn(e,t){return(t||z(8)).write_shift(8,e,"f")}function Hy(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=Yy[i];c&&(t.rgb=Yf(c));break;case 2:t.rgb=Yf([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Qa(e,t){if(t||(t=z(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Wy(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Vy(e,t){t||(t=z(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Tp=2,sr=3,ha=11,Za=19,da=64,Gy=65,Ky=71,zy=4108,qy=4126,kt=80,$f={1:{n:"CodePage",t:Tp},2:{n:"Category",t:kt},3:{n:"PresentationFormat",t:kt},4:{n:"ByteCount",t:sr},5:{n:"LineCount",t:sr},6:{n:"ParagraphCount",t:sr},7:{n:"SlideCount",t:sr},8:{n:"NoteCount",t:sr},9:{n:"HiddenCount",t:sr},10:{n:"MultimediaClipCount",t:sr},11:{n:"ScaleCrop",t:ha},12:{n:"HeadingPairs",t:zy},13:{n:"TitlesOfParts",t:qy},14:{n:"Manager",t:kt},15:{n:"Company",t:kt},16:{n:"LinksUpToDate",t:ha},17:{n:"CharacterCount",t:sr},19:{n:"SharedDoc",t:ha},22:{n:"HyperlinksChanged",t:ha},23:{n:"AppVersion",t:sr,p:"version"},24:{n:"DigSig",t:Gy},26:{n:"ContentType",t:kt},27:{n:"ContentStatus",t:kt},28:{n:"Language",t:kt},29:{n:"Version",t:kt},255:{},2147483648:{n:"Locale",t:Za},2147483651:{n:"Behavior",t:Za},1919054434:{}},Hf={1:{n:"CodePage",t:Tp},2:{n:"Title",t:kt},3:{n:"Subject",t:kt},4:{n:"Author",t:kt},5:{n:"Keywords",t:kt},6:{n:"Comments",t:kt},7:{n:"Template",t:kt},8:{n:"LastAuthor",t:kt},9:{n:"RevNumber",t:kt},10:{n:"EditTime",t:da},11:{n:"LastPrinted",t:da},12:{n:"CreatedDate",t:da},13:{n:"ModifiedDate",t:da},14:{n:"PageCount",t:sr},15:{n:"WordCount",t:sr},16:{n:"CharCount",t:sr},17:{n:"Thumbnail",t:Ky},18:{n:"Application",t:kt},19:{n:"DocSecurity",t:sr},255:{},2147483648:{n:"Locale",t:Za},2147483651:{n:"Behavior",t:Za},1919054434:{}};function Xy(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Jy=Xy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Yy=tr(Jy),Gs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Qy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},pa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Sp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Ap(e,t){var r=ly(Qy),n=[],i;n[n.length]=vt,n[n.length]=fe("Types",null,{xmlns:wt.CT,"xmlns:xsd":wt.xsd,"xmlns:xsi":wt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return fe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=fe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:pa[l][t.bookType]||pa[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=fe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:pa[l][t.bookType]||pa[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=fe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Me={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function bp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Oi(e){var t=[vt,fe("Relationships",null,{xmlns:wt.RELS})];return Pt(e["!id"]).forEach(function(r){t[t.length]=fe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ke(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Me.HLINK,Me.XPATH,Me.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function Zy(e){var t=[vt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Wf(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function e2(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function t2(e){var t=[vt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Wf(e[r][0],e[r][1])),t.push(e2("",e[r][0]));return t.push(Wf("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Op(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Va.version+"</meta:generator></office:meta></office:document-meta>"}var Xn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function al(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=ze(t),n[n.length]=r?fe(e,t,r):It(e,t))}function kp(e,t){var r=t||{},n=[vt,fe("cp:coreProperties",null,{"xmlns:cp":wt.CORE_PROPS,"xmlns:dc":wt.dc,"xmlns:dcterms":wt.dcterms,"xmlns:dcmitype":wt.dcmitype,"xmlns:xsi":wt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&al("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Gl(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&al("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Gl(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Xn.length;++s){var a=Xn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&al(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ki=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Cp=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Rp(e){var t=[],r=fe;return e||(e={}),e.Application="SheetJS",t[t.length]=vt,t[t.length]=fe("Properties",null,{xmlns:wt.EXT_PROPS,"xmlns:vt":wt.vt}),ki.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ze(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ze(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Ip(e){var t=[vt,fe("Properties",null,{xmlns:wt.CUST_PROPS,"xmlns:vt":wt.vt})];if(!e)return t.join("");var r=1;return Pt(e).forEach(function(i){++r,t[t.length]=fe("property",xy(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ze(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Vf={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function r2(e,t){var r=[];return Pt(Vf).map(function(n){for(var i=0;i<Xn.length;++i)if(Xn[i][1]==n)return Xn[i];for(i=0;i<ki.length;++i)if(ki[i][1]==n)return ki[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(It(Vf[n[1]]||n[1],i))}}),fe("DocumentProperties",r.join(""),{xmlns:or.o})}function n2(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Pt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<Xn.length;++a)if(s==Xn[a][1])return;for(a=0;a<ki.length;++a)if(s==ki[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(fe(If(s),o,{"dt:dt":l}))}}),t&&Pt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(fe(If(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+or.o+'">'+i.join("")+"</"+n+">"}function i2(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=z(8);return a.write_shift(4,n),a.write_shift(4,i),a}function Gf(e,t){var r=z(4),n=z(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=z(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=i2(t);break;case 31:case 80:for(n=z(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Rt([r,n])}var Fp=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function s2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Kf(e,t,r){var n=z(8),i=[],s=[],a=8,o=0,l=z(8),c=z(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!t){c=z(8),c.write_shift(4,0),i.unshift(c);var u=[z(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(l=z(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Rt(u),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Fp.indexOf(e[o][0])>-1||Cp.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],d=0;if(t){d=+t[e[o][0]];var g=r[d];if(g.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=Gf(g.t,h)}else{var m=s2(h);m==-1&&(m=31,h=String(h)),l=Gf(m,h)}s.push(l),c=z(8),c.write_shift(4,t?d:2+o),i.push(c),a+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,w),w+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Rt([n].concat(i).concat(s))}function zf(e,t,r,n,i,s){var a=z(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Je.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=Kf(e,r,n);if(o.push(l),i){var c=Kf(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Rt(o)}function a2(e,t){t||(t=z(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function o2(e,t){return e.read_shift(t)===1}function zt(e,t){return t||(t=z(2)),t.write_shift(2,+!!e),t}function Pp(e){return e.read_shift(2,"u")}function gr(e,t){return t||(t=z(2)),t.write_shift(2,e),t}function Np(e,t,r){return r||(r=z(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Dp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function l2(e){var t=e.t||"",r=z(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=z(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Rt(i)}function c2(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function u2(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):c2(e,n,r)}function f2(e,t,r){if(r.biff>5)return u2(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Lp(e,t,r){return r||(r=z(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function qf(e,t){t||(t=z(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function h2(e){var t=z(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),qf(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&qf(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Qn(e,t,r,n){return n||(n=z(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function d2(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function p2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Bp(e,t){return t||(t=z(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Bc(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=z(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function g2(e,t){var r=!t||t.biff==8,n=z(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function m2(e,t){var r=!t||t.biff>=8?2:1,n=z(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function v2(e,t){var r=z(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=l2(e[i]);var s=Rt([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function _2(){var e=z(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function x2(e){var t=z(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function w2(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=z(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function y2(e,t,r,n){var i=z(10);return Qn(e,t,n,i),i.write_shift(4,r),i}function E2(e,t,r,n,i){var s=!i||i.biff==8,a=z(8+ +s+(1+s)*r.length);return Qn(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function T2(e,t,r,n){var i=r&&r.biff==5;n||(n=z(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function S2(e,t){var r=t.biff==8||!t.biff?4:2,n=z(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Xf(e,t,r,n){var i=r&&r.biff==5;n||(n=z(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function A2(e){var t=z(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function b2(e,t,r,n,i,s){var a=z(8);return Qn(e,t,n,a),Np(r,s,a),a}function O2(e,t,r,n){var i=z(14);return Qn(e,t,n,i),Yn(r,i),i}function k2(e,t,r){if(r.biff<8)return C2(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(d2(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function C2(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Dp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function R2(e){var t=z(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Bp(e[r],t);return t}function I2(e){var t=z(24),r=Et(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Rt([t,h2(e[1])])}function F2(e){var t=e[1].Tooltip,r=z(10+2*(t.length+1));r.write_shift(2,2048);var n=Et(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function P2(e){return e||(e=z(4)),e.write_shift(2,1),e.write_shift(2,1),e}function N2(e,t,r){if(!r.cellStyles)return Hr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function D2(e,t){var r=z(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function L2(e){for(var t=z(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function B2(e,t,r){var n=z(15);return zs(n,e,t),n.write_shift(8,r,"f"),n}function M2(e,t,r){var n=z(9);return zs(n,e,t),n.write_shift(2,r),n}var U2=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=bc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Jn(1);switch(l.type){case"base64":u=Ar(an(o));break;case"binary":u=Ar(o);break;case"buffer":case"array":u=o;break}ar(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,m=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(m=u.read_shift(2));var w=u.read_shift(2),T=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(T=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var _=[],O={},V=Math.min(u.length,f==2?521:m-10-(d?264:0)),ee=g?32:11;u.l<V&&u[u.l]!=13;)switch(O={},O.name=Ga.utils.decode(T,u.slice(u.l,u.l+ee)).replace(/[\u0000\r\n].*$/g,""),u.l+=ee,O.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(O.offset=u.read_shift(4)),O.len=u.read_shift(1),f==2&&(O.offset=u.read_shift(2)),O.dec=u.read_shift(1),O.name.length&&_.push(O),f!=2&&(u.l+=g?13:14),O.type){case"B":(!d||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(u[u.l]!==13&&(u.l=m-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=m;var R=0,q=0;for(c[0]=[],q=0;q!=_.length;++q)c[0][q]=_[q].name;for(;p-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++R]=[],q=0,q=0;q!=_.length;++q){var B=u.slice(u.l,u.l+_[q].len);u.l+=_[q].len,ar(B,0);var te=Ga.utils.decode(T,B);switch(_[q].type){case"C":te.trim().length&&(c[R][q]=te.replace(/\s+$/,""));break;case"D":te.length===8?c[R][q]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):c[R][q]=te;break;case"F":c[R][q]=parseFloat(te.trim());break;case"+":case"I":c[R][q]=g?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":c[R][q]=!0;break;case"N":case"F":c[R][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[R][q]="##MEMO##"+(g?parseInt(te.trim(),10):B.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(c[R][q]=+te||0);break;case"@":c[R][q]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":c[R][q]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":c[R][q]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[R][q]=-B.read_shift(-8,"f");break;case"B":if(d&&_[q].len==8){c[R][q]=B.read_shift(8,"f");break}case"G":case"P":B.l+=_[q].len;break;case"0":if(_[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[q].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=$i(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(o,l){try{return Zn(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ks(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Zt(),f=io(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),g=o["!cols"]||[],p=0,m=0,w=0,T=1;for(p=0;p<h.length;++p){if(((g[p]||{}).DBF||{}).name){h[p]=g[p].DBF.name,++w;continue}if(h[p]!=null){if(++w,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(m=0;m<1024;++m)if(h.indexOf(h[p]+"_"+m)==-1){h[p]+="_"+m;break}}}}var _=tt(o["!ref"]),O=[],V=[],ee=[];for(p=0;p<=_.e.c-_.s.c;++p){var R="",q="",B=0,te=[];for(m=0;m<d.length;++m)d[m][p]!=null&&te.push(d[m][p]);if(te.length==0||h[p]==null){O[p]="?";continue}for(m=0;m<te.length;++m){switch(typeof te[m]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=te[m]instanceof Date?"D":"C";break;default:q="C"}B=Math.max(B,String(te[m]).length),R=R&&R!=q?"C":q}B>250&&(B=250),q=((g[p]||{}).DBF||{}).type,q=="C"&&g[p].DBF.len>B&&(B=g[p].DBF.len),R=="B"&&q=="N"&&(R="N",ee[p]=g[p].DBF.dec,B=g[p].DBF.len),V[p]=R=="C"||q=="N"?B:s[R]||0,T+=V[p],O[p]=R}var ne=u.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,d.length),ne.write_shift(2,296+32*w),ne.write_shift(2,T),p=0;p<4;++p)ne.write_shift(4,0);for(ne.write_shift(4,0|(+t[Ud]||3)<<8),p=0,m=0;p<h.length;++p)if(h[p]!=null){var se=u.next(32),de=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);se.write_shift(1,de,"sbcs"),se.write_shift(1,O[p]=="?"?"C":O[p],"sbcs"),se.write_shift(4,m),se.write_shift(1,V[p]||s[O[p]]||0),se.write_shift(1,ee[p]||0),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(1,0),se.write_shift(4,0),se.write_shift(4,0),m+=V[p]||s[O[p]]||0}var Be=u.next(264);for(Be.write_shift(4,13),p=0;p<65;++p)Be.write_shift(4,0);for(p=0;p<d.length;++p){var ke=u.next(T);for(ke.write_shift(1,0),m=0;m<h.length;++m)if(h[m]!=null)switch(O[m]){case"L":ke.write_shift(1,d[p][m]==null?63:d[p][m]?84:70);break;case"B":ke.write_shift(8,d[p][m]||0,"f");break;case"N":var Le="0";for(typeof d[p][m]=="number"&&(Le=d[p][m].toFixed(ee[m]||0)),w=0;w<V[m]-Le.length;++w)ke.write_shift(1,32);ke.write_shift(1,Le,"sbcs");break;case"D":d[p][m]?(ke.write_shift(4,("0000"+d[p][m].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(d[p][m].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+d[p][m].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(d[p][m]!=null?d[p][m]:"").slice(0,V[m]);for(ke.write_shift(1,Ae,"sbcs"),w=0;w<V[m]-Ae.length;++w)ke.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}})(),j2=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Pt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var g=e[d];return typeof g=="number"?xf(g):g},n=function(h,d,g){var p=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?h:xf(p)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return s(an(h),d);case"binary":return s(h,d);case"buffer":return s(je&&Buffer.isBuffer(h)?h.toString("binary"):Hs(h),d);case"array":return s(Co(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var g=h.split(/[\n\r]+/),p=-1,m=-1,w=0,T=0,_=[],O=[],V=null,ee={},R=[],q=[],B=[],te=0,ne;for(+d.codepage>=0&&ks(+d.codepage);w!==g.length;++w){te=0;var se=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),de=se.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),Be=de[0],ke;if(se.length>0)switch(Be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":de[1].charAt(0)=="P"&&O.push(se.slice(3).replace(/;;/g,";"));break;case"C":var Le=!1,Ae=!1,Fe=!1,Xe=!1,ut=-1,rt=-1;for(T=1;T<de.length;++T)switch(de[T].charAt(0)){case"A":break;case"X":m=parseInt(de[T].slice(1))-1,Ae=!0;break;case"Y":for(p=parseInt(de[T].slice(1))-1,Ae||(m=0),ne=_.length;ne<=p;++ne)_[ne]=[];break;case"K":ke=de[T].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(en(ke))?isNaN(Rs(ke).getDate())||(ke=Xt(ke)):(ke=en(ke),V!==null&&Yd(V)&&(ke=tp(ke))),Le=!0;break;case"E":Xe=!0;var C=ME(de[T].slice(1),{r:p,c:m});_[p][m]=[_[p][m],C];break;case"S":Fe=!0,_[p][m]=[_[p][m],"S5S"];break;case"G":break;case"R":ut=parseInt(de[T].slice(1))-1;break;case"C":rt=parseInt(de[T].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+se)}if(Le&&(_[p][m]&&_[p][m].length==2?_[p][m][0]=ke:_[p][m]=ke,V=null),Fe){if(Xe)throw new Error("SYLK shared formula cannot have own formula");var H=ut>-1&&_[ut][rt];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");_[p][m][1]=UE(H[1],{r:p-ut,c:m-rt})}break;case"F":var P=0;for(T=1;T<de.length;++T)switch(de[T].charAt(0)){case"X":m=parseInt(de[T].slice(1))-1,++P;break;case"Y":for(p=parseInt(de[T].slice(1))-1,ne=_.length;ne<=p;++ne)_[ne]=[];break;case"M":te=parseInt(de[T].slice(1))/20;break;case"F":break;case"G":break;case"P":V=O[parseInt(de[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=de[T].slice(1).split(" "),ne=parseInt(B[0],10);ne<=parseInt(B[1],10);++ne)te=parseInt(B[2],10),q[ne-1]=te===0?{hidden:!0}:{wch:te},Mc(q[ne-1]);break;case"C":m=parseInt(de[T].slice(1))-1,q[m]||(q[m]={});break;case"R":p=parseInt(de[T].slice(1))-1,R[p]||(R[p]={}),te>0?(R[p].hpt=te,R[p].hpx=Hp(te)):te===0&&(R[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+se)}P<1&&(V=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+se)}}return R.length>0&&(ee["!rows"]=R),q.length>0&&(ee["!cols"]=q),d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),[_,ee]}function a(h,d){var g=i(h,d),p=g[0],m=g[1],w=$i(p,d);return Pt(m).forEach(function(T){w[T]=m[T]}),w}function o(h,d){return Zn(a(h,d),d)}function l(h,d,g,p){var m="C;Y"+(g+1)+";X"+(p+1)+";K";switch(h.t){case"n":m+=h.v||0,h.f&&!h.F&&(m+=";E"+jc(h.f,{r:g,c:p}));break;case"b":m+=h.v?"TRUE":"FALSE";break;case"e":m+=h.w||h.v;break;case"d":m+='"'+(h.w||h.v)+'"';break;case"s":m+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(h,d){d.forEach(function(g,p){var m="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=eo(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=to(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&h.push(m)})}function u(h,d){d.forEach(function(g,p){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*ro(g.hpx)+";"),m.length>2&&h.push(m+"R"+(p+1))})}function f(h,d){var g=["ID;PWXL;N;E"],p=[],m=tt(h["!ref"]),w,T=Array.isArray(h),_=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&c(g,h["!cols"]),h["!rows"]&&u(g,h["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var O=m.s.r;O<=m.e.r;++O)for(var V=m.s.c;V<=m.e.c;++V){var ee=qe({r:O,c:V});w=T?(h[O]||[])[V]:h[ee],!(!w||w.v==null&&(!w.f||w.F))&&p.push(l(w,h,O,V))}return g.join(_)+_+p.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),$2=(function(){function e(s,a){switch(a.type){case"base64":return t(an(s),a);case"binary":return t(s,a);case"buffer":return t(je&&Buffer.isBuffer(s)?s.toString("binary"):Hs(s),a);case"array":return t(Co(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),d=h[0],g=h[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+d){case-1:if(p==="BOT"){f[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][c]=!0:p==="FALSE"?f[l][c]=!1:isNaN(en(g))?isNaN(Rs(g).getDate())?f[l][c]=g:f[l][c]=Xt(g):f[l][c]=en(g),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return $i(e(s,a),a)}function n(s,a){return Zn(r(s,a),a)}var i=(function(){var s=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=tt(l["!ref"]),f,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=qe({r:d,c:g});if(f=h?(l[d]||[])[g]:l[p],!f){a(c,1,0,"");continue}switch(f.t){case"n":var m=f.w;!m&&f.v!=null&&(m=f.v),m==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,m,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=bn(f.z||ct[14],er(Xt(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var w=`\r
`,T=c.join(w);return T}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),Mp=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var d=f.split(`
`),g=-1,p=-1,m=0,w=[];m!==d.length;++m){var T=d[m].trim().split(":");if(T[0]==="cell"){var _=Et(T[1]);if(w.length<=_.r)for(g=w.length;g<=_.r;++g)w[g]||(w[g]=[]);switch(g=_.r,p=_.c,T[2]){case"t":w[g][p]=e(T[3]);break;case"v":w[g][p]=+T[3];break;case"vtf":var O=T[T.length-1];case"vtc":switch(T[3]){case"nl":w[g][p]=!!+T[4];break;default:w[g][p]=+T[4];break}T[2]=="vtf"&&(w[g][p]=[w[g][p],O])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function n(f,h){return $i(r(f,h),h)}function i(f,h){return Zn(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],g,p="",m=hr(f["!ref"]),w=Array.isArray(f),T=m.s.r;T<=m.e.r;++T)for(var _=m.s.c;_<=m.e.c;++_)if(p=qe({r:T,c:_}),g=w?(f[T]||[])[_]:f[p],!(!g||g.v==null||g.t==="z")){switch(d=["cell",p,"t"],g.t){case"s":case"str":d.push(t(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=t(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var O=er(Xt(g.v));d[2]="vtc",d[3]="nd",d[4]=""+O,d[5]=g.w||bn(g.z||ct[14],O);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}})(),H2=(function(){function e(u,f,h,d,g){g.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(en(u))?isNaN(Rs(u).getDate())?f[h][d]=u:f[h][d]=Xt(u):f[h][d]=en(u))}function t(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var m=10,w=0,T=0;T<=p;++T)w=g[T].indexOf(" "),w==-1?w=g[T].length:w++,m=Math.max(m,w);for(T=0;T<=p;++T){d[T]=[];var _=0;for(e(g[T].slice(0,m).trim(),d,T,_,h),_=1;_<=(g[T].length-m)/10+1;++_)e(g[T].slice(m+(_-1)*10,m+_*10).trim(),d,T,_,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,g=0;d<u.length;++d)(g=u.charCodeAt(d))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&g.push([f[d],d]);if(!g.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&g.push([f[d],d])}return g.sort(function(p,m){return p[0]-m[0]||n[p[1]]-n[m[1]]}),r[g.pop()[1]]||44}function s(u,f){var h=f||{},d="",g=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var m=0,w=0,T=0,_=0,O=0,V=d.charCodeAt(0),ee=!1,R=0,q=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var B=h.dateNF!=null?iy(h.dateNF):null;function te(){var ne=u.slice(_,O),se={};if(ne.charAt(0)=='"'&&ne.charAt(ne.length-1)=='"'&&(ne=ne.slice(1,-1).replace(/""/g,'"')),ne.length===0)se.t="z";else if(h.raw)se.t="s",se.v=ne;else if(ne.trim().length===0)se.t="s",se.v=ne;else if(ne.charCodeAt(0)==61)ne.charCodeAt(1)==34&&ne.charCodeAt(ne.length-1)==34?(se.t="s",se.v=ne.slice(2,-1).replace(/""/g,'"')):jE(ne)?(se.t="n",se.f=ne.slice(1)):(se.t="s",se.v=ne);else if(ne=="TRUE")se.t="b",se.v=!0;else if(ne=="FALSE")se.t="b",se.v=!1;else if(!isNaN(T=en(ne)))se.t="n",h.cellText!==!1&&(se.w=ne),se.v=T;else if(!isNaN(Rs(ne).getDate())||B&&ne.match(B)){se.z=h.dateNF||ct[14];var de=0;B&&ne.match(B)&&(ne=sy(ne,h.dateNF,ne.match(B)||[]),de=1),h.cellDates?(se.t="d",se.v=Xt(ne,de)):(se.t="n",se.v=er(Xt(ne,de))),h.cellText!==!1&&(se.w=bn(se.z,se.v instanceof Date?er(se.v):se.v)),h.cellNF||delete se.z}else se.t="s",se.v=ne;if(se.t=="z"||(h.dense?(g[m]||(g[m]=[]),g[m][w]=se):g[qe({c:w,r:m})]=se),_=O+1,q=u.charCodeAt(_),p.e.c<w&&(p.e.c=w),p.e.r<m&&(p.e.r=m),R==V)++w;else if(w=0,++m,h.sheetRows&&h.sheetRows<=m)return!0}e:for(;O<u.length;++O)switch(R=u.charCodeAt(O)){case 34:q===34&&(ee=!ee);break;case V:case 10:case 13:if(!ee&&te())break e;break}return O-_>0&&te(),g["!ref"]=gt(p),g}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):$i(t(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:e4(u,f);switch(f.type){case"base64":h=an(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Ga<"u"||(h=je&&Buffer.isBuffer(u)?u.toString("binary"):Hs(u));break;case"array":h=Co(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=gs(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=gs(h):f.type=="binary"&&typeof Ga<"u",h.slice(0,19)=="socialcalc:version:"?Mp.to_sheet(f.type=="string"?h:gs(h),f):a(h,f)}function l(u,f){return Zn(o(u,f),f)}function c(u){for(var f=[],h=tt(u["!ref"]),d,g=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var m=[],w=h.s.c;w<=h.e.c;++w){var T=qe({r:p,c:w});if(d=g?(u[p]||[])[w]:u[T],!d||d.v==null){m.push("          ");continue}for(var _=(d.w||(on(d),d.w)||"").slice(0,10);_.length<10;)_+=" ";m.push(_+(w===0?" ":""))}f.push(m.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),Jf=(function(){function e(C,H,P){if(C){ar(C,C.l||0);for(var F=P.Enum||ut;C.l<C.length;){var Z=C.read_shift(2),D=F[Z]||F[65535],Q=C.read_shift(2),G=C.l+Q,X=D.f&&D.f(C,Q,P);if(C.l=G,H(X,D,Z))return}}}function t(C,H){switch(H.type){case"base64":return r(Ar(an(C)),H);case"binary":return r(Ar(C),H);case"buffer":case"array":return r(C,H)}throw"Unsupported type "+H.type}function r(C,H){if(!C)return C;var P=H||{},F=P.dense?[]:{},Z="Sheet1",D="",Q=0,G={},X=[],ye=[],E={s:{r:0,c:0},e:{r:0,c:0}},k=P.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)P.Enum=ut,e(C,function(N,ue,le){switch(le){case 0:P.vers=N,N>=4096&&(P.qpro=!0);break;case 6:E=N;break;case 204:N&&(D=N);break;case 222:D=N;break;case 15:case 51:P.qpro||(N[1].v=N[1].v.slice(1));case 13:case 14:case 16:le==14&&(N[2]&112)==112&&(N[2]&15)>1&&(N[2]&15)<15&&(N[1].z=P.dateNF||ct[14],P.cellDates&&(N[1].t="d",N[1].v=tp(N[1].v))),P.qpro&&N[3]>Q&&(F["!ref"]=gt(E),G[Z]=F,X.push(Z),F=P.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},Q=N[3],Z=D||"Sheet"+(Q+1),D="");var oe=P.dense?(F[N[0].r]||[])[N[0].c]:F[qe(N[0])];if(oe){oe.t=N[1].t,oe.v=N[1].v,N[1].z!=null&&(oe.z=N[1].z),N[1].f!=null&&(oe.f=N[1].f);break}P.dense?(F[N[0].r]||(F[N[0].r]=[]),F[N[0].r][N[0].c]=N[1]):F[qe(N[0])]=N[1];break}},P);else if(C[2]==26||C[2]==14)P.Enum=rt,C[2]==14&&(P.qpro=!0,C.l=0),e(C,function(N,ue,le){switch(le){case 204:Z=N;break;case 22:N[1].v=N[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(N[3]>Q&&(F["!ref"]=gt(E),G[Z]=F,X.push(Z),F=P.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},Q=N[3],Z="Sheet"+(Q+1)),k>0&&N[0].r>=k)break;P.dense?(F[N[0].r]||(F[N[0].r]=[]),F[N[0].r][N[0].c]=N[1]):F[qe(N[0])]=N[1],E.e.c<N[0].c&&(E.e.c=N[0].c),E.e.r<N[0].r&&(E.e.r=N[0].r);break;case 27:N[14e3]&&(ye[N[14e3][0]]=N[14e3][1]);break;case 1537:ye[N[0]]=N[1],N[0]==Q&&(Z=N[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(F["!ref"]=gt(E),G[D||Z]=F,X.push(D||Z),!ye.length)return{SheetNames:X,Sheets:G};for(var I={},J=[],K=0;K<ye.length;++K)G[X[K]]?(J.push(ye[K]||X[K]),I[ye[K]]=G[ye[K]]||G[X[K]]):(J.push(ye[K]),I[ye[K]]={"!ref":"A1"});return{SheetNames:J,Sheets:I}}function n(C,H){var P=H||{};if(+P.codepage>=0&&ks(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var F=Zt(),Z=tt(C["!ref"]),D=Array.isArray(C),Q=[];he(F,0,s(1030)),he(F,6,l(Z));for(var G=Math.min(Z.e.r,8191),X=Z.s.r;X<=G;++X)for(var ye=Ft(X),E=Z.s.c;E<=Z.e.c;++E){X===Z.s.r&&(Q[E]=$t(E));var k=Q[E]+ye,I=D?(C[X]||[])[E]:C[k];if(!(!I||I.t=="z"))if(I.t=="n")(I.v|0)==I.v&&I.v>=-32768&&I.v<=32767?he(F,13,d(X,E,I.v)):he(F,14,p(X,E,I.v));else{var J=on(I);he(F,15,f(X,E,J.slice(0,239)))}}return he(F,1),F.end()}function i(C,H){var P=H||{};if(+P.codepage>=0&&ks(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var F=Zt();he(F,0,a(C));for(var Z=0,D=0;Z<C.SheetNames.length;++Z)(C.Sheets[C.SheetNames[Z]]||{})["!ref"]&&he(F,27,Xe(C.SheetNames[Z],D++));var Q=0;for(Z=0;Z<C.SheetNames.length;++Z){var G=C.Sheets[C.SheetNames[Z]];if(!(!G||!G["!ref"])){for(var X=tt(G["!ref"]),ye=Array.isArray(G),E=[],k=Math.min(X.e.r,8191),I=X.s.r;I<=k;++I)for(var J=Ft(I),K=X.s.c;K<=X.e.c;++K){I===X.s.r&&(E[K]=$t(K));var N=E[K]+J,ue=ye?(G[I]||[])[K]:G[N];if(!(!ue||ue.t=="z"))if(ue.t=="n")he(F,23,te(I,K,Q,ue.v));else{var le=on(ue);he(F,22,R(I,K,Q,le.slice(0,239)))}}++Q}}return he(F,1),F.end()}function s(C){var H=z(2);return H.write_shift(2,C),H}function a(C){var H=z(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var P=0,F=0,Z=0,D=0;D<C.SheetNames.length;++D){var Q=C.SheetNames[D],G=C.Sheets[Q];if(!(!G||!G["!ref"])){++Z;var X=hr(G["!ref"]);P<X.e.r&&(P=X.e.r),F<X.e.c&&(F=X.e.c)}}return P>8191&&(P=8191),H.write_shift(2,P),H.write_shift(1,Z),H.write_shift(1,F),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(C,H,P){var F={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&P.qpro?(F.s.c=C.read_shift(1),C.l++,F.s.r=C.read_shift(2),F.e.c=C.read_shift(1),C.l++,F.e.r=C.read_shift(2),F):(F.s.c=C.read_shift(2),F.s.r=C.read_shift(2),H==12&&P.qpro&&(C.l+=2),F.e.c=C.read_shift(2),F.e.r=C.read_shift(2),H==12&&P.qpro&&(C.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function l(C){var H=z(8);return H.write_shift(2,C.s.c),H.write_shift(2,C.s.r),H.write_shift(2,C.e.c),H.write_shift(2,C.e.r),H}function c(C,H,P){var F=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(F[0].c=C.read_shift(1),F[3]=C.read_shift(1),F[0].r=C.read_shift(2),C.l+=2):(F[2]=C.read_shift(1),F[0].c=C.read_shift(2),F[0].r=C.read_shift(2)),F}function u(C,H,P){var F=C.l+H,Z=c(C,H,P);if(Z[1].t="s",P.vers==20768){C.l++;var D=C.read_shift(1);return Z[1].v=C.read_shift(D,"utf8"),Z}return P.qpro&&C.l++,Z[1].v=C.read_shift(F-C.l,"cstr"),Z}function f(C,H,P){var F=z(7+P.length);F.write_shift(1,255),F.write_shift(2,H),F.write_shift(2,C),F.write_shift(1,39);for(var Z=0;Z<F.length;++Z){var D=P.charCodeAt(Z);F.write_shift(1,D>=128?95:D)}return F.write_shift(1,0),F}function h(C,H,P){var F=c(C,H,P);return F[1].v=C.read_shift(2,"i"),F}function d(C,H,P){var F=z(7);return F.write_shift(1,255),F.write_shift(2,H),F.write_shift(2,C),F.write_shift(2,P,"i"),F}function g(C,H,P){var F=c(C,H,P);return F[1].v=C.read_shift(8,"f"),F}function p(C,H,P){var F=z(13);return F.write_shift(1,255),F.write_shift(2,H),F.write_shift(2,C),F.write_shift(8,P,"f"),F}function m(C,H,P){var F=C.l+H,Z=c(C,H,P);if(Z[1].v=C.read_shift(8,"f"),P.qpro)C.l=F;else{var D=C.read_shift(2);O(C.slice(C.l,C.l+D),Z),C.l+=D}return Z}function w(C,H,P){var F=H&32768;return H&=-32769,H=(F?C:0)+(H>=8192?H-16384:H),(F?"":"$")+(P?$t(H):Ft(H))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(C,H){ar(C,0);for(var P=[],F=0,Z="",D="",Q="",G="";C.l<C.length;){var X=C[C.l++];switch(X){case 0:P.push(C.read_shift(8,"f"));break;case 1:D=w(H[0].c,C.read_shift(2),!0),Z=w(H[0].r,C.read_shift(2),!1),P.push(D+Z);break;case 2:{var ye=w(H[0].c,C.read_shift(2),!0),E=w(H[0].r,C.read_shift(2),!1);D=w(H[0].c,C.read_shift(2),!0),Z=w(H[0].r,C.read_shift(2),!1),P.push(ye+E+":"+D+Z)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(C.read_shift(2));break;case 6:{for(var k="";X=C[C.l++];)k+=String.fromCharCode(X);P.push('"'+k.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:G=P.pop(),Q=P.pop(),P.push(["AND","OR"][X-20]+"("+Q+","+G+")");break;default:if(X<32&&_[X])G=P.pop(),Q=P.pop(),P.push(Q+_[X]+G);else if(T[X]){if(F=T[X][1],F==69&&(F=C[C.l++]),F>P.length){console.error("WK1 bad formula parse 0x"+X.toString(16)+":|"+P.join("|")+"|");return}var I=P.slice(-F);P.length-=F,P.push(T[X][0]+"("+I.join(",")+")")}else return X<=7?console.error("WK1 invalid opcode "+X.toString(16)):X<=24?console.error("WK1 unsupported op "+X.toString(16)):X<=30?console.error("WK1 invalid opcode "+X.toString(16)):X<=115?console.error("WK1 unsupported function opcode "+X.toString(16)):console.error("WK1 unrecognized opcode "+X.toString(16))}}P.length==1?H[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function V(C){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=C.read_shift(2),H[3]=C[C.l++],H[0].c=C[C.l++],H}function ee(C,H){var P=V(C);return P[1].t="s",P[1].v=C.read_shift(H-4,"cstr"),P}function R(C,H,P,F){var Z=z(6+F.length);Z.write_shift(2,C),Z.write_shift(1,P),Z.write_shift(1,H),Z.write_shift(1,39);for(var D=0;D<F.length;++D){var Q=F.charCodeAt(D);Z.write_shift(1,Q>=128?95:Q)}return Z.write_shift(1,0),Z}function q(C,H){var P=V(C);P[1].v=C.read_shift(2);var F=P[1].v>>1;if(P[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return P[1].v=F,P}function B(C,H){var P=V(C),F=C.read_shift(4),Z=C.read_shift(4),D=C.read_shift(2);if(D==65535)return F===0&&Z===3221225472?(P[1].t="e",P[1].v=15):F===0&&Z===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var Q=D&32768;return D=(D&32767)-16446,P[1].v=(1-Q*2)*(Z*Math.pow(2,D+32)+F*Math.pow(2,D)),P}function te(C,H,P,F){var Z=z(14);if(Z.write_shift(2,C),Z.write_shift(1,P),Z.write_shift(1,H),F==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var D=0,Q=0,G=0,X=0;return F<0&&(D=1,F=-F),Q=Math.log2(F)|0,F/=Math.pow(2,Q-31),X=F>>>0,(X&2147483648)==0&&(F/=2,++Q,X=F>>>0),F-=X,X|=2147483648,X>>>=0,F*=Math.pow(2,32),G=F>>>0,Z.write_shift(4,G),Z.write_shift(4,X),Q+=16383+(D?32768:0),Z.write_shift(2,Q),Z}function ne(C,H){var P=B(C);return C.l+=H-14,P}function se(C,H){var P=V(C),F=C.read_shift(4);return P[1].v=F>>6,P}function de(C,H){var P=V(C),F=C.read_shift(8,"f");return P[1].v=F,P}function Be(C,H){var P=de(C);return C.l+=H-10,P}function ke(C,H){return C[C.l+H-1]==0?C.read_shift(H,"cstr"):""}function Le(C,H){var P=C[C.l++];P>H-1&&(P=H-1);for(var F="";F.length<P;)F+=String.fromCharCode(C[C.l++]);return F}function Ae(C,H,P){if(!(!P.qpro||H<21)){var F=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var Z=C.read_shift(H-21,"cstr");return[F,Z]}}function Fe(C,H){for(var P={},F=C.l+H;C.l<F;){var Z=C.read_shift(2);if(Z==14e3){for(P[Z]=[0,""],P[Z][0]=C.read_shift(2);C[C.l];)P[Z][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return P}function Xe(C,H){var P=z(5+C.length);P.write_shift(2,14e3),P.write_shift(2,H);for(var F=0;F<C.length;++F){var Z=C.charCodeAt(F);P[P.l++]=Z>127?95:Z}return P[P.l++]=0,P}var ut={0:{n:"BOF",f:Pp},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:Le},65535:{n:""}},rt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ee},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:se},38:{n:"??"},39:{n:"NUMBER27",f:de},40:{n:"FORMULA28",f:Be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}})(),W2=/^\s|\s$|[\t\n\r]/;function Up(e,t){if(!t.bookSST)return"";var r=[vt];r[r.length]=fe("sst",null,{xmlns:ji[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(W2)&&(s+=' xml:space="preserve"'),s+=">"+ze(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function V2(e){return[e.read_shift(4),e.read_shift(4)]}function G2(e,t){return t||(t=z(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var K2=Ly;function z2(e){var t=Zt();re(t,159,G2(e));for(var r=0;r<e.length;++r)re(t,19,K2(e[r]));return re(t,160),t.end()}function q2(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function jp(e){var t=0,r,n=q2(e),i=n.length+1,s,a,o,l,c;for(r=Jn(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=(t&16384)===0?0:1,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var X2=(function(){function e(i,s){switch(s.type){case"base64":return t(an(i),s);case"binary":return t(i,s);case"buffer":return t(je&&Buffer.isBuffer(i)?i.toString("binary"):Hs(i),s);case"array":return t(Co(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,g,p=-1;g=h.exec(u);){switch(g[0]){case"\\cell":var m=u.slice(d,h.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++p,m.length){var w={v:m,t:"s"};Array.isArray(o)?o[f][p]=w:o[qe({r:f,c:p})]=w}break}d=h.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=gt(c),o}function r(i,s){return Zn(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=tt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=qe({r:c,c:u});o=l?(i[c]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(on(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Yf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var J2=6,tn=J2;function eo(e){return Math.floor((e+Math.round(128/tn)/256)*tn)}function to(e){return Math.floor((e-5)/tn*100+.5)/100}function zl(e){return Math.round((e*tn+5)/tn*256)/256}function Mc(e){e.width?(e.wpx=eo(e.width),e.wch=to(e.wpx),e.MDW=tn):e.wpx?(e.wch=to(e.wpx),e.width=zl(e.wch),e.MDW=tn):typeof e.wch=="number"&&(e.width=zl(e.wch),e.wpx=eo(e.width),e.MDW=tn),e.customWidth&&delete e.customWidth}var Y2=96,$p=Y2;function ro(e){return e*96/$p}function Hp(e){return e*$p/96}function Q2(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=fe("numFmt",null,{numFmtId:n,formatCode:ze(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=fe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Z2(e){var t=[];return t[t.length]=fe("cellXfs",null),e.forEach(function(r){t[t.length]=fe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=fe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Wp(e,t){var r=[vt,fe("styleSheet",null,{xmlns:ji[0],"xmlns:vt":wt.vt})],n;return e.SSF&&(n=Q2(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Z2(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function eE(e,t){var r=e.read_shift(2),n=Ht(e);return[r,n]}function tE(e,t,r){r||(r=z(6+4*t.length)),r.write_shift(2,e),Tt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function rE(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Wy(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Hy(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ht(e),n}function nE(e,t){t||(t=z(153)),t.write_shift(2,e.sz*20),Vy(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Qa(e.color,t);var n=0;return n=2,t.write_shift(1,n),Tt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var iE=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ol,sE=Hr;function Qf(e,t){t||(t=z(84)),ol||(ol=bc(iE));var r=ol[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Qa({auto:1},t),Qa({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function aE(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function Vp(e,t,r){r||(r=z(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function es(e,t){return t||(t=z(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var oE=Hr;function lE(e,t){return t||(t=z(51)),t.write_shift(1,0),es(null,t),es(null,t),es(null,t),es(null,t),es(null,t),t.length>t.l?t.slice(0,t.l):t}function cE(e,t){return t||(t=z(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ya(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function uE(e,t,r){var n=z(2052);return n.write_shift(4,e),Ya(t,n),Ya(r,n),n.length>n.l?n.slice(0,n.l):n}function fE(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(re(e,615,Cr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&re(e,44,tE(i,t[i]))}),re(e,616))}}function hE(e){var t=1;re(e,611,Cr(t)),re(e,43,nE({sz:12,color:{theme:1},name:"Calibri",family:2})),re(e,612)}function dE(e){var t=2;re(e,603,Cr(t)),re(e,45,Qf({patternType:"none"})),re(e,45,Qf({patternType:"gray125"})),re(e,604)}function pE(e){var t=1;re(e,613,Cr(t)),re(e,46,lE()),re(e,614)}function gE(e){var t=1;re(e,626,Cr(t)),re(e,47,Vp({numFmtId:0},65535)),re(e,627)}function mE(e,t){re(e,617,Cr(t.length)),t.forEach(function(r){re(e,47,Vp(r,0))}),re(e,618)}function vE(e){var t=1;re(e,619,Cr(t)),re(e,48,cE({xfId:0,name:"Normal"})),re(e,620)}function _E(e){var t=0;re(e,505,Cr(t)),re(e,506)}function xE(e){var t=0;re(e,508,uE(t,"TableStyleMedium9","PivotStyleMedium4")),re(e,509)}function wE(e,t){var r=Zt();return re(r,278),fE(r,e.SSF),hE(r),dE(r),pE(r),gE(r),mE(r,t.cellXfs),vE(r),_E(r),xE(r),re(r,279),r.end()}function Gp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[vt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yE(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ht(e)}}function EE(e){var t=z(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Tt(e.name,t),t.slice(0,t.l)}function TE(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function SE(e){var t=z(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function AE(e,t){var r=z(8+2*t.length);return r.write_shift(4,e),Tt(t,r),r.slice(0,r.l)}function bE(e){return e.l+=4,e.read_shift(4)!=0}function OE(e,t){var r=z(8);return r.write_shift(4,e),r.write_shift(4,1),r}function kE(){var e=Zt();return re(e,332),re(e,334,Cr(1)),re(e,335,EE({name:"XLDAPR",version:12e4,flags:3496657072})),re(e,336),re(e,339,AE(1,"XLDAPR")),re(e,52),re(e,35,Cr(514)),re(e,4096,Cr(0)),re(e,4097,gr(1)),re(e,36),re(e,53),re(e,340),re(e,337,OE(1)),re(e,51,SE([[1,0]])),re(e,338),re(e,333),e.end()}function Kp(){var e=[vt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function CE(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=qe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var vi=1024;function zp(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[fe("xml",null,{"xmlns:v":or.v,"xmlns:o":or.o,"xmlns:x":or.x,"xmlns:mv":or.mv}).replace(/\/>/,">"),fe("o:shapelayout",fe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),fe("v:shapetype",[fe("v:stroke",null,{joinstyle:"miter"}),fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];vi<e*1e3;)vi+=1e3;return t.forEach(function(s){var a=Et(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=fe("v:fill",l,o),u={on:"t",obscured:"t"};++vi,i=i.concat(["<v:shape"+Fs({id:"_x0000_s"+vi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,fe("v:shadow",null,u),fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",It("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),It("x:AutoFill","False"),It("x:Row",String(a.r)),It("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function qp(e){var t=[vt,fe("comments",null,{xmlns:ji[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=ze(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(ze(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(It("t",ze(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(It("t",ze(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function RE(e,t,r){var n=[vt,fe("ThreadedComments",null,{xmlns:wt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(fe("threadedComment",It("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function IE(e){var t=[vt,fe("personList",null,{xmlns:wt.TCMNT,"xmlns:x":ji[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(fe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function FE(e){var t={};t.iauthor=e.read_shift(4);var r=ni(e);return t.rfx=r.s,t.ref=qe(r.s),e.l+=16,t}function PE(e,t){return t==null&&(t=z(36)),t.write_shift(4,e[1].iauthor),Hi(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var NE=Ht;function DE(e){return Tt(e.slice(0,54))}function LE(e){var t=Zt(),r=[];return re(t,628),re(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),re(t,632,DE(i.a)))})}),re(t,631),re(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Et(n[0]),e:Et(n[0])};re(t,635,PE([s,i])),i.t&&i.t.length>0&&re(t,637,My(i)),re(t,636),delete i.iauthor})}),re(t,634),re(t,629),t.end()}function BE(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Je.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var Xp=["xlsb","xlsm","xlam","biff8","xla"],ME=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+$t(u)+(l?"":"$")+Ft(c)}return function(i,s){return t=s,i.replace(e,r)}})(),Uc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,jc=(function(){return function(t,r){return t.replace(Uc,function(n,i,s,a,o,l){var c=Pc(a)-(s?0:r.c),u=Fc(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+h})}})();function UE(e,t){return e.replace(Uc,function(r,n,i,s,a,o){return n+(i=="$"?i+s:$t(Pc(s)+t.c))+(a=="$"?a+o:Ft(Fc(o)+t.r))})}function jE(e){return e.length!=1}function ht(e){e.l+=1}function On(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Jp(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Yp(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=On(e),o=On(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Yp(e){var t=On(e),r=On(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function $E(e,t,r){if(r.biff<8)return Yp(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=On(e),a=On(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Qp(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return HE(e);var n=e.read_shift(r&&r.biff==12?4:2),i=On(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function HE(e){var t=On(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function WE(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function VE(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return GE(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function GE(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function KE(e,t,r){var n=(e[e.l++]&96)>>5,i=Jp(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function zE(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=Jp(e,s,r);return[n,i,a]}function qE(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function XE(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function JE(e,t,r){var n=(e[e.l++]&96)>>5,i=$E(e,t-1,r);return[n,i]}function YE(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Zf(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function QE(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function ZE(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function eT(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function tT(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function rT(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Zp(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function nT(e){return e.read_shift(2),Zp(e)}function iT(e){return e.read_shift(2),Zp(e)}function sT(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Qp(e,0,r);return[n,i]}function aT(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=VE(e,0,r);return[n,i]}function oT(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Qp(e,0,r);return[n,i,s]}function lT(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[lS[i],r1[i],n]}function cT(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:uT(e);return[i,(s[0]===0?r1:oS)[s[1]]]}function uT(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function fT(e,t,r){e.l+=r&&r.biff==2?3:4}function hT(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function dT(e){return e.l++,Gs[e.read_shift(1)]}function pT(e){return e.l++,e.read_shift(2)}function gT(e){return e.l++,e.read_shift(1)!==0}function mT(e){return e.l++,Wi(e)}function vT(e,t,r){return e.l++,Dp(e,t-1,r)}function _T(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=o2(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Gs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wi(e);break;case 2:r[1]=f2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function xT(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ni:p2)(e));return i}function wT(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=_T(e,r.biff);return a}function yT(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function ET(e,t,r){if(r.biff==5)return TT(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function TT(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function ST(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function AT(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function bT(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function OT(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var kT=Hr,CT=Hr,RT=Hr;function Ks(e,t,r){return e.l+=2,[WE(e)]}function $c(e){return e.l+=6,[]}var IT=Ks,FT=$c,PT=$c,NT=Ks;function e1(e){return e.l+=2,[Pp(e),e.read_shift(2)&1]}var DT=Ks,LT=e1,BT=$c,MT=Ks,UT=Ks,jT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $T(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=jT[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function HT(e){return e.l+=2,[e.read_shift(4)]}function WT(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function VT(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function GT(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function KT(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function zT(e){return e.l+=4,[0,0]}var e0={1:{n:"PtgExp",f:hT},2:{n:"PtgTbl",f:RT},3:{n:"PtgAdd",f:ht},4:{n:"PtgSub",f:ht},5:{n:"PtgMul",f:ht},6:{n:"PtgDiv",f:ht},7:{n:"PtgPower",f:ht},8:{n:"PtgConcat",f:ht},9:{n:"PtgLt",f:ht},10:{n:"PtgLe",f:ht},11:{n:"PtgEq",f:ht},12:{n:"PtgGe",f:ht},13:{n:"PtgGt",f:ht},14:{n:"PtgNe",f:ht},15:{n:"PtgIsect",f:ht},16:{n:"PtgUnion",f:ht},17:{n:"PtgRange",f:ht},18:{n:"PtgUplus",f:ht},19:{n:"PtgUminus",f:ht},20:{n:"PtgPercent",f:ht},21:{n:"PtgParen",f:ht},22:{n:"PtgMissArg",f:ht},23:{n:"PtgStr",f:vT},26:{n:"PtgSheet",f:WT},27:{n:"PtgEndSheet",f:VT},28:{n:"PtgErr",f:dT},29:{n:"PtgBool",f:gT},30:{n:"PtgInt",f:pT},31:{n:"PtgNum",f:mT},32:{n:"PtgArray",f:YE},33:{n:"PtgFunc",f:lT},34:{n:"PtgFuncVar",f:cT},35:{n:"PtgName",f:yT},36:{n:"PtgRef",f:sT},37:{n:"PtgArea",f:KE},38:{n:"PtgMemArea",f:ST},39:{n:"PtgMemErr",f:kT},40:{n:"PtgMemNoMem",f:CT},41:{n:"PtgMemFunc",f:AT},42:{n:"PtgRefErr",f:bT},43:{n:"PtgAreaErr",f:qE},44:{n:"PtgRefN",f:aT},45:{n:"PtgAreaN",f:JE},46:{n:"PtgMemAreaN",f:GT},47:{n:"PtgMemNoMemN",f:KT},57:{n:"PtgNameX",f:ET},58:{n:"PtgRef3d",f:oT},59:{n:"PtgArea3d",f:zE},60:{n:"PtgRefErr3d",f:OT},61:{n:"PtgAreaErr3d",f:XE},255:{}},qT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},XT={1:{n:"PtgElfLel",f:e1},2:{n:"PtgElfRw",f:MT},3:{n:"PtgElfCol",f:IT},6:{n:"PtgElfRwV",f:UT},7:{n:"PtgElfColV",f:NT},10:{n:"PtgElfRadical",f:DT},11:{n:"PtgElfRadicalS",f:BT},13:{n:"PtgElfColS",f:FT},15:{n:"PtgElfColSV",f:PT},16:{n:"PtgElfRadicalLel",f:LT},25:{n:"PtgList",f:$T},29:{n:"PtgSxName",f:HT},255:{}},JT={0:{n:"PtgAttrNoop",f:zT},1:{n:"PtgAttrSemi",f:rT},2:{n:"PtgAttrIf",f:eT},4:{n:"PtgAttrChoose",f:QE},8:{n:"PtgAttrGoto",f:ZE},16:{n:"PtgAttrSum",f:fT},32:{n:"PtgAttrBaxcel",f:Zf},33:{n:"PtgAttrBaxcel",f:Zf},64:{n:"PtgAttrSpace",f:nT},65:{n:"PtgAttrSpaceSemi",f:iT},128:{n:"PtgAttrIfError",f:tT},255:{}};function YT(e,t,r,n){if(n.biff<8)return Hr(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=wT(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=xT(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Hr(e,t)),s}function QT(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=e0[s]||e0[qT[s]],(s===24||s===25)&&(i=(s===24?XT:JT)[e[e.l+1]]),!i||!i.f?Hr(e,t):a.push([i.n,i.f(e,t,r)]);return a}function ZT(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var eS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tS(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function t1(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function t0(e,t,r){var n=t1(e,t,r);return n=="#REF"?n:tS(n,r)}function Li(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,f=0,h=0,d,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",w=0,T=e[0].length;w<T;++w){var _=e[0][w];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=lt(" ",e[0][p][1][1]);break;case 1:m=lt("\r",e[0][p][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+m,p=-1}o.push(c+eS[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=vs(_[1][1],a,i),o.push(_s(u,s));break;case"PtgRefN":u=r?vs(_[1][1],r,i):_[1][1],o.push(_s(u,s));break;case"PtgRef3d":f=_[1][1],u=vs(_[1][2],a,i),g=t0(n,f,i),o.push(g+"!"+_s(u,s));break;case"PtgFunc":case"PtgFuncVar":var O=_[1][0],V=_[1][1];O||(O=0),O&=127;var ee=O==0?[]:o.slice(-O);o.length-=O,V==="User"&&(V=ee.shift()),o.push(V+"("+ee.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":d=Uf(_[1][1],r?{s:r}:a,i),o.push(sl(d,i));break;case"PtgArea":d=Uf(_[1][1],a,i),o.push(sl(d,i));break;case"PtgArea3d":f=_[1][1],d=_[1][2],g=t0(n,f,i),o.push(g+"!"+sl(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=_[1][2];var R=(n.names||[])[h-1]||(n[0]||[])[h],q=R?R.Name:"SH33TJSNAME"+String(h);q&&q.slice(0,6)=="_xlfn."&&!i.xlfn&&(q=q.slice(6)),o.push(q);break;case"PtgNameX":var B=_[1][1];h=_[1][2];var te;if(i.biff<=5)B<0&&(B=-B),n[B]&&(te=n[B][h]);else{var ne="";if(((n[B]||[])[0]||[])[0]==14849||(((n[B]||[])[0]||[])[0]==1025?n[B][h]&&n[B][h].itab>0&&(ne=n.SheetNames[n[B][h].itab-1]+"!"):ne=n.SheetNames[h-1]+"!"),n[B]&&n[B][h])ne+=n[B][h].Name;else if(n[0]&&n[0][h])ne+=n[0][h].Name;else{var se=(t1(n,B,i)||"").split(";;");se[h-1]?ne=se[h-1]:ne+="SH33TJSERRX"}o.push(ne);break}te||(te={Name:"SH33TJSERRY"}),o.push(te.Name);break;case"PtgParen":var de="(",Be=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:de=lt(" ",e[0][p][1][1])+de;break;case 3:de=lt("\r",e[0][p][1][1])+de;break;case 4:Be=lt(" ",e[0][p][1][1])+Be;break;case 5:Be=lt("\r",e[0][p][1][1])+Be;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(de+o.pop()+Be);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var ke={c:r.c,r:r.r};if(n.sharedf[qe(u)]){var Le=n.sharedf[qe(u)];o.push(Li(Le,a,ke,n,i))}else{var Ae=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Li(c[1],a,ke,n,i)),Ae=!0;break}Ae||o.push(_[1])}break;case"PtgArray":o.push("{"+ZT(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&Fe.indexOf(e[0][w][0])==-1){_=e[0][p];var Xe=!0;switch(_[1][0]){case 4:Xe=!1;case 0:m=lt(" ",_[1][1]);break;case 5:Xe=!1;case 1:m=lt("\r",_[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Xe?m:"")+o.pop()+(Xe?"":m)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function rS(e){if(e==null){var t=z(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Yn(e);return Yn(0)}function nS(e,t,r,n,i){var s=Qn(t,r,i),a=rS(e.v),o=z(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=z(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var f=Rt([s,a,o,c]);return f}function Ro(e,t,r){var n=e.read_shift(4),i=QT(e,n,r),s=e.read_shift(4),a=s>0?YT(e,s,i,r):null;return[i,a]}var iS=Ro,Io=Ro,sS=Ro,aS=Ro,oS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},r1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cS(e){var t="of:="+e.replace(Uc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function uS(e){return e.replace(/\./,"!")}var xs=typeof Map<"u";function Hc(e,t,r){var n=0,i=e.length;if(r){if(xs?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=xs?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(xs?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Fo(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(tn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=to(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=zl(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function n1(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Rn(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Qd(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function fS(e,t,r){if(e&&e["!ref"]){var n=tt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function hS(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+gt(e[r])+'"/>';return t+"</mergeCells>"}function dS(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Is(ze(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+fe("outlinePr",null,c)}!s&&!o||(i[i.length]=fe("sheetPr",o,a))}var pS=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gS=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function mS(e){var t={sheet:1};return pS.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),gS.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=jp(e.password).toString(16).toUpperCase()),fe("sheetProtection",null,t)}function vS(e){return n1(e),fe("pageMargins",null,e)}function _S(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=fe("col",null,Fo(i,n)));return r[r.length]="</cols>",r.join("")}function xS(e,t,r,n){var i=typeof e.ref=="string"?e.ref:gt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=hr(i);a.s.r==a.e.r&&(a.e.r=hr(t["!ref"]).e.r,i=gt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),fe("autoFilter",null,{ref:i})}function wS(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),fe("sheetViews",fe("sheetView",null,i),{})}function yS(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Gs[e.v];break;case"d":n&&n.cellDates?i=Xt(e.v,-1).toISOString():(e=tr(e),e.t="n",i=""+(e.v=er(Xt(e.v)))),typeof e.z>"u"&&(e.z=ct[14]);break;default:i=e.v;break}var o=It("v",ze(i)),l={r:t},c=Rn(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=It("v",""+Hc(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=fe("f",ze(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),fe("c",o,l)}function ES(e,t,r,n){var i=[],s=[],a=tt(e["!ref"]),o="",l,c="",u=[],f=0,h=0,d=e["!rows"],g=Array.isArray(e),p={r:c},m,w=-1;for(h=a.s.c;h<=a.e.c;++h)u[h]=$t(h);for(f=a.s.r;f<=a.e.r;++f){for(s=[],c=Ft(f),h=a.s.c;h<=a.e.c;++h){l=u[h]+c;var T=g?(e[f]||[])[h]:e[l];T!==void 0&&(o=yS(T,l,e,t))!=null&&s.push(o)}(s.length>0||d&&d[f])&&(p={r:c},d&&d[f]&&(m=d[f],m.hidden&&(p.hidden=1),w=-1,m.hpx?w=ro(m.hpx):m.hpt&&(w=m.hpt),w>-1&&(p.ht=w,p.customHeight=1),m.level&&(p.outlineLevel=m.level)),i[i.length]=fe("row",s.join(""),p))}if(d)for(;f<d.length;++f)d&&d[f]&&(p={r:f+1},m=d[f],m.hidden&&(p.hidden=1),w=-1,m.hpx?w=ro(m.hpx):m.hpt&&(w=m.hpt),w>-1&&(p.ht=w,p.customHeight=1),m.level&&(p.outlineLevel=m.level),i[i.length]=fe("row","",p));return i.join("")}function i1(e,t,r,n){var i=[vt,fe("worksheet",null,{xmlns:ji[0],"xmlns:r":wt.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=tt(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=gt(u)}n||(n={}),l["!comments"]=[];var f=[];dS(l,r,e,t,i),i[i.length]=fe("dimension",null,{ref:c}),i[i.length]=wS(l,t,e,r),t.sheetFormat&&(i[i.length]=fe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=_S(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=ES(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=mS(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=xS(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=hS(l["!merges"]));var h=-1,d,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=Ke(n,-1,ze(p[1].Target).replace(/#.*$/,""),Me.HLINK),d["r:id"]="rId"+g),(h=p[1].Target.indexOf("#"))>-1&&(d.location=ze(p[1].Target.slice(h+1))),p[1].Tooltip&&(d.tooltip=ze(p[1].Tooltip)),i[i.length]=fe("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=vS(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=It("ignoredErrors",fe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(g=Ke(n,-1,"../drawings/drawing"+(e+1)+".xml",Me.DRAW),i[i.length]=fe("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=f),l["!comments"].length>0&&(g=Ke(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Me.VML),i[i.length]=fe("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function TS(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function SS(e,t,r){var n=z(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=ro(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[qe(c)];g&&(f<0&&(f=d),h=d)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function AS(e,t,r,n){var i=SS(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&re(e,0,i)}var bS=ni,OS=Hi;function kS(){}function CS(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Uy(e),r}function RS(e,t,r){r==null&&(r=z(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Qa({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),xp(e,r),r.slice(0,r.l)}function IS(e){var t=_r(e);return[t]}function FS(e,t,r){return r==null&&(r=z(8)),ei(t,r)}function PS(e){var t=ti(e);return[t]}function NS(e,t,r){return r==null&&(r=z(4)),ri(t,r)}function DS(e){var t=_r(e),r=e.read_shift(1);return[t,r,"b"]}function LS(e,t,r){return r==null&&(r=z(9)),ei(t,r),r.write_shift(1,e.v?1:0),r}function BS(e){var t=ti(e),r=e.read_shift(1);return[t,r,"b"]}function MS(e,t,r){return r==null&&(r=z(5)),ri(t,r),r.write_shift(1,e.v?1:0),r}function US(e){var t=_r(e),r=e.read_shift(1);return[t,r,"e"]}function jS(e,t,r){return r==null&&(r=z(9)),ei(t,r),r.write_shift(1,e.v),r}function $S(e){var t=ti(e),r=e.read_shift(1);return[t,r,"e"]}function HS(e,t,r){return r==null&&(r=z(8)),ri(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function WS(e){var t=_r(e),r=e.read_shift(4);return[t,r,"s"]}function VS(e,t,r){return r==null&&(r=z(12)),ei(t,r),r.write_shift(4,t.v),r}function GS(e){var t=ti(e),r=e.read_shift(4);return[t,r,"s"]}function KS(e,t,r){return r==null&&(r=z(8)),ri(t,r),r.write_shift(4,t.v),r}function zS(e){var t=_r(e),r=Wi(e);return[t,r,"n"]}function qS(e,t,r){return r==null&&(r=z(16)),ei(t,r),Yn(e.v,r),r}function XS(e){var t=ti(e),r=Wi(e);return[t,r,"n"]}function JS(e,t,r){return r==null&&(r=z(12)),ri(t,r),Yn(e.v,r),r}function YS(e){var t=_r(e),r=wp(e);return[t,r,"n"]}function QS(e,t,r){return r==null&&(r=z(12)),ei(t,r),yp(e.v,r),r}function ZS(e){var t=ti(e),r=wp(e);return[t,r,"n"]}function eA(e,t,r){return r==null&&(r=z(8)),ri(t,r),yp(e.v,r),r}function tA(e){var t=_r(e),r=Nc(e);return[t,r,"is"]}function rA(e){var t=_r(e),r=Ht(e);return[t,r,"str"]}function nA(e,t,r){return r==null&&(r=z(12+4*e.v.length)),ei(t,r),Tt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function iA(e){var t=ti(e),r=Ht(e);return[t,r,"str"]}function sA(e,t,r){return r==null&&(r=z(8+4*e.v.length)),ri(t,r),Tt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function aA(e,t,r){var n=e.l+t,i=_r(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Io(e,n-e.l,r);a[3]=Li(o,null,i,r.supbooks,r)}else e.l=n;return a}function oA(e,t,r){var n=e.l+t,i=_r(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Io(e,n-e.l,r);a[3]=Li(o,null,i,r.supbooks,r)}else e.l=n;return a}function lA(e,t,r){var n=e.l+t,i=_r(e);i.r=r["!row"];var s=Wi(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Io(e,n-e.l,r);a[3]=Li(o,null,i,r.supbooks,r)}else e.l=n;return a}function cA(e,t,r){var n=e.l+t,i=_r(e);i.r=r["!row"];var s=Ht(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Io(e,n-e.l,r);a[3]=Li(o,null,i,r.supbooks,r)}else e.l=n;return a}var uA=ni,fA=Hi;function hA(e,t){return t==null&&(t=z(4)),t.write_shift(4,e),t}function dA(e,t){var r=e.l+t,n=ni(e),i=Dc(e),s=Ht(e),a=Ht(e),o=Ht(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function pA(e,t){var r=z(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Hi({s:Et(e[0]),e:Et(e[0])},r),Lc("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Tt(i||"",r),Tt(e[1].Tooltip||"",r),Tt("",r),r.slice(0,r.l)}function gA(){}function mA(e,t,r){var n=e.l+t,i=Ep(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=iS(e,n-e.l,r);a[1]=o}else e.l=n;return a}function vA(e,t,r){var n=e.l+t,i=ni(e),s=[i];if(r.cellFormula){var a=aS(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function _A(e,t,r){r==null&&(r=z(18));var n=Fo(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var s1=["left","right","top","bottom","header","footer"];function xA(e){var t={};return s1.forEach(function(r){t[r]=Wi(e)}),t}function wA(e,t){return t==null&&(t=z(48)),n1(e),s1.forEach(function(r){Yn(e[r],t)}),t}function yA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function EA(e,t,r){r==null&&(r=z(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function TA(e){var t=z(24);return t.write_shift(4,4),t.write_shift(4,1),Hi(e,t),t}function SA(e,t){return t==null&&(t=z(66)),t.write_shift(2,e.password?jp(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function AA(){}function bA(){}function OA(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=tr(t),t.z=t.z||ct[14],t.v=er(Xt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Rn(i.cellXfs,t,i),t.l&&s["!links"].push([qe(l),t.l]),t.c&&s["!comments"].push([qe(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Hc(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?re(e,18,KS(t,l)):re(e,7,VS(t,l))):(l.t="str",a?re(e,17,sA(t,l)):re(e,6,nA(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?re(e,13,eA(t,l)):re(e,2,QS(t,l)):a?re(e,16,JS(t,l)):re(e,5,qS(t,l)),!0;case"b":return l.t="b",a?re(e,15,MS(t,l)):re(e,4,LS(t,l)),!0;case"e":return l.t="e",a?re(e,14,HS(t,l)):re(e,3,jS(t,l)),!0}return a?re(e,12,NS(t,l)):re(e,1,FS(t,l)),!0}function kA(e,t,r,n){var i=tt(t["!ref"]||"A1"),s,a="",o=[];re(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){a=Ft(u),AS(e,t,i,u);var f=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(o[h]=$t(h)),s=o[h]+a;var d=l?(t[u]||[])[h]:t[s];if(!d){f=!1;continue}f=OA(e,d,u,h,n,t,f)}}re(e,146)}function CA(e,t){!t||!t["!merges"]||(re(e,177,hA(t["!merges"].length)),t["!merges"].forEach(function(r){re(e,176,fA(r))}),re(e,178))}function RA(e,t){!t||!t["!cols"]||(re(e,390),t["!cols"].forEach(function(r,n){r&&re(e,60,_A(n,r))}),re(e,391))}function IA(e,t){!t||!t["!ref"]||(re(e,648),re(e,649,TA(tt(t["!ref"]))),re(e,650))}function FA(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Ke(r,-1,n[1].Target.replace(/#.*$/,""),Me.HLINK);re(e,494,pA(n,i))}}),delete t["!links"]}function PA(e,t,r,n){if(t["!comments"].length>0){var i=Ke(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Me.VML);re(e,551,Lc("rId"+i)),t["!legacy"]=i}}function NA(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:gt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=hr(s);o.s.r==o.e.r&&(o.e.r=hr(t["!ref"]).e.r,s=gt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),re(e,161,Hi(tt(s))),re(e,162)}}function DA(e,t,r){re(e,133),re(e,137,EA(t,r)),re(e,138),re(e,134)}function LA(e,t){t["!protect"]&&re(e,535,SA(t["!protect"]))}function BA(e,t,r,n){var i=Zt(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=tt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],re(i,129),(r.vbaraw||a["!outline"])&&re(i,147,RS(o,a["!outline"])),re(i,148,OS(l)),DA(i,a,r.Workbook),RA(i,a),kA(i,a,e,t),LA(i,a),NA(i,a,r,e),CA(i,a),FA(i,a,n),a["!margins"]&&re(i,476,wA(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&IA(i,a),PA(i,a,e,n),re(i,130),i.end()}function MA(e,t){e.l+=10;var r=Ht(e);return{name:r}}var UA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function jA(e){return!e.Workbook||!e.Workbook.WBProps?"false":vy(e.Workbook.WBProps.date1904)?"true":"false"}var $A="][*?/\\".split("");function a1(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $A.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function HA(e,t,r){e.forEach(function(n,i){a1(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function WA(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];HA(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)fS(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function o1(e){var t=[vt];t[t.length]=fe("workbook",null,{xmlns:ji[0],"xmlns:r":wt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(UA.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=fe("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:ze(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=fe("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=fe("definedName",ze(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function VA(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Kl(e),r.name=Ht(e),r}function GA(e,t){return t||(t=z(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Lc(e.strRelID,t),Tt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function KA(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Ht(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function zA(e,t){t||(t=z(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),xp(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function qA(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=jy(e),a=sS(e,0,r),o=Dc(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function XA(e,t){re(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};re(e,156,GA(i))}re(e,144)}function JA(e,t){t||(t=z(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Tt("SheetJS",t),Tt(Va.version,t),Tt(Va.version,t),Tt("7262",t),t.length>t.l?t.slice(0,t.l):t}function YA(e,t){t||(t=z(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function QA(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(re(e,135),re(e,158,YA(i)),re(e,136))}}function ZA(e,t){var r=Zt();return re(r,131),re(r,128,JA()),re(r,153,zA(e.Workbook&&e.Workbook.WBProps||null)),QA(r,e),XA(r,e),re(r,132),r.end()}function eb(e,t,r){return(t.slice(-4)===".bin"?ZA:o1)(e)}function tb(e,t,r,n,i){return(t.slice(-4)===".bin"?BA:i1)(e,r,n,i)}function rb(e,t,r){return(t.slice(-4)===".bin"?wE:Wp)(e,r)}function nb(e,t,r){return(t.slice(-4)===".bin"?z2:Up)(e,r)}function ib(e,t,r){return(t.slice(-4)===".bin"?LE:qp)(e)}function sb(e){return(e.slice(-4)===".bin"?kE:Kp)()}function ab(e,t){var r=[];return e.Props&&r.push(r2(e.Props,t)),e.Custprops&&r.push(n2(e.Props,e.Custprops)),r.join("")}function ob(){return""}function lb(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(fe("NumberFormat",null,{"ss:Format":ze(ct[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(fe("Style",s.join(""),a))}),fe("Styles",r.join(""))}function l1(e){return fe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+jc(e.Ref,{r:0,c:0})})}function cb(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(l1(i)))}return fe("Names",r.join(""))}function ub(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(l1(o)))}return s.join("")}function fb(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(fe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(fe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(fe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(fe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(It("ProtectContents","True")),e["!protect"].objects&&i.push(It("ProtectObjects","True")),e["!protect"].scenarios&&i.push(It("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(It("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(It("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":fe("WorksheetOptions",i.join(""),{xmlns:or.x})}function hb(e){return e.map(function(t){var r=my(t.t||""),n=fe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return fe("Comment",n,{"ss:Author":t.a})}).join("")}function db(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ze(jc(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=Et(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ze(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ze(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Gs[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ct[14]);break;case"s":f="String",h=gy(e.v||"");break}var d=Rn(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var g=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=hb(e.c)),fe("Cell",p,o)}function pb(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Hp(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gb(e,t,r,n){if(!e["!ref"])return"";var i=tt(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(m,w){Mc(m);var T=!!m.width,_=Fo(w,m),O={"ss:Index":w+1};T&&(O["ss:Width"]=eo(_.width)),m.hidden&&(O["ss:Hidden"]="1"),o.push(fe("Column",null,O))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[pb(c,(e["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>c)&&!(s[a].e.c<f)&&!(s[a].e.r<c)){(s[a].s.c!=f||s[a].s.r!=c)&&(h=!0);break}if(!h){var d={r:c,c:f},g=qe(d),p=l?(e[c]||[])[f]:e[g];u.push(db(p,g,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function mb(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?ub(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?gb(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(fb(s,t,e,r)),n.join("")}function vb(e,t){t||(t={}),e.SSF||(e.SSF=tr(ct)),e.SSF&&(Oo(),bo(e.SSF),t.revssf=ko(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Rn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(ab(e,t)),r.push(ob()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(fe("Worksheet",mb(n,t,e),{"ss:Name":ze(e.SheetNames[n])}));return r[2]=lb(e,t),r[3]=cb(e),vt+fe("Workbook",r.join(""),{xmlns:or.ss,"xmlns:o":or.o,"xmlns:x":or.x,"xmlns:ss":or.ss,"xmlns:dt":or.dt,"xmlns:html":or.html})}var ll={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _b(e,t){var r=[],n=[],i=[],s=0,a,o=kf($f,"n"),l=kf(Hf,"n");if(e.Props)for(a=Pt(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=Pt(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)Fp.indexOf(i[s][0])>-1||Cp.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Je.utils.cfb_add(t,"/SummaryInformation",zf(n,ll.SI,l,Hf)),(r.length||c.length)&&Je.utils.cfb_add(t,"/DocumentSummaryInformation",zf(r,ll.DSI,o,$f,c.length?c:null,ll.UDI))}function xb(e,t){var r=t||{},n=Je.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Je.utils.cfb_add(n,i,c1(e,r)),r.biff==8&&(e.Props||e.Custprops)&&_b(e,n),r.biff==8&&e.vbaraw&&BE(n,Je.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var wb={0:{f:TS},1:{f:IS},2:{f:YS},3:{f:US},4:{f:DS},5:{f:zS},6:{f:rA},7:{f:WS},8:{f:cA},9:{f:lA},10:{f:aA},11:{f:oA},12:{f:PS},13:{f:ZS},14:{f:$S},15:{f:BS},16:{f:XS},17:{f:iA},18:{f:GS},19:{f:Nc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:qA},40:{},42:{},43:{f:rE},44:{f:eE},45:{f:sE},46:{f:oE},47:{f:aE},48:{},49:{f:Py},50:{},51:{f:TE},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:N2},62:{f:tA},63:{f:CE},64:{f:AA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CS},148:{f:bS,p:16},151:{f:gA},152:{},153:{f:KA},154:{},155:{},156:{f:VA},157:{},158:{},159:{T:1,f:V2},160:{T:-1},161:{T:1,f:ni},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:yE},336:{T:-1},337:{f:bE,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:k2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mA},427:{f:vA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:kS},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:dA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:NE},633:{T:1},634:{T:-1},635:{T:1,f:FE},636:{T:-1},637:{f:By},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:MA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:bA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function he(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Ic(r)&&e.push(r)}}function yb(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return he(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function zs(e,t,r){return e||(e=z(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Eb(e,t,r,n){var i=z(9);return zs(i,e,t),Np(r,n||"b",i),i}function Tb(e,t,r){var n=z(8+2*r.length);return zs(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Sb(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?er(Xt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?he(e,2,M2(r,n,i)):he(e,3,B2(r,n,i));return;case"b":case"e":he(e,5,Eb(r,n,t.v,t.t));return;case"s":case"str":he(e,4,Tb(r,n,(t.v||"").slice(0,255)));return}he(e,1,zs(null,r,n))}function Ab(e,t,r,n){var i=Array.isArray(t),s=tt(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=gt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Ft(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=$t(u)),a=l[u]+o;var f=i?(t[c]||[])[u]:t[a];f&&Sb(e,f,c,u)}}}function bb(e,t){for(var r=t||{},n=Zt(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return he(n,r.biff==4?1033:r.biff==3?521:9,Bc(e,16,r)),Ab(n,e.Sheets[e.SheetNames[i]],i,r),he(n,10),n.end()}function Ob(e,t,r){he(e,49,w2({sz:12,name:"Arial"},r))}function kb(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&he(e,1054,T2(i,t[i],r))})}function Cb(e,t){var r=z(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),he(e,2151,r),r=z(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Bp(tt(t["!ref"]||"A1"),r),r.write_shift(4,4),he(e,2152,r)}function Rb(e,t){for(var r=0;r<16;++r)he(e,224,Xf({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){he(e,224,Xf(n,0,t))})}function Ib(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];he(e,440,I2(n)),n[1].Tooltip&&he(e,2048,F2(n))}delete t["!links"]}function Fb(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&he(e,125,D2(Fo(i,n),i))})}}function Pb(e,t,r,n,i){var s=16+Rn(i.cellXfs,t,i);if(t.v==null&&!t.bf){he(e,513,Qn(r,n,s));return}if(t.bf)he(e,6,nS(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?er(Xt(t.v)):t.v;he(e,515,O2(r,n,a,s));break;case"b":case"e":he(e,517,b2(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Hc(i.Strings,t.v,i.revStrings);he(e,253,y2(r,n,o,s))}else he(e,516,E2(r,n,(t.v||"").slice(0,255),s,i));break;default:he(e,513,Qn(r,n,s))}}function Nb(e,t,r){var n=Zt(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,f="",h=[],d=tt(s["!ref"]||"A1"),g=c?65536:16384;if(d.e.c>255||d.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}he(n,2057,Bc(r,16,t)),he(n,13,gr(1)),he(n,12,gr(100)),he(n,15,zt(!0)),he(n,17,zt(!1)),he(n,16,Yn(.001)),he(n,95,zt(!0)),he(n,42,zt(!1)),he(n,43,zt(!1)),he(n,130,gr(1)),he(n,128,A2()),he(n,131,zt(!1)),he(n,132,zt(!1)),c&&Fb(n,s["!cols"]),he(n,512,S2(d,t)),c&&(s["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){f=Ft(p);for(var m=d.s.c;m<=d.e.c;++m){p===d.s.r&&(h[m]=$t(m)),u=h[m]+f;var w=l?(s[p]||[])[m]:s[u];w&&(Pb(n,w,p,m,t),c&&w.l&&s["!links"].push([u,w.l]))}}var T=o.CodeName||o.name||i;return c&&he(n,574,x2((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&he(n,229,R2(s["!merges"])),c&&Ib(n,s),he(n,442,Lp(T)),c&&Cb(n,s),he(n,10),n.end()}function Db(e,t,r){var n=Zt(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(he(n,2057,Bc(e,5,r)),r.bookType=="xla"&&he(n,135),he(n,225,o?gr(1200):null),he(n,193,a2(2)),l&&he(n,191),l&&he(n,192),he(n,226),he(n,92,g2("SheetJS",r)),he(n,66,gr(o?1200:1252)),o&&he(n,353,gr(0)),o&&he(n,448),he(n,317,L2(e.SheetNames.length)),o&&e.vbaraw&&he(n,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";he(n,442,Lp(c))}he(n,156,gr(17)),he(n,25,zt(!1)),he(n,18,zt(!1)),he(n,19,gr(0)),o&&he(n,431,zt(!1)),o&&he(n,444,gr(0)),he(n,61,_2()),he(n,64,zt(!1)),he(n,141,gr(0)),he(n,34,zt(jA(e)=="true")),he(n,14,zt(!0)),o&&he(n,439,zt(!1)),he(n,218,gr(0)),Ob(n,e,r),kb(n,e.SSF,r),Rb(n,r),o&&he(n,352,zt(!1));var u=n.end(),f=Zt();o&&he(f,140,P2()),o&&r.Strings&&yb(f,252,v2(r.Strings)),he(f,10);var h=f.end(),d=Zt(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var m=u.length+g+h.length;for(p=0;p<e.SheetNames.length;++p){var w=s[p]||{};he(d,133,m2({pos:m,hs:w.Hidden||0,dt:0,name:e.SheetNames[p]},r)),m+=t[p].length}var T=d.end();if(g!=T.length)throw new Error("BS8 "+g+" != "+T.length);var _=[];return u.length&&_.push(u),T.length&&_.push(T),h.length&&_.push(h),Rt(_)}function Lb(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=tr(ct)),e&&e.SSF&&(Oo(),bo(e.SSF),r.revssf=ko(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Wc(r),r.cellXfs=[],Rn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=Nb(i,r,e);return n.unshift(Db(e,n,r)),Rt(n)}function c1(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=hr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return Lb(e,t);case 4:case 3:case 2:return bb(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Bb(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=qe({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],h=f&&f.v!=null&&(f.h||py(f.w||(on(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+u,s.push(fe("td",h,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var Mb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Ub="</body></html>";function jb(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function u1(e,t){var r=t||{},n=r.header!=null?r.header:Mb,i=r.footer!=null?r.footer:Ub,s=[n],a=hr(e["!ref"]);r.dense=Array.isArray(e),s.push(jb(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Bb(e,a,o,r));return s.push("</table>"+i),s.join("")}function f1(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Et(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=hr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),g=0,p=0,m=0,w=0,T=0,_=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&p<l;++g){var O=o[g];if(r0(O)){if(n.display)continue;d[p]={hidden:!0}}var V=O.children;for(m=w=0;m<V.length;++m){var ee=V[m];if(!(n.display&&r0(ee))){var R=ee.hasAttribute("data-v")?ee.getAttribute("data-v"):ee.hasAttribute("v")?ee.getAttribute("v"):_y(ee.innerHTML),q=ee.getAttribute("data-z")||ee.getAttribute("z");for(h=0;h<f.length;++h){var B=f[h];B.s.c==w+s&&B.s.r<p+i&&p+i<=B.e.r&&(w=B.e.c+1-s,h=-1)}_=+ee.getAttribute("colspan")||1,((T=+ee.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:p+i,c:w+s},e:{r:p+i+(T||1)-1,c:w+s+(_||1)-1}});var te={t:"s",v:R},ne=ee.getAttribute("data-t")||ee.getAttribute("t")||"";R!=null&&(R.length==0?te.t=ne||"z":n.raw||R.trim().length==0||ne=="s"||(R==="TRUE"?te={t:"b",v:!0}:R==="FALSE"?te={t:"b",v:!1}:isNaN(en(R))?isNaN(Rs(R).getDate())||(te={t:"d",v:Xt(R)},n.cellDates||(te={t:"n",v:er(te.v)}),te.z=n.dateNF||ct[14]):te={t:"n",v:en(R)})),te.z===void 0&&q!=null&&(te.z=q);var se="",de=ee.getElementsByTagName("A");if(de&&de.length)for(var Be=0;Be<de.length&&!(de[Be].hasAttribute("href")&&(se=de[Be].getAttribute("href"),se.charAt(0)!="#"));++Be);se&&se.charAt(0)!="#"&&(te.l={Target:se}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][w+s]=te):e[qe({c:w+s,r:p+i})]=te,c.e.c<w+s&&(c.e.c=w+s),w+=_}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=gt(c),p>=l&&(e["!fullref"]=gt((c.e.r=o.length-g+p-1+i,c))),e}function h1(e,t){var r=t||{},n=r.dense?[]:{};return f1(n,e,t)}function $b(e,t){return Zn(h1(e,t),t)}function r0(e){var t="",r=Hb(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Hb(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Wb=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Fs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return vt+t}})(),n0=(function(){var e=function(s){return ze(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+ze(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,f=hr(s["!ref"]||"A1"),h=s["!merges"]||[],d=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",m=s["!rows"]||[];for(c=0;c<f.s.r;++c)p=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=f.e.r;++c){for(p=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var w=!1,T={},_="";for(d=0;d!=h.length;++d)if(!(h[d].s.c>u)&&!(h[d].s.r>c)&&!(h[d].e.c<u)&&!(h[d].e.r<c)){(h[d].s.c!=u||h[d].s.r!=c)&&(w=!0),T["table:number-columns-spanned"]=h[d].e.c-h[d].s.c+1,T["table:number-rows-spanned"]=h[d].e.r-h[d].s.r+1;break}if(w){l.push(r);continue}var O=qe({r:c,c:u}),V=g?(s[c]||[])[u]:s[O];if(V&&V.f&&(T["table:formula"]=ze(cS(V.f)),V.F&&V.F.slice(0,O.length)==O)){var ee=hr(V.F);T["table:number-matrix-columns-spanned"]=ee.e.c-ee.s.c+1,T["table:number-matrix-rows-spanned"]=ee.e.r-ee.s.r+1}if(!V){l.push(t);continue}switch(V.t){case"b":_=V.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=V.v?"true":"false";break;case"n":_=V.w||String(V.v||0),T["office:value-type"]="float",T["office:value"]=V.v||0;break;case"s":case"str":_=V.v==null?"":V.v,T["office:value-type"]="string";break;case"d":_=V.w||Xt(V.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=Xt(V.v).toISOString(),T["table:style-name"]="ce1";break;default:l.push(t);continue}var R=e(_);if(V.l&&V.l.Target){var q=V.l.Target;q=q.charAt(0)=="#"?"#"+uS(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),R=fe("text:a",R,{"xlink:href":q.replace(/&/g,"&amp;")})}l.push("          "+fe("table:table-cell",fe("text:p",R,{}),T)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Mc(f),f.ods=o;var h=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[vt],c=Fs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Fs({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(Op().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(n(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function d1(e,t){if(t.bookType=="fods")return n0(e,t);var r=Oc(),n="",i=[],s=[];return n="mimetype",Pe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Pe(r,n,n0(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Pe(r,n,Wb(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Pe(r,n,vt+Op()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Pe(r,n,t2(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Pe(r,n,Zy(i)),r}function no(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Vb(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ar(Is(e))}function Gb(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function kn(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Kb(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function Ps(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ge(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ci(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Ps(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Ps(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Ot(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Ge(n*8+i.type)),i.type==2&&t.push(Ge(i.data.length)),t.push(i.data))})}),kn(t)}function xr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Ps(e,n),s=xt(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:Ci(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=xt(o.data),c=Ci(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=Ci(s[3][0].data)>>>0>0),r.push(a)}return r}function ui(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ge(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ge(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ge(a.data.length)}],n[2].push({data:Ot(a.meta),type:2})});var s=Ot(n);t.push(Ge(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),kn(t)}function zb(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ps(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[kn(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=kn(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function wr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(zb(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return kn(t)}function fi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Ge(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return kn(t)}function cl(e,t){var r=new Uint8Array(32),n=no(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Kb(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function ul(e,t){var r=new Uint8Array(32),n=no(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function dn(e){var t=xt(e);return Ps(t[1][0].data)}function qb(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&Ci(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=no(e[7][0].data),u=0,f=[],h=no(e[4][0].data),d=0,g=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),h.setUint16(p*2,d,!0);var m,w;switch(typeof t[p]){case"string":m=cl({t:"s",v:t[p]},r),w=ul({t:"s",v:t[p]},r);break;case"number":m=cl({t:"n",v:t[p]},r),w=ul({t:"n",v:t[p]},r);break;case"boolean":m=cl({t:"b",v:t[p]},r),w=ul({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(m),u+=m.length,g.push(w),d+=w.length,++l}for(e[2][0].data=Ge(l);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=kn(f),e[3][0].data=kn(g),l}function Xb(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=hr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(gt(n)));var s=io(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(P){typeof P=="string"&&a.push(P)})});var o={},l=[],c=Je.read(t.numbers,{type:"base64"});c.FileIndex.map(function(H,P){return[H,c.FullPaths[P]]}).forEach(function(H){var P=H[0],F=H[1];if(P.type==2&&P.name.match(/\.iwa/)){var Z=P.content,D=wr(Z),Q=xr(D);Q.forEach(function(G){l.push(G.id),o[G.id]={deps:[],location:F,type:Ci(G.messages[0].meta[1][0].data)}})}}),l.sort(function(H,P){return H-P});var u=l.filter(function(H){return H>1}).map(function(H){return[H,Ge(H)]});c.FileIndex.map(function(H,P){return[H,c.FullPaths[P]]}).forEach(function(H){var P=H[0];if(H[1],!!P.name.match(/\.iwa/)){var F=xr(wr(P.content));F.forEach(function(Z){Z.messages.forEach(function(D){u.forEach(function(Q){Z.messages.some(function(G){return Ci(G.meta[1][0].data)!=11006&&Gb(G.data,Q[1])})&&o[Q[0]].deps.push(Z.id)})})})}});for(var f=Je.find(c,o[1].location),h=xr(wr(f.content)),d,g=0;g<h.length;++g){var p=h[g];p.id==1&&(d=p)}var m=dn(xt(d.messages[0].data)[1][0].data);for(f=Je.find(c,o[m].location),h=xr(wr(f.content)),g=0;g<h.length;++g)p=h[g],p.id==m&&(d=p);for(m=dn(xt(d.messages[0].data)[2][0].data),f=Je.find(c,o[m].location),h=xr(wr(f.content)),g=0;g<h.length;++g)p=h[g],p.id==m&&(d=p);for(m=dn(xt(d.messages[0].data)[2][0].data),f=Je.find(c,o[m].location),h=xr(wr(f.content)),g=0;g<h.length;++g)p=h[g],p.id==m&&(d=p);var w=xt(d.messages[0].data);{w[6][0].data=Ge(n.e.r+1),w[7][0].data=Ge(n.e.c+1);var T=dn(w[46][0].data),_=Je.find(c,o[T].location),O=xr(wr(_.content));{for(var V=0;V<O.length&&O[V].id!=T;++V);if(O[V].id!=T)throw"Bad ColumnRowUIDMapArchive";var ee=xt(O[V].messages[0].data);ee[1]=[],ee[2]=[],ee[3]=[];for(var R=0;R<=n.e.c;++R){var q=[];q[1]=q[2]=[{type:0,data:Ge(R+420690)}],ee[1].push({type:2,data:Ot(q)}),ee[2].push({type:0,data:Ge(R)}),ee[3].push({type:0,data:Ge(R)})}ee[4]=[],ee[5]=[],ee[6]=[];for(var B=0;B<=n.e.r;++B)q=[],q[1]=q[2]=[{type:0,data:Ge(B+726270)}],ee[4].push({type:2,data:Ot(q)}),ee[5].push({type:0,data:Ge(B)}),ee[6].push({type:0,data:Ge(B)});O[V].messages[0].data=Ot(ee)}_.content=fi(ui(O)),_.size=_.content.length,delete w[46];var te=xt(w[4][0].data);{te[7][0].data=Ge(n.e.r+1);var ne=xt(te[1][0].data),se=dn(ne[2][0].data);_=Je.find(c,o[se].location),O=xr(wr(_.content));{if(O[0].id!=se)throw"Bad HeaderStorageBucket";var de=xt(O[0].messages[0].data);for(B=0;B<s.length;++B){var Be=xt(de[2][0].data);Be[1][0].data=Ge(B),Be[4][0].data=Ge(s[B].length),de[2][B]={type:de[2][0].type,data:Ot(Be)}}O[0].messages[0].data=Ot(de)}_.content=fi(ui(O)),_.size=_.content.length;var ke=dn(te[2][0].data);_=Je.find(c,o[ke].location),O=xr(wr(_.content));{if(O[0].id!=ke)throw"Bad HeaderStorageBucket";for(de=xt(O[0].messages[0].data),R=0;R<=n.e.c;++R)Be=xt(de[2][0].data),Be[1][0].data=Ge(R),Be[4][0].data=Ge(n.e.r+1),de[2][R]={type:de[2][0].type,data:Ot(Be)};O[0].messages[0].data=Ot(de)}_.content=fi(ui(O)),_.size=_.content.length;var Le=dn(te[4][0].data);(function(){for(var H=Je.find(c,o[Le].location),P=xr(wr(H.content)),F,Z=0;Z<P.length;++Z){var D=P[Z];D.id==Le&&(F=D)}var Q=xt(F.messages[0].data);{Q[3]=[];var G=[];a.forEach(function(E,k){G[1]=[{type:0,data:Ge(k)}],G[2]=[{type:0,data:Ge(1)}],G[3]=[{type:2,data:Vb(E)}],Q[3].push({type:2,data:Ot(G)})})}F.messages[0].data=Ot(Q);var X=ui(P),ye=fi(X);H.content=ye,H.size=H.content.length})();var Ae=xt(te[3][0].data);{var Fe=Ae[1][0];delete Ae[2];var Xe=xt(Fe.data);{var ut=dn(Xe[2][0].data);(function(){for(var H=Je.find(c,o[ut].location),P=xr(wr(H.content)),F,Z=0;Z<P.length;++Z){var D=P[Z];D.id==ut&&(F=D)}var Q=xt(F.messages[0].data);{delete Q[6],delete Ae[7];var G=new Uint8Array(Q[5][0].data);Q[5]=[];for(var X=0,ye=0;ye<=n.e.r;++ye){var E=xt(G);X+=qb(E,s[ye],a),E[1][0].data=Ge(ye),Q[5].push({data:Ot(E),type:2})}Q[1]=[{type:0,data:Ge(n.e.c+1)}],Q[2]=[{type:0,data:Ge(n.e.r+1)}],Q[3]=[{type:0,data:Ge(X)}],Q[4]=[{type:0,data:Ge(n.e.r+1)}]}F.messages[0].data=Ot(Q);var k=ui(P),I=fi(k);H.content=I,H.size=H.content.length})()}Fe.data=Ot(Xe)}te[3][0].data=Ot(Ae)}w[4][0].data=Ot(te)}d.messages[0].data=Ot(w);var rt=ui(h),C=fi(rt);return f.content=C,f.size=f.content.length,c}function Jb(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Wc(e){Jb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Yb(e,t){return t.bookType=="ods"?d1(e,t):t.bookType=="numbers"?Xb(e,t):t.bookType=="xlsb"?Qb(e,t):Zb(e,t)}function Qb(e,t){vi=1024,e&&!e.SSF&&(e.SSF=tr(ct)),e&&e.SSF&&(Oo(),bo(e.SSF),t.revssf=ko(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xs?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Xp.indexOf(t.bookType)>-1,i=Sp();Wc(t=t||{});var s=Oc(),a="",o=0;if(t.cellXfs=[],Rn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Pe(s,a,kp(e.Props,t)),i.coreprops.push(a),Ke(t.rels,2,a,Me.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Pe(s,a,Rp(e.Props)),i.extprops.push(a),Ke(t.rels,3,a,Me.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Pe(s,a,Ip(e.Custprops)),i.custprops.push(a),Ke(t.rels,4,a,Me.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Pe(s,a,tb(o-1,a,t,e,u)),i.sheets.push(a),Ke(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Me.WS[0])}if(f){var d=f["!comments"],g=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+r,Pe(s,p,ib(d,p)),i.comments.push(p),Ke(u,-1,"../comments"+o+"."+r,Me.CMNT),g=!0),f["!legacy"]&&g&&Pe(s,"xl/drawings/vmlDrawing"+o+".vml",zp(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Pe(s,bp(a),Oi(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Pe(s,a,nb(t.Strings,a,t)),i.strs.push(a),Ke(t.wbrels,-1,"sharedStrings."+r,Me.SST)),a="xl/workbook."+r,Pe(s,a,eb(e,a)),i.workbooks.push(a),Ke(t.rels,1,a,Me.WB),a="xl/theme/theme1.xml",Pe(s,a,Gp(e.Themes,t)),i.themes.push(a),Ke(t.wbrels,-1,"theme/theme1.xml",Me.THEME),a="xl/styles."+r,Pe(s,a,rb(e,a,t)),i.styles.push(a),Ke(t.wbrels,-1,"styles."+r,Me.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Pe(s,a,e.vbaraw),i.vba.push(a),Ke(t.wbrels,-1,"vbaProject.bin",Me.VBA)),a="xl/metadata."+r,Pe(s,a,sb(a)),i.metadata.push(a),Ke(t.wbrels,-1,"metadata."+r,Me.XLMETA),Pe(s,"[Content_Types].xml",Ap(i,t)),Pe(s,"_rels/.rels",Oi(t.rels)),Pe(s,"xl/_rels/workbook."+r+".rels",Oi(t.wbrels)),delete t.revssf,delete t.ssf,s}function Zb(e,t){vi=1024,e&&!e.SSF&&(e.SSF=tr(ct)),e&&e.SSF&&(Oo(),bo(e.SSF),t.revssf=ko(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xs?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Xp.indexOf(t.bookType)>-1,i=Sp();Wc(t=t||{});var s=Oc(),a="",o=0;if(t.cellXfs=[],Rn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Pe(s,a,kp(e.Props,t)),i.coreprops.push(a),Ke(t.rels,2,a,Me.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Pe(s,a,Rp(e.Props)),i.extprops.push(a),Ke(t.rels,3,a,Me.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Pe(s,a,Ip(e.Custprops)),i.custprops.push(a),Ke(t.rels,4,a,Me.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Pe(s,a,i1(o-1,t,e,f)),i.sheets.push(a),Ke(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Me.WS[0])}if(h){var g=h["!comments"],p=!1,m="";if(g&&g.length>0){var w=!1;g.forEach(function(T){T[1].forEach(function(_){_.T==!0&&(w=!0)})}),w&&(m="xl/threadedComments/threadedComment"+o+"."+r,Pe(s,m,RE(g,u,t)),i.threadedcomments.push(m),Ke(f,-1,"../threadedComments/threadedComment"+o+"."+r,Me.TCMNT)),m="xl/comments"+o+"."+r,Pe(s,m,qp(g)),i.comments.push(m),Ke(f,-1,"../comments"+o+"."+r,Me.CMNT),p=!0}h["!legacy"]&&p&&Pe(s,"xl/drawings/vmlDrawing"+o+".vml",zp(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Pe(s,bp(a),Oi(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Pe(s,a,Up(t.Strings,t)),i.strs.push(a),Ke(t.wbrels,-1,"sharedStrings."+r,Me.SST)),a="xl/workbook."+r,Pe(s,a,o1(e)),i.workbooks.push(a),Ke(t.rels,1,a,Me.WB),a="xl/theme/theme1.xml",Pe(s,a,Gp(e.Themes,t)),i.themes.push(a),Ke(t.wbrels,-1,"theme/theme1.xml",Me.THEME),a="xl/styles."+r,Pe(s,a,Wp(e,t)),i.styles.push(a),Ke(t.wbrels,-1,"styles."+r,Me.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Pe(s,a,e.vbaraw),i.vba.push(a),Ke(t.wbrels,-1,"vbaProject.bin",Me.VBA)),a="xl/metadata."+r,Pe(s,a,Kp()),i.metadata.push(a),Ke(t.wbrels,-1,"metadata."+r,Me.XLMETA),u.length>1&&(a="xl/persons/person.xml",Pe(s,a,IE(u)),i.people.push(a),Ke(t.wbrels,-1,"persons/person.xml",Me.PEOPLE)),Pe(s,"[Content_Types].xml",Ap(i,t)),Pe(s,"_rels/.rels",Oi(t.rels)),Pe(s,"xl/_rels/workbook."+r+".rels",Oi(t.wbrels)),delete t.revssf,delete t.ssf,s}function e4(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=an(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function p1(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ws(t.file,Je.write(e,{type:je?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Je.write(e,t)}function t4(e,t){var r=tr(t||{}),n=Yb(e,r);return r4(n,r)}function r4(e,t){var r={},n=je?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Je.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Ao(i))}return t.password&&typeof encrypt_agile<"u"?p1(encrypt_agile(i,t.password),t):t.type==="file"?Ws(t.file,i):t.type=="string"?gs(i):i}function n4(e,t){var r=t||{},n=xb(e,r);return p1(n,r)}function Nr(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Cs(Is(n));case"binary":return Is(n);case"string":return e;case"file":return Ws(t.file,n,"utf8");case"buffer":return je?un(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Nr(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function i4(e,t){switch(t.type){case"base64":return Cs(e);case"binary":return e;case"string":return e;case"file":return Ws(t.file,e,"binary");case"buffer":return je?un(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ga(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Cs(r):t.type=="string"?gs(r):r;case"file":return Ws(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function g1(e,t){Fw(),WA(e);var r=tr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=g1(e,r);return r.type="array",Ao(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Nr(vb(e,r),r);case"slk":case"sylk":return Nr(j2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Nr(u1(e.Sheets[e.SheetNames[i]],r),r);case"txt":return i4(m1(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Nr(Vc(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Nr($2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return ga(U2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Nr(H2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Nr(X2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Nr(Mp.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Nr(d1(e,r),r);case"wk1":return ga(Jf.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return ga(Jf.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ga(c1(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),n4(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return t4(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function s4(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function a4(e,t,r){var n={};return n.type="file",n.file=t,s4(n),g1(e,n)}function o4(e,t,r,n,i,s,a,o){var l=Ft(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var g=a?e[r][d]:e[n[d]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[d]!=null&&(h[s[d]]=c);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(p==null)if(g.t=="e"&&p===null)h[s[d]]=null;else if(c!==void 0)h[s[d]]=c;else if(u&&p===null)h[s[d]]=null;else continue;else h[s[d]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:on(g,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function io(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=tt(u);break;case"number":l=tt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=Ft(l.s.r),h=[],d=[],g=0,p=0,m=Array.isArray(e),w=l.s.r,T=0,_={};m&&!e[w]&&(e[w]=[]);var O=c.skipHidden&&e["!cols"]||[],V=c.skipHidden&&e["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(O[T]||{}).hidden)switch(h[T]=$t(T),r=m?e[w][T]:e[h[T]+f],n){case 1:s[T]=T-l.s.c;break;case 2:s[T]=h[T];break;case 3:s[T]=c.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=on(r,null,c),p=_[a]||0,!p)_[a]=1;else{do o=a+"_"+p++;while(_[o]);_[a]=p,_[o]=1}s[T]=o}for(w=l.s.r+i;w<=l.e.r;++w)if(!(V[w]||{}).hidden){var ee=o4(e,l,w,h,n,s,m,c);(ee.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[g++]=ee.row)}return d.length=g,d}var i0=/"/g;function l4(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",f=Ft(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=o.dense?(e[r]||[])[h]:e[n[h]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:on(d,null,o));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===i||p===s||p===34||o.forceQuotes){u='"'+u.replace(i0,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(i0,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function Vc(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=tt(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(h[g]||{}).hidden||(f[g]=$t(g));for(var p=0,m=i.s.r;m<=i.e.r;++m)(d[m]||{}).hidden||(u=l4(e,i,m,f,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function m1(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Vc(e,t);return r}function c4(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=tt(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=$t(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Ft(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function v1(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Et(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var f=tt(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(p,m){Pt(p).forEach(function(w){(d=h.indexOf(w))==-1&&(h[d=h.length]=w);var T=p[w],_="z",O="",V=qe({c:o+d,r:a+m+i});c=Ns(s,V),T&&typeof T=="object"&&!(T instanceof Date)?s[V]=T:(typeof T=="number"?_="n":typeof T=="boolean"?_="b":typeof T=="string"?_="s":T instanceof Date?(_="d",n.cellDates||(_="n",T=er(T)),O=n.dateNF||ct[14]):T===null&&n.nullError&&(_="e",T=0),c?(c.t=_,c.v=T,delete c.w,delete c.R,O&&(c.z=O)):s[V]=c={t:_,v:T},O&&(c.z=O))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var g=Ft(a);if(i)for(d=0;d<h.length;++d)s[$t(d+o)+g]={t:"s",v:h[d]};return s["!ref"]=gt(u),s}function u4(e,t){return v1(null,e,t)}function Ns(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Et(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ns(e,qe(t)):Ns(e,qe({r:t,c:r||0}))}function f4(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function h4(){return{SheetNames:[],Sheets:{}}}function d4(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(a1(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function p4(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=f4(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function g4(e,t){return e.z=t,e}function _1(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function m4(e,t,r){return _1(e,"#"+t,r)}function v4(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function _4(e,t,r,n){for(var i=typeof t!="string"?t:tt(t),s=typeof t=="string"?t:gt(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Ns(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var fl={encode_col:$t,encode_row:Ft,encode_cell:qe,encode_range:gt,decode_col:Pc,decode_row:Fc,split_cell:Fy,decode_cell:Et,decode_range:hr,format_cell:on,sheet_add_aoa:_p,sheet_add_json:v1,sheet_add_dom:f1,aoa_to_sheet:$i,json_to_sheet:u4,table_to_sheet:h1,table_to_book:$b,sheet_to_csv:Vc,sheet_to_txt:m1,sheet_to_json:io,sheet_to_html:u1,sheet_to_formulae:c4,sheet_to_row_object_array:io,sheet_get_cell:Ns,book_new:h4,book_append_sheet:d4,book_set_sheet_visibility:p4,cell_set_number_format:g4,cell_set_hyperlink:_1,cell_set_internal_link:m4,cell_add_comment:v4,sheet_set_array_formula:_4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const x4={name:"HomePage",data(){return{dersler:[],dersIcerikSayilari:{},dersGmBilgisi:{},dersKatilimcilari:{},loading:!0,exporting:!1}},computed:{dogmDersler(){return this.dersler.filter(e=>this.dersGmBilgisi[e]==="Din retimi Genel Mdrl")},oerhgmDersler(){return this.dersler.filter(e=>this.dersGmBilgisi[e]==="zel Eitim ve Rehberlik Hizmetleri Genel Mdrl")}},async mounted(){await this.loadDersler()},methods:{async loadDersler(){try{const{data:e,error:t}=await Ct.from("icerik_kayitlari").select("ders_adi, gm, katilimci");if(t)throw t;const r=[...new Set(e.map(n=>n.ders_adi).filter(Boolean))];this.dersler=r.sort(),this.dersler.forEach(n=>{const i=e.filter(s=>s.ders_adi===n);this.dersIcerikSayilari[n]=i.length,this.dersGmBilgisi[n]=i[0]?.gm||"",this.dersKatilimcilari[n]=i[0]?.katilimci||""})}catch(e){console.error("Dersler yklenirken hata:",e),alert("Dersler yklenirken bir hata olutu: "+e.message)}finally{this.loading=!1}},goDersDetay(e){this.$router.push({name:"dersDetay",params:{dersAdi:e}})},async exportToExcel(){this.exporting=!0;try{const{data:e,error:t}=await Ct.from("icerik_kayitlari").select("*").order("ders_adi").order("sinif").order("unite");if(t)throw t;const{data:r}=await Ct.from("icerik_turleri").select("*"),{data:n}=await Ct.from("alt_turler").select("*"),i={},s={};r?.forEach(c=>i[c.id]=c.tur_adi),n?.forEach(c=>s[c.id]=c.alt_tur_adi);const a=fl.book_new(),o={};e.forEach(c=>{const u=c.ders_adi||"Bilinmeyen";o[u]||(o[u]=[]),o[u].push(c)}),Object.keys(o).sort().forEach(c=>{const f=o[c].map(g=>({Snf:g.sinif||"","nite/Tema":g.unite||"","Kazanm/renme kts":g.kazanim||"",Aklama:g.aciklama||"","erik Tr":g.icerik_turu||"","1. ncelik Tr":i[g.tur_1_id]||"","1. ncelik Alt Tr":s[g.alt_tur_1_id]||"","2. ncelik Tr":i[g.tur_2_id]||"","2. ncelik Alt Tr":s[g.alt_tur_2_id]||"","3. ncelik Tr":i[g.tur_3_id]||"","3. ncelik Alt Tr":s[g.alt_tur_3_id]||"","4. ncelik Tr":i[g.tur_4_id]||"","4. ncelik Alt Tr":s[g.alt_tur_4_id]||"","5. ncelik Tr":i[g.tur_5_id]||"","5. ncelik Alt Tr":s[g.alt_tur_5_id]||"",Dier:g.diger_aciklama||"",GM:g.gm||"",Katlmc:g.katilimci||""}));let h=c.substring(0,31);h=h.replace(/[\\/*?:\[\]]/g,"");const d=fl.json_to_sheet(f);d["!cols"]=[{wch:12},{wch:40},{wch:60},{wch:40},{wch:15},{wch:20},{wch:25},{wch:20},{wch:25},{wch:20},{wch:25},{wch:20},{wch:25},{wch:20},{wch:25},{wch:30},{wch:35},{wch:30}],fl.book_append_sheet(a,d,h)});const l=new Date().toISOString().split("T")[0];a4(a,`EBA_Icerik_Analizi_${l}.xlsx`),alert("Excel dosyas baaryla oluturuldu!")}catch(e){console.error("Excel export hatas:",e),alert("Excel oluturulurken hata: "+e.message)}finally{this.exporting=!1}}}},w4={class:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100"},y4={class:"bg-white shadow-sm border-b border-slate-200 sticky top-0 z-10"},E4={class:"max-w-full mx-auto px-2 sm:px-3 py-3"},T4={class:"flex items-center justify-between"},S4={class:"flex items-center gap-2"},A4=["disabled"],b4={class:"max-w-full mx-auto px-2 sm:px-3 py-4"},O4={key:0,class:"text-center py-12"},k4={key:1},C4={class:"mb-6"},R4={class:"flex items-center gap-2 mb-3"},I4={class:"text-sm text-slate-500"},F4={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"},P4=["onClick"],N4={class:"flex items-start justify-between"},D4={class:"flex-1 min-w-0"},L4={class:"text-sm font-semibold text-slate-900 truncate group-hover:text-blue-600 transition-colors"},B4={class:"text-xs text-slate-500 mt-1"},M4=["title"],U4={class:"mb-6"},j4={class:"flex items-center gap-2 mb-3"},$4={class:"text-sm text-slate-500"},H4={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"},W4=["onClick"],V4={class:"flex items-start justify-between"},G4={class:"flex-1 min-w-0"},K4={class:"text-sm font-semibold text-slate-900 truncate group-hover:text-green-600 transition-colors"},z4={class:"text-xs text-slate-500 mt-1"},q4=["title"];function X4(e,t,r,n,i,s){const a=Bs("router-link");return xe(),Ee("div",w4,[L("header",y4,[L("div",E4,[L("div",T4,[t[3]||(t[3]=L("div",null,[L("h1",{class:"text-2xl font-bold text-slate-900"},"EBA DJTAL ERK HTYA ANALZ")],-1)),L("div",S4,[L("button",{onClick:t[0]||(t[0]=(...o)=>s.exportToExcel&&s.exportToExcel(...o)),disabled:i.exporting,class:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all text-sm font-medium shadow-sm disabled:opacity-50"},[t[1]||(t[1]=L("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),Vn(" "+Ue(i.exporting?"Da Aktarlyor...":"Excel'e Aktar"),1)],8,A4),yt(a,{to:"/tur-yonetimi",class:"inline-flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-all text-sm font-medium shadow-sm"},{default:lc(()=>[...t[2]||(t[2]=[L("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),Vn(" Tr Ynetimi ",-1)])]),_:1})])])])]),L("main",b4,[i.loading?(xe(),Ee("div",O4,[...t[4]||(t[4]=[L("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-3 border-slate-300 border-t-blue-600"},null,-1)])])):(xe(),Ee("div",k4,[L("div",C4,[L("div",R4,[t[5]||(t[5]=L("span",{class:"bg-blue-100 text-blue-800 text-sm font-bold px-3 py-1 rounded-full"},"DGM",-1)),t[6]||(t[6]=L("h2",{class:"text-lg font-semibold text-slate-900"},"Din retimi Genel Mdrl",-1)),L("span",I4,"("+Ue(s.dogmDersler.length)+" ders)",1)]),L("div",F4,[(xe(!0),Ee(it,null,br(s.dogmDersler,o=>(xe(),Ee("button",{key:o,onClick:l=>s.goDersDetay(o),class:"group bg-white hover:bg-blue-50 border border-slate-200 hover:border-blue-300 rounded-xl p-4 transition-all shadow-sm hover:shadow-md text-left"},[L("div",N4,[L("div",D4,[L("h3",L4,Ue(o),1),L("p",B4,Ue(i.dersIcerikSayilari[o]||0)+" ierik ",1),i.dersKatilimcilari[o]?(xe(),Ee("p",{key:0,class:"text-xs text-slate-400 mt-2",title:i.dersKatilimcilari[o]},[t[7]||(t[7]=L("span",{class:"font-medium text-slate-500"},"Katlmclar:",-1)),Vn(" "+Ue(i.dersKatilimcilari[o]),1)],8,M4)):ft("",!0)]),t[8]||(t[8]=L("svg",{class:"w-5 h-5 text-slate-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all flex-shrink-0 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])],8,P4))),128))])]),L("div",U4,[L("div",j4,[t[9]||(t[9]=L("span",{class:"bg-green-100 text-green-800 text-sm font-bold px-3 py-1 rounded-full"},"ERHGM",-1)),t[10]||(t[10]=L("h2",{class:"text-lg font-semibold text-slate-900"},"zel Eitim ve Rehberlik Hizmetleri Genel Mdrl",-1)),L("span",$4,"("+Ue(s.oerhgmDersler.length)+" ders)",1)]),L("div",H4,[(xe(!0),Ee(it,null,br(s.oerhgmDersler,o=>(xe(),Ee("button",{key:o,onClick:l=>s.goDersDetay(o),class:"group bg-white hover:bg-green-50 border border-slate-200 hover:border-green-300 rounded-xl p-4 transition-all shadow-sm hover:shadow-md text-left"},[L("div",V4,[L("div",G4,[L("h3",K4,Ue(o),1),L("p",z4,Ue(i.dersIcerikSayilari[o]||0)+" ierik ",1),i.dersKatilimcilari[o]?(xe(),Ee("p",{key:0,class:"text-xs text-slate-400 mt-2",title:i.dersKatilimcilari[o]},[t[11]||(t[11]=L("span",{class:"font-medium text-slate-500"},"Katlmclar:",-1)),Vn(" "+Ue(i.dersKatilimcilari[o]),1)],8,q4)):ft("",!0)]),t[12]||(t[12]=L("svg",{class:"w-5 h-5 text-slate-400 group-hover:text-green-600 group-hover:translate-x-1 transition-all flex-shrink-0 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])],8,W4))),128))])])]))])])}const J4=Bi(x4,[["render",X4]]),Y4={name:"TurSecici",props:{icerik:{type:Object,required:!0},column:{type:Number,required:!0},turler:{type:Array,required:!0},altTurler:{type:Array,required:!0}},data(){return{selectedTur:null,selectedAltTur:null,saving:!1,saved:!1,error:!1,savedTimer:null}},computed:{turFieldName(){return`tur_${this.column}_id`},altTurFieldName(){return`alt_tur_${this.column}_id`},currentTurId(){return this.icerik[this.turFieldName]},currentAltTurId(){return this.icerik[this.altTurFieldName]},isAdded(){return this.currentTurId&&this.currentAltTurId},filteredAltTurler(){return this.selectedTur?this.altTurler.filter(e=>e.icerik_turu_id===this.selectedTur):[]}},mounted(){this.currentTurId&&(this.selectedTur=this.currentTurId),this.currentAltTurId&&(this.selectedAltTur=this.currentAltTurId)},beforeUnmount(){this.savedTimer&&clearTimeout(this.savedTimer)},methods:{onTurChange(){this.selectedAltTur=null},onAltTurChange(){},async onEkle(){this.icerik[this.turFieldName]=this.selectedTur,this.icerik[this.altTurFieldName]=this.selectedAltTur,await this.saveWithFeedback(),this.selectedTur=null,this.selectedAltTur=null},async onSil(){this.icerik[this.turFieldName]=null,this.icerik[this.altTurFieldName]=null,await this.saveWithFeedback(),this.selectedTur=null,this.selectedAltTur=null},async saveWithFeedback(){this.savedTimer&&clearTimeout(this.savedTimer),this.saving=!0,this.saved=!1,this.error=!1;try{await this.$emit("save",this.icerik),this.saving=!1,this.saved=!0,this.savedTimer=setTimeout(()=>{this.saved=!1},1e3)}catch(e){this.saving=!1,this.error=!0,console.error("Kayt hatas:",e)}},getTurAdi(e){const t=this.turler.find(r=>r.id===e);return t?t.icerik_turu:""},getAltTurAdi(e){const t=this.altTurler.find(r=>r.id===e);return t?t.alt_tur_adi:""}}},Q4={class:"space-y-1.5"},Z4=["disabled"],eO=["value"],tO=["disabled"],rO=["value"],nO=["disabled"],iO={key:3,class:"flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-300 rounded-lg"},sO={key:4,class:"flex items-center gap-2 p-2 bg-red-50 border border-red-300 rounded-lg"},aO={key:5,class:"flex items-center gap-2 p-2 bg-green-50 border border-green-300 rounded-lg"},oO={key:6,class:"flex items-center justify-between gap-2 p-2 bg-blue-50 border border-blue-200 rounded-lg"},lO={class:"flex-1 min-w-0"},cO={class:"text-xs font-medium text-slate-900 truncate"},uO={class:"text-xs text-slate-600 truncate"};function fO(e,t,r,n,i,s){return xe(),Ee("div",Q4,[s.isAdded?ft("",!0):Br((xe(),Ee("select",{key:0,"onUpdate:modelValue":t[0]||(t[0]=a=>i.selectedTur=a),onChange:t[1]||(t[1]=(...a)=>s.onTurChange&&s.onTurChange(...a)),disabled:i.saving,class:"w-full text-xs px-2 py-1.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white disabled:bg-slate-100"},[t[6]||(t[6]=L("option",{value:null},"Seiniz...",-1)),(xe(!0),Ee(it,null,br(r.turler,a=>(xe(),Ee("option",{key:a.id,value:a.id},Ue(a.icerik_turu),9,eO))),128))],40,Z4)),[[Tu,i.selectedTur]]),i.selectedTur&&!s.isAdded?Br((xe(),Ee("select",{key:1,"onUpdate:modelValue":t[2]||(t[2]=a=>i.selectedAltTur=a),onChange:t[3]||(t[3]=(...a)=>s.onAltTurChange&&s.onAltTurChange(...a)),disabled:i.saving,class:"w-full text-xs px-2 py-1.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white disabled:bg-slate-100"},[t[7]||(t[7]=L("option",{value:null},"Alt tr seiniz...",-1)),(xe(!0),Ee(it,null,br(s.filteredAltTurler,a=>(xe(),Ee("option",{key:a.id,value:a.id},Ue(a.alt_tur_adi),9,rO))),128))],40,tO)),[[Tu,i.selectedAltTur]]):ft("",!0),i.selectedTur&&i.selectedAltTur&&!s.isAdded?(xe(),Ee("button",{key:2,onClick:t[4]||(t[4]=(...a)=>s.onEkle&&s.onEkle(...a)),disabled:i.saving,class:Sn([i.error?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700","w-full px-2 py-1.5 text-white text-xs rounded-lg transition-all disabled:bg-slate-400 disabled:cursor-not-allowed"])},Ue(i.saving?"Kaydediliyor...":i.error?"Tekrar Dene":"Ekle"),11,nO)):ft("",!0),i.saving?(xe(),Ee("div",iO,[...t[8]||(t[8]=[L("div",{class:"animate-spin h-3 w-3 border-2 border-yellow-600 border-t-transparent rounded-full"},null,-1),L("span",{class:"text-xs text-yellow-800"},"Kaydediliyor...",-1)])])):ft("",!0),i.error?(xe(),Ee("div",sO,[...t[9]||(t[9]=[L("svg",{class:"w-3.5 h-3.5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),L("span",{class:"text-xs text-red-800"},"Kayt baarsz",-1)])])):ft("",!0),i.saved?(xe(),Ee("div",aO,[...t[10]||(t[10]=[L("svg",{class:"w-3.5 h-3.5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),L("span",{class:"text-xs text-green-800"},"Kaydedildi",-1)])])):ft("",!0),s.isAdded&&!i.saving&&!i.saved&&!i.error?(xe(),Ee("div",oO,[L("div",lO,[L("div",cO,Ue(s.getTurAdi(s.currentTurId)),1),L("div",uO,Ue(s.getAltTurAdi(s.currentAltTurId)),1)]),L("button",{onClick:t[5]||(t[5]=(...a)=>s.onSil&&s.onSil(...a)),class:"flex-shrink-0 p-1 text-red-600 hover:bg-red-100 rounded transition-all",title:"Sil"},[...t[11]||(t[11]=[L("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])):ft("",!0)])}const hO=Bi(Y4,[["render",fO]]),dO={name:"SinifTablosu",components:{TurSecici:hO},props:{sinif:{type:String,required:!0},icerikler:{type:Array,required:!0}},data(){return{turler:[],altTurler:[],modalAciklama:null,digerSaving:{},digerSaved:{},digerError:{}}},computed:{uniteGruplari(){const e={};this.icerikler.forEach(r=>{let n=r.unite||"nite Belirtilmemi";n=n.replace(//g,"").trim(),e[n]||(e[n]=[]),e[n].push(r)});const t={};return Object.keys(e).sort((r,n)=>{if(r==="nite Belirtilmemi")return 1;if(n==="nite Belirtilmemi")return-1;const i=r.match(/\d+/),s=n.match(/\d+/);return i&&s?parseInt(i[0])-parseInt(s[0]):r.localeCompare(n,"tr")}).forEach(r=>{t[r]=e[r]}),t}},async mounted(){await this.loadTurler(),await this.loadAltTurler()},methods:{hasKazanim(e){return e.some(t=>t.kazanim&&t.kazanim.trim()!=="")},async loadTurler(){try{const{data:e,error:t}=await Ct.from("icerik_turleri").select("*").order("icerik_turu");if(t)throw t;this.turler=e||[]}catch(e){console.error("Trler yklenirken hata:",e)}},async loadAltTurler(){try{const{data:e,error:t}=await Ct.from("icerik_alt_turleri").select("*").order("alt_tur_adi");if(t)throw t;this.altTurler=e||[]}catch(e){console.error("Alt trler yklenirken hata:",e)}},showAciklama(e){e&&e!=="-"&&(this.modalAciklama=e)},closeModal(){this.modalAciklama=null},async saveDiger(e){const t=e.id;this.digerSaving[t]=!0,this.digerSaved[t]=!1,this.digerError[t]=!1;try{const{error:r}=await Ct.from("icerik_kayitlari").update({diger_aciklama:e.diger_aciklama||null}).eq("id",t);if(r)throw r;this.digerSaving[t]=!1,this.digerSaved[t]=!0,setTimeout(()=>{this.digerSaved[t]=!1},1e3)}catch(r){console.error("Kayt hatas:",r),this.digerSaving[t]=!1,this.digerError[t]=!0}},async saveIcerik(e){try{const{error:t}=await Ct.from("icerik_kayitlari").update({tur_1_id:e.tur_1_id||null,alt_tur_1_id:e.alt_tur_1_id||null,tur_2_id:e.tur_2_id||null,alt_tur_2_id:e.alt_tur_2_id||null,tur_3_id:e.tur_3_id||null,alt_tur_3_id:e.alt_tur_3_id||null,tur_4_id:e.tur_4_id||null,alt_tur_4_id:e.alt_tur_4_id||null,tur_5_id:e.tur_5_id||null,alt_tur_5_id:e.alt_tur_5_id||null,diger_aciklama:e.diger_aciklama||null}).eq("id",e.id);if(t)throw t}catch(t){throw console.error("Kayt hatas:",t),t}}}},pO={class:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden mb-4"},gO={class:"bg-gradient-to-r from-slate-800 to-slate-700 px-3 py-2.5"},mO={class:"text-xl font-bold text-white"},vO={class:"text-sm font-normal text-slate-300 ml-2"},_O={class:"overflow-x-auto"},xO={class:"w-full table-fixed"},wO={class:"bg-gradient-to-r from-slate-100 to-slate-50"},yO={key:0,colspan:"9",class:"px-2 py-2"},EO={class:"text-xs font-bold text-slate-800"},TO={class:"px-2 py-2 align-top"},SO={class:"text-xs font-bold text-slate-800"},AO={class:"px-2 py-2 text-xs text-slate-600 align-top"},bO=["onClick"],OO={key:1,class:"text-slate-400"},kO={class:"px-2 py-2 text-xs text-slate-600 align-middle text-center"},CO={class:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs leading-tight inline-block"},RO={class:"px-2 py-2 align-top"},IO={class:"relative"},FO=["onUpdate:modelValue","onBlur"],PO={key:0,class:"absolute right-2 top-1/2 -translate-y-1/2"},NO={key:1,class:"absolute right-2 top-1/2 -translate-y-1/2 text-green-600 text-xs font-semibold"},DO={key:2,class:"absolute right-2 top-1/2 -translate-y-1/2 text-red-600 text-xs font-semibold"},LO={class:"px-2 py-2 text-xs text-slate-700 align-top"},BO={class:"px-2 py-2 text-xs text-slate-600 align-top"},MO=["onClick"],UO={class:"px-2 py-2 text-xs text-slate-600 align-middle text-center"},jO={class:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs leading-tight inline-block"},$O={class:"px-2 py-2 align-top"},HO={class:"relative"},WO=["onUpdate:modelValue","onBlur"],VO={key:0,class:"absolute right-2 top-1/2 -translate-y-1/2"},GO={key:1,class:"absolute right-2 top-1/2 -translate-y-1/2 text-green-600 text-xs font-semibold"},KO={key:2,class:"absolute right-2 top-1/2 -translate-y-1/2 text-red-600 text-xs font-semibold"},zO={class:"flex items-center justify-between p-4 border-b border-slate-200 sticky top-0 bg-white"},qO={class:"p-6"},XO={class:"text-sm text-slate-700 whitespace-pre-wrap leading-relaxed"};function JO(e,t,r,n,i,s){const a=Bs("TurSecici");return xe(),Ee("div",pO,[L("div",gO,[L("h2",mO,[Vn(" Snf: "+Ue(r.sinif)+" ",1),L("span",vO,"("+Ue(r.icerikler.length)+" ierik)",1)])]),L("div",_O,[L("table",xO,[t[5]||(t[5]=L("thead",{class:"bg-slate-50 border-b-2 border-slate-200"},[L("tr",null,[L("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-80"},"renme kts"),L("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-60"},"Aklama"),L("th",{class:"px-2 py-2 text-center text-xs font-semibold text-slate-700 uppercase w-28"},"erk Tr"),L("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"1. NCELK"),L("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"2. NCELK"),L("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"3. NCELK"),L("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"4. NCELK"),L("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-32"},"5. NCELK"),L("th",{class:"px-2 py-2 text-left text-xs font-semibold text-slate-700 uppercase w-40"},"DER")])],-1)),L("tbody",null,[(xe(!0),Ee(it,null,br(s.uniteGruplari,(o,l)=>(xe(),Ee(it,{key:l},[L("tr",wO,[s.hasKazanim(o)?(xe(),Ee("td",yO,[L("h3",EO,Ue(l),1)])):(xe(),Ee(it,{key:1},[L("td",TO,[L("h3",SO,Ue(l),1)]),L("td",AO,[o[0]?.aciklama?(xe(),Ee("div",{key:0,class:"line-clamp-3 cursor-pointer hover:text-blue-600 transition-colors",onClick:c=>s.showAciklama(o[0].aciklama)},Ue(o[0].aciklama),9,bO)):(xe(),Ee("span",OO,"-"))]),L("td",kO,[L("span",CO,Ue(o[0]?.icerik_turu||"-"),1)]),(xe(),Ee(it,null,br(5,c=>L("td",{key:c,class:"px-2 py-2 align-top"},[yt(a,{icerik:o[0],column:c,turler:i.turler,altTurler:i.altTurler,onSave:s.saveIcerik},null,8,["icerik","column","turler","altTurler","onSave"])])),64)),L("td",RO,[L("div",IO,[Br(L("input",{"onUpdate:modelValue":c=>o[0].diger_aciklama=c,onBlur:c=>s.saveDiger(o[0]),type:"text",placeholder:"Dier...",class:Sn(["w-full text-xs px-2 py-1.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",{"border-yellow-400":i.digerSaving[o[0].id],"border-green-500":i.digerSaved[o[0].id],"border-red-500":i.digerError[o[0].id]}])},null,42,FO),[[vn,o[0].diger_aciklama]]),i.digerSaving[o[0].id]?(xe(),Ee("div",PO,[...t[3]||(t[3]=[L("svg",{class:"animate-spin h-3 w-3 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[L("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),L("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):ft("",!0),i.digerSaved[o[0].id]?(xe(),Ee("div",NO,"  ")):ft("",!0),i.digerError[o[0].id]?(xe(),Ee("div",DO,"  ")):ft("",!0)])])],64))]),(xe(!0),Ee(it,null,br(o,(c,u)=>(xe(),Ee(it,{key:c.id},[s.hasKazanim(o)&&c.kazanim?(xe(),Ee("tr",{key:0,class:Sn([u%2===0?"bg-white":"bg-slate-50","hover:bg-blue-50 transition-colors"])},[L("td",LO,Ue(c.kazanim),1),L("td",BO,[L("div",{class:"line-clamp-3 cursor-pointer hover:text-blue-600 transition-colors",onClick:f=>s.showAciklama(c.aciklama)},Ue(c.aciklama||"-"),9,MO)]),L("td",UO,[L("span",jO,Ue(c.icerik_turu||"-"),1)]),(xe(),Ee(it,null,br(5,f=>L("td",{key:f,class:"px-2 py-2 align-top"},[yt(a,{icerik:c,column:f,turler:i.turler,altTurler:i.altTurler,onSave:s.saveIcerik},null,8,["icerik","column","turler","altTurler","onSave"])])),64)),L("td",$O,[L("div",HO,[Br(L("input",{"onUpdate:modelValue":f=>c.diger_aciklama=f,onBlur:f=>s.saveDiger(c),type:"text",placeholder:"Dier...",class:Sn(["w-full text-xs px-2 py-1.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",{"border-yellow-400":i.digerSaving[c.id],"border-green-500":i.digerSaved[c.id],"border-red-500":i.digerError[c.id]}])},null,42,WO),[[vn,c.diger_aciklama]]),i.digerSaving[c.id]?(xe(),Ee("div",VO,[...t[4]||(t[4]=[L("svg",{class:"animate-spin h-3 w-3 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[L("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),L("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):ft("",!0),i.digerSaved[c.id]?(xe(),Ee("div",GO,"  ")):ft("",!0),i.digerError[c.id]?(xe(),Ee("div",KO,"  ")):ft("",!0)])])],2)):ft("",!0)],64))),128))],64))),128))])])]),i.modalAciklama?(xe(),Ee("div",{key:0,onClick:t[2]||(t[2]=(...o)=>s.closeModal&&s.closeModal(...o)),class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},[L("div",{onClick:t[1]||(t[1]=ev(()=>{},["stop"])),class:"bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[80vh] overflow-auto"},[L("div",zO,[t[7]||(t[7]=L("h3",{class:"text-lg font-semibold text-slate-900"},"Aklama",-1)),L("button",{onClick:t[0]||(t[0]=(...o)=>s.closeModal&&s.closeModal(...o)),class:"p-2 hover:bg-slate-100 rounded-lg transition-colors"},[...t[6]||(t[6]=[L("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),L("div",qO,[L("p",XO,Ue(i.modalAciklama),1)])])])):ft("",!0)])}const YO=Bi(dO,[["render",JO]]),QO={name:"DersDetay",components:{SinifTablosu:YO},props:{dersAdi:{type:String,required:!0}},data(){return{icerikler:[],gmBilgisi:"",loading:!0}},computed:{sinifBazindaIcerikler(){const e={};this.icerikler.forEach(r=>{const n=r.sinif||"Belirtilmemi";e[n]||(e[n]=[]),e[n].push(r)});const t={};return Object.keys(e).sort((r,n)=>r==="Belirtilmemi"?1:n==="Belirtilmemi"?-1:r.localeCompare(n,"tr")).forEach(r=>{t[r]=e[r]}),t},toplamIcerik(){return this.icerikler.length}},async mounted(){await this.loadIcerikler()},methods:{async loadIcerikler(){try{const{data:e,error:t}=await Ct.from("icerik_kayitlari").select("*").eq("ders_adi",this.dersAdi).order("sinif",{ascending:!0});if(t)throw t;this.icerikler=e||[],this.icerikler.length>0&&(this.gmBilgisi=this.icerikler[0].gm||"")}catch(e){console.error("erikler yklenirken hata:",e),alert("erikler yklenirken bir hata olutu: "+e.message)}finally{this.loading=!1}}}},ZO={class:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100"},ek={class:"bg-white shadow-sm border-b border-slate-200 sticky top-0 z-10"},tk={class:"max-w-full mx-auto px-2 sm:px-3 py-3"},rk={class:"flex items-center gap-4"},nk={class:"flex-1"},ik={class:"text-2xl font-bold text-slate-900"},sk={class:"text-sm text-slate-600 mt-0.5"},ak={class:"max-w-full mx-auto px-2 sm:px-3 py-4"},ok={key:0,class:"text-center py-12"},lk={key:1},ck={key:0,class:"text-center py-12"};function uk(e,t,r,n,i,s){const a=Bs("SinifTablosu");return xe(),Ee("div",ZO,[L("header",ek,[L("div",tk,[L("div",rk,[L("button",{onClick:t[0]||(t[0]=o=>e.$router.push("/")),class:"p-2 hover:bg-slate-100 rounded-lg transition-colors"},[...t[1]||(t[1]=[L("svg",{class:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),L("div",nk,[L("h1",ik,Ue(r.dersAdi),1),L("p",sk,Ue(s.toplamIcerik)+" ierik",1)]),i.gmBilgisi?(xe(),Ee("span",{key:0,class:Sn([i.gmBilgisi==="Din retimi Genel Mdrl"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800","text-sm font-bold px-3 py-1 rounded-full"])},Ue(i.gmBilgisi),3)):ft("",!0)])])]),L("main",ak,[i.loading?(xe(),Ee("div",ok,[...t[2]||(t[2]=[L("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-3 border-slate-300 border-t-blue-600"},null,-1)])])):(xe(),Ee("div",lk,[(xe(!0),Ee(it,null,br(s.sinifBazindaIcerikler,(o,l)=>(xe(),Ee("div",{key:l,class:"mb-4"},[yt(a,{sinif:l,icerikler:o},null,8,["sinif","icerikler"])]))),128)),Object.keys(s.sinifBazindaIcerikler).length===0?(xe(),Ee("div",ck,[...t[3]||(t[3]=[L("div",{class:"text-slate-400 text-sm"},"Bu ders iin ierik bulunamad.",-1)])])):ft("",!0)]))])])}const fk=Bi(QO,[["render",uk]]),hk={name:"TurYonetimi",data(){return{yukleniyor:!0,turler:[],altTurler:[],yeniTur:"",yeniAltTur:{},yeniAltTurAciklama:{},duzenleniyorTur:null,duzenleniyorTurAdi:"",duzenleniyorAltTur:null,duzenleniyorAltTurAdi:"",duzenleniyorAltTurAciklama:""}},computed:{altTurlerByTur(){const e={};return this.altTurler.forEach(t=>{e[t.icerik_turu_id]||(e[t.icerik_turu_id]=[]),e[t.icerik_turu_id].push(t)}),e}},async mounted(){await this.verileriYukle()},methods:{async verileriYukle(){try{this.yukleniyor=!0;const{data:e,error:t}=await Ct.from("icerik_turleri").select("*").order("icerik_turu");if(t)throw t;this.turler=e;const{data:r,error:n}=await Ct.from("icerik_alt_turleri").select("*").order("alt_tur_adi");if(n)throw n;this.altTurler=r}catch(e){console.error("Veriler yklenirken hata:",e),alert("Veriler yklenirken bir hata olutu: "+e.message)}finally{this.yukleniyor=!1}},async turEkle(){if(this.yeniTur.trim())try{const{data:e,error:t}=await Ct.from("icerik_turleri").insert([{icerik_turu:this.yeniTur.trim()}]).select();if(t)throw t;this.turler.push(e[0]),this.turler.sort((r,n)=>r.icerik_turu.localeCompare(n.icerik_turu,"tr")),this.yeniTur="",alert("Tr baaryla eklendi!")}catch(e){console.error("Tr eklenirken hata:",e),alert("Tr eklenirken bir hata olutu: "+e.message)}},turDuzenleBaslat(e){this.duzenleniyorTur=e.id,this.duzenleniyorTurAdi=e.icerik_turu},async turGuncelle(e){if(this.duzenleniyorTurAdi.trim())try{const{error:t}=await Ct.from("icerik_turleri").update({icerik_turu:this.duzenleniyorTurAdi.trim()}).eq("id",e.id);if(t)throw t;e.icerik_turu=this.duzenleniyorTurAdi.trim(),this.duzenleniyorTur=null,this.turler.sort((r,n)=>r.icerik_turu.localeCompare(n.icerik_turu,"tr")),alert("Tr baaryla gncellendi!")}catch(t){console.error("Tr gncellenirken hata:",t),alert("Tr gncellenirken bir hata olutu: "+t.message)}},async turSil(e){const t=this.altTurlerByTur[e.id]?.length||0,r=t>0?`"${e.icerik_turu}" trn ve ${t} alt trn silmek istediinize emin misiniz?`:`"${e.icerik_turu}" trn silmek istediinize emin misiniz?`;if(confirm(r))try{const{error:n}=await Ct.from("icerik_turleri").delete().eq("id",e.id);if(n)throw n;this.turler=this.turler.filter(i=>i.id!==e.id),this.altTurler=this.altTurler.filter(i=>i.icerik_turu_id!==e.id),alert("Tr baaryla silindi!")}catch(n){console.error("Tr silinirken hata:",n),alert("Tr silinirken bir hata olutu: "+n.message)}},async altTurEkle(e){if(this.yeniAltTur[e]?.trim())try{const{data:t,error:r}=await Ct.from("icerik_alt_turleri").insert([{icerik_turu_id:e,alt_tur_adi:this.yeniAltTur[e].trim(),aciklama:this.yeniAltTurAciklama[e]?.trim()||null}]).select();if(r)throw r;this.altTurler.push(t[0]),this.yeniAltTur[e]="",this.yeniAltTurAciklama[e]="",alert("Alt tr baaryla eklendi!")}catch(t){console.error("Alt tr eklenirken hata:",t),alert("Alt tr eklenirken bir hata olutu: "+t.message)}},altTurDuzenleBaslat(e){this.duzenleniyorAltTur=e.id,this.duzenleniyorAltTurAdi=e.alt_tur_adi,this.duzenleniyorAltTurAciklama=e.aciklama||""},async altTurGuncelle(e){if(this.duzenleniyorAltTurAdi.trim())try{const{error:t}=await Ct.from("icerik_alt_turleri").update({alt_tur_adi:this.duzenleniyorAltTurAdi.trim(),aciklama:this.duzenleniyorAltTurAciklama.trim()||null}).eq("id",e.id);if(t)throw t;e.alt_tur_adi=this.duzenleniyorAltTurAdi.trim(),e.aciklama=this.duzenleniyorAltTurAciklama.trim()||null,this.duzenleniyorAltTur=null,alert("Alt tr baaryla gncellendi!")}catch(t){console.error("Alt tr gncellenirken hata:",t),alert("Alt tr gncellenirken bir hata olutu: "+t.message)}},async altTurSil(e){if(confirm(`"${e.alt_tur_adi}" alt trn silmek istediinize emin misiniz?`))try{const{error:t}=await Ct.from("icerik_alt_turleri").delete().eq("id",e.id);if(t)throw t;this.altTurler=this.altTurler.filter(r=>r.id!==e.id),alert("Alt tr baaryla silindi!")}catch(t){console.error("Alt tr silinirken hata:",t),alert("Alt tr silinirken bir hata olutu: "+t.message)}}}},dk={class:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100"},pk={class:"bg-white shadow-sm border-b border-slate-200 sticky top-0 z-10"},gk={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},mk={class:"flex items-center justify-between"},vk={class:"max-w-full mx-auto px-2 sm:px-3 py-4"},_k={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-6"},xk={class:"flex gap-3"},wk=["disabled"],yk={key:0,class:"text-center py-12"},Ek={key:1,class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Tk={class:"bg-gradient-to-r from-slate-800 to-slate-700 px-4 py-3"},Sk={key:0,class:"flex items-center gap-2"},Ak=["onKeyup"],bk=["onClick"],Ok={key:1,class:"flex items-center justify-between"},kk={class:"flex items-center gap-2"},Ck={class:"text-base font-semibold text-white"},Rk={class:"text-xs text-slate-300 bg-slate-600/50 px-2 py-0.5 rounded-full"},Ik={class:"flex gap-1.5"},Fk=["onClick"],Pk=["onClick"],Nk={class:"px-4 py-2.5 bg-slate-50 border-b border-slate-200"},Dk={class:"flex gap-2"},Lk=["onUpdate:modelValue","onKeyup"],Bk=["onUpdate:modelValue","onKeyup"],Mk=["onClick","disabled"],Uk={class:"p-3 max-h-64 overflow-y-auto"},jk={key:0,class:"text-center py-6 text-slate-400 text-sm"},$k={key:1,class:"space-y-1.5"},Hk={class:"flex-1 min-w-0"},Wk={key:0,class:"flex gap-2"},Vk=["onKeyup"],Gk=["onKeyup"],Kk=["onClick"],zk={class:"text-sm font-medium text-slate-800 truncate"},qk={key:0,class:"text-xs text-slate-500 truncate mt-0.5"},Xk={key:0,class:"flex gap-1 ml-2 opacity-0 group-hover:opacity-100 transition-opacity"},Jk=["onClick"],Yk=["onClick"];function Qk(e,t,r,n,i,s){const a=Bs("router-link");return xe(),Ee("div",dk,[L("header",pk,[L("div",gk,[L("div",mk,[t[12]||(t[12]=L("div",null,[L("h1",{class:"text-2xl font-bold text-slate-900"},"Tr Ynetimi"),L("p",{class:"text-sm text-slate-600 mt-0.5"},"erik trleri ve alt trler")],-1)),yt(a,{to:"/",class:"inline-flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-all text-sm font-medium shadow-sm"},{default:lc(()=>[...t[11]||(t[11]=[L("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),Vn(" Ana Sayfa ",-1)])]),_:1})])])]),L("div",vk,[L("div",_k,[L("div",xk,[Br(L("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>i.yeniTur=o),type:"text",placeholder:"Yeni tr ad...",class:"flex-1 px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",onKeyup:t[1]||(t[1]=Gr((...o)=>s.turEkle&&s.turEkle(...o),["enter"]))},null,544),[[vn,i.yeniTur]]),L("button",{onClick:t[2]||(t[2]=(...o)=>s.turEkle&&s.turEkle(...o)),disabled:!i.yeniTur.trim(),class:"px-5 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all shadow-sm"}," + Tr Ekle ",8,wk)])]),i.yukleniyor?(xe(),Ee("div",yk,[...t[13]||(t[13]=[L("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-3 border-slate-300 border-t-blue-600"},null,-1)])])):(xe(),Ee("div",Ek,[(xe(!0),Ee(it,null,br(i.turler,o=>(xe(),Ee("div",{key:o.id,class:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-all"},[L("div",Tk,[i.duzenleniyorTur===o.id?(xe(),Ee("div",Sk,[Br(L("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>i.duzenleniyorTurAdi=l),type:"text",class:"flex-1 px-3 py-1.5 text-sm border border-slate-300 rounded-lg",onKeyup:[Gr(l=>s.turGuncelle(o),["enter"]),t[4]||(t[4]=Gr(l=>i.duzenleniyorTur=null,["esc"]))]},null,40,Ak),[[vn,i.duzenleniyorTurAdi]]),L("button",{onClick:l=>s.turGuncelle(o),class:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700"},"  ",8,bk),L("button",{onClick:t[5]||(t[5]=l=>i.duzenleniyorTur=null),class:"px-3 py-1.5 bg-slate-600 text-white text-sm rounded-lg hover:bg-slate-700"},"  ")])):(xe(),Ee("div",Ok,[L("div",kk,[L("h2",Ck,Ue(o.icerik_turu),1),L("span",Rk,Ue(s.altTurlerByTur[o.id]?.length||0),1)]),L("div",Ik,[L("button",{onClick:l=>s.turDuzenleBaslat(o),class:"p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded transition-all",title:"Dzenle"},[...t[14]||(t[14]=[L("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Fk),L("button",{onClick:l=>s.turSil(o),class:"p-1.5 text-white/80 hover:text-red-300 hover:bg-red-500/20 rounded transition-all",title:"Sil"},[...t[15]||(t[15]=[L("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Pk)])]))]),L("div",Nk,[L("div",Dk,[Br(L("input",{"onUpdate:modelValue":l=>i.yeniAltTur[o.id]=l,type:"text",placeholder:"Alt tr ad...",class:"flex-1 px-3 py-1.5 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyup:Gr(l=>s.altTurEkle(o.id),["enter"])},null,40,Lk),[[vn,i.yeniAltTur[o.id]]]),Br(L("input",{"onUpdate:modelValue":l=>i.yeniAltTurAciklama[o.id]=l,type:"text",placeholder:"Aklama...",class:"flex-1 px-3 py-1.5 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyup:Gr(l=>s.altTurEkle(o.id),["enter"])},null,40,Bk),[[vn,i.yeniAltTurAciklama[o.id]]]),L("button",{onClick:l=>s.altTurEkle(o.id),disabled:!i.yeniAltTur[o.id]?.trim(),class:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all"}," + ",8,Mk)])]),L("div",Uk,[s.altTurlerByTur[o.id]?.length?(xe(),Ee("div",$k,[(xe(!0),Ee(it,null,br(s.altTurlerByTur[o.id],l=>(xe(),Ee("div",{key:l.id,class:"group flex items-center justify-between p-2.5 bg-slate-50 rounded-lg hover:bg-slate-100 transition-all"},[L("div",Hk,[i.duzenleniyorAltTur===l.id?(xe(),Ee("div",Wk,[Br(L("input",{"onUpdate:modelValue":t[6]||(t[6]=c=>i.duzenleniyorAltTurAdi=c),type:"text",class:"flex-1 px-2 py-1 text-sm border border-slate-300 rounded",onKeyup:[Gr(c=>s.altTurGuncelle(l),["enter"]),t[7]||(t[7]=Gr(c=>i.duzenleniyorAltTur=null,["esc"]))]},null,40,Vk),[[vn,i.duzenleniyorAltTurAdi]]),Br(L("input",{"onUpdate:modelValue":t[8]||(t[8]=c=>i.duzenleniyorAltTurAciklama=c),type:"text",placeholder:"Aklama",class:"flex-1 px-2 py-1 text-sm border border-slate-300 rounded",onKeyup:[Gr(c=>s.altTurGuncelle(l),["enter"]),t[9]||(t[9]=Gr(c=>i.duzenleniyorAltTur=null,["esc"]))]},null,40,Gk),[[vn,i.duzenleniyorAltTurAciklama]]),L("button",{onClick:c=>s.altTurGuncelle(l),class:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700"},"  ",8,Kk),L("button",{onClick:t[10]||(t[10]=c=>i.duzenleniyorAltTur=null),class:"px-2 py-1 bg-slate-600 text-white text-xs rounded hover:bg-slate-700"},"  ")])):(xe(),Ee(it,{key:1},[L("div",zk,Ue(l.alt_tur_adi),1),l.aciklama?(xe(),Ee("div",qk,Ue(l.aciklama),1)):ft("",!0)],64))]),i.duzenleniyorAltTur!==l.id?(xe(),Ee("div",Xk,[L("button",{onClick:c=>s.altTurDuzenleBaslat(l),class:"p-1.5 text-slate-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-all",title:"Dzenle"},[...t[16]||(t[16]=[L("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Jk),L("button",{onClick:c=>s.altTurSil(l),class:"p-1.5 text-slate-600 hover:text-red-600 hover:bg-red-50 rounded transition-all",title:"Sil"},[...t[17]||(t[17]=[L("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[L("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Yk)])):ft("",!0)]))),128))])):(xe(),Ee("div",jk," Alt tr yok "))])]))),128))]))])])}const Zk=Bi(hk,[["render",Qk]]),eC=m_({history:qv(),routes:[{path:"/",name:"home",component:J4},{path:"/ders/:dersAdi",name:"dersDetay",component:fk,props:!0},{path:"/tur-yonetimi",name:"turYonetimi",component:Zk}]}),x1=iv(cv);x1.use(eC);x1.mount("#app");
